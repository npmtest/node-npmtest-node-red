<div class="coverageReportDiv">
<h1>coverage-report</h1>
<div style="background: #fff; border: 1px solid #000; margin 0; padding: 0;">


<!doctype html>
<html lang="en">
<head>
    <title>Code coverage report for All files</title>
    <meta charset="utf-8">
    <style>
        body, html {
            margin:0; padding: 0;
        }
        body {
            font-family: Arial, Helvetica;
            font-size: 10pt;
        }
        div.header, div.footer {
            background: #eee;
            padding: 1em;
        }
        div.header {
            height: 160px;
            padding: 0 1em 0 1em;
            z-index: 100;
            position: fixed;
            top: 0;
            border-bottom: 1px solid #666;
            width: 100%;
        }
        div.footer {
            border-top: 1px solid #666;
        }
        div.body {
            margin-top: 170px;
        }
        div.meta {
            font-size: 90%;
            text-align: center;
        }
        h1, h2, h3 {
            font-weight: normal;
        }
        h1 {
            font-size: 12pt;
        }
        h2 {
            font-size: 10pt;
        }
        pre {
            font-family: Menlo, Monaco, Consolas, Courier New, monospace;
            margin: 0;
            padding: 0;
            font-size: 14px;
            tab-size: 2;
        }

        div.path { font-size: 110%; }
        div.path a:link, div.path a:visited { color: #000; }
        table.coverage { border-collapse: collapse; margin:0; padding: 0 }

        table.coverage td {
            margin: 0;
            padding: 0;
            color: #111;
            vertical-align: top;
        }
        table.coverage td.line-count {
            width: 50px;
            text-align: right;
            padding-right: 5px;
        }
        table.coverage td.line-coverage {
            color: #777 !important;
            text-align: right;
            border-left: 1px solid #666;
            border-right: 1px solid #666;
        }

        table.coverage td.text {
        }

        table.coverage td span.cline-any {
            display: inline-block;
            padding: 0 5px;
            width: 40px;
        }
        table.coverage td span.cline-neutral {
            background: #eee;
        }
        table.coverage td span.cline-yes {
            background: #b5d592;
            color: #999;
        }
        table.coverage td span.cline-no {
            background: #fc8c84;
        }

        .cstat-yes { color: #111; }
        .cstat-no { background: #fc8c84; color: #111; }
        .fstat-no { background: #ffc520; color: #111 !important; }
        .cbranch-no { background:  yellow !important; color: #111; }

        .cstat-skip { background: #ddd; color: #111; }
        .fstat-skip { background: #ddd; color: #111 !important; }
        .cbranch-skip { background: #ddd !important; color: #111; }

        .missing-if-branch {
            display: inline-block;
            margin-right: 10px;
            position: relative;
            padding: 0 4px;
            background: black;
            color: yellow;
        }

        .skip-if-branch {
            display: none;
            margin-right: 10px;
            position: relative;
            padding: 0 4px;
            background: #ccc;
            color: white;
        }

        .missing-if-branch .typ, .skip-if-branch .typ {
            color: inherit !important;
        }

        .entity, .metric { font-weight: bold; }
        .metric { display: inline-block; border: 1px solid #333; padding: 0.3em; background: white; }
        .metric small { font-size: 80%; font-weight: normal; color: #666; }

        div.coverage-summary table { border-collapse: collapse; margin: 3em; font-size: 110%; }
        div.coverage-summary td, div.coverage-summary table  th { margin: 0; padding: 0.25em 1em; border-top: 1px solid #666; border-bottom: 1px solid #666; }
        div.coverage-summary th { text-align: left; border: 1px solid #666; background: #eee; font-weight: normal; }
        div.coverage-summary th.file { border-right: none !important; }
        div.coverage-summary th.pic { border-left: none !important; text-align: right; }
        div.coverage-summary th.pct { border-right: none !important; }
        div.coverage-summary th.abs { border-left: none !important; text-align: right; }
        div.coverage-summary td.pct { text-align: right; border-left: 1px solid #666; }
        div.coverage-summary td.abs { text-align: right; font-size: 90%; color: #444; border-right: 1px solid #666; }
        div.coverage-summary td.file { text-align: right; border-left: 1px solid #666; white-space: nowrap;  }
        div.coverage-summary td.pic { min-width: 120px !important;  }
        div.coverage-summary a:link { color: #000; }
        div.coverage-summary a:visited { color: #333; }
        div.coverage-summary tfoot td { border-top: 1px solid #666; }

        div.coverage-summary .yui3-datatable-sort-indicator, div.coverage-summary .dummy-sort-indicator {
            height: 10px;
            width: 7px;
            display: inline-block;
            margin-left: 0.5em;
        }
        div.coverage-summary .yui3-datatable-sort-indicator {
            background: no-repeat scroll 0 0 transparent;
        }
        div.coverage-summary .yui3-datatable-sorted .yui3-datatable-sort-indicator {
            background-position: 0 -20px;
        }
        div.coverage-summary .yui3-datatable-sorted-desc .yui3-datatable-sort-indicator {
            background-position: 0 -10px;
        }

        .high { background: #b5d592 !important; }
        .medium { background: #ffe87c !important; }
        .low { background: #fc8c84 !important; }

        span.cover-fill, span.cover-empty {
            display:inline-block;
            border:1px solid #444;
            background: white;
            height: 12px;
        }
        span.cover-fill {
            background: #ccc;
            border-right: 1px solid #444;
        }
        span.cover-empty {
            background: white;
            border-left: none;
        }
        span.cover-full {
            border-right: none !important;
        }
        pre.prettyprint {
            border: none !important;
            padding: 0 !important;
            margin: 0 !important;
        }
        .com { color: #999 !important; }
        .ignore-none { color: #999; font-weight: normal; }

    </style>
</head>
<body>
<div class="header low">
    <h1 style="font-weight: bold;">
        <a href="https://github.com/npmtest/node-npmtest-node-red">npmtest-node-red (v0.0.1)</a>
    </h1>
    <h1>Code coverage report for <span class="entity">All files</span></h1>
    <h2>
        
        Statements: <span class="metric">17.74% <small>(686 / 3868)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        
        Branches: <span class="metric">7.74% <small>(154 / 1989)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        
        Functions: <span class="metric">5.31% <small>(28 / 527)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        
        Lines: <span class="metric">17.78% <small>(685 / 3853)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        Ignored: <span class="metric">26 statements, 1 function, 54 branches</span> &nbsp;&nbsp;&nbsp;&nbsp;
    </h2>
    <div class="path"></div>
</div>
<div class="body">
<div class="coverage-summary">
<table>
<thead>
<tr>
   <th data-col="file" data-fmt="html" data-html="true" class="file">File</th>
   <th data-col="pic" data-type="number" data-fmt="html" data-html="true" class="pic"></th>
   <th data-col="statements" data-type="number" data-fmt="pct" class="pct">Statements</th>
   <th data-col="statements_raw" data-type="number" data-fmt="html" class="abs"></th>
   <th data-col="branches" data-type="number" data-fmt="pct" class="pct">Branches</th>
   <th data-col="branches_raw" data-type="number" data-fmt="html" class="abs"></th>
   <th data-col="functions" data-type="number" data-fmt="pct" class="pct">Functions</th>
   <th data-col="functions_raw" data-type="number" data-fmt="html" class="abs"></th>
   <th data-col="lines" data-type="number" data-fmt="pct" class="pct">Lines</th>
   <th data-col="lines_raw" data-type="number" data-fmt="html" class="abs"></th>
</tr>
</thead>
<tbody><tr>
	<td class="file high" data-value="node-npmtest-node-red/"><a href="node-npmtest-node-red/index.html">node-npmtest-node-red/</a></td>
	<td data-value="100" class="pic high"><span class="cover-fill cover-full" style="width: 100px;"></span><span class="cover-empty" style="width:0px;"></span></td>
	<td data-value="100" class="pct high">100%</td>
	<td data-value="151" class="abs high">(151&nbsp;/&nbsp;151)</td>
	<td data-value="100" class="pct high">100%</td>
	<td data-value="124" class="abs high">(124&nbsp;/&nbsp;124)</td>
	<td data-value="100" class="pct high">100%</td>
	<td data-value="27" class="abs high">(27&nbsp;/&nbsp;27)</td>
	<td data-value="100" class="pct high">100%</td>
	<td data-value="151" class="abs high">(151&nbsp;/&nbsp;151)</td>
	</tr>

<tr>
	<td class="file low" data-value="node-npmtest-node-red/node-red/red/"><a href="node-npmtest-node-red/node-red/red/index.html">node-npmtest-node-red/node-red/red/</a></td>
	<td data-value="24" class="pic low"><span class="cover-fill" style="width: 24px;"></span><span class="cover-empty" style="width:76px;"></span></td>
	<td data-value="24" class="pct low">24%</td>
	<td data-value="50" class="abs low">(12&nbsp;/&nbsp;50)</td>
	<td data-value="12.5" class="pct low">12.5%</td>
	<td data-value="16" class="abs low">(2&nbsp;/&nbsp;16)</td>
	<td data-value="0" class="pct low">0%</td>
	<td data-value="11" class="abs low">(0&nbsp;/&nbsp;11)</td>
	<td data-value="24.49" class="pct low">24.49%</td>
	<td data-value="49" class="abs low">(12&nbsp;/&nbsp;49)</td>
	</tr>

<tr>
	<td class="file low" data-value="node-npmtest-node-red/node-red/red/api/"><a href="node-npmtest-node-red/node-red/red/api/index.html">node-npmtest-node-red/node-red/red/api/</a></td>
	<td data-value="15.49" class="pic low"><span class="cover-fill" style="width: 15px;"></span><span class="cover-empty" style="width:85px;"></span></td>
	<td data-value="15.49" class="pct low">15.49%</td>
	<td data-value="794" class="abs low">(123&nbsp;/&nbsp;794)</td>
	<td data-value="0.61" class="pct low">0.61%</td>
	<td data-value="328" class="abs low">(2&nbsp;/&nbsp;328)</td>
	<td data-value="0" class="pct low">0%</td>
	<td data-value="109" class="abs low">(0&nbsp;/&nbsp;109)</td>
	<td data-value="15.49" class="pct low">15.49%</td>
	<td data-value="794" class="abs low">(123&nbsp;/&nbsp;794)</td>
	</tr>

<tr>
	<td class="file low" data-value="node-npmtest-node-red/node-red/red/api/auth/"><a href="node-npmtest-node-red/node-red/red/api/auth/index.html">node-npmtest-node-red/node-red/red/api/auth/</a></td>
	<td data-value="29.69" class="pic low"><span class="cover-fill" style="width: 29px;"></span><span class="cover-empty" style="width:71px;"></span></td>
	<td data-value="29.69" class="pct low">29.69%</td>
	<td data-value="256" class="abs low">(76&nbsp;/&nbsp;256)</td>
	<td data-value="1.96" class="pct low">1.96%</td>
	<td data-value="102" class="abs low">(2&nbsp;/&nbsp;102)</td>
	<td data-value="1.96" class="pct low">1.96%</td>
	<td data-value="51" class="abs low">(1&nbsp;/&nbsp;51)</td>
	<td data-value="29.53" class="pct low">29.53%</td>
	<td data-value="254" class="abs low">(75&nbsp;/&nbsp;254)</td>
	</tr>

<tr>
	<td class="file low" data-value="node-npmtest-node-red/node-red/red/runtime/"><a href="node-npmtest-node-red/node-red/red/runtime/index.html">node-npmtest-node-red/node-red/red/runtime/</a></td>
	<td data-value="15.45" class="pic low"><span class="cover-fill" style="width: 15px;"></span><span class="cover-empty" style="width:85px;"></span></td>
	<td data-value="15.45" class="pct low">15.45%</td>
	<td data-value="479" class="abs low">(74&nbsp;/&nbsp;479)</td>
	<td data-value="0.96" class="pct low">0.96%</td>
	<td data-value="311" class="abs low">(3&nbsp;/&nbsp;311)</td>
	<td data-value="0" class="pct low">0%</td>
	<td data-value="75" class="abs low">(0&nbsp;/&nbsp;75)</td>
	<td data-value="15.58" class="pct low">15.58%</td>
	<td data-value="475" class="abs low">(74&nbsp;/&nbsp;475)</td>
	</tr>

<tr>
	<td class="file low" data-value="node-npmtest-node-red/node-red/red/runtime/nodes/"><a href="node-npmtest-node-red/node-red/red/runtime/nodes/index.html">node-npmtest-node-red/node-red/red/runtime/nodes/</a></td>
	<td data-value="16.88" class="pic low"><span class="cover-fill" style="width: 16px;"></span><span class="cover-empty" style="width:84px;"></span></td>
	<td data-value="16.88" class="pct low">16.88%</td>
	<td data-value="391" class="abs low">(66&nbsp;/&nbsp;391)</td>
	<td data-value="3.33" class="pct low">3.33%</td>
	<td data-value="180" class="abs low">(6&nbsp;/&nbsp;180)</td>
	<td data-value="0" class="pct low">0%</td>
	<td data-value="45" class="abs low">(0&nbsp;/&nbsp;45)</td>
	<td data-value="16.88" class="pct low">16.88%</td>
	<td data-value="391" class="abs low">(66&nbsp;/&nbsp;391)</td>
	</tr>

<tr>
	<td class="file low" data-value="node-npmtest-node-red/node-red/red/runtime/nodes/flows/"><a href="node-npmtest-node-red/node-red/red/runtime/nodes/flows/index.html">node-npmtest-node-red/node-red/red/runtime/nodes/flows/</a></td>
	<td data-value="6.89" class="pic low"><span class="cover-fill" style="width: 6px;"></span><span class="cover-empty" style="width:94px;"></span></td>
	<td data-value="6.89" class="pct low">6.89%</td>
	<td data-value="842" class="abs low">(58&nbsp;/&nbsp;842)</td>
	<td data-value="0" class="pct low">0%</td>
	<td data-value="551" class="abs low">(0&nbsp;/&nbsp;551)</td>
	<td data-value="0" class="pct low">0%</td>
	<td data-value="88" class="abs low">(0&nbsp;/&nbsp;88)</td>
	<td data-value="6.94" class="pct low">6.94%</td>
	<td data-value="836" class="abs low">(58&nbsp;/&nbsp;836)</td>
	</tr>

<tr>
	<td class="file low" data-value="node-npmtest-node-red/node-red/red/runtime/nodes/registry/"><a href="node-npmtest-node-red/node-red/red/runtime/nodes/registry/index.html">node-npmtest-node-red/node-red/red/runtime/nodes/registry/</a></td>
	<td data-value="14.09" class="pic low"><span class="cover-fill" style="width: 14px;"></span><span class="cover-empty" style="width:86px;"></span></td>
	<td data-value="14.09" class="pct low">14.09%</td>
	<td data-value="802" class="abs low">(113&nbsp;/&nbsp;802)</td>
	<td data-value="4.5" class="pct low">4.5%</td>
	<td data-value="333" class="abs low">(15&nbsp;/&nbsp;333)</td>
	<td data-value="0" class="pct low">0%</td>
	<td data-value="97" class="abs low">(0&nbsp;/&nbsp;97)</td>
	<td data-value="14.13" class="pct low">14.13%</td>
	<td data-value="800" class="abs low">(113&nbsp;/&nbsp;800)</td>
	</tr>

<tr>
	<td class="file low" data-value="node-npmtest-node-red/node-red/red/runtime/storage/"><a href="node-npmtest-node-red/node-red/red/runtime/storage/index.html">node-npmtest-node-red/node-red/red/runtime/storage/</a></td>
	<td data-value="12.62" class="pic low"><span class="cover-fill" style="width: 12px;"></span><span class="cover-empty" style="width:88px;"></span></td>
	<td data-value="12.62" class="pct low">12.62%</td>
	<td data-value="103" class="abs low">(13&nbsp;/&nbsp;103)</td>
	<td data-value="0" class="pct low">0%</td>
	<td data-value="44" class="abs low">(0&nbsp;/&nbsp;44)</td>
	<td data-value="0" class="pct low">0%</td>
	<td data-value="24" class="abs low">(0&nbsp;/&nbsp;24)</td>
	<td data-value="12.62" class="pct low">12.62%</td>
	<td data-value="103" class="abs low">(13&nbsp;/&nbsp;103)</td>
	</tr>

</tbody>
</table>
</div></div>
<div class="footer">
    <div class="meta">Generated by <a href="https://github.com/kaizhu256/node-utility2" target="_blank">utility2</a> at Tue Apr 11 2017 17:25:15 GMT+0000 (UTC)</div>
</div>
</body>
</html>


<!doctype html>
<html lang="en">
<head>
    <title>Code coverage report for node-npmtest-node-red/</title>
    <meta charset="utf-8">
    <style>
        body, html {
            margin:0; padding: 0;
        }
        body {
            font-family: Arial, Helvetica;
            font-size: 10pt;
        }
        div.header, div.footer {
            background: #eee;
            padding: 1em;
        }
        div.header {
            height: 160px;
            padding: 0 1em 0 1em;
            z-index: 100;
            position: fixed;
            top: 0;
            border-bottom: 1px solid #666;
            width: 100%;
        }
        div.footer {
            border-top: 1px solid #666;
        }
        div.body {
            margin-top: 170px;
        }
        div.meta {
            font-size: 90%;
            text-align: center;
        }
        h1, h2, h3 {
            font-weight: normal;
        }
        h1 {
            font-size: 12pt;
        }
        h2 {
            font-size: 10pt;
        }
        pre {
            font-family: Menlo, Monaco, Consolas, Courier New, monospace;
            margin: 0;
            padding: 0;
            font-size: 14px;
            tab-size: 2;
        }

        div.path { font-size: 110%; }
        div.path a:link, div.path a:visited { color: #000; }
        table.coverage { border-collapse: collapse; margin:0; padding: 0 }

        table.coverage td {
            margin: 0;
            padding: 0;
            color: #111;
            vertical-align: top;
        }
        table.coverage td.line-count {
            width: 50px;
            text-align: right;
            padding-right: 5px;
        }
        table.coverage td.line-coverage {
            color: #777 !important;
            text-align: right;
            border-left: 1px solid #666;
            border-right: 1px solid #666;
        }

        table.coverage td.text {
        }

        table.coverage td span.cline-any {
            display: inline-block;
            padding: 0 5px;
            width: 40px;
        }
        table.coverage td span.cline-neutral {
            background: #eee;
        }
        table.coverage td span.cline-yes {
            background: #b5d592;
            color: #999;
        }
        table.coverage td span.cline-no {
            background: #fc8c84;
        }

        .cstat-yes { color: #111; }
        .cstat-no { background: #fc8c84; color: #111; }
        .fstat-no { background: #ffc520; color: #111 !important; }
        .cbranch-no { background:  yellow !important; color: #111; }

        .cstat-skip { background: #ddd; color: #111; }
        .fstat-skip { background: #ddd; color: #111 !important; }
        .cbranch-skip { background: #ddd !important; color: #111; }

        .missing-if-branch {
            display: inline-block;
            margin-right: 10px;
            position: relative;
            padding: 0 4px;
            background: black;
            color: yellow;
        }

        .skip-if-branch {
            display: none;
            margin-right: 10px;
            position: relative;
            padding: 0 4px;
            background: #ccc;
            color: white;
        }

        .missing-if-branch .typ, .skip-if-branch .typ {
            color: inherit !important;
        }

        .entity, .metric { font-weight: bold; }
        .metric { display: inline-block; border: 1px solid #333; padding: 0.3em; background: white; }
        .metric small { font-size: 80%; font-weight: normal; color: #666; }

        div.coverage-summary table { border-collapse: collapse; margin: 3em; font-size: 110%; }
        div.coverage-summary td, div.coverage-summary table  th { margin: 0; padding: 0.25em 1em; border-top: 1px solid #666; border-bottom: 1px solid #666; }
        div.coverage-summary th { text-align: left; border: 1px solid #666; background: #eee; font-weight: normal; }
        div.coverage-summary th.file { border-right: none !important; }
        div.coverage-summary th.pic { border-left: none !important; text-align: right; }
        div.coverage-summary th.pct { border-right: none !important; }
        div.coverage-summary th.abs { border-left: none !important; text-align: right; }
        div.coverage-summary td.pct { text-align: right; border-left: 1px solid #666; }
        div.coverage-summary td.abs { text-align: right; font-size: 90%; color: #444; border-right: 1px solid #666; }
        div.coverage-summary td.file { text-align: right; border-left: 1px solid #666; white-space: nowrap;  }
        div.coverage-summary td.pic { min-width: 120px !important;  }
        div.coverage-summary a:link { color: #000; }
        div.coverage-summary a:visited { color: #333; }
        div.coverage-summary tfoot td { border-top: 1px solid #666; }

        div.coverage-summary .yui3-datatable-sort-indicator, div.coverage-summary .dummy-sort-indicator {
            height: 10px;
            width: 7px;
            display: inline-block;
            margin-left: 0.5em;
        }
        div.coverage-summary .yui3-datatable-sort-indicator {
            background: no-repeat scroll 0 0 transparent;
        }
        div.coverage-summary .yui3-datatable-sorted .yui3-datatable-sort-indicator {
            background-position: 0 -20px;
        }
        div.coverage-summary .yui3-datatable-sorted-desc .yui3-datatable-sort-indicator {
            background-position: 0 -10px;
        }

        .high { background: #b5d592 !important; }
        .medium { background: #ffe87c !important; }
        .low { background: #fc8c84 !important; }

        span.cover-fill, span.cover-empty {
            display:inline-block;
            border:1px solid #444;
            background: white;
            height: 12px;
        }
        span.cover-fill {
            background: #ccc;
            border-right: 1px solid #444;
        }
        span.cover-empty {
            background: white;
            border-left: none;
        }
        span.cover-full {
            border-right: none !important;
        }
        pre.prettyprint {
            border: none !important;
            padding: 0 !important;
            margin: 0 !important;
        }
        .com { color: #999 !important; }
        .ignore-none { color: #999; font-weight: normal; }

    </style>
</head>
<body>
<div class="header high">
    <h1 style="font-weight: bold;">
        <a href="https://github.com/npmtest/node-npmtest-node-red">npmtest-node-red (v0.0.1)</a>
    </h1>
    <h1>Code coverage report for <span class="entity">node-npmtest-node-red/</span></h1>
    <h2>
        
        Statements: <span class="metric">100% <small>(151 / 151)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        
        Branches: <span class="metric">100% <small>(124 / 124)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        
        Functions: <span class="metric">100% <small>(27 / 27)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        
        Lines: <span class="metric">100% <small>(151 / 151)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        Ignored: <span class="metric">26 statements, 1 function, 30 branches</span> &nbsp;&nbsp;&nbsp;&nbsp;
    </h2>
    <div class="path"><a href="../index.html">All files</a> &#187; node-npmtest-node-red/</div>
</div>
<div class="body">
<div class="coverage-summary">
<table>
<thead>
<tr>
   <th data-col="file" data-fmt="html" data-html="true" class="file">File</th>
   <th data-col="pic" data-type="number" data-fmt="html" data-html="true" class="pic"></th>
   <th data-col="statements" data-type="number" data-fmt="pct" class="pct">Statements</th>
   <th data-col="statements_raw" data-type="number" data-fmt="html" class="abs"></th>
   <th data-col="branches" data-type="number" data-fmt="pct" class="pct">Branches</th>
   <th data-col="branches_raw" data-type="number" data-fmt="html" class="abs"></th>
   <th data-col="functions" data-type="number" data-fmt="pct" class="pct">Functions</th>
   <th data-col="functions_raw" data-type="number" data-fmt="html" class="abs"></th>
   <th data-col="lines" data-type="number" data-fmt="pct" class="pct">Lines</th>
   <th data-col="lines_raw" data-type="number" data-fmt="html" class="abs"></th>
</tr>
</thead>
<tbody><tr>
	<td class="file high" data-value="example.js"><a href="example.js.html">example.js</a></td>
	<td data-value="100" class="pic high"><span class="cover-fill cover-full" style="width: 100px;"></span><span class="cover-empty" style="width:0px;"></span></td>
	<td data-value="100" class="pct high">100%</td>
	<td data-value="83" class="abs high">(83&nbsp;/&nbsp;83)</td>
	<td data-value="100" class="pct high">100%</td>
	<td data-value="73" class="abs high">(73&nbsp;/&nbsp;73)</td>
	<td data-value="100" class="pct high">100%</td>
	<td data-value="12" class="abs high">(12&nbsp;/&nbsp;12)</td>
	<td data-value="100" class="pct high">100%</td>
	<td data-value="83" class="abs high">(83&nbsp;/&nbsp;83)</td>
	</tr>

<tr>
	<td class="file high" data-value="lib.npmtest_node_red.js"><a href="lib.npmtest_node_red.js.html">lib.npmtest_node_red.js</a></td>
	<td data-value="100" class="pic high"><span class="cover-fill cover-full" style="width: 100px;"></span><span class="cover-empty" style="width:0px;"></span></td>
	<td data-value="100" class="pct high">100%</td>
	<td data-value="16" class="abs high">(16&nbsp;/&nbsp;16)</td>
	<td data-value="100" class="pct high">100%</td>
	<td data-value="14" class="abs high">(14&nbsp;/&nbsp;14)</td>
	<td data-value="100" class="pct high">100%</td>
	<td data-value="3" class="abs high">(3&nbsp;/&nbsp;3)</td>
	<td data-value="100" class="pct high">100%</td>
	<td data-value="16" class="abs high">(16&nbsp;/&nbsp;16)</td>
	</tr>

<tr>
	<td class="file high" data-value="test.js"><a href="test.js.html">test.js</a></td>
	<td data-value="100" class="pic high"><span class="cover-fill cover-full" style="width: 100px;"></span><span class="cover-empty" style="width:0px;"></span></td>
	<td data-value="100" class="pct high">100%</td>
	<td data-value="52" class="abs high">(52&nbsp;/&nbsp;52)</td>
	<td data-value="100" class="pct high">100%</td>
	<td data-value="37" class="abs high">(37&nbsp;/&nbsp;37)</td>
	<td data-value="100" class="pct high">100%</td>
	<td data-value="12" class="abs high">(12&nbsp;/&nbsp;12)</td>
	<td data-value="100" class="pct high">100%</td>
	<td data-value="52" class="abs high">(52&nbsp;/&nbsp;52)</td>
	</tr>

</tbody>
</table>
</div></div>
<div class="footer">
    <div class="meta">Generated by <a href="https://github.com/kaizhu256/node-utility2" target="_blank">utility2</a> at Tue Apr 11 2017 17:25:15 GMT+0000 (UTC)</div>
</div>
</body>
</html>


<!doctype html>
<html lang="en">
<head>
    <title>Code coverage report for node-npmtest-node-red/example.js</title>
    <meta charset="utf-8">
    <style>
        body, html {
            margin:0; padding: 0;
        }
        body {
            font-family: Arial, Helvetica;
            font-size: 10pt;
        }
        div.header, div.footer {
            background: #eee;
            padding: 1em;
        }
        div.header {
            height: 160px;
            padding: 0 1em 0 1em;
            z-index: 100;
            position: fixed;
            top: 0;
            border-bottom: 1px solid #666;
            width: 100%;
        }
        div.footer {
            border-top: 1px solid #666;
        }
        div.body {
            margin-top: 170px;
        }
        div.meta {
            font-size: 90%;
            text-align: center;
        }
        h1, h2, h3 {
            font-weight: normal;
        }
        h1 {
            font-size: 12pt;
        }
        h2 {
            font-size: 10pt;
        }
        pre {
            font-family: Menlo, Monaco, Consolas, Courier New, monospace;
            margin: 0;
            padding: 0;
            font-size: 14px;
            tab-size: 2;
        }

        div.path { font-size: 110%; }
        div.path a:link, div.path a:visited { color: #000; }
        table.coverage { border-collapse: collapse; margin:0; padding: 0 }

        table.coverage td {
            margin: 0;
            padding: 0;
            color: #111;
            vertical-align: top;
        }
        table.coverage td.line-count {
            width: 50px;
            text-align: right;
            padding-right: 5px;
        }
        table.coverage td.line-coverage {
            color: #777 !important;
            text-align: right;
            border-left: 1px solid #666;
            border-right: 1px solid #666;
        }

        table.coverage td.text {
        }

        table.coverage td span.cline-any {
            display: inline-block;
            padding: 0 5px;
            width: 40px;
        }
        table.coverage td span.cline-neutral {
            background: #eee;
        }
        table.coverage td span.cline-yes {
            background: #b5d592;
            color: #999;
        }
        table.coverage td span.cline-no {
            background: #fc8c84;
        }

        .cstat-yes { color: #111; }
        .cstat-no { background: #fc8c84; color: #111; }
        .fstat-no { background: #ffc520; color: #111 !important; }
        .cbranch-no { background:  yellow !important; color: #111; }

        .cstat-skip { background: #ddd; color: #111; }
        .fstat-skip { background: #ddd; color: #111 !important; }
        .cbranch-skip { background: #ddd !important; color: #111; }

        .missing-if-branch {
            display: inline-block;
            margin-right: 10px;
            position: relative;
            padding: 0 4px;
            background: black;
            color: yellow;
        }

        .skip-if-branch {
            display: none;
            margin-right: 10px;
            position: relative;
            padding: 0 4px;
            background: #ccc;
            color: white;
        }

        .missing-if-branch .typ, .skip-if-branch .typ {
            color: inherit !important;
        }

        .entity, .metric { font-weight: bold; }
        .metric { display: inline-block; border: 1px solid #333; padding: 0.3em; background: white; }
        .metric small { font-size: 80%; font-weight: normal; color: #666; }

        div.coverage-summary table { border-collapse: collapse; margin: 3em; font-size: 110%; }
        div.coverage-summary td, div.coverage-summary table  th { margin: 0; padding: 0.25em 1em; border-top: 1px solid #666; border-bottom: 1px solid #666; }
        div.coverage-summary th { text-align: left; border: 1px solid #666; background: #eee; font-weight: normal; }
        div.coverage-summary th.file { border-right: none !important; }
        div.coverage-summary th.pic { border-left: none !important; text-align: right; }
        div.coverage-summary th.pct { border-right: none !important; }
        div.coverage-summary th.abs { border-left: none !important; text-align: right; }
        div.coverage-summary td.pct { text-align: right; border-left: 1px solid #666; }
        div.coverage-summary td.abs { text-align: right; font-size: 90%; color: #444; border-right: 1px solid #666; }
        div.coverage-summary td.file { text-align: right; border-left: 1px solid #666; white-space: nowrap;  }
        div.coverage-summary td.pic { min-width: 120px !important;  }
        div.coverage-summary a:link { color: #000; }
        div.coverage-summary a:visited { color: #333; }
        div.coverage-summary tfoot td { border-top: 1px solid #666; }

        div.coverage-summary .yui3-datatable-sort-indicator, div.coverage-summary .dummy-sort-indicator {
            height: 10px;
            width: 7px;
            display: inline-block;
            margin-left: 0.5em;
        }
        div.coverage-summary .yui3-datatable-sort-indicator {
            background: no-repeat scroll 0 0 transparent;
        }
        div.coverage-summary .yui3-datatable-sorted .yui3-datatable-sort-indicator {
            background-position: 0 -20px;
        }
        div.coverage-summary .yui3-datatable-sorted-desc .yui3-datatable-sort-indicator {
            background-position: 0 -10px;
        }

        .high { background: #b5d592 !important; }
        .medium { background: #ffe87c !important; }
        .low { background: #fc8c84 !important; }

        span.cover-fill, span.cover-empty {
            display:inline-block;
            border:1px solid #444;
            background: white;
            height: 12px;
        }
        span.cover-fill {
            background: #ccc;
            border-right: 1px solid #444;
        }
        span.cover-empty {
            background: white;
            border-left: none;
        }
        span.cover-full {
            border-right: none !important;
        }
        pre.prettyprint {
            border: none !important;
            padding: 0 !important;
            margin: 0 !important;
        }
        .com { color: #999 !important; }
        .ignore-none { color: #999; font-weight: normal; }

    </style>
</head>
<body>
<div class="header high">
    <h1 style="font-weight: bold;">
        <a href="https://github.com/npmtest/node-npmtest-node-red">npmtest-node-red (v0.0.1)</a>
    </h1>
    <h1>Code coverage report for <span class="entity">node-npmtest-node-red/example.js</span></h1>
    <h2>
        
        Statements: <span class="metric">100% <small>(83 / 83)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        
        Branches: <span class="metric">100% <small>(73 / 73)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        
        Functions: <span class="metric">100% <small>(12 / 12)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        
        Lines: <span class="metric">100% <small>(83 / 83)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        Ignored: <span class="metric">26 statements, 1 function, 30 branches</span> &nbsp;&nbsp;&nbsp;&nbsp;
    </h2>
    <div class="path"><a href="../index.html">All files</a> &#187; <a href="index.html">node-npmtest-node-red/</a> &#187; example.js</div>
</div>
<div class="body">
<pre><table class="coverage">
<tr><td class="line-count">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
164
165
166
167
168
169
170
171
172
173
174
175
176
177
178
179
180
181
182
183
184
185
186
187
188
189
190
191
192
193
194
195
196
197
198
199
200
201
202
203
204
205
206
207
208
209
210
211
212
213
214
215
216
217
218
219
220
221
222
223
224
225
226
227
228
229
230
231
232
233
234
235
236
237
238
239
240
241
242
243
244
245
246
247
248
249
250
251
252
253
254
255
256
257
258
259
260
261
262
263
264
265
266
267
268
269
270
271
272
273
274
275
276
277
278
279
280
281
282
283
284
285
286
287
288
289
290
291
292
293
294
295
296
297
298
299
300
301
302
303
304
305
306
307
308
309
310
311
312
313
314
315
316
317
318
319
320
321
322
323
324
325
326
327</td><td class="line-coverage"><span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">2</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">2</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">2</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">2</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">2</span>
<span class="cline-any cline-yes">2</span>
<span class="cline-any cline-yes">2</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">2</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">2</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">2</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">2</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">2</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">2</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">2</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">2</span>
<span class="cline-any cline-yes">2</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">2</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">2</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">2</span>
<span class="cline-any cline-yes">2</span>
<span class="cline-any cline-yes">2</span>
<span class="cline-any cline-yes">2</span>
<span class="cline-any cline-yes">2</span>
<span class="cline-any cline-yes">2</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">2</span>
<span class="cline-any cline-yes">2</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">2</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">3</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">6</span>
<span class="cline-any cline-yes">6</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">2</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">2</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span></td><td class="text"><pre class="prettyprint lang-js">/*
example.js
&nbsp;
quickstart example
&nbsp;
instruction
    1. save this script as example.js
    2. run the shell command:
        $ npm install npmtest-node-red &amp;&amp; PORT=8081 node example.js
    3. play with the browser-demo on http://127.0.0.1:8081
*/
&nbsp;
&nbsp;
&nbsp;
/* istanbul instrument in package npmtest_node_red */
/*jslint
    bitwise: true,
    browser: true,
    maxerr: 8,
    maxlen: 96,
    node: true,
    nomen: true,
    regexp: true,
    stupid: true
*/
(function () {
    'use strict';
    var local;
&nbsp;
&nbsp;
&nbsp;
    // run shared js-env code - pre-init
    (function () {
        // init local
        local = {};
        // init modeJs
        local.modeJs = (function () {
            try {
                return typeof navigator.userAgent === 'string' &amp;&amp;
                    typeof document.querySelector('body') === 'object' &amp;&amp;
                    typeof XMLHttpRequest.prototype.open === 'function' &amp;&amp;
                    'browser';
            } catch (errorCaughtBrowser) {
                return module.exports &amp;&amp;
                    typeof process.versions.node === 'string' &amp;&amp;
                    typeof require('http').createServer === 'function' &amp;&amp;
                    'node';
            }
        }());
        // init global
        local.global = local.modeJs === 'browser'
            ? window
            : global;
        // init utility2_rollup
        local = local.global.utility2_rollup || (local.modeJs === 'browser'
            ? local.global.utility2_npmtest_node_red
            : global.utility2_moduleExports);
        // export local
        local.global.local = local;
    }());
    switch (local.modeJs) {
&nbsp;
&nbsp;
&nbsp;
    // post-init
    // run browser js-env code - post-init
    /* istanbul ignore next */
    case 'browser':
        local.testRunBrowser = function (event) {
            <span class="skip-if-branch" title="else path not taken" >E</span>if (!event || (event &amp;&amp;
                    event.currentTarget &amp;&amp;
                    event.currentTarget.className &amp;&amp;
                    event.currentTarget.className.includes &amp;&amp;
                    event.currentTarget.className.includes('onreset'))) {
                // reset output
                Array.from(
                    document.querySelectorAll('body &gt; .resettable')
                ).forEach(function (element) {
                    switch (element.tagName) {
<span class="branch-0 cbranch-skip" title="branch not covered" >                    case 'INPUT':</span>
                    case 'TEXTAREA':
                        element.value = '';
                        break;
<span class="branch-2 cbranch-skip" title="branch not covered" >                    default:</span>
<span class="cstat-skip" title="statement not covered" >                        element.textContent = '';</span>
                    }
                });
            }
            switch (event &amp;&amp; event.currentTarget &amp;&amp; event.currentTarget.id) {
            case 'testRunButton1':
                // show tests
                <span class="skip-if-branch" title="else path not taken" >E</span>if (document.querySelector('#testReportDiv1').style.display === 'none') {
                    document.querySelector('#testReportDiv1').style.display = 'block';
                    document.querySelector('#testRunButton1').textContent =
                        'hide internal test';
                    local.modeTest = true;
                    local.testRunDefault(local);
                // hide tests
                } else {
<span class="cstat-skip" title="statement not covered" >                    document.querySelector('#testReportDiv1').style.display = 'none';</span>
<span class="cstat-skip" title="statement not covered" >                    document.querySelector('#testRunButton1').textContent = 'run internal test';</span>
                }
                break;
            // custom-case
            default:
                break;
            }
            <span class="skip-if-branch" title="if path not taken" >I</span>if (document.querySelector('#inputTextareaEval1') &amp;&amp; (<span class="branch-1 cbranch-skip" title="branch not covered" >!event </span>|| (<span class="branch-2 cbranch-skip" title="branch not covered" >event </span>&amp;&amp;
<span class="branch-3 cbranch-skip" title="branch not covered" >                    event.currentTarget </span>&amp;&amp;
<span class="branch-4 cbranch-skip" title="branch not covered" >                    event.currentTarget.className </span>&amp;&amp;
<span class="branch-5 cbranch-skip" title="branch not covered" >                    event.currentTarget.className.includes </span>&amp;&amp;
<span class="branch-6 cbranch-skip" title="branch not covered" >                    event.currentTarget.className.includes('oneval'))</span>)) {
                // try to eval input-code
<span class="cstat-skip" title="statement not covered" >                try {</span>
                    /*jslint evil: true*/
<span class="cstat-skip" title="statement not covered" >                    eval(document.querySelector('#inputTextareaEval1').value);</span>
                } catch (errorCaught) {
<span class="cstat-skip" title="statement not covered" >                    console.error(errorCaught.stack);</span>
                }
            }
        };
        // log stderr and stdout to #outputTextareaStdout1
        ['error', 'log'].forEach(function (key) {
            console[key + '_original'] = console[key];
            console[key] = function () {
                var element;
                console[key + '_original'].apply(console, arguments);
                element = document.querySelector('#outputTextareaStdout1');
                <span class="skip-if-branch" title="if path not taken" >I</span>if (!element) {
<span class="cstat-skip" title="statement not covered" >                    return;</span>
                }
                // append text to #outputTextareaStdout1
                element.value += Array.from(arguments).map(function (arg) {
                    return typeof arg === 'string'
                        ? arg
                        : <span class="branch-1 cbranch-skip" title="branch not covered" >JSON.stringify(arg, null, 4);</span>
                }).join(' ') + '\n';
                // scroll textarea to bottom
                element.scrollTop = element.scrollHeight;
            };
        });
        // init event-handling
        ['change', 'click', 'keyup'].forEach(function (event) {
            Array.from(document.querySelectorAll('.on' + event)).forEach(function (element) {
                element.addEventListener(event, local.testRunBrowser);
            });
        });
        // run tests
        local.testRunBrowser();
        break;
&nbsp;
&nbsp;
&nbsp;
    // run node js-env code - post-init
    /* istanbul ignore next */
    case 'node':
        // export local
        module.exports = local;
        // require modules
        local.fs = require('fs');
        local.http = require('http');
        local.url = require('url');
        // init assets
        local.assetsDict = local.assetsDict || {};
        /* jslint-ignore-begin */
        local.assetsDict['/assets.index.template.html'] = '\
&lt;!doctype html&gt;\n\
&lt;html lang="en"&gt;\n\
&lt;head&gt;\n\
&lt;meta charset="UTF-8"&gt;\n\
&lt;meta name="viewport" content="width=device-width, initial-scale=1"&gt;\n\
&lt;title&gt;{{env.npm_package_name}} (v{{env.npm_package_version}})&lt;/title&gt;\n\
&lt;style&gt;\n\
/*csslint\n\
    box-sizing: false,\n\
    universal-selector: false\n\
*/\n\
* {\n\
    box-sizing: border-box;\n\
}\n\
body {\n\
    background: #dde;\n\
    font-family: Arial, Helvetica, sans-serif;\n\
    margin: 2rem;\n\
}\n\
body &gt; * {\n\
    margin-bottom: 1rem;\n\
}\n\
.utility2FooterDiv {\n\
    margin-top: 20px;\n\
    text-align: center;\n\
}\n\
&lt;/style&gt;\n\
&lt;style&gt;\n\
/*csslint\n\
*/\n\
textarea {\n\
    font-family: monospace;\n\
    height: 10rem;\n\
    width: 100%;\n\
}\n\
textarea[readonly] {\n\
    background: #ddd;\n\
}\n\
&lt;/style&gt;\n\
&lt;/head&gt;\n\
&lt;body&gt;\n\
&lt;!-- utility2-comment\n\
&lt;div id="ajaxProgressDiv1" style="background: #d00; height: 2px; left: 0; margin: 0; padding: 0; position: fixed; top: 0; transition: background 0.5s, width 1.5s; width: 25%;"&gt;&lt;/div&gt;\n\
utility2-comment --&gt;\n\
&lt;h1&gt;\n\
&lt;!-- utility2-comment\n\
    &lt;a\n\
        {{#if env.npm_package_homepage}}\n\
        href="{{env.npm_package_homepage}}"\n\
        {{/if env.npm_package_homepage}}\n\
        target="_blank"\n\
    &gt;\n\
utility2-comment --&gt;\n\
        {{env.npm_package_name}} (v{{env.npm_package_version}})\n\
&lt;!-- utility2-comment\n\
    &lt;/a&gt;\n\
utility2-comment --&gt;\n\
&lt;/h1&gt;\n\
&lt;h3&gt;{{env.npm_package_description}}&lt;/h3&gt;\n\
&lt;!-- utility2-comment\n\
&lt;h4&gt;&lt;a download href="assets.app.js"&gt;download standalone app&lt;/a&gt;&lt;/h4&gt;\n\
&lt;button class="onclick onreset" id="testRunButton1"&gt;run internal test&lt;/button&gt;&lt;br&gt;\n\
&lt;div id="testReportDiv1" style="display: none;"&gt;&lt;/div&gt;\n\
utility2-comment --&gt;\n\
\n\
\n\
\n\
&lt;label&gt;stderr and stdout&lt;/label&gt;\n\
&lt;textarea class="resettable" id="outputTextareaStdout1" readonly&gt;&lt;/textarea&gt;\n\
&lt;!-- utility2-comment\n\
{{#if isRollup}}\n\
&lt;script src="assets.app.js"&gt;&lt;/script&gt;\n\
{{#unless isRollup}}\n\
utility2-comment --&gt;\n\
&lt;script src="assets.utility2.rollup.js"&gt;&lt;/script&gt;\n\
&lt;script src="jsonp.utility2._stateInit?callback=window.utility2._stateInit"&gt;&lt;/script&gt;\n\
&lt;script src="assets.npmtest_node_red.rollup.js"&gt;&lt;/script&gt;\n\
&lt;script src="assets.example.js"&gt;&lt;/script&gt;\n\
&lt;script src="assets.test.js"&gt;&lt;/script&gt;\n\
&lt;!-- utility2-comment\n\
{{/if isRollup}}\n\
utility2-comment --&gt;\n\
&lt;div class="utility2FooterDiv"&gt;\n\
    [ this app was created with\n\
    &lt;a href="https://github.com/kaizhu256/node-utility2" target="_blank"&gt;utility2&lt;/a&gt;\n\
    ]\n\
&lt;/div&gt;\n\
&lt;/body&gt;\n\
&lt;/html&gt;\n\
';
        /* jslint-ignore-end */
        <span class="skip-if-branch" title="if path not taken" >I</span>if (local.templateRender) {
<span class="cstat-skip" title="statement not covered" >            local.assetsDict['/'] = local.templateRender(</span>
                local.assetsDict['/assets.index.template.html'],
                {
                    env: local.objectSetDefault(local.env, {
                        npm_package_description: 'the greatest app in the world!',
                        npm_package_name: 'my-app',
                        npm_package_nameAlias: 'my_app',
                        npm_package_version: '0.0.1'
                    })
                }
            );
        } else {
            local.assetsDict['/'] = local.assetsDict['/assets.index.template.html']
                .replace((/\{\{env\.(\w+?)\}\}/g), function (match0, match1) {
                    // jslint-hack
                    String(match0);
                    switch (match1) {
                    case 'npm_package_description':
                        return 'the greatest app in the world!';
                    case 'npm_package_name':
                        return 'my-app';
<span class="branch-2 cbranch-skip" title="branch not covered" >                    case 'npm_package_nameAlias':</span>
<span class="cstat-skip" title="statement not covered" >                        return 'my_app';</span>
                    case 'npm_package_version':
                        return '0.0.1';
                    }
                });
        }
        // run the cli
        <span class="skip-if-branch" title="else path not taken" >E</span>if (local.global.utility2_rollup || module !== require.main) {
            break;
        }
<span class="cstat-skip" title="statement not covered" >        local.assetsDict['/assets.example.js'] =</span>
            local.assetsDict['/assets.example.js'] ||
            local.fs.readFileSync(__filename, 'utf8');
<span class="cstat-skip" title="statement not covered" >        local.assetsDict['/assets.npmtest_node_red.rollup.js'] =</span>
            local.assetsDict['/assets.npmtest_node_red.rollup.js'] ||
            local.fs.readFileSync(
                // buildCustomOrg-hack
                local.npmtest_node_red.__dirname +
                    '/lib.npmtest_node_red.js',
                'utf8'
            ).replace((/^#!/), '//');
<span class="cstat-skip" title="statement not covered" >        local.assetsDict['/favicon.ico'] = local.assetsDict['/favicon.ico'] || '';</span>
        // if $npm_config_timeout_exit exists,
        // then exit this process after $npm_config_timeout_exit ms
<span class="cstat-skip" title="statement not covered" >        if (Number(process.env.npm_config_timeout_exit)) {</span>
<span class="cstat-skip" title="statement not covered" >            setTimeout(process.exit, Number(process.env.npm_config_timeout_exit));</span>
        }
        // start server
<span class="cstat-skip" title="statement not covered" >        if (local.global.utility2_serverHttp1) {</span>
<span class="cstat-skip" title="statement not covered" >            break;</span>
        }
<span class="cstat-skip" title="statement not covered" >        process.env.PORT = process.env.PORT || '8081';</span>
<span class="cstat-skip" title="statement not covered" >        console.error('server starting on port ' + process.env.PORT);</span>
<span class="cstat-skip" title="statement not covered" >        local.http.createServer(<span class="fstat-skip" title="function not covered" >function (request, response) {</span></span>
<span class="cstat-skip" title="statement not covered" >            request.urlParsed = local.url.parse(request.url);</span>
<span class="cstat-skip" title="statement not covered" >            if (local.assetsDict[request.urlParsed.pathname] !== undefined) {</span>
<span class="cstat-skip" title="statement not covered" >                response.end(local.assetsDict[request.urlParsed.pathname]);</span>
<span class="cstat-skip" title="statement not covered" >                return;</span>
            }
<span class="cstat-skip" title="statement not covered" >            response.statusCode = 404;</span>
<span class="cstat-skip" title="statement not covered" >            response.end();</span>
        }).listen(process.env.PORT);
<span class="cstat-skip" title="statement not covered" >        break;</span>
    }
}());
&nbsp;
&nbsp;</pre></td></tr>
</table></pre>
</div>
<div class="footer">
    <div class="meta">Generated by <a href="https://github.com/kaizhu256/node-utility2" target="_blank">utility2</a> at Tue Apr 11 2017 17:25:15 GMT+0000 (UTC)</div>
</div>
</body>
</html>


<!doctype html>
<html lang="en">
<head>
    <title>Code coverage report for node-npmtest-node-red/lib.npmtest_node_red.js</title>
    <meta charset="utf-8">
    <style>
        body, html {
            margin:0; padding: 0;
        }
        body {
            font-family: Arial, Helvetica;
            font-size: 10pt;
        }
        div.header, div.footer {
            background: #eee;
            padding: 1em;
        }
        div.header {
            height: 160px;
            padding: 0 1em 0 1em;
            z-index: 100;
            position: fixed;
            top: 0;
            border-bottom: 1px solid #666;
            width: 100%;
        }
        div.footer {
            border-top: 1px solid #666;
        }
        div.body {
            margin-top: 170px;
        }
        div.meta {
            font-size: 90%;
            text-align: center;
        }
        h1, h2, h3 {
            font-weight: normal;
        }
        h1 {
            font-size: 12pt;
        }
        h2 {
            font-size: 10pt;
        }
        pre {
            font-family: Menlo, Monaco, Consolas, Courier New, monospace;
            margin: 0;
            padding: 0;
            font-size: 14px;
            tab-size: 2;
        }

        div.path { font-size: 110%; }
        div.path a:link, div.path a:visited { color: #000; }
        table.coverage { border-collapse: collapse; margin:0; padding: 0 }

        table.coverage td {
            margin: 0;
            padding: 0;
            color: #111;
            vertical-align: top;
        }
        table.coverage td.line-count {
            width: 50px;
            text-align: right;
            padding-right: 5px;
        }
        table.coverage td.line-coverage {
            color: #777 !important;
            text-align: right;
            border-left: 1px solid #666;
            border-right: 1px solid #666;
        }

        table.coverage td.text {
        }

        table.coverage td span.cline-any {
            display: inline-block;
            padding: 0 5px;
            width: 40px;
        }
        table.coverage td span.cline-neutral {
            background: #eee;
        }
        table.coverage td span.cline-yes {
            background: #b5d592;
            color: #999;
        }
        table.coverage td span.cline-no {
            background: #fc8c84;
        }

        .cstat-yes { color: #111; }
        .cstat-no { background: #fc8c84; color: #111; }
        .fstat-no { background: #ffc520; color: #111 !important; }
        .cbranch-no { background:  yellow !important; color: #111; }

        .cstat-skip { background: #ddd; color: #111; }
        .fstat-skip { background: #ddd; color: #111 !important; }
        .cbranch-skip { background: #ddd !important; color: #111; }

        .missing-if-branch {
            display: inline-block;
            margin-right: 10px;
            position: relative;
            padding: 0 4px;
            background: black;
            color: yellow;
        }

        .skip-if-branch {
            display: none;
            margin-right: 10px;
            position: relative;
            padding: 0 4px;
            background: #ccc;
            color: white;
        }

        .missing-if-branch .typ, .skip-if-branch .typ {
            color: inherit !important;
        }

        .entity, .metric { font-weight: bold; }
        .metric { display: inline-block; border: 1px solid #333; padding: 0.3em; background: white; }
        .metric small { font-size: 80%; font-weight: normal; color: #666; }

        div.coverage-summary table { border-collapse: collapse; margin: 3em; font-size: 110%; }
        div.coverage-summary td, div.coverage-summary table  th { margin: 0; padding: 0.25em 1em; border-top: 1px solid #666; border-bottom: 1px solid #666; }
        div.coverage-summary th { text-align: left; border: 1px solid #666; background: #eee; font-weight: normal; }
        div.coverage-summary th.file { border-right: none !important; }
        div.coverage-summary th.pic { border-left: none !important; text-align: right; }
        div.coverage-summary th.pct { border-right: none !important; }
        div.coverage-summary th.abs { border-left: none !important; text-align: right; }
        div.coverage-summary td.pct { text-align: right; border-left: 1px solid #666; }
        div.coverage-summary td.abs { text-align: right; font-size: 90%; color: #444; border-right: 1px solid #666; }
        div.coverage-summary td.file { text-align: right; border-left: 1px solid #666; white-space: nowrap;  }
        div.coverage-summary td.pic { min-width: 120px !important;  }
        div.coverage-summary a:link { color: #000; }
        div.coverage-summary a:visited { color: #333; }
        div.coverage-summary tfoot td { border-top: 1px solid #666; }

        div.coverage-summary .yui3-datatable-sort-indicator, div.coverage-summary .dummy-sort-indicator {
            height: 10px;
            width: 7px;
            display: inline-block;
            margin-left: 0.5em;
        }
        div.coverage-summary .yui3-datatable-sort-indicator {
            background: no-repeat scroll 0 0 transparent;
        }
        div.coverage-summary .yui3-datatable-sorted .yui3-datatable-sort-indicator {
            background-position: 0 -20px;
        }
        div.coverage-summary .yui3-datatable-sorted-desc .yui3-datatable-sort-indicator {
            background-position: 0 -10px;
        }

        .high { background: #b5d592 !important; }
        .medium { background: #ffe87c !important; }
        .low { background: #fc8c84 !important; }

        span.cover-fill, span.cover-empty {
            display:inline-block;
            border:1px solid #444;
            background: white;
            height: 12px;
        }
        span.cover-fill {
            background: #ccc;
            border-right: 1px solid #444;
        }
        span.cover-empty {
            background: white;
            border-left: none;
        }
        span.cover-full {
            border-right: none !important;
        }
        pre.prettyprint {
            border: none !important;
            padding: 0 !important;
            margin: 0 !important;
        }
        .com { color: #999 !important; }
        .ignore-none { color: #999; font-weight: normal; }

    </style>
</head>
<body>
<div class="header high">
    <h1 style="font-weight: bold;">
        <a href="https://github.com/npmtest/node-npmtest-node-red">npmtest-node-red (v0.0.1)</a>
    </h1>
    <h1>Code coverage report for <span class="entity">node-npmtest-node-red/lib.npmtest_node_red.js</span></h1>
    <h2>
        
        Statements: <span class="metric">100% <small>(16 / 16)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        
        Branches: <span class="metric">100% <small>(14 / 14)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        
        Functions: <span class="metric">100% <small>(3 / 3)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        
        Lines: <span class="metric">100% <small>(16 / 16)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        Ignored: <span class="metric"><span class="ignore-none">none</span></span> &nbsp;&nbsp;&nbsp;&nbsp;
    </h2>
    <div class="path"><a href="../index.html">All files</a> &#187; <a href="index.html">node-npmtest-node-red/</a> &#187; lib.npmtest_node_red.js</div>
</div>
<div class="body">
<pre><table class="coverage">
<tr><td class="line-count">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55</td><td class="line-coverage"><span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">2</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">2</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">2</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">2</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">2</span>
<span class="cline-any cline-yes">2</span>
<span class="cline-any cline-yes">2</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">2</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">2</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">2</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">2</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span></td><td class="text"><pre class="prettyprint lang-js">/* istanbul instrument in package npmtest_node_red */
/*jslint
    bitwise: true,
    browser: true,
    maxerr: 8,
    maxlen: 96,
    node: true,
    nomen: true,
    regexp: true,
    stupid: true
*/
(function () {
    'use strict';
    var local;
&nbsp;
&nbsp;
&nbsp;
    // run shared js-env code - pre-init
    (function () {
        // init local
        local = {};
        // init modeJs
        local.modeJs = (function () {
            try {
                return typeof navigator.userAgent === 'string' &amp;&amp;
                    typeof document.querySelector('body') === 'object' &amp;&amp;
                    typeof XMLHttpRequest.prototype.open === 'function' &amp;&amp;
                    'browser';
            } catch (errorCaughtBrowser) {
                return module.exports &amp;&amp;
                    typeof process.versions.node === 'string' &amp;&amp;
                    typeof require('http').createServer === 'function' &amp;&amp;
                    'node';
            }
        }());
        // init global
        local.global = local.modeJs === 'browser'
            ? window
            : global;
        // init utility2_rollup
        local = local.global.utility2_rollup || local;
        // init lib
        local.local = local.npmtest_node_red = local;
        // init exports
        if (local.modeJs === 'browser') {
            local.global.utility2_npmtest_node_red = local;
        } else {
            module.exports = local;
            module.exports.__dirname = __dirname;
            module.exports.module = module;
        }
    }());
}());
&nbsp;
&nbsp;</pre></td></tr>
</table></pre>
</div>
<div class="footer">
    <div class="meta">Generated by <a href="https://github.com/kaizhu256/node-utility2" target="_blank">utility2</a> at Tue Apr 11 2017 17:25:15 GMT+0000 (UTC)</div>
</div>
</body>
</html>


<!doctype html>
<html lang="en">
<head>
    <title>Code coverage report for node-npmtest-node-red/test.js</title>
    <meta charset="utf-8">
    <style>
        body, html {
            margin:0; padding: 0;
        }
        body {
            font-family: Arial, Helvetica;
            font-size: 10pt;
        }
        div.header, div.footer {
            background: #eee;
            padding: 1em;
        }
        div.header {
            height: 160px;
            padding: 0 1em 0 1em;
            z-index: 100;
            position: fixed;
            top: 0;
            border-bottom: 1px solid #666;
            width: 100%;
        }
        div.footer {
            border-top: 1px solid #666;
        }
        div.body {
            margin-top: 170px;
        }
        div.meta {
            font-size: 90%;
            text-align: center;
        }
        h1, h2, h3 {
            font-weight: normal;
        }
        h1 {
            font-size: 12pt;
        }
        h2 {
            font-size: 10pt;
        }
        pre {
            font-family: Menlo, Monaco, Consolas, Courier New, monospace;
            margin: 0;
            padding: 0;
            font-size: 14px;
            tab-size: 2;
        }

        div.path { font-size: 110%; }
        div.path a:link, div.path a:visited { color: #000; }
        table.coverage { border-collapse: collapse; margin:0; padding: 0 }

        table.coverage td {
            margin: 0;
            padding: 0;
            color: #111;
            vertical-align: top;
        }
        table.coverage td.line-count {
            width: 50px;
            text-align: right;
            padding-right: 5px;
        }
        table.coverage td.line-coverage {
            color: #777 !important;
            text-align: right;
            border-left: 1px solid #666;
            border-right: 1px solid #666;
        }

        table.coverage td.text {
        }

        table.coverage td span.cline-any {
            display: inline-block;
            padding: 0 5px;
            width: 40px;
        }
        table.coverage td span.cline-neutral {
            background: #eee;
        }
        table.coverage td span.cline-yes {
            background: #b5d592;
            color: #999;
        }
        table.coverage td span.cline-no {
            background: #fc8c84;
        }

        .cstat-yes { color: #111; }
        .cstat-no { background: #fc8c84; color: #111; }
        .fstat-no { background: #ffc520; color: #111 !important; }
        .cbranch-no { background:  yellow !important; color: #111; }

        .cstat-skip { background: #ddd; color: #111; }
        .fstat-skip { background: #ddd; color: #111 !important; }
        .cbranch-skip { background: #ddd !important; color: #111; }

        .missing-if-branch {
            display: inline-block;
            margin-right: 10px;
            position: relative;
            padding: 0 4px;
            background: black;
            color: yellow;
        }

        .skip-if-branch {
            display: none;
            margin-right: 10px;
            position: relative;
            padding: 0 4px;
            background: #ccc;
            color: white;
        }

        .missing-if-branch .typ, .skip-if-branch .typ {
            color: inherit !important;
        }

        .entity, .metric { font-weight: bold; }
        .metric { display: inline-block; border: 1px solid #333; padding: 0.3em; background: white; }
        .metric small { font-size: 80%; font-weight: normal; color: #666; }

        div.coverage-summary table { border-collapse: collapse; margin: 3em; font-size: 110%; }
        div.coverage-summary td, div.coverage-summary table  th { margin: 0; padding: 0.25em 1em; border-top: 1px solid #666; border-bottom: 1px solid #666; }
        div.coverage-summary th { text-align: left; border: 1px solid #666; background: #eee; font-weight: normal; }
        div.coverage-summary th.file { border-right: none !important; }
        div.coverage-summary th.pic { border-left: none !important; text-align: right; }
        div.coverage-summary th.pct { border-right: none !important; }
        div.coverage-summary th.abs { border-left: none !important; text-align: right; }
        div.coverage-summary td.pct { text-align: right; border-left: 1px solid #666; }
        div.coverage-summary td.abs { text-align: right; font-size: 90%; color: #444; border-right: 1px solid #666; }
        div.coverage-summary td.file { text-align: right; border-left: 1px solid #666; white-space: nowrap;  }
        div.coverage-summary td.pic { min-width: 120px !important;  }
        div.coverage-summary a:link { color: #000; }
        div.coverage-summary a:visited { color: #333; }
        div.coverage-summary tfoot td { border-top: 1px solid #666; }

        div.coverage-summary .yui3-datatable-sort-indicator, div.coverage-summary .dummy-sort-indicator {
            height: 10px;
            width: 7px;
            display: inline-block;
            margin-left: 0.5em;
        }
        div.coverage-summary .yui3-datatable-sort-indicator {
            background: no-repeat scroll 0 0 transparent;
        }
        div.coverage-summary .yui3-datatable-sorted .yui3-datatable-sort-indicator {
            background-position: 0 -20px;
        }
        div.coverage-summary .yui3-datatable-sorted-desc .yui3-datatable-sort-indicator {
            background-position: 0 -10px;
        }

        .high { background: #b5d592 !important; }
        .medium { background: #ffe87c !important; }
        .low { background: #fc8c84 !important; }

        span.cover-fill, span.cover-empty {
            display:inline-block;
            border:1px solid #444;
            background: white;
            height: 12px;
        }
        span.cover-fill {
            background: #ccc;
            border-right: 1px solid #444;
        }
        span.cover-empty {
            background: white;
            border-left: none;
        }
        span.cover-full {
            border-right: none !important;
        }
        pre.prettyprint {
            border: none !important;
            padding: 0 !important;
            margin: 0 !important;
        }
        .com { color: #999 !important; }
        .ignore-none { color: #999; font-weight: normal; }

    </style>
</head>
<body>
<div class="header high">
    <h1 style="font-weight: bold;">
        <a href="https://github.com/npmtest/node-npmtest-node-red">npmtest-node-red (v0.0.1)</a>
    </h1>
    <h1>Code coverage report for <span class="entity">node-npmtest-node-red/test.js</span></h1>
    <h2>
        
        Statements: <span class="metric">100% <small>(52 / 52)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        
        Branches: <span class="metric">100% <small>(37 / 37)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        
        Functions: <span class="metric">100% <small>(12 / 12)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        
        Lines: <span class="metric">100% <small>(52 / 52)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        Ignored: <span class="metric"><span class="ignore-none">none</span></span> &nbsp;&nbsp;&nbsp;&nbsp;
    </h2>
    <div class="path"><a href="../index.html">All files</a> &#187; <a href="index.html">node-npmtest-node-red/</a> &#187; test.js</div>
</div>
<div class="body">
<pre><table class="coverage">
<tr><td class="line-count">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
164
165
166
167
168
169
170
171
172
173
174
175
176
177
178
179
180
181
182
183
184
185
186
187</td><td class="line-coverage"><span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">2</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">2</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">2</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">2</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">2</span>
<span class="cline-any cline-yes">2</span>
<span class="cline-any cline-yes">2</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">2</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">2</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">2</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">2</span>
<span class="cline-any cline-yes">2</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">2</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">2</span>
<span class="cline-any cline-yes">2</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">2</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">2</span>
<span class="cline-any cline-yes">2</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">2</span>
<span class="cline-any cline-yes">2</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">2</span>
<span class="cline-any cline-yes">2</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">2</span>
<span class="cline-any cline-yes">2</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span></td><td class="text"><pre class="prettyprint lang-js">/* istanbul instrument in package npmtest_node_red */
/*jslint
    bitwise: true,
    browser: true,
    maxerr: 8,
    maxlen: 96,
    node: true,
    nomen: true,
    regexp: true,
    stupid: true
*/
(function () {
    'use strict';
    var local;
&nbsp;
&nbsp;
&nbsp;
    // run shared js-env code - pre-init
    (function () {
        // init local
        local = {};
        // init modeJs
        local.modeJs = (function () {
            try {
                return typeof navigator.userAgent === 'string' &amp;&amp;
                    typeof document.querySelector('body') === 'object' &amp;&amp;
                    typeof XMLHttpRequest.prototype.open === 'function' &amp;&amp;
                    'browser';
            } catch (errorCaughtBrowser) {
                return module.exports &amp;&amp;
                    typeof process.versions.node === 'string' &amp;&amp;
                    typeof require('http').createServer === 'function' &amp;&amp;
                    'node';
            }
        }());
        // init global
        local.global = local.modeJs === 'browser'
            ? window
            : global;
        switch (local.modeJs) {
        // re-init local from window.local
        case 'browser':
            local = local.global.utility2.objectSetDefault(
                local.global.utility2_rollup || local.global.local,
                local.global.utility2
            );
            break;
        // re-init local from example.js
        case 'node':
            local = (local.global.utility2_rollup || require('utility2'))
                .requireExampleJsFromReadme();
            break;
        }
        // export local
        local.global.local = local;
    }());
&nbsp;
&nbsp;
&nbsp;
    // run shared js-env code - function
    (function () {
        return;
    }());
    switch (local.modeJs) {
&nbsp;
&nbsp;
&nbsp;
    // run browser js-env code - function
    case 'browser':
        break;
&nbsp;
&nbsp;
&nbsp;
    // run node js-env code - function
    case 'node':
        break;
    }
&nbsp;
&nbsp;
&nbsp;
    // run shared js-env code - post-init
    (function () {
        return;
    }());
    switch (local.modeJs) {
&nbsp;
&nbsp;
&nbsp;
    // run browser js-env code - post-init
    case 'browser':
        // run tests
        local.nop(local.modeTest &amp;&amp;
            document.querySelector('#testRunButton1') &amp;&amp;
            document.querySelector('#testRunButton1').click());
        break;
&nbsp;
&nbsp;
&nbsp;
    // run node js-env code - post-init
    /* istanbul ignore next */
    case 'node':
        local.testCase_buildApidoc_default = local.testCase_buildApidoc_default || function (
            options,
            onError
        ) {
        /*
         * this function will test buildApidoc's default handling-behavior-behavior
         */
            options = { modulePathList: module.paths };
            local.buildApidoc(options, onError);
        };
&nbsp;
        local.testCase_buildApp_default = local.testCase_buildApp_default || function (
            options,
            onError
        ) {
        /*
         * this function will test buildApp's default handling-behavior-behavior
         */
            local.testCase_buildReadme_default(options, local.onErrorThrow);
            local.testCase_buildLib_default(options, local.onErrorThrow);
            local.testCase_buildTest_default(options, local.onErrorThrow);
            local.testCase_buildCustomOrg_default(options, local.onErrorThrow);
            options = [];
            local.buildApp(options, onError);
        };
&nbsp;
        local.testCase_buildCustomOrg_default = local.testCase_buildCustomOrg_default ||
            function (options, onError) {
            /*
             * this function will test buildCustomOrg's default handling-behavior
             */
                options = {};
                local.buildCustomOrg(options, onError);
            };
&nbsp;
        local.testCase_buildLib_default = local.testCase_buildLib_default || function (
            options,
            onError
        ) {
        /*
         * this function will test buildLib's default handling-behavior
         */
            options = {};
            local.buildLib(options, onError);
        };
&nbsp;
        local.testCase_buildReadme_default = local.testCase_buildReadme_default || function (
            options,
            onError
        ) {
        /*
         * this function will test buildReadme's default handling-behavior-behavior
         */
            options = {};
            local.buildReadme(options, onError);
        };
&nbsp;
        local.testCase_buildTest_default = local.testCase_buildTest_default || function (
            options,
            onError
        ) {
        /*
         * this function will test buildTest's default handling-behavior
         */
            options = {};
            local.buildTest(options, onError);
        };
&nbsp;
        local.testCase_webpage_default = local.testCase_webpage_default || function (
            options,
            onError
        ) {
        /*
         * this function will test webpage's default handling-behavior
         */
            options = { modeCoverageMerge: true, url: local.serverLocalHost + '?modeTest=1' };
            local.browserTest(options, onError);
        };
&nbsp;
        // run test-server
        local.testRunServer(local);
        break;
    }
}());
&nbsp;
&nbsp;</pre></td></tr>
</table></pre>
</div>
<div class="footer">
    <div class="meta">Generated by <a href="https://github.com/kaizhu256/node-utility2" target="_blank">utility2</a> at Tue Apr 11 2017 17:25:15 GMT+0000 (UTC)</div>
</div>
</body>
</html>


<!doctype html>
<html lang="en">
<head>
    <title>Code coverage report for node-npmtest-node-red/node-red/red/</title>
    <meta charset="utf-8">
    <style>
        body, html {
            margin:0; padding: 0;
        }
        body {
            font-family: Arial, Helvetica;
            font-size: 10pt;
        }
        div.header, div.footer {
            background: #eee;
            padding: 1em;
        }
        div.header {
            height: 160px;
            padding: 0 1em 0 1em;
            z-index: 100;
            position: fixed;
            top: 0;
            border-bottom: 1px solid #666;
            width: 100%;
        }
        div.footer {
            border-top: 1px solid #666;
        }
        div.body {
            margin-top: 170px;
        }
        div.meta {
            font-size: 90%;
            text-align: center;
        }
        h1, h2, h3 {
            font-weight: normal;
        }
        h1 {
            font-size: 12pt;
        }
        h2 {
            font-size: 10pt;
        }
        pre {
            font-family: Menlo, Monaco, Consolas, Courier New, monospace;
            margin: 0;
            padding: 0;
            font-size: 14px;
            tab-size: 2;
        }

        div.path { font-size: 110%; }
        div.path a:link, div.path a:visited { color: #000; }
        table.coverage { border-collapse: collapse; margin:0; padding: 0 }

        table.coverage td {
            margin: 0;
            padding: 0;
            color: #111;
            vertical-align: top;
        }
        table.coverage td.line-count {
            width: 50px;
            text-align: right;
            padding-right: 5px;
        }
        table.coverage td.line-coverage {
            color: #777 !important;
            text-align: right;
            border-left: 1px solid #666;
            border-right: 1px solid #666;
        }

        table.coverage td.text {
        }

        table.coverage td span.cline-any {
            display: inline-block;
            padding: 0 5px;
            width: 40px;
        }
        table.coverage td span.cline-neutral {
            background: #eee;
        }
        table.coverage td span.cline-yes {
            background: #b5d592;
            color: #999;
        }
        table.coverage td span.cline-no {
            background: #fc8c84;
        }

        .cstat-yes { color: #111; }
        .cstat-no { background: #fc8c84; color: #111; }
        .fstat-no { background: #ffc520; color: #111 !important; }
        .cbranch-no { background:  yellow !important; color: #111; }

        .cstat-skip { background: #ddd; color: #111; }
        .fstat-skip { background: #ddd; color: #111 !important; }
        .cbranch-skip { background: #ddd !important; color: #111; }

        .missing-if-branch {
            display: inline-block;
            margin-right: 10px;
            position: relative;
            padding: 0 4px;
            background: black;
            color: yellow;
        }

        .skip-if-branch {
            display: none;
            margin-right: 10px;
            position: relative;
            padding: 0 4px;
            background: #ccc;
            color: white;
        }

        .missing-if-branch .typ, .skip-if-branch .typ {
            color: inherit !important;
        }

        .entity, .metric { font-weight: bold; }
        .metric { display: inline-block; border: 1px solid #333; padding: 0.3em; background: white; }
        .metric small { font-size: 80%; font-weight: normal; color: #666; }

        div.coverage-summary table { border-collapse: collapse; margin: 3em; font-size: 110%; }
        div.coverage-summary td, div.coverage-summary table  th { margin: 0; padding: 0.25em 1em; border-top: 1px solid #666; border-bottom: 1px solid #666; }
        div.coverage-summary th { text-align: left; border: 1px solid #666; background: #eee; font-weight: normal; }
        div.coverage-summary th.file { border-right: none !important; }
        div.coverage-summary th.pic { border-left: none !important; text-align: right; }
        div.coverage-summary th.pct { border-right: none !important; }
        div.coverage-summary th.abs { border-left: none !important; text-align: right; }
        div.coverage-summary td.pct { text-align: right; border-left: 1px solid #666; }
        div.coverage-summary td.abs { text-align: right; font-size: 90%; color: #444; border-right: 1px solid #666; }
        div.coverage-summary td.file { text-align: right; border-left: 1px solid #666; white-space: nowrap;  }
        div.coverage-summary td.pic { min-width: 120px !important;  }
        div.coverage-summary a:link { color: #000; }
        div.coverage-summary a:visited { color: #333; }
        div.coverage-summary tfoot td { border-top: 1px solid #666; }

        div.coverage-summary .yui3-datatable-sort-indicator, div.coverage-summary .dummy-sort-indicator {
            height: 10px;
            width: 7px;
            display: inline-block;
            margin-left: 0.5em;
        }
        div.coverage-summary .yui3-datatable-sort-indicator {
            background: no-repeat scroll 0 0 transparent;
        }
        div.coverage-summary .yui3-datatable-sorted .yui3-datatable-sort-indicator {
            background-position: 0 -20px;
        }
        div.coverage-summary .yui3-datatable-sorted-desc .yui3-datatable-sort-indicator {
            background-position: 0 -10px;
        }

        .high { background: #b5d592 !important; }
        .medium { background: #ffe87c !important; }
        .low { background: #fc8c84 !important; }

        span.cover-fill, span.cover-empty {
            display:inline-block;
            border:1px solid #444;
            background: white;
            height: 12px;
        }
        span.cover-fill {
            background: #ccc;
            border-right: 1px solid #444;
        }
        span.cover-empty {
            background: white;
            border-left: none;
        }
        span.cover-full {
            border-right: none !important;
        }
        pre.prettyprint {
            border: none !important;
            padding: 0 !important;
            margin: 0 !important;
        }
        .com { color: #999 !important; }
        .ignore-none { color: #999; font-weight: normal; }

    </style>
</head>
<body>
<div class="header low">
    <h1 style="font-weight: bold;">
        <a href="https://github.com/npmtest/node-npmtest-node-red">npmtest-node-red (v0.0.1)</a>
    </h1>
    <h1>Code coverage report for <span class="entity">node-npmtest-node-red/node-red/red/</span></h1>
    <h2>
        
        Statements: <span class="metric">24% <small>(12 / 50)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        
        Branches: <span class="metric">12.5% <small>(2 / 16)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        
        Functions: <span class="metric">0% <small>(0 / 11)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        
        Lines: <span class="metric">24.49% <small>(12 / 49)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        Ignored: <span class="metric"><span class="ignore-none">none</span></span> &nbsp;&nbsp;&nbsp;&nbsp;
    </h2>
    <div class="path"><a href="../../../index.html">All files</a> &#187; node-npmtest-node-red/node-red/red/</div>
</div>
<div class="body">
<div class="coverage-summary">
<table>
<thead>
<tr>
   <th data-col="file" data-fmt="html" data-html="true" class="file">File</th>
   <th data-col="pic" data-type="number" data-fmt="html" data-html="true" class="pic"></th>
   <th data-col="statements" data-type="number" data-fmt="pct" class="pct">Statements</th>
   <th data-col="statements_raw" data-type="number" data-fmt="html" class="abs"></th>
   <th data-col="branches" data-type="number" data-fmt="pct" class="pct">Branches</th>
   <th data-col="branches_raw" data-type="number" data-fmt="html" class="abs"></th>
   <th data-col="functions" data-type="number" data-fmt="pct" class="pct">Functions</th>
   <th data-col="functions_raw" data-type="number" data-fmt="html" class="abs"></th>
   <th data-col="lines" data-type="number" data-fmt="pct" class="pct">Lines</th>
   <th data-col="lines_raw" data-type="number" data-fmt="html" class="abs"></th>
</tr>
</thead>
<tbody><tr>
	<td class="file low" data-value="red.js"><a href="red.js.html">red.js</a></td>
	<td data-value="24" class="pic low"><span class="cover-fill" style="width: 24px;"></span><span class="cover-empty" style="width:76px;"></span></td>
	<td data-value="24" class="pct low">24%</td>
	<td data-value="50" class="abs low">(12&nbsp;/&nbsp;50)</td>
	<td data-value="12.5" class="pct low">12.5%</td>
	<td data-value="16" class="abs low">(2&nbsp;/&nbsp;16)</td>
	<td data-value="0" class="pct low">0%</td>
	<td data-value="11" class="abs low">(0&nbsp;/&nbsp;11)</td>
	<td data-value="24.49" class="pct low">24.49%</td>
	<td data-value="49" class="abs low">(12&nbsp;/&nbsp;49)</td>
	</tr>

</tbody>
</table>
</div></div>
<div class="footer">
    <div class="meta">Generated by <a href="https://github.com/kaizhu256/node-utility2" target="_blank">utility2</a> at Tue Apr 11 2017 17:25:15 GMT+0000 (UTC)</div>
</div>
</body>
</html>


<!doctype html>
<html lang="en">
<head>
    <title>Code coverage report for node-npmtest-node-red/node-red/red/red.js</title>
    <meta charset="utf-8">
    <style>
        body, html {
            margin:0; padding: 0;
        }
        body {
            font-family: Arial, Helvetica;
            font-size: 10pt;
        }
        div.header, div.footer {
            background: #eee;
            padding: 1em;
        }
        div.header {
            height: 160px;
            padding: 0 1em 0 1em;
            z-index: 100;
            position: fixed;
            top: 0;
            border-bottom: 1px solid #666;
            width: 100%;
        }
        div.footer {
            border-top: 1px solid #666;
        }
        div.body {
            margin-top: 170px;
        }
        div.meta {
            font-size: 90%;
            text-align: center;
        }
        h1, h2, h3 {
            font-weight: normal;
        }
        h1 {
            font-size: 12pt;
        }
        h2 {
            font-size: 10pt;
        }
        pre {
            font-family: Menlo, Monaco, Consolas, Courier New, monospace;
            margin: 0;
            padding: 0;
            font-size: 14px;
            tab-size: 2;
        }

        div.path { font-size: 110%; }
        div.path a:link, div.path a:visited { color: #000; }
        table.coverage { border-collapse: collapse; margin:0; padding: 0 }

        table.coverage td {
            margin: 0;
            padding: 0;
            color: #111;
            vertical-align: top;
        }
        table.coverage td.line-count {
            width: 50px;
            text-align: right;
            padding-right: 5px;
        }
        table.coverage td.line-coverage {
            color: #777 !important;
            text-align: right;
            border-left: 1px solid #666;
            border-right: 1px solid #666;
        }

        table.coverage td.text {
        }

        table.coverage td span.cline-any {
            display: inline-block;
            padding: 0 5px;
            width: 40px;
        }
        table.coverage td span.cline-neutral {
            background: #eee;
        }
        table.coverage td span.cline-yes {
            background: #b5d592;
            color: #999;
        }
        table.coverage td span.cline-no {
            background: #fc8c84;
        }

        .cstat-yes { color: #111; }
        .cstat-no { background: #fc8c84; color: #111; }
        .fstat-no { background: #ffc520; color: #111 !important; }
        .cbranch-no { background:  yellow !important; color: #111; }

        .cstat-skip { background: #ddd; color: #111; }
        .fstat-skip { background: #ddd; color: #111 !important; }
        .cbranch-skip { background: #ddd !important; color: #111; }

        .missing-if-branch {
            display: inline-block;
            margin-right: 10px;
            position: relative;
            padding: 0 4px;
            background: black;
            color: yellow;
        }

        .skip-if-branch {
            display: none;
            margin-right: 10px;
            position: relative;
            padding: 0 4px;
            background: #ccc;
            color: white;
        }

        .missing-if-branch .typ, .skip-if-branch .typ {
            color: inherit !important;
        }

        .entity, .metric { font-weight: bold; }
        .metric { display: inline-block; border: 1px solid #333; padding: 0.3em; background: white; }
        .metric small { font-size: 80%; font-weight: normal; color: #666; }

        div.coverage-summary table { border-collapse: collapse; margin: 3em; font-size: 110%; }
        div.coverage-summary td, div.coverage-summary table  th { margin: 0; padding: 0.25em 1em; border-top: 1px solid #666; border-bottom: 1px solid #666; }
        div.coverage-summary th { text-align: left; border: 1px solid #666; background: #eee; font-weight: normal; }
        div.coverage-summary th.file { border-right: none !important; }
        div.coverage-summary th.pic { border-left: none !important; text-align: right; }
        div.coverage-summary th.pct { border-right: none !important; }
        div.coverage-summary th.abs { border-left: none !important; text-align: right; }
        div.coverage-summary td.pct { text-align: right; border-left: 1px solid #666; }
        div.coverage-summary td.abs { text-align: right; font-size: 90%; color: #444; border-right: 1px solid #666; }
        div.coverage-summary td.file { text-align: right; border-left: 1px solid #666; white-space: nowrap;  }
        div.coverage-summary td.pic { min-width: 120px !important;  }
        div.coverage-summary a:link { color: #000; }
        div.coverage-summary a:visited { color: #333; }
        div.coverage-summary tfoot td { border-top: 1px solid #666; }

        div.coverage-summary .yui3-datatable-sort-indicator, div.coverage-summary .dummy-sort-indicator {
            height: 10px;
            width: 7px;
            display: inline-block;
            margin-left: 0.5em;
        }
        div.coverage-summary .yui3-datatable-sort-indicator {
            background: no-repeat scroll 0 0 transparent;
        }
        div.coverage-summary .yui3-datatable-sorted .yui3-datatable-sort-indicator {
            background-position: 0 -20px;
        }
        div.coverage-summary .yui3-datatable-sorted-desc .yui3-datatable-sort-indicator {
            background-position: 0 -10px;
        }

        .high { background: #b5d592 !important; }
        .medium { background: #ffe87c !important; }
        .low { background: #fc8c84 !important; }

        span.cover-fill, span.cover-empty {
            display:inline-block;
            border:1px solid #444;
            background: white;
            height: 12px;
        }
        span.cover-fill {
            background: #ccc;
            border-right: 1px solid #444;
        }
        span.cover-empty {
            background: white;
            border-left: none;
        }
        span.cover-full {
            border-right: none !important;
        }
        pre.prettyprint {
            border: none !important;
            padding: 0 !important;
            margin: 0 !important;
        }
        .com { color: #999 !important; }
        .ignore-none { color: #999; font-weight: normal; }

    </style>
</head>
<body>
<div class="header low">
    <h1 style="font-weight: bold;">
        <a href="https://github.com/npmtest/node-npmtest-node-red">npmtest-node-red (v0.0.1)</a>
    </h1>
    <h1>Code coverage report for <span class="entity">node-npmtest-node-red/node-red/red/red.js</span></h1>
    <h2>
        
        Statements: <span class="metric">24% <small>(12 / 50)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        
        Branches: <span class="metric">12.5% <small>(2 / 16)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        
        Functions: <span class="metric">0% <small>(0 / 11)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        
        Lines: <span class="metric">24.49% <small>(12 / 49)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        Ignored: <span class="metric"><span class="ignore-none">none</span></span> &nbsp;&nbsp;&nbsp;&nbsp;
    </h2>
    <div class="path"><a href="../../../index.html">All files</a> &#187; <a href="index.html">node-npmtest-node-red/node-red/red/</a> &#187; red.js</div>
</div>
<div class="body">
<pre><table class="coverage">
<tr><td class="line-count">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111</td><td class="line-coverage"><span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span></td><td class="text"><pre class="prettyprint lang-js">/**
 * Copyright JS Foundation and other contributors, http://js.foundation
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 **/
&nbsp;
var fs = require("fs");
var path = require('path');
&nbsp;
var runtime = require("./runtime");
var api = require("./api");
&nbsp;
process.env.NODE_RED_HOME = process.env.NODE_RED_HOME || path.resolve(__dirname+"/..");
&nbsp;
var nodeApp = null;
var adminApp = null;
var server = null;
var apiEnabled = false;
&nbsp;
<span class="fstat-no" title="function not covered" >function checkVersion(userSettings) {</span>
<span class="cstat-no" title="statement not covered" >    var semver = require('semver');</span>
<span class="cstat-no" title="statement not covered" >    if (!semver.satisfies(process.version,"&gt;=4.0.0")) {</span>
        // TODO: in the future, make this a hard error.
        // var e = new Error("Unsupported version of node.js");
        // e.code = "unsupported_version";
        // throw e;
<span class="cstat-no" title="statement not covered" >        userSettings.UNSUPPORTED_VERSION = process.version;</span>
    }
}
&nbsp;
<span class="fstat-no" title="function not covered" >function checkBuild() {</span>
<span class="cstat-no" title="statement not covered" >    var editorFile = path.resolve(path.join(__dirname,"..","public","red","red.min.js"));</span>
<span class="cstat-no" title="statement not covered" >    try {</span>
<span class="cstat-no" title="statement not covered" >        var stats = fs.statSync(editorFile);</span>
    } catch(err) {
<span class="cstat-no" title="statement not covered" >        var e = new Error("Node-RED not built");</span>
<span class="cstat-no" title="statement not covered" >        e.code = "not_built";</span>
<span class="cstat-no" title="statement not covered" >        throw e;</span>
    }
}
&nbsp;
module.exports = {
    init: <span class="fstat-no" title="function not covered" >function(httpServer,userSettings) {</span>
<span class="cstat-no" title="statement not covered" >        if (!userSettings) {</span>
<span class="cstat-no" title="statement not covered" >            userSettings = httpServer;</span>
<span class="cstat-no" title="statement not covered" >            httpServer = null;</span>
        }
&nbsp;
<span class="cstat-no" title="statement not covered" >        if (!userSettings.SKIP_BUILD_CHECK) {</span>
<span class="cstat-no" title="statement not covered" >            checkVersion(userSettings);</span>
<span class="cstat-no" title="statement not covered" >            checkBuild();</span>
        }
&nbsp;
<span class="cstat-no" title="statement not covered" >        if (!userSettings.coreNodesDir) {</span>
<span class="cstat-no" title="statement not covered" >            userSettings.coreNodesDir = path.resolve(path.join(__dirname,"..","nodes"));</span>
        }
&nbsp;
<span class="cstat-no" title="statement not covered" >        if (userSettings.httpAdminRoot !== false) {</span>
<span class="cstat-no" title="statement not covered" >            runtime.init(userSettings,api);</span>
<span class="cstat-no" title="statement not covered" >            api.init(httpServer,runtime);</span>
<span class="cstat-no" title="statement not covered" >            apiEnabled = true;</span>
        } else {
<span class="cstat-no" title="statement not covered" >            runtime.init(userSettings);</span>
<span class="cstat-no" title="statement not covered" >            apiEnabled = false;</span>
        }
<span class="cstat-no" title="statement not covered" >        adminApp = runtime.adminApi.adminApp;</span>
<span class="cstat-no" title="statement not covered" >        nodeApp = runtime.nodeApp;</span>
<span class="cstat-no" title="statement not covered" >        server = runtime.adminApi.server;</span>
<span class="cstat-no" title="statement not covered" >        return;</span>
    },
    start: <span class="fstat-no" title="function not covered" >function() {</span>
<span class="cstat-no" title="statement not covered" >        return runtime.start().then(<span class="fstat-no" title="function not covered" >function() {</span></span>
<span class="cstat-no" title="statement not covered" >            if (apiEnabled) {</span>
<span class="cstat-no" title="statement not covered" >                return api.start();</span>
            }
        });
    },
    stop: <span class="fstat-no" title="function not covered" >function() {</span>
<span class="cstat-no" title="statement not covered" >        return runtime.stop().then(<span class="fstat-no" title="function not covered" >function() {</span></span>
<span class="cstat-no" title="statement not covered" >            if (apiEnabled) {</span>
<span class="cstat-no" title="statement not covered" >                return api.stop();</span>
            }
        })
    },
    nodes: runtime.nodes,
    log: runtime.log,
    settings:runtime.settings,
    util: runtime.util,
    version: runtime.version,
&nbsp;
    comms: api.comms,
    library: api.library,
    auth: api.auth,
&nbsp;
    get app<span class="fstat-no" title="function not covered" >() {</span> <span class="cstat-no" title="statement not covered" >console.log("Deprecated use of RED.app - use RED.httpAdmin instead"); <span class="cstat-no" title="statement not covered" ></span>return runtime.app }</span>,
    get httpAdmin<span class="fstat-no" title="function not covered" >() {</span> <span class="cstat-no" title="statement not covered" >return adminApp }</span>,
    get httpNode<span class="fstat-no" title="function not covered" >() {</span> <span class="cstat-no" title="statement not covered" >return nodeApp }</span>,
    get server<span class="fstat-no" title="function not covered" >() {</span> <span class="cstat-no" title="statement not covered" >return server }</span>
};
&nbsp;
&nbsp;</pre></td></tr>
</table></pre>
</div>
<div class="footer">
    <div class="meta">Generated by <a href="https://github.com/kaizhu256/node-utility2" target="_blank">utility2</a> at Tue Apr 11 2017 17:25:15 GMT+0000 (UTC)</div>
</div>
</body>
</html>


<!doctype html>
<html lang="en">
<head>
    <title>Code coverage report for node-npmtest-node-red/node-red/red/api/</title>
    <meta charset="utf-8">
    <style>
        body, html {
            margin:0; padding: 0;
        }
        body {
            font-family: Arial, Helvetica;
            font-size: 10pt;
        }
        div.header, div.footer {
            background: #eee;
            padding: 1em;
        }
        div.header {
            height: 160px;
            padding: 0 1em 0 1em;
            z-index: 100;
            position: fixed;
            top: 0;
            border-bottom: 1px solid #666;
            width: 100%;
        }
        div.footer {
            border-top: 1px solid #666;
        }
        div.body {
            margin-top: 170px;
        }
        div.meta {
            font-size: 90%;
            text-align: center;
        }
        h1, h2, h3 {
            font-weight: normal;
        }
        h1 {
            font-size: 12pt;
        }
        h2 {
            font-size: 10pt;
        }
        pre {
            font-family: Menlo, Monaco, Consolas, Courier New, monospace;
            margin: 0;
            padding: 0;
            font-size: 14px;
            tab-size: 2;
        }

        div.path { font-size: 110%; }
        div.path a:link, div.path a:visited { color: #000; }
        table.coverage { border-collapse: collapse; margin:0; padding: 0 }

        table.coverage td {
            margin: 0;
            padding: 0;
            color: #111;
            vertical-align: top;
        }
        table.coverage td.line-count {
            width: 50px;
            text-align: right;
            padding-right: 5px;
        }
        table.coverage td.line-coverage {
            color: #777 !important;
            text-align: right;
            border-left: 1px solid #666;
            border-right: 1px solid #666;
        }

        table.coverage td.text {
        }

        table.coverage td span.cline-any {
            display: inline-block;
            padding: 0 5px;
            width: 40px;
        }
        table.coverage td span.cline-neutral {
            background: #eee;
        }
        table.coverage td span.cline-yes {
            background: #b5d592;
            color: #999;
        }
        table.coverage td span.cline-no {
            background: #fc8c84;
        }

        .cstat-yes { color: #111; }
        .cstat-no { background: #fc8c84; color: #111; }
        .fstat-no { background: #ffc520; color: #111 !important; }
        .cbranch-no { background:  yellow !important; color: #111; }

        .cstat-skip { background: #ddd; color: #111; }
        .fstat-skip { background: #ddd; color: #111 !important; }
        .cbranch-skip { background: #ddd !important; color: #111; }

        .missing-if-branch {
            display: inline-block;
            margin-right: 10px;
            position: relative;
            padding: 0 4px;
            background: black;
            color: yellow;
        }

        .skip-if-branch {
            display: none;
            margin-right: 10px;
            position: relative;
            padding: 0 4px;
            background: #ccc;
            color: white;
        }

        .missing-if-branch .typ, .skip-if-branch .typ {
            color: inherit !important;
        }

        .entity, .metric { font-weight: bold; }
        .metric { display: inline-block; border: 1px solid #333; padding: 0.3em; background: white; }
        .metric small { font-size: 80%; font-weight: normal; color: #666; }

        div.coverage-summary table { border-collapse: collapse; margin: 3em; font-size: 110%; }
        div.coverage-summary td, div.coverage-summary table  th { margin: 0; padding: 0.25em 1em; border-top: 1px solid #666; border-bottom: 1px solid #666; }
        div.coverage-summary th { text-align: left; border: 1px solid #666; background: #eee; font-weight: normal; }
        div.coverage-summary th.file { border-right: none !important; }
        div.coverage-summary th.pic { border-left: none !important; text-align: right; }
        div.coverage-summary th.pct { border-right: none !important; }
        div.coverage-summary th.abs { border-left: none !important; text-align: right; }
        div.coverage-summary td.pct { text-align: right; border-left: 1px solid #666; }
        div.coverage-summary td.abs { text-align: right; font-size: 90%; color: #444; border-right: 1px solid #666; }
        div.coverage-summary td.file { text-align: right; border-left: 1px solid #666; white-space: nowrap;  }
        div.coverage-summary td.pic { min-width: 120px !important;  }
        div.coverage-summary a:link { color: #000; }
        div.coverage-summary a:visited { color: #333; }
        div.coverage-summary tfoot td { border-top: 1px solid #666; }

        div.coverage-summary .yui3-datatable-sort-indicator, div.coverage-summary .dummy-sort-indicator {
            height: 10px;
            width: 7px;
            display: inline-block;
            margin-left: 0.5em;
        }
        div.coverage-summary .yui3-datatable-sort-indicator {
            background: no-repeat scroll 0 0 transparent;
        }
        div.coverage-summary .yui3-datatable-sorted .yui3-datatable-sort-indicator {
            background-position: 0 -20px;
        }
        div.coverage-summary .yui3-datatable-sorted-desc .yui3-datatable-sort-indicator {
            background-position: 0 -10px;
        }

        .high { background: #b5d592 !important; }
        .medium { background: #ffe87c !important; }
        .low { background: #fc8c84 !important; }

        span.cover-fill, span.cover-empty {
            display:inline-block;
            border:1px solid #444;
            background: white;
            height: 12px;
        }
        span.cover-fill {
            background: #ccc;
            border-right: 1px solid #444;
        }
        span.cover-empty {
            background: white;
            border-left: none;
        }
        span.cover-full {
            border-right: none !important;
        }
        pre.prettyprint {
            border: none !important;
            padding: 0 !important;
            margin: 0 !important;
        }
        .com { color: #999 !important; }
        .ignore-none { color: #999; font-weight: normal; }

    </style>
</head>
<body>
<div class="header low">
    <h1 style="font-weight: bold;">
        <a href="https://github.com/npmtest/node-npmtest-node-red">npmtest-node-red (v0.0.1)</a>
    </h1>
    <h1>Code coverage report for <span class="entity">node-npmtest-node-red/node-red/red/api/</span></h1>
    <h2>
        
        Statements: <span class="metric">15.49% <small>(123 / 794)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        
        Branches: <span class="metric">0.61% <small>(2 / 328)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        
        Functions: <span class="metric">0% <small>(0 / 109)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        
        Lines: <span class="metric">15.49% <small>(123 / 794)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        Ignored: <span class="metric"><span class="ignore-none">none</span></span> &nbsp;&nbsp;&nbsp;&nbsp;
    </h2>
    <div class="path"><a href="../../../../index.html">All files</a> &#187; node-npmtest-node-red/node-red/red/api/</div>
</div>
<div class="body">
<div class="coverage-summary">
<table>
<thead>
<tr>
   <th data-col="file" data-fmt="html" data-html="true" class="file">File</th>
   <th data-col="pic" data-type="number" data-fmt="html" data-html="true" class="pic"></th>
   <th data-col="statements" data-type="number" data-fmt="pct" class="pct">Statements</th>
   <th data-col="statements_raw" data-type="number" data-fmt="html" class="abs"></th>
   <th data-col="branches" data-type="number" data-fmt="pct" class="pct">Branches</th>
   <th data-col="branches_raw" data-type="number" data-fmt="html" class="abs"></th>
   <th data-col="functions" data-type="number" data-fmt="pct" class="pct">Functions</th>
   <th data-col="functions_raw" data-type="number" data-fmt="html" class="abs"></th>
   <th data-col="lines" data-type="number" data-fmt="pct" class="pct">Lines</th>
   <th data-col="lines_raw" data-type="number" data-fmt="html" class="abs"></th>
</tr>
</thead>
<tbody><tr>
	<td class="file low" data-value="comms.js"><a href="comms.js.html">comms.js</a></td>
	<td data-value="16.54" class="pic low"><span class="cover-fill" style="width: 16px;"></span><span class="cover-empty" style="width:84px;"></span></td>
	<td data-value="16.54" class="pct low">16.54%</td>
	<td data-value="127" class="abs low">(21&nbsp;/&nbsp;127)</td>
	<td data-value="0" class="pct low">0%</td>
	<td data-value="48" class="abs low">(0&nbsp;/&nbsp;48)</td>
	<td data-value="0" class="pct low">0%</td>
	<td data-value="21" class="abs low">(0&nbsp;/&nbsp;21)</td>
	<td data-value="16.54" class="pct low">16.54%</td>
	<td data-value="127" class="abs low">(21&nbsp;/&nbsp;127)</td>
	</tr>

<tr>
	<td class="file low" data-value="credentials.js"><a href="credentials.js.html">credentials.js</a></td>
	<td data-value="13.64" class="pic low"><span class="cover-fill" style="width: 13px;"></span><span class="cover-empty" style="width:87px;"></span></td>
	<td data-value="13.64" class="pct low">13.64%</td>
	<td data-value="22" class="abs low">(3&nbsp;/&nbsp;22)</td>
	<td data-value="0" class="pct low">0%</td>
	<td data-value="10" class="abs low">(0&nbsp;/&nbsp;10)</td>
	<td data-value="0" class="pct low">0%</td>
	<td data-value="2" class="abs low">(0&nbsp;/&nbsp;2)</td>
	<td data-value="13.64" class="pct low">13.64%</td>
	<td data-value="22" class="abs low">(3&nbsp;/&nbsp;22)</td>
	</tr>

<tr>
	<td class="file low" data-value="flow.js"><a href="flow.js.html">flow.js</a></td>
	<td data-value="9.3" class="pic low"><span class="cover-fill" style="width: 9px;"></span><span class="cover-empty" style="width:91px;"></span></td>
	<td data-value="9.3" class="pct low">9.3%</td>
	<td data-value="43" class="abs low">(4&nbsp;/&nbsp;43)</td>
	<td data-value="0" class="pct low">0%</td>
	<td data-value="22" class="abs low">(0&nbsp;/&nbsp;22)</td>
	<td data-value="0" class="pct low">0%</td>
	<td data-value="10" class="abs low">(0&nbsp;/&nbsp;10)</td>
	<td data-value="9.3" class="pct low">9.3%</td>
	<td data-value="43" class="abs low">(4&nbsp;/&nbsp;43)</td>
	</tr>

<tr>
	<td class="file low" data-value="flows.js"><a href="flows.js.html">flows.js</a></td>
	<td data-value="9.09" class="pic low"><span class="cover-fill" style="width: 9px;"></span><span class="cover-empty" style="width:91px;"></span></td>
	<td data-value="9.09" class="pct low">9.09%</td>
	<td data-value="44" class="abs low">(4&nbsp;/&nbsp;44)</td>
	<td data-value="0" class="pct low">0%</td>
	<td data-value="24" class="abs low">(0&nbsp;/&nbsp;24)</td>
	<td data-value="0" class="pct low">0%</td>
	<td data-value="7" class="abs low">(0&nbsp;/&nbsp;7)</td>
	<td data-value="9.09" class="pct low">9.09%</td>
	<td data-value="44" class="abs low">(4&nbsp;/&nbsp;44)</td>
	</tr>

<tr>
	<td class="file low" data-value="index.js"><a href="index.js.html">index.js</a></td>
	<td data-value="27.78" class="pic low"><span class="cover-fill" style="width: 27px;"></span><span class="cover-empty" style="width:73px;"></span></td>
	<td data-value="27.78" class="pct low">27.78%</td>
	<td data-value="108" class="abs low">(30&nbsp;/&nbsp;108)</td>
	<td data-value="0" class="pct low">0%</td>
	<td data-value="22" class="abs low">(0&nbsp;/&nbsp;22)</td>
	<td data-value="0" class="pct low">0%</td>
	<td data-value="9" class="abs low">(0&nbsp;/&nbsp;9)</td>
	<td data-value="27.78" class="pct low">27.78%</td>
	<td data-value="108" class="abs low">(30&nbsp;/&nbsp;108)</td>
	</tr>

<tr>
	<td class="file low" data-value="info.js"><a href="info.js.html">info.js</a></td>
	<td data-value="25" class="pic low"><span class="cover-fill" style="width: 25px;"></span><span class="cover-empty" style="width:75px;"></span></td>
	<td data-value="25" class="pct low">25%</td>
	<td data-value="20" class="abs low">(5&nbsp;/&nbsp;20)</td>
	<td data-value="0" class="pct low">0%</td>
	<td data-value="14" class="abs low">(0&nbsp;/&nbsp;14)</td>
	<td data-value="0" class="pct low">0%</td>
	<td data-value="2" class="abs low">(0&nbsp;/&nbsp;2)</td>
	<td data-value="25" class="pct low">25%</td>
	<td data-value="20" class="abs low">(5&nbsp;/&nbsp;20)</td>
	</tr>

<tr>
	<td class="file low" data-value="library.js"><a href="library.js.html">library.js</a></td>
	<td data-value="11.72" class="pic low"><span class="cover-fill" style="width: 11px;"></span><span class="cover-empty" style="width:89px;"></span></td>
	<td data-value="11.72" class="pct low">11.72%</td>
	<td data-value="128" class="abs low">(15&nbsp;/&nbsp;128)</td>
	<td data-value="0" class="pct low">0%</td>
	<td data-value="38" class="abs low">(0&nbsp;/&nbsp;38)</td>
	<td data-value="0" class="pct low">0%</td>
	<td data-value="25" class="abs low">(0&nbsp;/&nbsp;25)</td>
	<td data-value="11.72" class="pct low">11.72%</td>
	<td data-value="128" class="abs low">(15&nbsp;/&nbsp;128)</td>
	</tr>

<tr>
	<td class="file low" data-value="locales.js"><a href="locales.js.html">locales.js</a></td>
	<td data-value="25.81" class="pic low"><span class="cover-fill" style="width: 25px;"></span><span class="cover-empty" style="width:75px;"></span></td>
	<td data-value="25.81" class="pct low">25.81%</td>
	<td data-value="31" class="abs low">(8&nbsp;/&nbsp;31)</td>
	<td data-value="0" class="pct low">0%</td>
	<td data-value="12" class="abs low">(0&nbsp;/&nbsp;12)</td>
	<td data-value="0" class="pct low">0%</td>
	<td data-value="6" class="abs low">(0&nbsp;/&nbsp;6)</td>
	<td data-value="25.81" class="pct low">25.81%</td>
	<td data-value="31" class="abs low">(8&nbsp;/&nbsp;31)</td>
	</tr>

<tr>
	<td class="file low" data-value="nodes.js"><a href="nodes.js.html">nodes.js</a></td>
	<td data-value="5.77" class="pic low"><span class="cover-fill" style="width: 5px;"></span><span class="cover-empty" style="width:95px;"></span></td>
	<td data-value="5.77" class="pct low">5.77%</td>
	<td data-value="156" class="abs low">(9&nbsp;/&nbsp;156)</td>
	<td data-value="0" class="pct low">0%</td>
	<td data-value="76" class="abs low">(0&nbsp;/&nbsp;76)</td>
	<td data-value="0" class="pct low">0%</td>
	<td data-value="16" class="abs low">(0&nbsp;/&nbsp;16)</td>
	<td data-value="5.77" class="pct low">5.77%</td>
	<td data-value="156" class="abs low">(9&nbsp;/&nbsp;156)</td>
	</tr>

<tr>
	<td class="file low" data-value="theme.js"><a href="theme.js.html">theme.js</a></td>
	<td data-value="14.81" class="pic low"><span class="cover-fill" style="width: 14px;"></span><span class="cover-empty" style="width:86px;"></span></td>
	<td data-value="14.81" class="pct low">14.81%</td>
	<td data-value="81" class="abs low">(12&nbsp;/&nbsp;81)</td>
	<td data-value="3.45" class="pct low">3.45%</td>
	<td data-value="58" class="abs low">(2&nbsp;/&nbsp;58)</td>
	<td data-value="0" class="pct low">0%</td>
	<td data-value="6" class="abs low">(0&nbsp;/&nbsp;6)</td>
	<td data-value="14.81" class="pct low">14.81%</td>
	<td data-value="81" class="abs low">(12&nbsp;/&nbsp;81)</td>
	</tr>

<tr>
	<td class="file low" data-value="ui.js"><a href="ui.js.html">ui.js</a></td>
	<td data-value="35.29" class="pic low"><span class="cover-fill" style="width: 35px;"></span><span class="cover-empty" style="width:65px;"></span></td>
	<td data-value="35.29" class="pct low">35.29%</td>
	<td data-value="34" class="abs low">(12&nbsp;/&nbsp;34)</td>
	<td data-value="0" class="pct low">0%</td>
	<td data-value="4" class="abs low">(0&nbsp;/&nbsp;4)</td>
	<td data-value="0" class="pct low">0%</td>
	<td data-value="5" class="abs low">(0&nbsp;/&nbsp;5)</td>
	<td data-value="35.29" class="pct low">35.29%</td>
	<td data-value="34" class="abs low">(12&nbsp;/&nbsp;34)</td>
	</tr>

</tbody>
</table>
</div></div>
<div class="footer">
    <div class="meta">Generated by <a href="https://github.com/kaizhu256/node-utility2" target="_blank">utility2</a> at Tue Apr 11 2017 17:25:15 GMT+0000 (UTC)</div>
</div>
</body>
</html>


<!doctype html>
<html lang="en">
<head>
    <title>Code coverage report for node-npmtest-node-red/node-red/red/api/comms.js</title>
    <meta charset="utf-8">
    <style>
        body, html {
            margin:0; padding: 0;
        }
        body {
            font-family: Arial, Helvetica;
            font-size: 10pt;
        }
        div.header, div.footer {
            background: #eee;
            padding: 1em;
        }
        div.header {
            height: 160px;
            padding: 0 1em 0 1em;
            z-index: 100;
            position: fixed;
            top: 0;
            border-bottom: 1px solid #666;
            width: 100%;
        }
        div.footer {
            border-top: 1px solid #666;
        }
        div.body {
            margin-top: 170px;
        }
        div.meta {
            font-size: 90%;
            text-align: center;
        }
        h1, h2, h3 {
            font-weight: normal;
        }
        h1 {
            font-size: 12pt;
        }
        h2 {
            font-size: 10pt;
        }
        pre {
            font-family: Menlo, Monaco, Consolas, Courier New, monospace;
            margin: 0;
            padding: 0;
            font-size: 14px;
            tab-size: 2;
        }

        div.path { font-size: 110%; }
        div.path a:link, div.path a:visited { color: #000; }
        table.coverage { border-collapse: collapse; margin:0; padding: 0 }

        table.coverage td {
            margin: 0;
            padding: 0;
            color: #111;
            vertical-align: top;
        }
        table.coverage td.line-count {
            width: 50px;
            text-align: right;
            padding-right: 5px;
        }
        table.coverage td.line-coverage {
            color: #777 !important;
            text-align: right;
            border-left: 1px solid #666;
            border-right: 1px solid #666;
        }

        table.coverage td.text {
        }

        table.coverage td span.cline-any {
            display: inline-block;
            padding: 0 5px;
            width: 40px;
        }
        table.coverage td span.cline-neutral {
            background: #eee;
        }
        table.coverage td span.cline-yes {
            background: #b5d592;
            color: #999;
        }
        table.coverage td span.cline-no {
            background: #fc8c84;
        }

        .cstat-yes { color: #111; }
        .cstat-no { background: #fc8c84; color: #111; }
        .fstat-no { background: #ffc520; color: #111 !important; }
        .cbranch-no { background:  yellow !important; color: #111; }

        .cstat-skip { background: #ddd; color: #111; }
        .fstat-skip { background: #ddd; color: #111 !important; }
        .cbranch-skip { background: #ddd !important; color: #111; }

        .missing-if-branch {
            display: inline-block;
            margin-right: 10px;
            position: relative;
            padding: 0 4px;
            background: black;
            color: yellow;
        }

        .skip-if-branch {
            display: none;
            margin-right: 10px;
            position: relative;
            padding: 0 4px;
            background: #ccc;
            color: white;
        }

        .missing-if-branch .typ, .skip-if-branch .typ {
            color: inherit !important;
        }

        .entity, .metric { font-weight: bold; }
        .metric { display: inline-block; border: 1px solid #333; padding: 0.3em; background: white; }
        .metric small { font-size: 80%; font-weight: normal; color: #666; }

        div.coverage-summary table { border-collapse: collapse; margin: 3em; font-size: 110%; }
        div.coverage-summary td, div.coverage-summary table  th { margin: 0; padding: 0.25em 1em; border-top: 1px solid #666; border-bottom: 1px solid #666; }
        div.coverage-summary th { text-align: left; border: 1px solid #666; background: #eee; font-weight: normal; }
        div.coverage-summary th.file { border-right: none !important; }
        div.coverage-summary th.pic { border-left: none !important; text-align: right; }
        div.coverage-summary th.pct { border-right: none !important; }
        div.coverage-summary th.abs { border-left: none !important; text-align: right; }
        div.coverage-summary td.pct { text-align: right; border-left: 1px solid #666; }
        div.coverage-summary td.abs { text-align: right; font-size: 90%; color: #444; border-right: 1px solid #666; }
        div.coverage-summary td.file { text-align: right; border-left: 1px solid #666; white-space: nowrap;  }
        div.coverage-summary td.pic { min-width: 120px !important;  }
        div.coverage-summary a:link { color: #000; }
        div.coverage-summary a:visited { color: #333; }
        div.coverage-summary tfoot td { border-top: 1px solid #666; }

        div.coverage-summary .yui3-datatable-sort-indicator, div.coverage-summary .dummy-sort-indicator {
            height: 10px;
            width: 7px;
            display: inline-block;
            margin-left: 0.5em;
        }
        div.coverage-summary .yui3-datatable-sort-indicator {
            background: no-repeat scroll 0 0 transparent;
        }
        div.coverage-summary .yui3-datatable-sorted .yui3-datatable-sort-indicator {
            background-position: 0 -20px;
        }
        div.coverage-summary .yui3-datatable-sorted-desc .yui3-datatable-sort-indicator {
            background-position: 0 -10px;
        }

        .high { background: #b5d592 !important; }
        .medium { background: #ffe87c !important; }
        .low { background: #fc8c84 !important; }

        span.cover-fill, span.cover-empty {
            display:inline-block;
            border:1px solid #444;
            background: white;
            height: 12px;
        }
        span.cover-fill {
            background: #ccc;
            border-right: 1px solid #444;
        }
        span.cover-empty {
            background: white;
            border-left: none;
        }
        span.cover-full {
            border-right: none !important;
        }
        pre.prettyprint {
            border: none !important;
            padding: 0 !important;
            margin: 0 !important;
        }
        .com { color: #999 !important; }
        .ignore-none { color: #999; font-weight: normal; }

    </style>
</head>
<body>
<div class="header low">
    <h1 style="font-weight: bold;">
        <a href="https://github.com/npmtest/node-npmtest-node-red">npmtest-node-red (v0.0.1)</a>
    </h1>
    <h1>Code coverage report for <span class="entity">node-npmtest-node-red/node-red/red/api/comms.js</span></h1>
    <h2>
        
        Statements: <span class="metric">16.54% <small>(21 / 127)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        
        Branches: <span class="metric">0% <small>(0 / 48)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        
        Functions: <span class="metric">0% <small>(0 / 21)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        
        Lines: <span class="metric">16.54% <small>(21 / 127)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        Ignored: <span class="metric"><span class="ignore-none">none</span></span> &nbsp;&nbsp;&nbsp;&nbsp;
    </h2>
    <div class="path"><a href="../../../../index.html">All files</a> &#187; <a href="index.html">node-npmtest-node-red/node-red/red/api/</a> &#187; comms.js</div>
</div>
<div class="body">
<pre><table class="coverage">
<tr><td class="line-count">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
164
165
166
167
168
169
170
171
172
173
174
175
176
177
178
179
180
181
182
183
184
185
186
187
188
189
190
191
192
193
194
195
196
197
198
199
200
201
202
203
204
205
206
207
208
209
210
211
212
213
214
215
216
217
218
219
220
221
222
223
224
225
226
227
228
229
230
231
232
233
234
235
236</td><td class="line-coverage"><span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span></td><td class="text"><pre class="prettyprint lang-js">/**
 * Copyright JS Foundation and other contributors, http://js.foundation
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 **/
&nbsp;
var ws = require("ws");
var log;
&nbsp;
var server;
var settings;
&nbsp;
var wsServer;
var pendingConnections = [];
var activeConnections = [];
&nbsp;
var retained = {};
&nbsp;
var heartbeatTimer;
var lastSentTime;
&nbsp;
<span class="fstat-no" title="function not covered" >function handleStatus(event) {</span>
<span class="cstat-no" title="statement not covered" >    publish("status/"+event.id,event.status,true);</span>
}
<span class="fstat-no" title="function not covered" >function handleRuntimeEvent(event) {</span>
<span class="cstat-no" title="statement not covered" >    publish("notification/"+event.id,event,true);</span>
}
<span class="fstat-no" title="function not covered" >function init(_server,runtime) {</span>
<span class="cstat-no" title="statement not covered" >    server = _server;</span>
<span class="cstat-no" title="statement not covered" >    settings = runtime.settings;</span>
<span class="cstat-no" title="statement not covered" >    log = runtime.log;</span>
&nbsp;
<span class="cstat-no" title="statement not covered" >    runtime.events.removeListener("node-status",handleStatus);</span>
<span class="cstat-no" title="statement not covered" >    runtime.events.on("node-status",handleStatus);</span>
&nbsp;
<span class="cstat-no" title="statement not covered" >    runtime.events.removeListener("runtime-event",handleRuntimeEvent);</span>
<span class="cstat-no" title="statement not covered" >    runtime.events.on("runtime-event",handleRuntimeEvent);</span>
}
&nbsp;
<span class="fstat-no" title="function not covered" >function start() {</span>
<span class="cstat-no" title="statement not covered" >    var Tokens = require("./auth/tokens");</span>
<span class="cstat-no" title="statement not covered" >    var Users = require("./auth/users");</span>
<span class="cstat-no" title="statement not covered" >    var Permissions = require("./auth/permissions");</span>
<span class="cstat-no" title="statement not covered" >    if (!settings.disableEditor) {</span>
<span class="cstat-no" title="statement not covered" >        Users.default().then(<span class="fstat-no" title="function not covered" >function(anonymousUser) {</span></span>
<span class="cstat-no" title="statement not covered" >            var webSocketKeepAliveTime = settings.webSocketKeepAliveTime || 15000;</span>
<span class="cstat-no" title="statement not covered" >            var path = settings.httpAdminRoot || "/";</span>
<span class="cstat-no" title="statement not covered" >            path = (path.slice(0,1) != "/" ? "/":"") + path + (path.slice(-1) == "/" ? "":"/") + "comms";</span>
<span class="cstat-no" title="statement not covered" >            wsServer = new ws.Server({</span>
                server:server,
                path:path,
                // Disable the deflate option due to this issue
                //  https://github.com/websockets/ws/pull/632
                // that is fixed in the 1.x release of the ws module
                // that we cannot currently pickup as it drops node 0.10 support
                perMessageDeflate: false
            });
&nbsp;
<span class="cstat-no" title="statement not covered" >            wsServer.on('connection',<span class="fstat-no" title="function not covered" >function(ws) {</span></span>
<span class="cstat-no" title="statement not covered" >                log.audit({event: "comms.open"});</span>
<span class="cstat-no" title="statement not covered" >                var pendingAuth = (settings.adminAuth != null);</span>
<span class="cstat-no" title="statement not covered" >                if (!pendingAuth) {</span>
<span class="cstat-no" title="statement not covered" >                    activeConnections.push(ws);</span>
                } else {
<span class="cstat-no" title="statement not covered" >                    pendingConnections.push(ws);</span>
                }
<span class="cstat-no" title="statement not covered" >                ws.on('close',<span class="fstat-no" title="function not covered" >function() {</span></span>
<span class="cstat-no" title="statement not covered" >                    log.audit({event: "comms.close",user:ws.user});</span>
<span class="cstat-no" title="statement not covered" >                    removeActiveConnection(ws);</span>
<span class="cstat-no" title="statement not covered" >                    removePendingConnection(ws);</span>
                });
<span class="cstat-no" title="statement not covered" >                ws.on('message', <span class="fstat-no" title="function not covered" >function(data,flags) {</span></span>
<span class="cstat-no" title="statement not covered" >                    var msg = null;</span>
<span class="cstat-no" title="statement not covered" >                    try {</span>
<span class="cstat-no" title="statement not covered" >                        msg = JSON.parse(data);</span>
                    } catch(err) {
<span class="cstat-no" title="statement not covered" >                        log.trace("comms received malformed message : "+err.toString());</span>
<span class="cstat-no" title="statement not covered" >                        return;</span>
                    }
<span class="cstat-no" title="statement not covered" >                    if (!pendingAuth) {</span>
<span class="cstat-no" title="statement not covered" >                        if (msg.subscribe) {</span>
<span class="cstat-no" title="statement not covered" >                            handleRemoteSubscription(ws,msg.subscribe);</span>
                        }
                    } else {
<span class="cstat-no" title="statement not covered" >                        var completeConnection = <span class="fstat-no" title="function not covered" >function(userScope,sendAck) {</span></span>
<span class="cstat-no" title="statement not covered" >                            try {</span>
<span class="cstat-no" title="statement not covered" >                                if (!userScope || !Permissions.hasPermission(userScope,"status.read")) {</span>
<span class="cstat-no" title="statement not covered" >                                    ws.send(JSON.stringify({auth:"fail"}));</span>
<span class="cstat-no" title="statement not covered" >                                    ws.close();</span>
                                } else {
<span class="cstat-no" title="statement not covered" >                                    pendingAuth = false;</span>
<span class="cstat-no" title="statement not covered" >                                    removePendingConnection(ws);</span>
<span class="cstat-no" title="statement not covered" >                                    activeConnections.push(ws);</span>
<span class="cstat-no" title="statement not covered" >                                    if (sendAck) {</span>
<span class="cstat-no" title="statement not covered" >                                        ws.send(JSON.stringify({auth:"ok"}));</span>
                                    }
                                }
                            } catch(err) {
                                // Just in case the socket closes before we attempt
                                // to send anything.
                            }
                        }
<span class="cstat-no" title="statement not covered" >                        if (msg.auth) {</span>
<span class="cstat-no" title="statement not covered" >                            Tokens.get(msg.auth).then(<span class="fstat-no" title="function not covered" >function(client) {</span></span>
<span class="cstat-no" title="statement not covered" >                                if (client) {</span>
<span class="cstat-no" title="statement not covered" >                                    Users.get(client.user).then(<span class="fstat-no" title="function not covered" >function(user) {</span></span>
<span class="cstat-no" title="statement not covered" >                                        if (user) {</span>
<span class="cstat-no" title="statement not covered" >                                            ws.user = user;</span>
<span class="cstat-no" title="statement not covered" >                                            log.audit({event: "comms.auth",user:ws.user});</span>
<span class="cstat-no" title="statement not covered" >                                            completeConnection(client.scope,true);</span>
                                        } else {
<span class="cstat-no" title="statement not covered" >                                            log.audit({event: "comms.auth.fail"});</span>
<span class="cstat-no" title="statement not covered" >                                            completeConnection(null,false);</span>
                                        }
                                    });
                                } else {
<span class="cstat-no" title="statement not covered" >                                    log.audit({event: "comms.auth.fail"});</span>
<span class="cstat-no" title="statement not covered" >                                    completeConnection(null,false);</span>
                                }
                            });
                        } else {
<span class="cstat-no" title="statement not covered" >                            if (anonymousUser) {</span>
<span class="cstat-no" title="statement not covered" >                                log.audit({event: "comms.auth",user:anonymousUser});</span>
<span class="cstat-no" title="statement not covered" >                                completeConnection(anonymousUser.permissions,false);</span>
                            } else {
<span class="cstat-no" title="statement not covered" >                                log.audit({event: "comms.auth.fail"});</span>
<span class="cstat-no" title="statement not covered" >                                completeConnection(null,false);</span>
                            }
                            //TODO: duplicated code - pull non-auth message handling out
<span class="cstat-no" title="statement not covered" >                            if (msg.subscribe) {</span>
<span class="cstat-no" title="statement not covered" >                                handleRemoteSubscription(ws,msg.subscribe);</span>
                            }
                        }
                    }
                });
<span class="cstat-no" title="statement not covered" >                ws.on('error', <span class="fstat-no" title="function not covered" >function(err) {</span></span>
<span class="cstat-no" title="statement not covered" >                    log.warn(log._("comms.error",{message:err.toString()}));</span>
                });
            });
&nbsp;
<span class="cstat-no" title="statement not covered" >            wsServer.on('error', <span class="fstat-no" title="function not covered" >function(err) {</span></span>
<span class="cstat-no" title="statement not covered" >                log.warn(log._("comms.error-server",{message:err.toString()}));</span>
            });
&nbsp;
<span class="cstat-no" title="statement not covered" >            lastSentTime = Date.now();</span>
&nbsp;
<span class="cstat-no" title="statement not covered" >            heartbeatTimer = setInterval(<span class="fstat-no" title="function not covered" >function() {</span></span>
<span class="cstat-no" title="statement not covered" >                var now = Date.now();</span>
<span class="cstat-no" title="statement not covered" >                if (now-lastSentTime &gt; webSocketKeepAliveTime) {</span>
<span class="cstat-no" title="statement not covered" >                    publish("hb",lastSentTime);</span>
                }
            }, webSocketKeepAliveTime);
        });
    }
}
&nbsp;
<span class="fstat-no" title="function not covered" >function stop() {</span>
<span class="cstat-no" title="statement not covered" >    if (heartbeatTimer) {</span>
<span class="cstat-no" title="statement not covered" >        clearInterval(heartbeatTimer);</span>
<span class="cstat-no" title="statement not covered" >        heartbeatTimer = null;</span>
    }
<span class="cstat-no" title="statement not covered" >    if (wsServer) {</span>
<span class="cstat-no" title="statement not covered" >        wsServer.close();</span>
<span class="cstat-no" title="statement not covered" >        wsServer = null;</span>
    }
}
&nbsp;
<span class="fstat-no" title="function not covered" >function publish(topic,data,retain) {</span>
<span class="cstat-no" title="statement not covered" >    if (server) {</span>
<span class="cstat-no" title="statement not covered" >        if (retain) {</span>
<span class="cstat-no" title="statement not covered" >            retained[topic] = data;</span>
        } else {
<span class="cstat-no" title="statement not covered" >            delete retained[topic];</span>
        }
<span class="cstat-no" title="statement not covered" >        lastSentTime = Date.now();</span>
<span class="cstat-no" title="statement not covered" >        activeConnections.forEach(<span class="fstat-no" title="function not covered" >function(conn) {</span></span>
<span class="cstat-no" title="statement not covered" >            publishTo(conn,topic,data);</span>
        });
    }
}
&nbsp;
<span class="fstat-no" title="function not covered" >function publishTo(ws,topic,data) {</span>
<span class="cstat-no" title="statement not covered" >    var msg = JSON.stringify({topic:topic,data:data});</span>
<span class="cstat-no" title="statement not covered" >    try {</span>
<span class="cstat-no" title="statement not covered" >        ws.send(msg);</span>
    } catch(err) {
<span class="cstat-no" title="statement not covered" >        removeActiveConnection(ws);</span>
<span class="cstat-no" title="statement not covered" >        removePendingConnection(ws);</span>
<span class="cstat-no" title="statement not covered" >        log.warn(log._("comms.error-send",{message:err.toString()}));</span>
    }
}
&nbsp;
<span class="fstat-no" title="function not covered" >function handleRemoteSubscription(ws,topic) {</span>
<span class="cstat-no" title="statement not covered" >    var re = new RegExp("^"+topic.replace(/([\[\]\?\(\)\\\\$\^\*\.|])/g,"\\$1").replace(/\+/g,"[^/]+").replace(/\/#$/,"(\/.*)?")+"$");</span>
<span class="cstat-no" title="statement not covered" >    for (var t in retained) {</span>
<span class="cstat-no" title="statement not covered" >        if (re.test(t)) {</span>
<span class="cstat-no" title="statement not covered" >            publishTo(ws,t,retained[t]);</span>
        }
    }
}
&nbsp;
<span class="fstat-no" title="function not covered" >function removeActiveConnection(ws) {</span>
<span class="cstat-no" title="statement not covered" >    for (var i=0;i&lt;activeConnections.length;i++) {</span>
<span class="cstat-no" title="statement not covered" >        if (activeConnections[i] === ws) {</span>
<span class="cstat-no" title="statement not covered" >            activeConnections.splice(i,1);</span>
<span class="cstat-no" title="statement not covered" >            break;</span>
        }
    }
}
<span class="fstat-no" title="function not covered" >function removePendingConnection(ws) {</span>
<span class="cstat-no" title="statement not covered" >    for (var i=0;i&lt;pendingConnections.length;i++) {</span>
<span class="cstat-no" title="statement not covered" >        if (pendingConnections[i] === ws) {</span>
<span class="cstat-no" title="statement not covered" >            pendingConnections.splice(i,1);</span>
<span class="cstat-no" title="statement not covered" >            break;</span>
        }
    }
}
&nbsp;
module.exports = {
    init:init,
    start:start,
    stop:stop,
    publish:publish
}
&nbsp;
&nbsp;</pre></td></tr>
</table></pre>
</div>
<div class="footer">
    <div class="meta">Generated by <a href="https://github.com/kaizhu256/node-utility2" target="_blank">utility2</a> at Tue Apr 11 2017 17:25:15 GMT+0000 (UTC)</div>
</div>
</body>
</html>


<!doctype html>
<html lang="en">
<head>
    <title>Code coverage report for node-npmtest-node-red/node-red/red/api/credentials.js</title>
    <meta charset="utf-8">
    <style>
        body, html {
            margin:0; padding: 0;
        }
        body {
            font-family: Arial, Helvetica;
            font-size: 10pt;
        }
        div.header, div.footer {
            background: #eee;
            padding: 1em;
        }
        div.header {
            height: 160px;
            padding: 0 1em 0 1em;
            z-index: 100;
            position: fixed;
            top: 0;
            border-bottom: 1px solid #666;
            width: 100%;
        }
        div.footer {
            border-top: 1px solid #666;
        }
        div.body {
            margin-top: 170px;
        }
        div.meta {
            font-size: 90%;
            text-align: center;
        }
        h1, h2, h3 {
            font-weight: normal;
        }
        h1 {
            font-size: 12pt;
        }
        h2 {
            font-size: 10pt;
        }
        pre {
            font-family: Menlo, Monaco, Consolas, Courier New, monospace;
            margin: 0;
            padding: 0;
            font-size: 14px;
            tab-size: 2;
        }

        div.path { font-size: 110%; }
        div.path a:link, div.path a:visited { color: #000; }
        table.coverage { border-collapse: collapse; margin:0; padding: 0 }

        table.coverage td {
            margin: 0;
            padding: 0;
            color: #111;
            vertical-align: top;
        }
        table.coverage td.line-count {
            width: 50px;
            text-align: right;
            padding-right: 5px;
        }
        table.coverage td.line-coverage {
            color: #777 !important;
            text-align: right;
            border-left: 1px solid #666;
            border-right: 1px solid #666;
        }

        table.coverage td.text {
        }

        table.coverage td span.cline-any {
            display: inline-block;
            padding: 0 5px;
            width: 40px;
        }
        table.coverage td span.cline-neutral {
            background: #eee;
        }
        table.coverage td span.cline-yes {
            background: #b5d592;
            color: #999;
        }
        table.coverage td span.cline-no {
            background: #fc8c84;
        }

        .cstat-yes { color: #111; }
        .cstat-no { background: #fc8c84; color: #111; }
        .fstat-no { background: #ffc520; color: #111 !important; }
        .cbranch-no { background:  yellow !important; color: #111; }

        .cstat-skip { background: #ddd; color: #111; }
        .fstat-skip { background: #ddd; color: #111 !important; }
        .cbranch-skip { background: #ddd !important; color: #111; }

        .missing-if-branch {
            display: inline-block;
            margin-right: 10px;
            position: relative;
            padding: 0 4px;
            background: black;
            color: yellow;
        }

        .skip-if-branch {
            display: none;
            margin-right: 10px;
            position: relative;
            padding: 0 4px;
            background: #ccc;
            color: white;
        }

        .missing-if-branch .typ, .skip-if-branch .typ {
            color: inherit !important;
        }

        .entity, .metric { font-weight: bold; }
        .metric { display: inline-block; border: 1px solid #333; padding: 0.3em; background: white; }
        .metric small { font-size: 80%; font-weight: normal; color: #666; }

        div.coverage-summary table { border-collapse: collapse; margin: 3em; font-size: 110%; }
        div.coverage-summary td, div.coverage-summary table  th { margin: 0; padding: 0.25em 1em; border-top: 1px solid #666; border-bottom: 1px solid #666; }
        div.coverage-summary th { text-align: left; border: 1px solid #666; background: #eee; font-weight: normal; }
        div.coverage-summary th.file { border-right: none !important; }
        div.coverage-summary th.pic { border-left: none !important; text-align: right; }
        div.coverage-summary th.pct { border-right: none !important; }
        div.coverage-summary th.abs { border-left: none !important; text-align: right; }
        div.coverage-summary td.pct { text-align: right; border-left: 1px solid #666; }
        div.coverage-summary td.abs { text-align: right; font-size: 90%; color: #444; border-right: 1px solid #666; }
        div.coverage-summary td.file { text-align: right; border-left: 1px solid #666; white-space: nowrap;  }
        div.coverage-summary td.pic { min-width: 120px !important;  }
        div.coverage-summary a:link { color: #000; }
        div.coverage-summary a:visited { color: #333; }
        div.coverage-summary tfoot td { border-top: 1px solid #666; }

        div.coverage-summary .yui3-datatable-sort-indicator, div.coverage-summary .dummy-sort-indicator {
            height: 10px;
            width: 7px;
            display: inline-block;
            margin-left: 0.5em;
        }
        div.coverage-summary .yui3-datatable-sort-indicator {
            background: no-repeat scroll 0 0 transparent;
        }
        div.coverage-summary .yui3-datatable-sorted .yui3-datatable-sort-indicator {
            background-position: 0 -20px;
        }
        div.coverage-summary .yui3-datatable-sorted-desc .yui3-datatable-sort-indicator {
            background-position: 0 -10px;
        }

        .high { background: #b5d592 !important; }
        .medium { background: #ffe87c !important; }
        .low { background: #fc8c84 !important; }

        span.cover-fill, span.cover-empty {
            display:inline-block;
            border:1px solid #444;
            background: white;
            height: 12px;
        }
        span.cover-fill {
            background: #ccc;
            border-right: 1px solid #444;
        }
        span.cover-empty {
            background: white;
            border-left: none;
        }
        span.cover-full {
            border-right: none !important;
        }
        pre.prettyprint {
            border: none !important;
            padding: 0 !important;
            margin: 0 !important;
        }
        .com { color: #999 !important; }
        .ignore-none { color: #999; font-weight: normal; }

    </style>
</head>
<body>
<div class="header low">
    <h1 style="font-weight: bold;">
        <a href="https://github.com/npmtest/node-npmtest-node-red">npmtest-node-red (v0.0.1)</a>
    </h1>
    <h1>Code coverage report for <span class="entity">node-npmtest-node-red/node-red/red/api/credentials.js</span></h1>
    <h2>
        
        Statements: <span class="metric">13.64% <small>(3 / 22)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        
        Branches: <span class="metric">0% <small>(0 / 10)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        
        Functions: <span class="metric">0% <small>(0 / 2)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        
        Lines: <span class="metric">13.64% <small>(3 / 22)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        Ignored: <span class="metric"><span class="ignore-none">none</span></span> &nbsp;&nbsp;&nbsp;&nbsp;
    </h2>
    <div class="path"><a href="../../../../index.html">All files</a> &#187; <a href="index.html">node-npmtest-node-red/node-red/red/api/</a> &#187; credentials.js</div>
</div>
<div class="body">
<pre><table class="coverage">
<tr><td class="line-count">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54</td><td class="line-coverage"><span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span></td><td class="text"><pre class="prettyprint lang-js">/**
 * Copyright JS Foundation and other contributors, http://js.foundation
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 **/
&nbsp;
var log;
var api;
&nbsp;
module.exports = {
    init: <span class="fstat-no" title="function not covered" >function(runtime) {</span>
<span class="cstat-no" title="statement not covered" >        log = runtime.log;</span>
<span class="cstat-no" title="statement not covered" >        api = runtime.nodes;</span>
    },
    get: <span class="fstat-no" title="function not covered" >function (req, res) {</span>
        // TODO: It should verify the given node id is of the type specified -
        //       but that would add a dependency from this module to the
        //       registry module that knows about node types.
<span class="cstat-no" title="statement not covered" >        var nodeType = req.params.type;</span>
<span class="cstat-no" title="statement not covered" >        var nodeID = req.params.id;</span>
<span class="cstat-no" title="statement not covered" >        log.audit({event: "credentials.get",type:nodeType,id:nodeID},req);</span>
<span class="cstat-no" title="statement not covered" >        var credentials = api.getCredentials(nodeID);</span>
<span class="cstat-no" title="statement not covered" >        if (!credentials) {</span>
<span class="cstat-no" title="statement not covered" >            res.json({});</span>
<span class="cstat-no" title="statement not covered" >            return;</span>
        }
<span class="cstat-no" title="statement not covered" >        var definition = api.getCredentialDefinition(nodeType);</span>
&nbsp;
<span class="cstat-no" title="statement not covered" >        var sendCredentials = {};</span>
<span class="cstat-no" title="statement not covered" >        for (var cred in definition) {</span>
<span class="cstat-no" title="statement not covered" >            if (definition.hasOwnProperty(cred)) {</span>
<span class="cstat-no" title="statement not covered" >                if (definition[cred].type == "password") {</span>
<span class="cstat-no" title="statement not covered" >                    var key = 'has_' + cred;</span>
<span class="cstat-no" title="statement not covered" >                    sendCredentials[key] = credentials[cred] != null &amp;&amp; credentials[cred] !== '';</span>
<span class="cstat-no" title="statement not covered" >                    continue;</span>
                }
<span class="cstat-no" title="statement not covered" >                sendCredentials[cred] = credentials[cred] || '';</span>
            }
        }
<span class="cstat-no" title="statement not covered" >        res.json(sendCredentials);</span>
    }
}
&nbsp;
&nbsp;</pre></td></tr>
</table></pre>
</div>
<div class="footer">
    <div class="meta">Generated by <a href="https://github.com/kaizhu256/node-utility2" target="_blank">utility2</a> at Tue Apr 11 2017 17:25:15 GMT+0000 (UTC)</div>
</div>
</body>
</html>


<!doctype html>
<html lang="en">
<head>
    <title>Code coverage report for node-npmtest-node-red/node-red/red/api/flow.js</title>
    <meta charset="utf-8">
    <style>
        body, html {
            margin:0; padding: 0;
        }
        body {
            font-family: Arial, Helvetica;
            font-size: 10pt;
        }
        div.header, div.footer {
            background: #eee;
            padding: 1em;
        }
        div.header {
            height: 160px;
            padding: 0 1em 0 1em;
            z-index: 100;
            position: fixed;
            top: 0;
            border-bottom: 1px solid #666;
            width: 100%;
        }
        div.footer {
            border-top: 1px solid #666;
        }
        div.body {
            margin-top: 170px;
        }
        div.meta {
            font-size: 90%;
            text-align: center;
        }
        h1, h2, h3 {
            font-weight: normal;
        }
        h1 {
            font-size: 12pt;
        }
        h2 {
            font-size: 10pt;
        }
        pre {
            font-family: Menlo, Monaco, Consolas, Courier New, monospace;
            margin: 0;
            padding: 0;
            font-size: 14px;
            tab-size: 2;
        }

        div.path { font-size: 110%; }
        div.path a:link, div.path a:visited { color: #000; }
        table.coverage { border-collapse: collapse; margin:0; padding: 0 }

        table.coverage td {
            margin: 0;
            padding: 0;
            color: #111;
            vertical-align: top;
        }
        table.coverage td.line-count {
            width: 50px;
            text-align: right;
            padding-right: 5px;
        }
        table.coverage td.line-coverage {
            color: #777 !important;
            text-align: right;
            border-left: 1px solid #666;
            border-right: 1px solid #666;
        }

        table.coverage td.text {
        }

        table.coverage td span.cline-any {
            display: inline-block;
            padding: 0 5px;
            width: 40px;
        }
        table.coverage td span.cline-neutral {
            background: #eee;
        }
        table.coverage td span.cline-yes {
            background: #b5d592;
            color: #999;
        }
        table.coverage td span.cline-no {
            background: #fc8c84;
        }

        .cstat-yes { color: #111; }
        .cstat-no { background: #fc8c84; color: #111; }
        .fstat-no { background: #ffc520; color: #111 !important; }
        .cbranch-no { background:  yellow !important; color: #111; }

        .cstat-skip { background: #ddd; color: #111; }
        .fstat-skip { background: #ddd; color: #111 !important; }
        .cbranch-skip { background: #ddd !important; color: #111; }

        .missing-if-branch {
            display: inline-block;
            margin-right: 10px;
            position: relative;
            padding: 0 4px;
            background: black;
            color: yellow;
        }

        .skip-if-branch {
            display: none;
            margin-right: 10px;
            position: relative;
            padding: 0 4px;
            background: #ccc;
            color: white;
        }

        .missing-if-branch .typ, .skip-if-branch .typ {
            color: inherit !important;
        }

        .entity, .metric { font-weight: bold; }
        .metric { display: inline-block; border: 1px solid #333; padding: 0.3em; background: white; }
        .metric small { font-size: 80%; font-weight: normal; color: #666; }

        div.coverage-summary table { border-collapse: collapse; margin: 3em; font-size: 110%; }
        div.coverage-summary td, div.coverage-summary table  th { margin: 0; padding: 0.25em 1em; border-top: 1px solid #666; border-bottom: 1px solid #666; }
        div.coverage-summary th { text-align: left; border: 1px solid #666; background: #eee; font-weight: normal; }
        div.coverage-summary th.file { border-right: none !important; }
        div.coverage-summary th.pic { border-left: none !important; text-align: right; }
        div.coverage-summary th.pct { border-right: none !important; }
        div.coverage-summary th.abs { border-left: none !important; text-align: right; }
        div.coverage-summary td.pct { text-align: right; border-left: 1px solid #666; }
        div.coverage-summary td.abs { text-align: right; font-size: 90%; color: #444; border-right: 1px solid #666; }
        div.coverage-summary td.file { text-align: right; border-left: 1px solid #666; white-space: nowrap;  }
        div.coverage-summary td.pic { min-width: 120px !important;  }
        div.coverage-summary a:link { color: #000; }
        div.coverage-summary a:visited { color: #333; }
        div.coverage-summary tfoot td { border-top: 1px solid #666; }

        div.coverage-summary .yui3-datatable-sort-indicator, div.coverage-summary .dummy-sort-indicator {
            height: 10px;
            width: 7px;
            display: inline-block;
            margin-left: 0.5em;
        }
        div.coverage-summary .yui3-datatable-sort-indicator {
            background: no-repeat scroll 0 0 transparent;
        }
        div.coverage-summary .yui3-datatable-sorted .yui3-datatable-sort-indicator {
            background-position: 0 -20px;
        }
        div.coverage-summary .yui3-datatable-sorted-desc .yui3-datatable-sort-indicator {
            background-position: 0 -10px;
        }

        .high { background: #b5d592 !important; }
        .medium { background: #ffe87c !important; }
        .low { background: #fc8c84 !important; }

        span.cover-fill, span.cover-empty {
            display:inline-block;
            border:1px solid #444;
            background: white;
            height: 12px;
        }
        span.cover-fill {
            background: #ccc;
            border-right: 1px solid #444;
        }
        span.cover-empty {
            background: white;
            border-left: none;
        }
        span.cover-full {
            border-right: none !important;
        }
        pre.prettyprint {
            border: none !important;
            padding: 0 !important;
            margin: 0 !important;
        }
        .com { color: #999 !important; }
        .ignore-none { color: #999; font-weight: normal; }

    </style>
</head>
<body>
<div class="header low">
    <h1 style="font-weight: bold;">
        <a href="https://github.com/npmtest/node-npmtest-node-red">npmtest-node-red (v0.0.1)</a>
    </h1>
    <h1>Code coverage report for <span class="entity">node-npmtest-node-red/node-red/red/api/flow.js</span></h1>
    <h2>
        
        Statements: <span class="metric">9.3% <small>(4 / 43)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        
        Branches: <span class="metric">0% <small>(0 / 22)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        
        Functions: <span class="metric">0% <small>(0 / 10)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        
        Lines: <span class="metric">9.3% <small>(4 / 43)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        Ignored: <span class="metric"><span class="ignore-none">none</span></span> &nbsp;&nbsp;&nbsp;&nbsp;
    </h2>
    <div class="path"><a href="../../../../index.html">All files</a> &#187; <a href="index.html">node-npmtest-node-red/node-red/red/api/</a> &#187; flow.js</div>
</div>
<div class="body">
<pre><table class="coverage">
<tr><td class="line-count">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89</td><td class="line-coverage"><span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span></td><td class="text"><pre class="prettyprint lang-js">/**
 * Copyright JS Foundation and other contributors, http://js.foundation
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 **/
&nbsp;
var log;
var redNodes;
var settings;
&nbsp;
module.exports = {
    init: <span class="fstat-no" title="function not covered" >function(runtime) {</span>
<span class="cstat-no" title="statement not covered" >        settings = runtime.settings;</span>
<span class="cstat-no" title="statement not covered" >        redNodes = runtime.nodes;</span>
<span class="cstat-no" title="statement not covered" >        log = runtime.log;</span>
    },
    get: <span class="fstat-no" title="function not covered" >function(req,res) {</span>
<span class="cstat-no" title="statement not covered" >        var id = req.params.id;</span>
<span class="cstat-no" title="statement not covered" >        var flow = redNodes.getFlow(id);</span>
<span class="cstat-no" title="statement not covered" >        if (flow) {</span>
<span class="cstat-no" title="statement not covered" >            log.audit({event: "flow.get",id:id},req);</span>
<span class="cstat-no" title="statement not covered" >            res.json(flow);</span>
        } else {
<span class="cstat-no" title="statement not covered" >            log.audit({event: "flow.get",id:id,error:"not_found"},req);</span>
<span class="cstat-no" title="statement not covered" >            res.status(404).end();</span>
        }
    },
    post: <span class="fstat-no" title="function not covered" >function(req,res) {</span>
<span class="cstat-no" title="statement not covered" >        var flow = req.body;</span>
<span class="cstat-no" title="statement not covered" >        redNodes.addFlow(flow).then(<span class="fstat-no" title="function not covered" >function(id) {</span></span>
<span class="cstat-no" title="statement not covered" >            log.audit({event: "flow.add",id:id},req);</span>
<span class="cstat-no" title="statement not covered" >            res.json({id:id});</span>
        }).otherwise(<span class="fstat-no" title="function not covered" >function(err) {</span>
<span class="cstat-no" title="statement not covered" >            log.audit({event: "flow.add",error:err.code||"unexpected_error",message:err.toString()},req);</span>
<span class="cstat-no" title="statement not covered" >            res.status(400).json({error:err.code||"unexpected_error", message:err.toString()});</span>
        })
&nbsp;
    },
    put: <span class="fstat-no" title="function not covered" >function(req,res) {</span>
<span class="cstat-no" title="statement not covered" >        var id = req.params.id;</span>
<span class="cstat-no" title="statement not covered" >        var flow = req.body;</span>
<span class="cstat-no" title="statement not covered" >        try {</span>
<span class="cstat-no" title="statement not covered" >            redNodes.updateFlow(id,flow).then(<span class="fstat-no" title="function not covered" >function() {</span></span>
<span class="cstat-no" title="statement not covered" >                log.audit({event: "flow.update",id:id},req);</span>
<span class="cstat-no" title="statement not covered" >                res.json({id:id});</span>
            }).otherwise(<span class="fstat-no" title="function not covered" >function(err) {</span>
<span class="cstat-no" title="statement not covered" >                log.audit({event: "flow.update",error:err.code||"unexpected_error",message:err.toString()},req);</span>
<span class="cstat-no" title="statement not covered" >                res.status(400).json({error:err.code||"unexpected_error", message:err.toString()});</span>
            })
        } catch(err) {
<span class="cstat-no" title="statement not covered" >            if (err.code === 404) {</span>
<span class="cstat-no" title="statement not covered" >                log.audit({event: "flow.update",id:id,error:"not_found"},req);</span>
<span class="cstat-no" title="statement not covered" >                res.status(404).end();</span>
            } else {
<span class="cstat-no" title="statement not covered" >                log.audit({event: "flow.update",error:err.code||"unexpected_error",message:err.toString()},req);</span>
<span class="cstat-no" title="statement not covered" >                res.status(400).json({error:err.code||"unexpected_error", message:err.toString()});</span>
            }
        }
    },
    delete: <span class="fstat-no" title="function not covered" >function(req,res) {</span>
<span class="cstat-no" title="statement not covered" >        var id = req.params.id;</span>
<span class="cstat-no" title="statement not covered" >        try {</span>
<span class="cstat-no" title="statement not covered" >            redNodes.removeFlow(id).then(<span class="fstat-no" title="function not covered" >function() {</span></span>
<span class="cstat-no" title="statement not covered" >                log.audit({event: "flow.remove",id:id},req);</span>
<span class="cstat-no" title="statement not covered" >                res.status(204).end();</span>
            })
        } catch(err) {
<span class="cstat-no" title="statement not covered" >            if (err.code === 404) {</span>
<span class="cstat-no" title="statement not covered" >                log.audit({event: "flow.remove",id:id,error:"not_found"},req);</span>
<span class="cstat-no" title="statement not covered" >                res.status(404).end();</span>
            } else {
<span class="cstat-no" title="statement not covered" >                log.audit({event: "flow.remove",id:id,error:err.code||"unexpected_error",message:err.toString()},req);</span>
<span class="cstat-no" title="statement not covered" >                res.status(400).json({error:err.code||"unexpected_error", message:err.toString()});</span>
            }
        }
    }
}
&nbsp;
&nbsp;</pre></td></tr>
</table></pre>
</div>
<div class="footer">
    <div class="meta">Generated by <a href="https://github.com/kaizhu256/node-utility2" target="_blank">utility2</a> at Tue Apr 11 2017 17:25:15 GMT+0000 (UTC)</div>
</div>
</body>
</html>


<!doctype html>
<html lang="en">
<head>
    <title>Code coverage report for node-npmtest-node-red/node-red/red/api/flows.js</title>
    <meta charset="utf-8">
    <style>
        body, html {
            margin:0; padding: 0;
        }
        body {
            font-family: Arial, Helvetica;
            font-size: 10pt;
        }
        div.header, div.footer {
            background: #eee;
            padding: 1em;
        }
        div.header {
            height: 160px;
            padding: 0 1em 0 1em;
            z-index: 100;
            position: fixed;
            top: 0;
            border-bottom: 1px solid #666;
            width: 100%;
        }
        div.footer {
            border-top: 1px solid #666;
        }
        div.body {
            margin-top: 170px;
        }
        div.meta {
            font-size: 90%;
            text-align: center;
        }
        h1, h2, h3 {
            font-weight: normal;
        }
        h1 {
            font-size: 12pt;
        }
        h2 {
            font-size: 10pt;
        }
        pre {
            font-family: Menlo, Monaco, Consolas, Courier New, monospace;
            margin: 0;
            padding: 0;
            font-size: 14px;
            tab-size: 2;
        }

        div.path { font-size: 110%; }
        div.path a:link, div.path a:visited { color: #000; }
        table.coverage { border-collapse: collapse; margin:0; padding: 0 }

        table.coverage td {
            margin: 0;
            padding: 0;
            color: #111;
            vertical-align: top;
        }
        table.coverage td.line-count {
            width: 50px;
            text-align: right;
            padding-right: 5px;
        }
        table.coverage td.line-coverage {
            color: #777 !important;
            text-align: right;
            border-left: 1px solid #666;
            border-right: 1px solid #666;
        }

        table.coverage td.text {
        }

        table.coverage td span.cline-any {
            display: inline-block;
            padding: 0 5px;
            width: 40px;
        }
        table.coverage td span.cline-neutral {
            background: #eee;
        }
        table.coverage td span.cline-yes {
            background: #b5d592;
            color: #999;
        }
        table.coverage td span.cline-no {
            background: #fc8c84;
        }

        .cstat-yes { color: #111; }
        .cstat-no { background: #fc8c84; color: #111; }
        .fstat-no { background: #ffc520; color: #111 !important; }
        .cbranch-no { background:  yellow !important; color: #111; }

        .cstat-skip { background: #ddd; color: #111; }
        .fstat-skip { background: #ddd; color: #111 !important; }
        .cbranch-skip { background: #ddd !important; color: #111; }

        .missing-if-branch {
            display: inline-block;
            margin-right: 10px;
            position: relative;
            padding: 0 4px;
            background: black;
            color: yellow;
        }

        .skip-if-branch {
            display: none;
            margin-right: 10px;
            position: relative;
            padding: 0 4px;
            background: #ccc;
            color: white;
        }

        .missing-if-branch .typ, .skip-if-branch .typ {
            color: inherit !important;
        }

        .entity, .metric { font-weight: bold; }
        .metric { display: inline-block; border: 1px solid #333; padding: 0.3em; background: white; }
        .metric small { font-size: 80%; font-weight: normal; color: #666; }

        div.coverage-summary table { border-collapse: collapse; margin: 3em; font-size: 110%; }
        div.coverage-summary td, div.coverage-summary table  th { margin: 0; padding: 0.25em 1em; border-top: 1px solid #666; border-bottom: 1px solid #666; }
        div.coverage-summary th { text-align: left; border: 1px solid #666; background: #eee; font-weight: normal; }
        div.coverage-summary th.file { border-right: none !important; }
        div.coverage-summary th.pic { border-left: none !important; text-align: right; }
        div.coverage-summary th.pct { border-right: none !important; }
        div.coverage-summary th.abs { border-left: none !important; text-align: right; }
        div.coverage-summary td.pct { text-align: right; border-left: 1px solid #666; }
        div.coverage-summary td.abs { text-align: right; font-size: 90%; color: #444; border-right: 1px solid #666; }
        div.coverage-summary td.file { text-align: right; border-left: 1px solid #666; white-space: nowrap;  }
        div.coverage-summary td.pic { min-width: 120px !important;  }
        div.coverage-summary a:link { color: #000; }
        div.coverage-summary a:visited { color: #333; }
        div.coverage-summary tfoot td { border-top: 1px solid #666; }

        div.coverage-summary .yui3-datatable-sort-indicator, div.coverage-summary .dummy-sort-indicator {
            height: 10px;
            width: 7px;
            display: inline-block;
            margin-left: 0.5em;
        }
        div.coverage-summary .yui3-datatable-sort-indicator {
            background: no-repeat scroll 0 0 transparent;
        }
        div.coverage-summary .yui3-datatable-sorted .yui3-datatable-sort-indicator {
            background-position: 0 -20px;
        }
        div.coverage-summary .yui3-datatable-sorted-desc .yui3-datatable-sort-indicator {
            background-position: 0 -10px;
        }

        .high { background: #b5d592 !important; }
        .medium { background: #ffe87c !important; }
        .low { background: #fc8c84 !important; }

        span.cover-fill, span.cover-empty {
            display:inline-block;
            border:1px solid #444;
            background: white;
            height: 12px;
        }
        span.cover-fill {
            background: #ccc;
            border-right: 1px solid #444;
        }
        span.cover-empty {
            background: white;
            border-left: none;
        }
        span.cover-full {
            border-right: none !important;
        }
        pre.prettyprint {
            border: none !important;
            padding: 0 !important;
            margin: 0 !important;
        }
        .com { color: #999 !important; }
        .ignore-none { color: #999; font-weight: normal; }

    </style>
</head>
<body>
<div class="header low">
    <h1 style="font-weight: bold;">
        <a href="https://github.com/npmtest/node-npmtest-node-red">npmtest-node-red (v0.0.1)</a>
    </h1>
    <h1>Code coverage report for <span class="entity">node-npmtest-node-red/node-red/red/api/flows.js</span></h1>
    <h2>
        
        Statements: <span class="metric">9.09% <small>(4 / 44)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        
        Branches: <span class="metric">0% <small>(0 / 24)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        
        Functions: <span class="metric">0% <small>(0 / 7)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        
        Lines: <span class="metric">9.09% <small>(4 / 44)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        Ignored: <span class="metric"><span class="ignore-none">none</span></span> &nbsp;&nbsp;&nbsp;&nbsp;
    </h2>
    <div class="path"><a href="../../../../index.html">All files</a> &#187; <a href="index.html">node-npmtest-node-red/node-red/red/api/</a> &#187; flows.js</div>
</div>
<div class="body">
<pre><table class="coverage">
<tr><td class="line-count">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85</td><td class="line-coverage"><span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span></td><td class="text"><pre class="prettyprint lang-js">/**
 * Copyright JS Foundation and other contributors, http://js.foundation
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 **/
&nbsp;
var log;
var redNodes;
var settings;
&nbsp;
module.exports = {
    init: <span class="fstat-no" title="function not covered" >function(runtime) {</span>
<span class="cstat-no" title="statement not covered" >        settings = runtime.settings;</span>
<span class="cstat-no" title="statement not covered" >        redNodes = runtime.nodes;</span>
<span class="cstat-no" title="statement not covered" >        log = runtime.log;</span>
    },
    get: <span class="fstat-no" title="function not covered" >function(req,res) {</span>
<span class="cstat-no" title="statement not covered" >        var version = req.get("Node-RED-API-Version")||"v1";</span>
<span class="cstat-no" title="statement not covered" >        if (version === "v1") {</span>
<span class="cstat-no" title="statement not covered" >            log.audit({event: "flows.get",version:"v1"},req);</span>
<span class="cstat-no" title="statement not covered" >            res.json(redNodes.getFlows().flows);</span>
        } else <span class="cstat-no" title="statement not covered" >if (version === "v2") {</span>
<span class="cstat-no" title="statement not covered" >            log.audit({event: "flows.get",version:"v2"},req);</span>
<span class="cstat-no" title="statement not covered" >            res.json(redNodes.getFlows());</span>
        } else {
<span class="cstat-no" title="statement not covered" >            log.audit({event: "flows.get",version:version,error:"invalid_api_version"},req);</span>
<span class="cstat-no" title="statement not covered" >            res.status(400).json({code:"invalid_api_version", message:"Invalid API Version requested"});</span>
        }
    },
    post: <span class="fstat-no" title="function not covered" >function(req,res) {</span>
<span class="cstat-no" title="statement not covered" >        var version = req.get("Node-RED-API-Version")||"v1";</span>
<span class="cstat-no" title="statement not covered" >        var flows = req.body;</span>
<span class="cstat-no" title="statement not covered" >        var deploymentType = req.get("Node-RED-Deployment-Type")||"full";</span>
<span class="cstat-no" title="statement not covered" >        log.audit({event: "flows.set",type:deploymentType,version:version},req);</span>
<span class="cstat-no" title="statement not covered" >        if (deploymentType === 'reload') {</span>
<span class="cstat-no" title="statement not covered" >            redNodes.loadFlows().then(<span class="fstat-no" title="function not covered" >function() {</span></span>
<span class="cstat-no" title="statement not covered" >                res.status(204).end();</span>
            }).otherwise(<span class="fstat-no" title="function not covered" >function(err) {</span>
<span class="cstat-no" title="statement not covered" >                log.warn(log._("api.flows.error-reload",{message:err.message}));</span>
<span class="cstat-no" title="statement not covered" >                log.warn(err.stack);</span>
<span class="cstat-no" title="statement not covered" >                res.status(500).json({error:"unexpected_error", message:err.message});</span>
            });
        } else {
<span class="cstat-no" title="statement not covered" >            var flowConfig = flows;</span>
<span class="cstat-no" title="statement not covered" >            if (version === "v2") {</span>
<span class="cstat-no" title="statement not covered" >                flowConfig = flows.flows;</span>
<span class="cstat-no" title="statement not covered" >                if (flows.hasOwnProperty('rev')) {</span>
<span class="cstat-no" title="statement not covered" >                    var currentVersion = redNodes.getFlows().rev;</span>
<span class="cstat-no" title="statement not covered" >                    if (currentVersion !== flows.rev) {</span>
                        //TODO: log warning
<span class="cstat-no" title="statement not covered" >                        return res.status(409).json({code:"version_mismatch"});</span>
                    }
                }
            } else <span class="cstat-no" title="statement not covered" >if (version !== 'v1') {</span>
<span class="cstat-no" title="statement not covered" >                log.audit({event: "flows.set",version:version,error:"invalid_api_version"},req);</span>
<span class="cstat-no" title="statement not covered" >                res.status(400).json({code:"invalid_api_version", message:"Invalid API Version requested"});</span>
            }
<span class="cstat-no" title="statement not covered" >            redNodes.setFlows(flowConfig,deploymentType).then(<span class="fstat-no" title="function not covered" >function(flowId) {</span></span>
<span class="cstat-no" title="statement not covered" >                if (version === "v1") {</span>
<span class="cstat-no" title="statement not covered" >                    res.status(204).end();</span>
                } else <span class="cstat-no" title="statement not covered" >if (version === "v2") {</span>
<span class="cstat-no" title="statement not covered" >                    res.json({rev:flowId});</span>
                } else {
                    // TODO: invalid version
                }
            }).otherwise(<span class="fstat-no" title="function not covered" >function(err) {</span>
<span class="cstat-no" title="statement not covered" >                log.warn(log._("api.flows.error-save",{message:err.message}));</span>
<span class="cstat-no" title="statement not covered" >                log.warn(err.stack);</span>
<span class="cstat-no" title="statement not covered" >                res.status(500).json({error:"unexpected_error", message:err.message});</span>
            });
        }
    }
}
&nbsp;
&nbsp;</pre></td></tr>
</table></pre>
</div>
<div class="footer">
    <div class="meta">Generated by <a href="https://github.com/kaizhu256/node-utility2" target="_blank">utility2</a> at Tue Apr 11 2017 17:25:15 GMT+0000 (UTC)</div>
</div>
</body>
</html>


<!doctype html>
<html lang="en">
<head>
    <title>Code coverage report for node-npmtest-node-red/node-red/red/api/index.js</title>
    <meta charset="utf-8">
    <style>
        body, html {
            margin:0; padding: 0;
        }
        body {
            font-family: Arial, Helvetica;
            font-size: 10pt;
        }
        div.header, div.footer {
            background: #eee;
            padding: 1em;
        }
        div.header {
            height: 160px;
            padding: 0 1em 0 1em;
            z-index: 100;
            position: fixed;
            top: 0;
            border-bottom: 1px solid #666;
            width: 100%;
        }
        div.footer {
            border-top: 1px solid #666;
        }
        div.body {
            margin-top: 170px;
        }
        div.meta {
            font-size: 90%;
            text-align: center;
        }
        h1, h2, h3 {
            font-weight: normal;
        }
        h1 {
            font-size: 12pt;
        }
        h2 {
            font-size: 10pt;
        }
        pre {
            font-family: Menlo, Monaco, Consolas, Courier New, monospace;
            margin: 0;
            padding: 0;
            font-size: 14px;
            tab-size: 2;
        }

        div.path { font-size: 110%; }
        div.path a:link, div.path a:visited { color: #000; }
        table.coverage { border-collapse: collapse; margin:0; padding: 0 }

        table.coverage td {
            margin: 0;
            padding: 0;
            color: #111;
            vertical-align: top;
        }
        table.coverage td.line-count {
            width: 50px;
            text-align: right;
            padding-right: 5px;
        }
        table.coverage td.line-coverage {
            color: #777 !important;
            text-align: right;
            border-left: 1px solid #666;
            border-right: 1px solid #666;
        }

        table.coverage td.text {
        }

        table.coverage td span.cline-any {
            display: inline-block;
            padding: 0 5px;
            width: 40px;
        }
        table.coverage td span.cline-neutral {
            background: #eee;
        }
        table.coverage td span.cline-yes {
            background: #b5d592;
            color: #999;
        }
        table.coverage td span.cline-no {
            background: #fc8c84;
        }

        .cstat-yes { color: #111; }
        .cstat-no { background: #fc8c84; color: #111; }
        .fstat-no { background: #ffc520; color: #111 !important; }
        .cbranch-no { background:  yellow !important; color: #111; }

        .cstat-skip { background: #ddd; color: #111; }
        .fstat-skip { background: #ddd; color: #111 !important; }
        .cbranch-skip { background: #ddd !important; color: #111; }

        .missing-if-branch {
            display: inline-block;
            margin-right: 10px;
            position: relative;
            padding: 0 4px;
            background: black;
            color: yellow;
        }

        .skip-if-branch {
            display: none;
            margin-right: 10px;
            position: relative;
            padding: 0 4px;
            background: #ccc;
            color: white;
        }

        .missing-if-branch .typ, .skip-if-branch .typ {
            color: inherit !important;
        }

        .entity, .metric { font-weight: bold; }
        .metric { display: inline-block; border: 1px solid #333; padding: 0.3em; background: white; }
        .metric small { font-size: 80%; font-weight: normal; color: #666; }

        div.coverage-summary table { border-collapse: collapse; margin: 3em; font-size: 110%; }
        div.coverage-summary td, div.coverage-summary table  th { margin: 0; padding: 0.25em 1em; border-top: 1px solid #666; border-bottom: 1px solid #666; }
        div.coverage-summary th { text-align: left; border: 1px solid #666; background: #eee; font-weight: normal; }
        div.coverage-summary th.file { border-right: none !important; }
        div.coverage-summary th.pic { border-left: none !important; text-align: right; }
        div.coverage-summary th.pct { border-right: none !important; }
        div.coverage-summary th.abs { border-left: none !important; text-align: right; }
        div.coverage-summary td.pct { text-align: right; border-left: 1px solid #666; }
        div.coverage-summary td.abs { text-align: right; font-size: 90%; color: #444; border-right: 1px solid #666; }
        div.coverage-summary td.file { text-align: right; border-left: 1px solid #666; white-space: nowrap;  }
        div.coverage-summary td.pic { min-width: 120px !important;  }
        div.coverage-summary a:link { color: #000; }
        div.coverage-summary a:visited { color: #333; }
        div.coverage-summary tfoot td { border-top: 1px solid #666; }

        div.coverage-summary .yui3-datatable-sort-indicator, div.coverage-summary .dummy-sort-indicator {
            height: 10px;
            width: 7px;
            display: inline-block;
            margin-left: 0.5em;
        }
        div.coverage-summary .yui3-datatable-sort-indicator {
            background: no-repeat scroll 0 0 transparent;
        }
        div.coverage-summary .yui3-datatable-sorted .yui3-datatable-sort-indicator {
            background-position: 0 -20px;
        }
        div.coverage-summary .yui3-datatable-sorted-desc .yui3-datatable-sort-indicator {
            background-position: 0 -10px;
        }

        .high { background: #b5d592 !important; }
        .medium { background: #ffe87c !important; }
        .low { background: #fc8c84 !important; }

        span.cover-fill, span.cover-empty {
            display:inline-block;
            border:1px solid #444;
            background: white;
            height: 12px;
        }
        span.cover-fill {
            background: #ccc;
            border-right: 1px solid #444;
        }
        span.cover-empty {
            background: white;
            border-left: none;
        }
        span.cover-full {
            border-right: none !important;
        }
        pre.prettyprint {
            border: none !important;
            padding: 0 !important;
            margin: 0 !important;
        }
        .com { color: #999 !important; }
        .ignore-none { color: #999; font-weight: normal; }

    </style>
</head>
<body>
<div class="header low">
    <h1 style="font-weight: bold;">
        <a href="https://github.com/npmtest/node-npmtest-node-red">npmtest-node-red (v0.0.1)</a>
    </h1>
    <h1>Code coverage report for <span class="entity">node-npmtest-node-red/node-red/red/api/index.js</span></h1>
    <h2>
        
        Statements: <span class="metric">27.78% <small>(30 / 108)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        
        Branches: <span class="metric">0% <small>(0 / 22)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        
        Functions: <span class="metric">0% <small>(0 / 9)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        
        Lines: <span class="metric">27.78% <small>(30 / 108)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        Ignored: <span class="metric"><span class="ignore-none">none</span></span> &nbsp;&nbsp;&nbsp;&nbsp;
    </h2>
    <div class="path"><a href="../../../../index.html">All files</a> &#187; <a href="index.html">node-npmtest-node-red/node-red/red/api/</a> &#187; index.js</div>
</div>
<div class="body">
<pre><table class="coverage">
<tr><td class="line-count">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
164
165
166
167
168
169
170
171
172
173
174
175
176
177
178
179
180
181
182
183
184
185
186
187
188
189
190
191
192
193
194</td><td class="line-coverage"><span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span></td><td class="text"><pre class="prettyprint lang-js">/**
 * Copyright JS Foundation and other contributors, http://js.foundation
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 **/
&nbsp;
var express = require("express");
var bodyParser = require("body-parser");
var util = require('util');
var path = require('path');
var passport = require('passport');
var when = require('when');
var cors = require('cors');
&nbsp;
var ui = require("./ui");
var nodes = require("./nodes");
var flows = require("./flows");
var flow = require("./flow");
var library = require("./library");
var info = require("./info");
var theme = require("./theme");
var locales = require("./locales");
var credentials = require("./credentials");
var comms = require("./comms");
&nbsp;
var auth = require("./auth");
var needsPermission = auth.needsPermission;
&nbsp;
var i18n;
var log;
var adminApp;
var server;
var runtime;
&nbsp;
var errorHandler = <span class="fstat-no" title="function not covered" >function(err,req,res,next) {</span>
<span class="cstat-no" title="statement not covered" >    if (err.message === "request entity too large") {</span>
<span class="cstat-no" title="statement not covered" >        log.error(err);</span>
    } else {
<span class="cstat-no" title="statement not covered" >        console.log(err.stack);</span>
    }
<span class="cstat-no" title="statement not covered" >    log.audit({event: "api.error",error:err.code||"unexpected_error",message:err.toString()},req);</span>
<span class="cstat-no" title="statement not covered" >    res.status(400).json({error:"unexpected_error", message:err.toString()});</span>
};
&nbsp;
var ensureRuntimeStarted = <span class="fstat-no" title="function not covered" >function(req,res,next) {</span>
<span class="cstat-no" title="statement not covered" >    if (!runtime.isStarted()) {</span>
<span class="cstat-no" title="statement not covered" >        log.error("Node-RED runtime not started");</span>
<span class="cstat-no" title="statement not covered" >        res.status(503).send("Not started");</span>
    } else {
<span class="cstat-no" title="statement not covered" >        next();</span>
    }
}
&nbsp;
<span class="fstat-no" title="function not covered" >function init(_server,_runtime) {</span>
<span class="cstat-no" title="statement not covered" >    server = _server;</span>
<span class="cstat-no" title="statement not covered" >    runtime = _runtime;</span>
<span class="cstat-no" title="statement not covered" >    var settings = runtime.settings;</span>
<span class="cstat-no" title="statement not covered" >    i18n = runtime.i18n;</span>
<span class="cstat-no" title="statement not covered" >    log = runtime.log;</span>
<span class="cstat-no" title="statement not covered" >    if (settings.httpAdminRoot !== false) {</span>
<span class="cstat-no" title="statement not covered" >        comms.init(server,runtime);</span>
<span class="cstat-no" title="statement not covered" >        adminApp = express();</span>
<span class="cstat-no" title="statement not covered" >        auth.init(runtime);</span>
<span class="cstat-no" title="statement not covered" >        credentials.init(runtime);</span>
<span class="cstat-no" title="statement not covered" >        flows.init(runtime);</span>
<span class="cstat-no" title="statement not covered" >        flow.init(runtime);</span>
<span class="cstat-no" title="statement not covered" >        info.init(runtime);</span>
<span class="cstat-no" title="statement not covered" >        library.init(adminApp,runtime);</span>
<span class="cstat-no" title="statement not covered" >        locales.init(runtime);</span>
<span class="cstat-no" title="statement not covered" >        nodes.init(runtime);</span>
&nbsp;
        // Editor
<span class="cstat-no" title="statement not covered" >        if (!settings.disableEditor) {</span>
<span class="cstat-no" title="statement not covered" >            ui.init(runtime);</span>
<span class="cstat-no" title="statement not covered" >            var editorApp = express();</span>
<span class="cstat-no" title="statement not covered" >            if (settings.requireHttps === true) {</span>
<span class="cstat-no" title="statement not covered" >                editorApp.enable('trust proxy');</span>
<span class="cstat-no" title="statement not covered" >                editorApp.use(<span class="fstat-no" title="function not covered" >function (req, res, next) {</span></span>
<span class="cstat-no" title="statement not covered" >                    if (req.secure) {</span>
<span class="cstat-no" title="statement not covered" >                        next();</span>
                    } else {
<span class="cstat-no" title="statement not covered" >                        res.redirect('https://' + req.headers.host + req.originalUrl);</span>
                    }
                });
            }
<span class="cstat-no" title="statement not covered" >            editorApp.get("/",ensureRuntimeStarted,ui.ensureSlash,ui.editor);</span>
<span class="cstat-no" title="statement not covered" >            editorApp.get("/icons/:icon",ui.icon);</span>
<span class="cstat-no" title="statement not covered" >            theme.init(runtime);</span>
<span class="cstat-no" title="statement not covered" >            if (settings.editorTheme) {</span>
<span class="cstat-no" title="statement not covered" >                editorApp.use("/theme",theme.app());</span>
            }
<span class="cstat-no" title="statement not covered" >            editorApp.use("/",ui.editorResources);</span>
<span class="cstat-no" title="statement not covered" >            adminApp.use(editorApp);</span>
        }
<span class="cstat-no" title="statement not covered" >        var maxApiRequestSize = settings.apiMaxLength || '5mb';</span>
<span class="cstat-no" title="statement not covered" >        adminApp.use(bodyParser.json({limit:maxApiRequestSize}));</span>
<span class="cstat-no" title="statement not covered" >        adminApp.use(bodyParser.urlencoded({limit:maxApiRequestSize,extended:true}));</span>
&nbsp;
<span class="cstat-no" title="statement not covered" >        adminApp.get("/auth/login",auth.login,errorHandler);</span>
&nbsp;
<span class="cstat-no" title="statement not covered" >        if (settings.adminAuth) {</span>
            //TODO: all passport references ought to be in ./auth
<span class="cstat-no" title="statement not covered" >            adminApp.use(passport.initialize());</span>
<span class="cstat-no" title="statement not covered" >            adminApp.post("/auth/token",</span>
                auth.ensureClientSecret,
                auth.authenticateClient,
                auth.getToken,
                auth.errorHandler
            );
<span class="cstat-no" title="statement not covered" >            adminApp.post("/auth/revoke",needsPermission(""),auth.revoke,errorHandler);</span>
        }
<span class="cstat-no" title="statement not covered" >        if (settings.httpAdminCors) {</span>
<span class="cstat-no" title="statement not covered" >            var corsHandler = cors(settings.httpAdminCors);</span>
<span class="cstat-no" title="statement not covered" >            adminApp.use(corsHandler);</span>
        }
&nbsp;
        // Flows
<span class="cstat-no" title="statement not covered" >        adminApp.get("/flows",needsPermission("flows.read"),flows.get,errorHandler);</span>
<span class="cstat-no" title="statement not covered" >        adminApp.post("/flows",needsPermission("flows.write"),flows.post,errorHandler);</span>
&nbsp;
<span class="cstat-no" title="statement not covered" >        adminApp.get("/flow/:id",needsPermission("flows.read"),flow.get,errorHandler);</span>
<span class="cstat-no" title="statement not covered" >        adminApp.post("/flow",needsPermission("flows.write"),flow.post,errorHandler);</span>
<span class="cstat-no" title="statement not covered" >        adminApp.delete("/flow/:id",needsPermission("flows.write"),flow.delete,errorHandler);</span>
<span class="cstat-no" title="statement not covered" >        adminApp.put("/flow/:id",needsPermission("flows.write"),flow.put,errorHandler);</span>
&nbsp;
        // Nodes
<span class="cstat-no" title="statement not covered" >        adminApp.get("/nodes",needsPermission("nodes.read"),nodes.getAll,errorHandler);</span>
<span class="cstat-no" title="statement not covered" >        adminApp.post("/nodes",needsPermission("nodes.write"),nodes.post,errorHandler);</span>
&nbsp;
<span class="cstat-no" title="statement not covered" >        adminApp.get(/\/nodes\/((@[^\/]+\/)?[^\/]+)$/,needsPermission("nodes.read"),nodes.getModule,errorHandler);</span>
<span class="cstat-no" title="statement not covered" >        adminApp.put(/\/nodes\/((@[^\/]+\/)?[^\/]+)$/,needsPermission("nodes.write"),nodes.putModule,errorHandler);</span>
<span class="cstat-no" title="statement not covered" >        adminApp.delete(/\/nodes\/((@[^\/]+\/)?[^\/]+)$/,needsPermission("nodes.write"),nodes.delete,errorHandler);</span>
&nbsp;
<span class="cstat-no" title="statement not covered" >        adminApp.get(/\/nodes\/((@[^\/]+\/)?[^\/]+)\/([^\/]+)$/,needsPermission("nodes.read"),nodes.getSet,errorHandler);</span>
<span class="cstat-no" title="statement not covered" >        adminApp.put(/\/nodes\/((@[^\/]+\/)?[^\/]+)\/([^\/]+)$/,needsPermission("nodes.write"),nodes.putSet,errorHandler);</span>
&nbsp;
<span class="cstat-no" title="statement not covered" >        adminApp.get('/credentials/:type/:id', needsPermission("credentials.read"),credentials.get,errorHandler);</span>
&nbsp;
<span class="cstat-no" title="statement not covered" >        adminApp.get(/locales\/(.+)\/?$/,locales.get,errorHandler);</span>
&nbsp;
        // Library
<span class="cstat-no" title="statement not covered" >        adminApp.post(new RegExp("/library/flows\/(.*)"),needsPermission("library.write"),library.post,errorHandler);</span>
<span class="cstat-no" title="statement not covered" >        adminApp.get("/library/flows",needsPermission("library.read"),library.getAll,errorHandler);</span>
<span class="cstat-no" title="statement not covered" >        adminApp.get(new RegExp("/library/flows\/(.*)"),needsPermission("library.read"),library.get,errorHandler);</span>
&nbsp;
        // Settings
<span class="cstat-no" title="statement not covered" >        adminApp.get("/settings",needsPermission("settings.read"),info.settings,errorHandler);</span>
&nbsp;
        // Error Handler
        //adminApp.use(errorHandler);
    }
}
<span class="fstat-no" title="function not covered" >function start() {</span>
<span class="cstat-no" title="statement not covered" >    var catalogPath = path.resolve(path.join(__dirname,"locales"));</span>
<span class="cstat-no" title="statement not covered" >    return i18n.registerMessageCatalogs([</span>
        {namespace: "editor",   dir: catalogPath, file:"editor.json"},
        {namespace: "jsonata",  dir: catalogPath, file:"jsonata.json"},
        {namespace: "infotips", dir: catalogPath, file:"infotips.json"}
    ]).then(<span class="fstat-no" title="function not covered" >function(){</span>
<span class="cstat-no" title="statement not covered" >        comms.start();</span>
    });
}
<span class="fstat-no" title="function not covered" >function stop() {</span>
<span class="cstat-no" title="statement not covered" >    comms.stop();</span>
<span class="cstat-no" title="statement not covered" >    return when.resolve();</span>
}
module.exports = {
    init: init,
    start: start,
    stop: stop,
    library: {
        register: library.register
    },
    auth: {
        needsPermission: auth.needsPermission
    },
    comms: {
        publish: comms.publish
    },
    get adminApp<span class="fstat-no" title="function not covered" >() {</span> <span class="cstat-no" title="statement not covered" >return adminApp; </span>},
    get server<span class="fstat-no" title="function not covered" >() {</span> <span class="cstat-no" title="statement not covered" >return server; </span>}
};
&nbsp;
&nbsp;</pre></td></tr>
</table></pre>
</div>
<div class="footer">
    <div class="meta">Generated by <a href="https://github.com/kaizhu256/node-utility2" target="_blank">utility2</a> at Tue Apr 11 2017 17:25:15 GMT+0000 (UTC)</div>
</div>
</body>
</html>


<!doctype html>
<html lang="en">
<head>
    <title>Code coverage report for node-npmtest-node-red/node-red/red/api/info.js</title>
    <meta charset="utf-8">
    <style>
        body, html {
            margin:0; padding: 0;
        }
        body {
            font-family: Arial, Helvetica;
            font-size: 10pt;
        }
        div.header, div.footer {
            background: #eee;
            padding: 1em;
        }
        div.header {
            height: 160px;
            padding: 0 1em 0 1em;
            z-index: 100;
            position: fixed;
            top: 0;
            border-bottom: 1px solid #666;
            width: 100%;
        }
        div.footer {
            border-top: 1px solid #666;
        }
        div.body {
            margin-top: 170px;
        }
        div.meta {
            font-size: 90%;
            text-align: center;
        }
        h1, h2, h3 {
            font-weight: normal;
        }
        h1 {
            font-size: 12pt;
        }
        h2 {
            font-size: 10pt;
        }
        pre {
            font-family: Menlo, Monaco, Consolas, Courier New, monospace;
            margin: 0;
            padding: 0;
            font-size: 14px;
            tab-size: 2;
        }

        div.path { font-size: 110%; }
        div.path a:link, div.path a:visited { color: #000; }
        table.coverage { border-collapse: collapse; margin:0; padding: 0 }

        table.coverage td {
            margin: 0;
            padding: 0;
            color: #111;
            vertical-align: top;
        }
        table.coverage td.line-count {
            width: 50px;
            text-align: right;
            padding-right: 5px;
        }
        table.coverage td.line-coverage {
            color: #777 !important;
            text-align: right;
            border-left: 1px solid #666;
            border-right: 1px solid #666;
        }

        table.coverage td.text {
        }

        table.coverage td span.cline-any {
            display: inline-block;
            padding: 0 5px;
            width: 40px;
        }
        table.coverage td span.cline-neutral {
            background: #eee;
        }
        table.coverage td span.cline-yes {
            background: #b5d592;
            color: #999;
        }
        table.coverage td span.cline-no {
            background: #fc8c84;
        }

        .cstat-yes { color: #111; }
        .cstat-no { background: #fc8c84; color: #111; }
        .fstat-no { background: #ffc520; color: #111 !important; }
        .cbranch-no { background:  yellow !important; color: #111; }

        .cstat-skip { background: #ddd; color: #111; }
        .fstat-skip { background: #ddd; color: #111 !important; }
        .cbranch-skip { background: #ddd !important; color: #111; }

        .missing-if-branch {
            display: inline-block;
            margin-right: 10px;
            position: relative;
            padding: 0 4px;
            background: black;
            color: yellow;
        }

        .skip-if-branch {
            display: none;
            margin-right: 10px;
            position: relative;
            padding: 0 4px;
            background: #ccc;
            color: white;
        }

        .missing-if-branch .typ, .skip-if-branch .typ {
            color: inherit !important;
        }

        .entity, .metric { font-weight: bold; }
        .metric { display: inline-block; border: 1px solid #333; padding: 0.3em; background: white; }
        .metric small { font-size: 80%; font-weight: normal; color: #666; }

        div.coverage-summary table { border-collapse: collapse; margin: 3em; font-size: 110%; }
        div.coverage-summary td, div.coverage-summary table  th { margin: 0; padding: 0.25em 1em; border-top: 1px solid #666; border-bottom: 1px solid #666; }
        div.coverage-summary th { text-align: left; border: 1px solid #666; background: #eee; font-weight: normal; }
        div.coverage-summary th.file { border-right: none !important; }
        div.coverage-summary th.pic { border-left: none !important; text-align: right; }
        div.coverage-summary th.pct { border-right: none !important; }
        div.coverage-summary th.abs { border-left: none !important; text-align: right; }
        div.coverage-summary td.pct { text-align: right; border-left: 1px solid #666; }
        div.coverage-summary td.abs { text-align: right; font-size: 90%; color: #444; border-right: 1px solid #666; }
        div.coverage-summary td.file { text-align: right; border-left: 1px solid #666; white-space: nowrap;  }
        div.coverage-summary td.pic { min-width: 120px !important;  }
        div.coverage-summary a:link { color: #000; }
        div.coverage-summary a:visited { color: #333; }
        div.coverage-summary tfoot td { border-top: 1px solid #666; }

        div.coverage-summary .yui3-datatable-sort-indicator, div.coverage-summary .dummy-sort-indicator {
            height: 10px;
            width: 7px;
            display: inline-block;
            margin-left: 0.5em;
        }
        div.coverage-summary .yui3-datatable-sort-indicator {
            background: no-repeat scroll 0 0 transparent;
        }
        div.coverage-summary .yui3-datatable-sorted .yui3-datatable-sort-indicator {
            background-position: 0 -20px;
        }
        div.coverage-summary .yui3-datatable-sorted-desc .yui3-datatable-sort-indicator {
            background-position: 0 -10px;
        }

        .high { background: #b5d592 !important; }
        .medium { background: #ffe87c !important; }
        .low { background: #fc8c84 !important; }

        span.cover-fill, span.cover-empty {
            display:inline-block;
            border:1px solid #444;
            background: white;
            height: 12px;
        }
        span.cover-fill {
            background: #ccc;
            border-right: 1px solid #444;
        }
        span.cover-empty {
            background: white;
            border-left: none;
        }
        span.cover-full {
            border-right: none !important;
        }
        pre.prettyprint {
            border: none !important;
            padding: 0 !important;
            margin: 0 !important;
        }
        .com { color: #999 !important; }
        .ignore-none { color: #999; font-weight: normal; }

    </style>
</head>
<body>
<div class="header low">
    <h1 style="font-weight: bold;">
        <a href="https://github.com/npmtest/node-npmtest-node-red">npmtest-node-red (v0.0.1)</a>
    </h1>
    <h1>Code coverage report for <span class="entity">node-npmtest-node-red/node-red/red/api/info.js</span></h1>
    <h2>
        
        Statements: <span class="metric">25% <small>(5 / 20)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        
        Branches: <span class="metric">0% <small>(0 / 14)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        
        Functions: <span class="metric">0% <small>(0 / 2)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        
        Lines: <span class="metric">25% <small>(5 / 20)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        Ignored: <span class="metric"><span class="ignore-none">none</span></span> &nbsp;&nbsp;&nbsp;&nbsp;
    </h2>
    <div class="path"><a href="../../../../index.html">All files</a> &#187; <a href="index.html">node-npmtest-node-red/node-red/red/api/</a> &#187; info.js</div>
</div>
<div class="body">
<pre><table class="coverage">
<tr><td class="line-count">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56</td><td class="line-coverage"><span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span></td><td class="text"><pre class="prettyprint lang-js">/**
 * Copyright JS Foundation and other contributors, http://js.foundation
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 **/
var theme = require("./theme");
var util = require('util');
var runtime;
var settings;
&nbsp;
module.exports = {
    init: <span class="fstat-no" title="function not covered" >function(_runtime) {</span>
<span class="cstat-no" title="statement not covered" >        runtime = _runtime;</span>
<span class="cstat-no" title="statement not covered" >        settings = runtime.settings;</span>
    },
    settings: <span class="fstat-no" title="function not covered" >function(req,res) {</span>
<span class="cstat-no" title="statement not covered" >        var safeSettings = {</span>
            httpNodeRoot: settings.httpNodeRoot||"/",
            version: settings.version,
            user: req.user
        }
&nbsp;
<span class="cstat-no" title="statement not covered" >        var themeSettings = theme.settings();</span>
<span class="cstat-no" title="statement not covered" >        if (themeSettings) {</span>
<span class="cstat-no" title="statement not covered" >            safeSettings.editorTheme = themeSettings;</span>
        }
&nbsp;
<span class="cstat-no" title="statement not covered" >        if (util.isArray(settings.paletteCategories)) {</span>
<span class="cstat-no" title="statement not covered" >            safeSettings.paletteCategories = settings.paletteCategories;</span>
        }
&nbsp;
<span class="cstat-no" title="statement not covered" >        if (settings.flowFilePretty) {</span>
<span class="cstat-no" title="statement not covered" >            safeSettings.flowFilePretty = settings.flowFilePretty;</span>
        }
&nbsp;
<span class="cstat-no" title="statement not covered" >        if (!runtime.nodes.paletteEditorEnabled()) {</span>
<span class="cstat-no" title="statement not covered" >            safeSettings.editorTheme = safeSettings.editorTheme || {};</span>
<span class="cstat-no" title="statement not covered" >            safeSettings.editorTheme.palette = safeSettings.editorTheme.palette || {};</span>
<span class="cstat-no" title="statement not covered" >            safeSettings.editorTheme.palette.editable = false;</span>
        }
&nbsp;
<span class="cstat-no" title="statement not covered" >        res.json(safeSettings);</span>
    }
}
&nbsp;
&nbsp;</pre></td></tr>
</table></pre>
</div>
<div class="footer">
    <div class="meta">Generated by <a href="https://github.com/kaizhu256/node-utility2" target="_blank">utility2</a> at Tue Apr 11 2017 17:25:15 GMT+0000 (UTC)</div>
</div>
</body>
</html>


<!doctype html>
<html lang="en">
<head>
    <title>Code coverage report for node-npmtest-node-red/node-red/red/api/library.js</title>
    <meta charset="utf-8">
    <style>
        body, html {
            margin:0; padding: 0;
        }
        body {
            font-family: Arial, Helvetica;
            font-size: 10pt;
        }
        div.header, div.footer {
            background: #eee;
            padding: 1em;
        }
        div.header {
            height: 160px;
            padding: 0 1em 0 1em;
            z-index: 100;
            position: fixed;
            top: 0;
            border-bottom: 1px solid #666;
            width: 100%;
        }
        div.footer {
            border-top: 1px solid #666;
        }
        div.body {
            margin-top: 170px;
        }
        div.meta {
            font-size: 90%;
            text-align: center;
        }
        h1, h2, h3 {
            font-weight: normal;
        }
        h1 {
            font-size: 12pt;
        }
        h2 {
            font-size: 10pt;
        }
        pre {
            font-family: Menlo, Monaco, Consolas, Courier New, monospace;
            margin: 0;
            padding: 0;
            font-size: 14px;
            tab-size: 2;
        }

        div.path { font-size: 110%; }
        div.path a:link, div.path a:visited { color: #000; }
        table.coverage { border-collapse: collapse; margin:0; padding: 0 }

        table.coverage td {
            margin: 0;
            padding: 0;
            color: #111;
            vertical-align: top;
        }
        table.coverage td.line-count {
            width: 50px;
            text-align: right;
            padding-right: 5px;
        }
        table.coverage td.line-coverage {
            color: #777 !important;
            text-align: right;
            border-left: 1px solid #666;
            border-right: 1px solid #666;
        }

        table.coverage td.text {
        }

        table.coverage td span.cline-any {
            display: inline-block;
            padding: 0 5px;
            width: 40px;
        }
        table.coverage td span.cline-neutral {
            background: #eee;
        }
        table.coverage td span.cline-yes {
            background: #b5d592;
            color: #999;
        }
        table.coverage td span.cline-no {
            background: #fc8c84;
        }

        .cstat-yes { color: #111; }
        .cstat-no { background: #fc8c84; color: #111; }
        .fstat-no { background: #ffc520; color: #111 !important; }
        .cbranch-no { background:  yellow !important; color: #111; }

        .cstat-skip { background: #ddd; color: #111; }
        .fstat-skip { background: #ddd; color: #111 !important; }
        .cbranch-skip { background: #ddd !important; color: #111; }

        .missing-if-branch {
            display: inline-block;
            margin-right: 10px;
            position: relative;
            padding: 0 4px;
            background: black;
            color: yellow;
        }

        .skip-if-branch {
            display: none;
            margin-right: 10px;
            position: relative;
            padding: 0 4px;
            background: #ccc;
            color: white;
        }

        .missing-if-branch .typ, .skip-if-branch .typ {
            color: inherit !important;
        }

        .entity, .metric { font-weight: bold; }
        .metric { display: inline-block; border: 1px solid #333; padding: 0.3em; background: white; }
        .metric small { font-size: 80%; font-weight: normal; color: #666; }

        div.coverage-summary table { border-collapse: collapse; margin: 3em; font-size: 110%; }
        div.coverage-summary td, div.coverage-summary table  th { margin: 0; padding: 0.25em 1em; border-top: 1px solid #666; border-bottom: 1px solid #666; }
        div.coverage-summary th { text-align: left; border: 1px solid #666; background: #eee; font-weight: normal; }
        div.coverage-summary th.file { border-right: none !important; }
        div.coverage-summary th.pic { border-left: none !important; text-align: right; }
        div.coverage-summary th.pct { border-right: none !important; }
        div.coverage-summary th.abs { border-left: none !important; text-align: right; }
        div.coverage-summary td.pct { text-align: right; border-left: 1px solid #666; }
        div.coverage-summary td.abs { text-align: right; font-size: 90%; color: #444; border-right: 1px solid #666; }
        div.coverage-summary td.file { text-align: right; border-left: 1px solid #666; white-space: nowrap;  }
        div.coverage-summary td.pic { min-width: 120px !important;  }
        div.coverage-summary a:link { color: #000; }
        div.coverage-summary a:visited { color: #333; }
        div.coverage-summary tfoot td { border-top: 1px solid #666; }

        div.coverage-summary .yui3-datatable-sort-indicator, div.coverage-summary .dummy-sort-indicator {
            height: 10px;
            width: 7px;
            display: inline-block;
            margin-left: 0.5em;
        }
        div.coverage-summary .yui3-datatable-sort-indicator {
            background: no-repeat scroll 0 0 transparent;
        }
        div.coverage-summary .yui3-datatable-sorted .yui3-datatable-sort-indicator {
            background-position: 0 -20px;
        }
        div.coverage-summary .yui3-datatable-sorted-desc .yui3-datatable-sort-indicator {
            background-position: 0 -10px;
        }

        .high { background: #b5d592 !important; }
        .medium { background: #ffe87c !important; }
        .low { background: #fc8c84 !important; }

        span.cover-fill, span.cover-empty {
            display:inline-block;
            border:1px solid #444;
            background: white;
            height: 12px;
        }
        span.cover-fill {
            background: #ccc;
            border-right: 1px solid #444;
        }
        span.cover-empty {
            background: white;
            border-left: none;
        }
        span.cover-full {
            border-right: none !important;
        }
        pre.prettyprint {
            border: none !important;
            padding: 0 !important;
            margin: 0 !important;
        }
        .com { color: #999 !important; }
        .ignore-none { color: #999; font-weight: normal; }

    </style>
</head>
<body>
<div class="header low">
    <h1 style="font-weight: bold;">
        <a href="https://github.com/npmtest/node-npmtest-node-red">npmtest-node-red (v0.0.1)</a>
    </h1>
    <h1>Code coverage report for <span class="entity">node-npmtest-node-red/node-red/red/api/library.js</span></h1>
    <h2>
        
        Statements: <span class="metric">11.72% <small>(15 / 128)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        
        Branches: <span class="metric">0% <small>(0 / 38)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        
        Functions: <span class="metric">0% <small>(0 / 25)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        
        Lines: <span class="metric">11.72% <small>(15 / 128)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        Ignored: <span class="metric"><span class="ignore-none">none</span></span> &nbsp;&nbsp;&nbsp;&nbsp;
    </h2>
    <div class="path"><a href="../../../../index.html">All files</a> &#187; <a href="index.html">node-npmtest-node-red/node-red/red/api/</a> &#187; library.js</div>
</div>
<div class="body">
<pre><table class="coverage">
<tr><td class="line-count">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
164
165
166
167
168
169
170
171
172
173
174
175
176
177
178
179
180
181
182
183
184
185
186
187
188
189
190
191
192
193
194
195
196
197
198
199
200
201
202
203
204
205
206
207
208
209
210
211
212
213
214
215
216
217
218
219
220</td><td class="line-coverage"><span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span></td><td class="text"><pre class="prettyprint lang-js">/**
 * Copyright JS Foundation and other contributors, http://js.foundation
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 **/
var fs = require('fs');
var fspath = require('path');
var when = require('when');
&nbsp;
var redApp = null;
var storage;
var log;
var needsPermission = require("./auth").needsPermission;
&nbsp;
<span class="fstat-no" title="function not covered" >function createLibrary(type) {</span>
<span class="cstat-no" title="statement not covered" >    if (redApp) {</span>
<span class="cstat-no" title="statement not covered" >        redApp.get(new RegExp("/library/"+type+"($|\/(.*))"),needsPermission("library.read"),<span class="fstat-no" title="function not covered" >function(req,res) {</span></span>
<span class="cstat-no" title="statement not covered" >            var path = req.params[1]||"";</span>
<span class="cstat-no" title="statement not covered" >            storage.getLibraryEntry(type,path).then(<span class="fstat-no" title="function not covered" >function(result) {</span></span>
<span class="cstat-no" title="statement not covered" >                log.audit({event: "library.get",type:type},req);</span>
<span class="cstat-no" title="statement not covered" >                if (typeof result === "string") {</span>
<span class="cstat-no" title="statement not covered" >                    res.writeHead(200, {'Content-Type': 'text/plain'});</span>
<span class="cstat-no" title="statement not covered" >                    res.write(result);</span>
<span class="cstat-no" title="statement not covered" >                    res.end();</span>
                } else {
<span class="cstat-no" title="statement not covered" >                    res.json(result);</span>
                }
            }).otherwise(<span class="fstat-no" title="function not covered" >function(err) {</span>
<span class="cstat-no" title="statement not covered" >                if (err) {</span>
<span class="cstat-no" title="statement not covered" >                    log.warn(log._("api.library.error-load-entry",{path:path,message:err.toString()}));</span>
<span class="cstat-no" title="statement not covered" >                    if (err.code === 'forbidden') {</span>
<span class="cstat-no" title="statement not covered" >                        log.audit({event: "library.get",type:type,error:"forbidden"},req);</span>
<span class="cstat-no" title="statement not covered" >                        res.status(403).end();</span>
<span class="cstat-no" title="statement not covered" >                        return;</span>
                    }
                }
<span class="cstat-no" title="statement not covered" >                log.audit({event: "library.get",type:type,error:"not_found"},req);</span>
<span class="cstat-no" title="statement not covered" >                res.status(404).end();</span>
            });
        });
&nbsp;
<span class="cstat-no" title="statement not covered" >        redApp.post(new RegExp("/library/"+type+"\/(.*)"),needsPermission("library.write"),<span class="fstat-no" title="function not covered" >function(req,res) {</span></span>
<span class="cstat-no" title="statement not covered" >            var path = req.params[0];</span>
<span class="cstat-no" title="statement not covered" >            var meta = req.body;</span>
<span class="cstat-no" title="statement not covered" >            var text = meta.text;</span>
<span class="cstat-no" title="statement not covered" >            delete meta.text;</span>
&nbsp;
<span class="cstat-no" title="statement not covered" >            storage.saveLibraryEntry(type,path,meta,text).then(<span class="fstat-no" title="function not covered" >function() {</span></span>
<span class="cstat-no" title="statement not covered" >                log.audit({event: "library.set",type:type},req);</span>
<span class="cstat-no" title="statement not covered" >                res.status(204).end();</span>
            }).otherwise(<span class="fstat-no" title="function not covered" >function(err) {</span>
<span class="cstat-no" title="statement not covered" >                log.warn(log._("api.library.error-save-entry",{path:path,message:err.toString()}));</span>
<span class="cstat-no" title="statement not covered" >                    if (err.code === 'forbidden') {</span>
<span class="cstat-no" title="statement not covered" >                    log.audit({event: "library.set",type:type,error:"forbidden"},req);</span>
<span class="cstat-no" title="statement not covered" >                    res.status(403).end();</span>
<span class="cstat-no" title="statement not covered" >                    return;</span>
                }
<span class="cstat-no" title="statement not covered" >                log.audit({event: "library.set",type:type,error:"unexpected_error",message:err.toString()},req);</span>
<span class="cstat-no" title="statement not covered" >                res.status(500).json({error:"unexpected_error", message:err.toString()});</span>
            });
        });
    }
}
&nbsp;
var exampleRoots = {};
var exampleFlows = {d:{}};
var exampleCount = 0;
&nbsp;
<span class="fstat-no" title="function not covered" >function getFlowsFromPath(path) {</span>
<span class="cstat-no" title="statement not covered" >    return when.promise(<span class="fstat-no" title="function not covered" >function(resolve,reject) {</span></span>
<span class="cstat-no" title="statement not covered" >        var result = {};</span>
<span class="cstat-no" title="statement not covered" >        fs.readdir(path,<span class="fstat-no" title="function not covered" >function(err,files) {</span></span>
<span class="cstat-no" title="statement not covered" >            var promises = [];</span>
<span class="cstat-no" title="statement not covered" >            var validFiles = [];</span>
<span class="cstat-no" title="statement not covered" >            files.forEach(<span class="fstat-no" title="function not covered" >function(file) {</span></span>
<span class="cstat-no" title="statement not covered" >                var fullPath = fspath.join(path,file);</span>
<span class="cstat-no" title="statement not covered" >                var stats = fs.lstatSync(fullPath);</span>
<span class="cstat-no" title="statement not covered" >                if (stats.isDirectory()) {</span>
<span class="cstat-no" title="statement not covered" >                    validFiles.push(file);</span>
<span class="cstat-no" title="statement not covered" >                    promises.push(getFlowsFromPath(fullPath));</span>
                } else <span class="cstat-no" title="statement not covered" >if (/\.json$/.test(file)){</span>
<span class="cstat-no" title="statement not covered" >                    validFiles.push(file);</span>
<span class="cstat-no" title="statement not covered" >                    exampleCount++;</span>
<span class="cstat-no" title="statement not covered" >                    promises.push(when.resolve(file.split(".")[0]))</span>
                }
            })
<span class="cstat-no" title="statement not covered" >            var i=0;</span>
<span class="cstat-no" title="statement not covered" >            when.all(promises).then(<span class="fstat-no" title="function not covered" >function(results) {</span></span>
<span class="cstat-no" title="statement not covered" >                results.forEach(<span class="fstat-no" title="function not covered" >function(r) {</span></span>
<span class="cstat-no" title="statement not covered" >                    if (typeof r === 'string') {</span>
<span class="cstat-no" title="statement not covered" >                        result.f = result.f||[];</span>
<span class="cstat-no" title="statement not covered" >                        result.f.push(r);</span>
                    } else {
<span class="cstat-no" title="statement not covered" >                        result.d = result.d||{};</span>
<span class="cstat-no" title="statement not covered" >                        result.d[validFiles[i]] = r;</span>
                    }
<span class="cstat-no" title="statement not covered" >                    i++;</span>
                })
&nbsp;
<span class="cstat-no" title="statement not covered" >                resolve(result);</span>
            })
        });
    })
}
&nbsp;
<span class="fstat-no" title="function not covered" >function addNodeExamplesDir(module) {</span>
<span class="cstat-no" title="statement not covered" >    exampleRoots[module.name] = module.path;</span>
<span class="cstat-no" title="statement not covered" >    getFlowsFromPath(module.path).then(<span class="fstat-no" title="function not covered" >function(result) {</span></span>
<span class="cstat-no" title="statement not covered" >        exampleFlows.d[module.name] = result;</span>
    });
}
<span class="fstat-no" title="function not covered" >function removeNodeExamplesDir(module) {</span>
<span class="cstat-no" title="statement not covered" >    delete exampleRoots[module];</span>
<span class="cstat-no" title="statement not covered" >    delete exampleFlows.d[module];</span>
}
&nbsp;
module.exports = {
    init: <span class="fstat-no" title="function not covered" >function(app,runtime) {</span>
<span class="cstat-no" title="statement not covered" >        redApp = app;</span>
<span class="cstat-no" title="statement not covered" >        log = runtime.log;</span>
<span class="cstat-no" title="statement not covered" >        storage = runtime.storage;</span>
        // TODO: this allows init to be called multiple times without
        //       registering multiple instances of the listener.
        //       It isn't.... ideal.
<span class="cstat-no" title="statement not covered" >        runtime.events.removeListener("node-examples-dir",addNodeExamplesDir);</span>
<span class="cstat-no" title="statement not covered" >        runtime.events.on("node-examples-dir",addNodeExamplesDir);</span>
<span class="cstat-no" title="statement not covered" >        runtime.events.removeListener("node-module-uninstalled",removeNodeExamplesDir);</span>
<span class="cstat-no" title="statement not covered" >        runtime.events.on("node-module-uninstalled",removeNodeExamplesDir);</span>
&nbsp;
    },
    register: createLibrary,
&nbsp;
    getAll: <span class="fstat-no" title="function not covered" >function(req,res) {</span>
<span class="cstat-no" title="statement not covered" >        storage.getAllFlows().then(<span class="fstat-no" title="function not covered" >function(flows) {</span></span>
<span class="cstat-no" title="statement not covered" >            log.audit({event: "library.get.all",type:"flow"},req);</span>
<span class="cstat-no" title="statement not covered" >            if (exampleCount &gt; 0) {</span>
<span class="cstat-no" title="statement not covered" >                flows.d = flows.d||{};</span>
<span class="cstat-no" title="statement not covered" >                flows.d._examples_ = exampleFlows;</span>
            }
<span class="cstat-no" title="statement not covered" >            res.json(flows);</span>
        });
    },
    get: <span class="fstat-no" title="function not covered" >function(req,res) {</span>
<span class="cstat-no" title="statement not covered" >        if (req.params[0].indexOf("_examples_/") === 0) {</span>
<span class="cstat-no" title="statement not covered" >            var m = /^_examples_\/([^\/]+)\/(.*)$/.exec(req.params[0]);</span>
<span class="cstat-no" title="statement not covered" >            if (m) {</span>
<span class="cstat-no" title="statement not covered" >                var module = m[1];</span>
<span class="cstat-no" title="statement not covered" >                var path = m[2]+".json";</span>
<span class="cstat-no" title="statement not covered" >                if (exampleRoots[module]) {</span>
<span class="cstat-no" title="statement not covered" >                    var fullPath = fspath.join(exampleRoots[module],path);</span>
<span class="cstat-no" title="statement not covered" >                    try {</span>
<span class="cstat-no" title="statement not covered" >                        fs.statSync(fullPath);</span>
<span class="cstat-no" title="statement not covered" >                        log.audit({event: "library.get",type:"flow",path:req.params[0]},req);</span>
<span class="cstat-no" title="statement not covered" >                        return res.sendFile(fullPath,{</span>
                            headers:{
                                'Content-Type': 'application/json'
                            }
                        })
                    } catch(err) {
<span class="cstat-no" title="statement not covered" >                        console.log(err);</span>
                    }
                }
            }
            // IF we get here, we didn't find the file
<span class="cstat-no" title="statement not covered" >            log.audit({event: "library.get",type:"flow",path:req.params[0],error:"not_found"},req);</span>
<span class="cstat-no" title="statement not covered" >            return res.status(404).end();</span>
        } else {
<span class="cstat-no" title="statement not covered" >            storage.getFlow(req.params[0]).then(<span class="fstat-no" title="function not covered" >function(data) {</span></span>
                // data is already a JSON string
<span class="cstat-no" title="statement not covered" >                log.audit({event: "library.get",type:"flow",path:req.params[0]},req);</span>
<span class="cstat-no" title="statement not covered" >                res.set('Content-Type', 'application/json');</span>
<span class="cstat-no" title="statement not covered" >                res.send(data);</span>
            }).otherwise(<span class="fstat-no" title="function not covered" >function(err) {</span>
<span class="cstat-no" title="statement not covered" >                if (err) {</span>
<span class="cstat-no" title="statement not covered" >                    log.warn(log._("api.library.error-load-flow",{path:req.params[0],message:err.toString()}));</span>
<span class="cstat-no" title="statement not covered" >                    if (err.code === 'forbidden') {</span>
<span class="cstat-no" title="statement not covered" >                        log.audit({event: "library.get",type:"flow",path:req.params[0],error:"forbidden"},req);</span>
<span class="cstat-no" title="statement not covered" >                        res.status(403).end();</span>
<span class="cstat-no" title="statement not covered" >                        return;</span>
                    }
                }
<span class="cstat-no" title="statement not covered" >                log.audit({event: "library.get",type:"flow",path:req.params[0],error:"not_found"},req);</span>
<span class="cstat-no" title="statement not covered" >                res.status(404).end();</span>
            });
        }
    },
    post: <span class="fstat-no" title="function not covered" >function(req,res) {</span>
        // if (req.params[0].indexOf("_examples_/") === 0) {
        //     log.warn(log._("api.library.error-save-flow",{path:req.params[0],message:"forbidden"}));
        //     log.audit({event: "library.set",type:"flow",path:req.params[0],error:"forbidden"},req);
        //     return res.status(403).send({error:"unexpected_error", message:"forbidden"});
        // }
<span class="cstat-no" title="statement not covered" >        var flow = JSON.stringify(req.body);</span>
<span class="cstat-no" title="statement not covered" >        storage.saveFlow(req.params[0],flow).then(<span class="fstat-no" title="function not covered" >function() {</span></span>
<span class="cstat-no" title="statement not covered" >            log.audit({event: "library.set",type:"flow",path:req.params[0]},req);</span>
<span class="cstat-no" title="statement not covered" >            res.status(204).end();</span>
        }).otherwise(<span class="fstat-no" title="function not covered" >function(err) {</span>
<span class="cstat-no" title="statement not covered" >            log.warn(log._("api.library.error-save-flow",{path:req.params[0],message:err.toString()}));</span>
<span class="cstat-no" title="statement not covered" >            if (err.code === 'forbidden') {</span>
<span class="cstat-no" title="statement not covered" >                log.audit({event: "library.set",type:"flow",path:req.params[0],error:"forbidden"},req);</span>
<span class="cstat-no" title="statement not covered" >                res.status(403).end();</span>
<span class="cstat-no" title="statement not covered" >                return;</span>
            }
<span class="cstat-no" title="statement not covered" >            log.audit({event: "library.set",type:"flow",path:req.params[0],error:"unexpected_error",message:err.toString()},req);</span>
<span class="cstat-no" title="statement not covered" >            res.status(500).send({error:"unexpected_error", message:err.toString()});</span>
        });
    }
}
&nbsp;
&nbsp;</pre></td></tr>
</table></pre>
</div>
<div class="footer">
    <div class="meta">Generated by <a href="https://github.com/kaizhu256/node-utility2" target="_blank">utility2</a> at Tue Apr 11 2017 17:25:15 GMT+0000 (UTC)</div>
</div>
</body>
</html>


<!doctype html>
<html lang="en">
<head>
    <title>Code coverage report for node-npmtest-node-red/node-red/red/api/locales.js</title>
    <meta charset="utf-8">
    <style>
        body, html {
            margin:0; padding: 0;
        }
        body {
            font-family: Arial, Helvetica;
            font-size: 10pt;
        }
        div.header, div.footer {
            background: #eee;
            padding: 1em;
        }
        div.header {
            height: 160px;
            padding: 0 1em 0 1em;
            z-index: 100;
            position: fixed;
            top: 0;
            border-bottom: 1px solid #666;
            width: 100%;
        }
        div.footer {
            border-top: 1px solid #666;
        }
        div.body {
            margin-top: 170px;
        }
        div.meta {
            font-size: 90%;
            text-align: center;
        }
        h1, h2, h3 {
            font-weight: normal;
        }
        h1 {
            font-size: 12pt;
        }
        h2 {
            font-size: 10pt;
        }
        pre {
            font-family: Menlo, Monaco, Consolas, Courier New, monospace;
            margin: 0;
            padding: 0;
            font-size: 14px;
            tab-size: 2;
        }

        div.path { font-size: 110%; }
        div.path a:link, div.path a:visited { color: #000; }
        table.coverage { border-collapse: collapse; margin:0; padding: 0 }

        table.coverage td {
            margin: 0;
            padding: 0;
            color: #111;
            vertical-align: top;
        }
        table.coverage td.line-count {
            width: 50px;
            text-align: right;
            padding-right: 5px;
        }
        table.coverage td.line-coverage {
            color: #777 !important;
            text-align: right;
            border-left: 1px solid #666;
            border-right: 1px solid #666;
        }

        table.coverage td.text {
        }

        table.coverage td span.cline-any {
            display: inline-block;
            padding: 0 5px;
            width: 40px;
        }
        table.coverage td span.cline-neutral {
            background: #eee;
        }
        table.coverage td span.cline-yes {
            background: #b5d592;
            color: #999;
        }
        table.coverage td span.cline-no {
            background: #fc8c84;
        }

        .cstat-yes { color: #111; }
        .cstat-no { background: #fc8c84; color: #111; }
        .fstat-no { background: #ffc520; color: #111 !important; }
        .cbranch-no { background:  yellow !important; color: #111; }

        .cstat-skip { background: #ddd; color: #111; }
        .fstat-skip { background: #ddd; color: #111 !important; }
        .cbranch-skip { background: #ddd !important; color: #111; }

        .missing-if-branch {
            display: inline-block;
            margin-right: 10px;
            position: relative;
            padding: 0 4px;
            background: black;
            color: yellow;
        }

        .skip-if-branch {
            display: none;
            margin-right: 10px;
            position: relative;
            padding: 0 4px;
            background: #ccc;
            color: white;
        }

        .missing-if-branch .typ, .skip-if-branch .typ {
            color: inherit !important;
        }

        .entity, .metric { font-weight: bold; }
        .metric { display: inline-block; border: 1px solid #333; padding: 0.3em; background: white; }
        .metric small { font-size: 80%; font-weight: normal; color: #666; }

        div.coverage-summary table { border-collapse: collapse; margin: 3em; font-size: 110%; }
        div.coverage-summary td, div.coverage-summary table  th { margin: 0; padding: 0.25em 1em; border-top: 1px solid #666; border-bottom: 1px solid #666; }
        div.coverage-summary th { text-align: left; border: 1px solid #666; background: #eee; font-weight: normal; }
        div.coverage-summary th.file { border-right: none !important; }
        div.coverage-summary th.pic { border-left: none !important; text-align: right; }
        div.coverage-summary th.pct { border-right: none !important; }
        div.coverage-summary th.abs { border-left: none !important; text-align: right; }
        div.coverage-summary td.pct { text-align: right; border-left: 1px solid #666; }
        div.coverage-summary td.abs { text-align: right; font-size: 90%; color: #444; border-right: 1px solid #666; }
        div.coverage-summary td.file { text-align: right; border-left: 1px solid #666; white-space: nowrap;  }
        div.coverage-summary td.pic { min-width: 120px !important;  }
        div.coverage-summary a:link { color: #000; }
        div.coverage-summary a:visited { color: #333; }
        div.coverage-summary tfoot td { border-top: 1px solid #666; }

        div.coverage-summary .yui3-datatable-sort-indicator, div.coverage-summary .dummy-sort-indicator {
            height: 10px;
            width: 7px;
            display: inline-block;
            margin-left: 0.5em;
        }
        div.coverage-summary .yui3-datatable-sort-indicator {
            background: no-repeat scroll 0 0 transparent;
        }
        div.coverage-summary .yui3-datatable-sorted .yui3-datatable-sort-indicator {
            background-position: 0 -20px;
        }
        div.coverage-summary .yui3-datatable-sorted-desc .yui3-datatable-sort-indicator {
            background-position: 0 -10px;
        }

        .high { background: #b5d592 !important; }
        .medium { background: #ffe87c !important; }
        .low { background: #fc8c84 !important; }

        span.cover-fill, span.cover-empty {
            display:inline-block;
            border:1px solid #444;
            background: white;
            height: 12px;
        }
        span.cover-fill {
            background: #ccc;
            border-right: 1px solid #444;
        }
        span.cover-empty {
            background: white;
            border-left: none;
        }
        span.cover-full {
            border-right: none !important;
        }
        pre.prettyprint {
            border: none !important;
            padding: 0 !important;
            margin: 0 !important;
        }
        .com { color: #999 !important; }
        .ignore-none { color: #999; font-weight: normal; }

    </style>
</head>
<body>
<div class="header low">
    <h1 style="font-weight: bold;">
        <a href="https://github.com/npmtest/node-npmtest-node-red">npmtest-node-red (v0.0.1)</a>
    </h1>
    <h1>Code coverage report for <span class="entity">node-npmtest-node-red/node-red/red/api/locales.js</span></h1>
    <h2>
        
        Statements: <span class="metric">25.81% <small>(8 / 31)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        
        Branches: <span class="metric">0% <small>(0 / 12)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        
        Functions: <span class="metric">0% <small>(0 / 6)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        
        Lines: <span class="metric">25.81% <small>(8 / 31)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        Ignored: <span class="metric"><span class="ignore-none">none</span></span> &nbsp;&nbsp;&nbsp;&nbsp;
    </h2>
    <div class="path"><a href="../../../../index.html">All files</a> &#187; <a href="index.html">node-npmtest-node-red/node-red/red/api/</a> &#187; locales.js</div>
</div>
<div class="body">
<pre><table class="coverage">
<tr><td class="line-count">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66</td><td class="line-coverage"><span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span></td><td class="text"><pre class="prettyprint lang-js">/**
 * Copyright JS Foundation and other contributors, http://js.foundation
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 **/
var fs = require('fs');
var path = require('path');
var i18n;
var supportedLangs = [];
&nbsp;
var apiLocalDir = path.resolve(path.join(__dirname,"locales"));
&nbsp;
var initSupportedLangs = <span class="fstat-no" title="function not covered" >function() {</span>
<span class="cstat-no" title="statement not covered" >    fs.readdir(apiLocalDir, <span class="fstat-no" title="function not covered" >function(err,files) {</span></span>
<span class="cstat-no" title="statement not covered" >        if(!err) {</span>
<span class="cstat-no" title="statement not covered" >            supportedLangs = files;</span>
        }
    });
}
&nbsp;
<span class="fstat-no" title="function not covered" >function determineLangFromHeaders(acceptedLanguages){</span>
<span class="cstat-no" title="statement not covered" >    var lang = i18n.defaultLang;</span>
<span class="cstat-no" title="statement not covered" >    acceptedLanguages = acceptedLanguages || [];</span>
<span class="cstat-no" title="statement not covered" >    for (var i=0;i&lt;acceptedLanguages.length;i++){</span>
<span class="cstat-no" title="statement not covered" >        if (supportedLangs.indexOf(acceptedLanguages[i]) !== -1){</span>
<span class="cstat-no" title="statement not covered" >            lang = acceptedLanguages[i];</span>
<span class="cstat-no" title="statement not covered" >            break;</span>
        // check the language without the country code
        } else <span class="cstat-no" title="statement not covered" >if (supportedLangs.indexOf(acceptedLanguages[i].split("-")[0]) !== -1) {</span>
<span class="cstat-no" title="statement not covered" >            lang = acceptedLanguages[i].split("-")[0];</span>
<span class="cstat-no" title="statement not covered" >            break;</span>
        }
    }
<span class="cstat-no" title="statement not covered" >    return lang;</span>
}
&nbsp;
module.exports = {
    init: <span class="fstat-no" title="function not covered" >function(runtime) {</span>
<span class="cstat-no" title="statement not covered" >        i18n = runtime.i18n;</span>
<span class="cstat-no" title="statement not covered" >        initSupportedLangs();</span>
    },
    get: <span class="fstat-no" title="function not covered" >function(req,res) {</span>
<span class="cstat-no" title="statement not covered" >        var namespace = req.params[0];</span>
<span class="cstat-no" title="statement not covered" >        namespace = namespace.replace(/\.json$/,"");</span>
<span class="cstat-no" title="statement not covered" >        var lang = determineLangFromHeaders(req.acceptsLanguages() || []);</span>
<span class="cstat-no" title="statement not covered" >        var prevLang = i18n.i.lng();</span>
<span class="cstat-no" title="statement not covered" >        i18n.i.setLng(lang, <span class="fstat-no" title="function not covered" >function(){</span></span>
<span class="cstat-no" title="statement not covered" >            var catalog = i18n.catalog(namespace,lang);</span>
<span class="cstat-no" title="statement not covered" >            res.json(catalog||{});</span>
        });
<span class="cstat-no" title="statement not covered" >        i18n.i.setLng(prevLang);</span>
    },
    determineLangFromHeaders: determineLangFromHeaders
}
&nbsp;
&nbsp;</pre></td></tr>
</table></pre>
</div>
<div class="footer">
    <div class="meta">Generated by <a href="https://github.com/kaizhu256/node-utility2" target="_blank">utility2</a> at Tue Apr 11 2017 17:25:15 GMT+0000 (UTC)</div>
</div>
</body>
</html>


<!doctype html>
<html lang="en">
<head>
    <title>Code coverage report for node-npmtest-node-red/node-red/red/api/nodes.js</title>
    <meta charset="utf-8">
    <style>
        body, html {
            margin:0; padding: 0;
        }
        body {
            font-family: Arial, Helvetica;
            font-size: 10pt;
        }
        div.header, div.footer {
            background: #eee;
            padding: 1em;
        }
        div.header {
            height: 160px;
            padding: 0 1em 0 1em;
            z-index: 100;
            position: fixed;
            top: 0;
            border-bottom: 1px solid #666;
            width: 100%;
        }
        div.footer {
            border-top: 1px solid #666;
        }
        div.body {
            margin-top: 170px;
        }
        div.meta {
            font-size: 90%;
            text-align: center;
        }
        h1, h2, h3 {
            font-weight: normal;
        }
        h1 {
            font-size: 12pt;
        }
        h2 {
            font-size: 10pt;
        }
        pre {
            font-family: Menlo, Monaco, Consolas, Courier New, monospace;
            margin: 0;
            padding: 0;
            font-size: 14px;
            tab-size: 2;
        }

        div.path { font-size: 110%; }
        div.path a:link, div.path a:visited { color: #000; }
        table.coverage { border-collapse: collapse; margin:0; padding: 0 }

        table.coverage td {
            margin: 0;
            padding: 0;
            color: #111;
            vertical-align: top;
        }
        table.coverage td.line-count {
            width: 50px;
            text-align: right;
            padding-right: 5px;
        }
        table.coverage td.line-coverage {
            color: #777 !important;
            text-align: right;
            border-left: 1px solid #666;
            border-right: 1px solid #666;
        }

        table.coverage td.text {
        }

        table.coverage td span.cline-any {
            display: inline-block;
            padding: 0 5px;
            width: 40px;
        }
        table.coverage td span.cline-neutral {
            background: #eee;
        }
        table.coverage td span.cline-yes {
            background: #b5d592;
            color: #999;
        }
        table.coverage td span.cline-no {
            background: #fc8c84;
        }

        .cstat-yes { color: #111; }
        .cstat-no { background: #fc8c84; color: #111; }
        .fstat-no { background: #ffc520; color: #111 !important; }
        .cbranch-no { background:  yellow !important; color: #111; }

        .cstat-skip { background: #ddd; color: #111; }
        .fstat-skip { background: #ddd; color: #111 !important; }
        .cbranch-skip { background: #ddd !important; color: #111; }

        .missing-if-branch {
            display: inline-block;
            margin-right: 10px;
            position: relative;
            padding: 0 4px;
            background: black;
            color: yellow;
        }

        .skip-if-branch {
            display: none;
            margin-right: 10px;
            position: relative;
            padding: 0 4px;
            background: #ccc;
            color: white;
        }

        .missing-if-branch .typ, .skip-if-branch .typ {
            color: inherit !important;
        }

        .entity, .metric { font-weight: bold; }
        .metric { display: inline-block; border: 1px solid #333; padding: 0.3em; background: white; }
        .metric small { font-size: 80%; font-weight: normal; color: #666; }

        div.coverage-summary table { border-collapse: collapse; margin: 3em; font-size: 110%; }
        div.coverage-summary td, div.coverage-summary table  th { margin: 0; padding: 0.25em 1em; border-top: 1px solid #666; border-bottom: 1px solid #666; }
        div.coverage-summary th { text-align: left; border: 1px solid #666; background: #eee; font-weight: normal; }
        div.coverage-summary th.file { border-right: none !important; }
        div.coverage-summary th.pic { border-left: none !important; text-align: right; }
        div.coverage-summary th.pct { border-right: none !important; }
        div.coverage-summary th.abs { border-left: none !important; text-align: right; }
        div.coverage-summary td.pct { text-align: right; border-left: 1px solid #666; }
        div.coverage-summary td.abs { text-align: right; font-size: 90%; color: #444; border-right: 1px solid #666; }
        div.coverage-summary td.file { text-align: right; border-left: 1px solid #666; white-space: nowrap;  }
        div.coverage-summary td.pic { min-width: 120px !important;  }
        div.coverage-summary a:link { color: #000; }
        div.coverage-summary a:visited { color: #333; }
        div.coverage-summary tfoot td { border-top: 1px solid #666; }

        div.coverage-summary .yui3-datatable-sort-indicator, div.coverage-summary .dummy-sort-indicator {
            height: 10px;
            width: 7px;
            display: inline-block;
            margin-left: 0.5em;
        }
        div.coverage-summary .yui3-datatable-sort-indicator {
            background: no-repeat scroll 0 0 transparent;
        }
        div.coverage-summary .yui3-datatable-sorted .yui3-datatable-sort-indicator {
            background-position: 0 -20px;
        }
        div.coverage-summary .yui3-datatable-sorted-desc .yui3-datatable-sort-indicator {
            background-position: 0 -10px;
        }

        .high { background: #b5d592 !important; }
        .medium { background: #ffe87c !important; }
        .low { background: #fc8c84 !important; }

        span.cover-fill, span.cover-empty {
            display:inline-block;
            border:1px solid #444;
            background: white;
            height: 12px;
        }
        span.cover-fill {
            background: #ccc;
            border-right: 1px solid #444;
        }
        span.cover-empty {
            background: white;
            border-left: none;
        }
        span.cover-full {
            border-right: none !important;
        }
        pre.prettyprint {
            border: none !important;
            padding: 0 !important;
            margin: 0 !important;
        }
        .com { color: #999 !important; }
        .ignore-none { color: #999; font-weight: normal; }

    </style>
</head>
<body>
<div class="header low">
    <h1 style="font-weight: bold;">
        <a href="https://github.com/npmtest/node-npmtest-node-red">npmtest-node-red (v0.0.1)</a>
    </h1>
    <h1>Code coverage report for <span class="entity">node-npmtest-node-red/node-red/red/api/nodes.js</span></h1>
    <h2>
        
        Statements: <span class="metric">5.77% <small>(9 / 156)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        
        Branches: <span class="metric">0% <small>(0 / 76)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        
        Functions: <span class="metric">0% <small>(0 / 16)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        
        Lines: <span class="metric">5.77% <small>(9 / 156)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        Ignored: <span class="metric"><span class="ignore-none">none</span></span> &nbsp;&nbsp;&nbsp;&nbsp;
    </h2>
    <div class="path"><a href="../../../../index.html">All files</a> &#187; <a href="index.html">node-npmtest-node-red/node-red/red/api/</a> &#187; nodes.js</div>
</div>
<div class="body">
<pre><table class="coverage">
<tr><td class="line-count">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
164
165
166
167
168
169
170
171
172
173
174
175
176
177
178
179
180
181
182
183
184
185
186
187
188
189
190
191
192
193
194
195
196
197
198
199
200
201
202
203
204
205
206
207
208
209
210
211
212
213
214
215
216
217
218
219
220
221
222
223
224
225
226
227
228
229
230
231
232
233
234
235
236
237
238
239
240
241
242
243
244
245
246
247
248
249
250
251</td><td class="line-coverage"><span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span></td><td class="text"><pre class="prettyprint lang-js">/**
 * Copyright JS Foundation and other contributors, http://js.foundation
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 **/
&nbsp;
var when = require("when");
var comms = require("./comms");
var locales = require("./locales");
var redNodes;
var log;
var i18n;
var settings;
&nbsp;
module.exports = {
    init: <span class="fstat-no" title="function not covered" >function(runtime) {</span>
<span class="cstat-no" title="statement not covered" >        redNodes = runtime.nodes;</span>
<span class="cstat-no" title="statement not covered" >        log = runtime.log;</span>
<span class="cstat-no" title="statement not covered" >        i18n = runtime.i18n;</span>
<span class="cstat-no" title="statement not covered" >        settings = runtime.settings;</span>
    },
    getAll: <span class="fstat-no" title="function not covered" >function(req,res) {</span>
<span class="cstat-no" title="statement not covered" >        if (req.get("accept") == "application/json") {</span>
<span class="cstat-no" title="statement not covered" >            log.audit({event: "nodes.list.get"},req);</span>
<span class="cstat-no" title="statement not covered" >            res.json(redNodes.getNodeList());</span>
        } else {
<span class="cstat-no" title="statement not covered" >            var lang = locales.determineLangFromHeaders(req.acceptsLanguages());</span>
<span class="cstat-no" title="statement not covered" >            log.audit({event: "nodes.configs.get"},req);</span>
<span class="cstat-no" title="statement not covered" >            res.send(redNodes.getNodeConfigs(lang));</span>
        }
    },
&nbsp;
    post: <span class="fstat-no" title="function not covered" >function(req,res) {</span>
<span class="cstat-no" title="statement not covered" >        if (!settings.available()) {</span>
<span class="cstat-no" title="statement not covered" >            log.audit({event: "nodes.install",error:"settings_unavailable"},req);</span>
<span class="cstat-no" title="statement not covered" >            res.status(400).json({error:"settings_unavailable", message:"Settings unavailable"});</span>
<span class="cstat-no" title="statement not covered" >            return;</span>
        }
<span class="cstat-no" title="statement not covered" >        var node = req.body;</span>
<span class="cstat-no" title="statement not covered" >        var promise;</span>
<span class="cstat-no" title="statement not covered" >        if (node.module) {</span>
<span class="cstat-no" title="statement not covered" >            var module = redNodes.getModuleInfo(node.module);</span>
<span class="cstat-no" title="statement not covered" >            if (module) {</span>
<span class="cstat-no" title="statement not covered" >                log.audit({event: "nodes.install",module:node.module,error:"module_already_loaded"},req);</span>
<span class="cstat-no" title="statement not covered" >                res.status(400).json({error:"module_already_loaded", message:"Module already loaded"});</span>
<span class="cstat-no" title="statement not covered" >                return;</span>
            }
<span class="cstat-no" title="statement not covered" >            promise = redNodes.installModule(node.module);</span>
        } else {
<span class="cstat-no" title="statement not covered" >            log.audit({event: "nodes.install",module:node.module,error:"invalid_request"},req);</span>
<span class="cstat-no" title="statement not covered" >            res.status(400).json({error:"invalid_request", message:"Invalid request"});</span>
<span class="cstat-no" title="statement not covered" >            return;</span>
        }
<span class="cstat-no" title="statement not covered" >        promise.then(<span class="fstat-no" title="function not covered" >function(info) {</span></span>
<span class="cstat-no" title="statement not covered" >            comms.publish("node/added",info.nodes,false);</span>
<span class="cstat-no" title="statement not covered" >            if (node.module) {</span>
<span class="cstat-no" title="statement not covered" >                log.audit({event: "nodes.install",module:node.module},req);</span>
<span class="cstat-no" title="statement not covered" >                res.json(info);</span>
            }
        }).otherwise(<span class="fstat-no" title="function not covered" >function(err) {</span>
<span class="cstat-no" title="statement not covered" >            if (err.code === 404) {</span>
<span class="cstat-no" title="statement not covered" >                log.audit({event: "nodes.install",module:node.module,error:"not_found"},req);</span>
<span class="cstat-no" title="statement not covered" >                res.status(404).end();</span>
            } else <span class="cstat-no" title="statement not covered" >if (err.code) {</span>
<span class="cstat-no" title="statement not covered" >                log.audit({event: "nodes.install",module:node.module,error:err.code},req);</span>
<span class="cstat-no" title="statement not covered" >                res.status(400).json({error:err.code, message:err.message});</span>
            } else {
<span class="cstat-no" title="statement not covered" >                log.audit({event: "nodes.install",module:node.module,error:err.code||"unexpected_error",message:err.toString()},req);</span>
<span class="cstat-no" title="statement not covered" >                res.status(400).json({error:err.code||"unexpected_error", message:err.toString()});</span>
            }
        });
    },
&nbsp;
    delete: <span class="fstat-no" title="function not covered" >function(req,res) {</span>
<span class="cstat-no" title="statement not covered" >        if (!settings.available()) {</span>
<span class="cstat-no" title="statement not covered" >            log.audit({event: "nodes.remove",error:"settings_unavailable"},req);</span>
<span class="cstat-no" title="statement not covered" >            res.status(400).json({error:"settings_unavailable", message:"Settings unavailable"});</span>
<span class="cstat-no" title="statement not covered" >            return;</span>
        }
<span class="cstat-no" title="statement not covered" >        var mod = req.params[0];</span>
<span class="cstat-no" title="statement not covered" >        try {</span>
<span class="cstat-no" title="statement not covered" >            var promise = null;</span>
<span class="cstat-no" title="statement not covered" >            var module = redNodes.getModuleInfo(mod);</span>
<span class="cstat-no" title="statement not covered" >            if (!module) {</span>
<span class="cstat-no" title="statement not covered" >                log.audit({event: "nodes.remove",module:mod,error:"not_found"},req);</span>
<span class="cstat-no" title="statement not covered" >                res.status(404).end();</span>
<span class="cstat-no" title="statement not covered" >                return;</span>
            } else {
<span class="cstat-no" title="statement not covered" >                promise = redNodes.uninstallModule(mod);</span>
            }
&nbsp;
<span class="cstat-no" title="statement not covered" >            promise.then(<span class="fstat-no" title="function not covered" >function(list) {</span></span>
<span class="cstat-no" title="statement not covered" >                comms.publish("node/removed",list,false);</span>
<span class="cstat-no" title="statement not covered" >                log.audit({event: "nodes.remove",module:mod},req);</span>
<span class="cstat-no" title="statement not covered" >                res.status(204).end();</span>
            }).otherwise(<span class="fstat-no" title="function not covered" >function(err) {</span>
<span class="cstat-no" title="statement not covered" >                log.audit({event: "nodes.remove",module:mod,error:err.code||"unexpected_error",message:err.toString()},req);</span>
<span class="cstat-no" title="statement not covered" >                res.status(400).json({error:err.code||"unexpected_error", message:err.toString()});</span>
            });
        } catch(err) {
<span class="cstat-no" title="statement not covered" >            log.audit({event: "nodes.remove",module:mod,error:err.code||"unexpected_error",message:err.toString()},req);</span>
<span class="cstat-no" title="statement not covered" >            res.status(400).json({error:err.code||"unexpected_error", message:err.toString()});</span>
        }
    },
&nbsp;
    getSet: <span class="fstat-no" title="function not covered" >function(req,res) {</span>
<span class="cstat-no" title="statement not covered" >        var id = req.params[0] + "/" + req.params[2];</span>
<span class="cstat-no" title="statement not covered" >        var result = null;</span>
<span class="cstat-no" title="statement not covered" >        if (req.get("accept") === "application/json") {</span>
<span class="cstat-no" title="statement not covered" >            result = redNodes.getNodeInfo(id);</span>
<span class="cstat-no" title="statement not covered" >            if (result) {</span>
<span class="cstat-no" title="statement not covered" >                log.audit({event: "nodes.info.get",id:id},req);</span>
<span class="cstat-no" title="statement not covered" >                delete result.loaded;</span>
<span class="cstat-no" title="statement not covered" >                res.send(result);</span>
            } else {
<span class="cstat-no" title="statement not covered" >                log.audit({event: "nodes.info.get",id:id,error:"not_found"},req);</span>
<span class="cstat-no" title="statement not covered" >                res.status(404).end();</span>
            }
        } else {
<span class="cstat-no" title="statement not covered" >            var lang = locales.determineLangFromHeaders(req.acceptsLanguages());</span>
<span class="cstat-no" title="statement not covered" >            result = redNodes.getNodeConfig(id,lang);</span>
<span class="cstat-no" title="statement not covered" >            if (result) {</span>
<span class="cstat-no" title="statement not covered" >                log.audit({event: "nodes.config.get",id:id},req);</span>
<span class="cstat-no" title="statement not covered" >                res.send(result);</span>
            } else {
<span class="cstat-no" title="statement not covered" >                log.audit({event: "nodes.config.get",id:id,error:"not_found"},req);</span>
<span class="cstat-no" title="statement not covered" >                res.status(404).end();</span>
            }
        }
    },
&nbsp;
    getModule: <span class="fstat-no" title="function not covered" >function(req,res) {</span>
<span class="cstat-no" title="statement not covered" >        var module = req.params[0];</span>
<span class="cstat-no" title="statement not covered" >        var result = redNodes.getModuleInfo(module);</span>
<span class="cstat-no" title="statement not covered" >        if (result) {</span>
<span class="cstat-no" title="statement not covered" >            log.audit({event: "nodes.module.get",module:module},req);</span>
<span class="cstat-no" title="statement not covered" >            res.json(result);</span>
        } else {
<span class="cstat-no" title="statement not covered" >            log.audit({event: "nodes.module.get",module:module,error:"not_found"},req);</span>
<span class="cstat-no" title="statement not covered" >            res.status(404).end();</span>
        }
    },
&nbsp;
    putSet: <span class="fstat-no" title="function not covered" >function(req,res) {</span>
<span class="cstat-no" title="statement not covered" >        if (!settings.available()) {</span>
<span class="cstat-no" title="statement not covered" >            log.audit({event: "nodes.info.set",error:"settings_unavailable"},req);</span>
<span class="cstat-no" title="statement not covered" >            res.status(400).json({error:"settings_unavailable", message:"Settings unavailable"});</span>
<span class="cstat-no" title="statement not covered" >            return;</span>
        }
<span class="cstat-no" title="statement not covered" >        var body = req.body;</span>
<span class="cstat-no" title="statement not covered" >        if (!body.hasOwnProperty("enabled")) {</span>
<span class="cstat-no" title="statement not covered" >            log.audit({event: "nodes.info.set",error:"invalid_request"},req);</span>
<span class="cstat-no" title="statement not covered" >            res.status(400).json({error:"invalid_request", message:"Invalid request"});</span>
<span class="cstat-no" title="statement not covered" >            return;</span>
        }
<span class="cstat-no" title="statement not covered" >        var id = req.params[0] + "/" + req.params[2];</span>
<span class="cstat-no" title="statement not covered" >        try {</span>
<span class="cstat-no" title="statement not covered" >            var node = redNodes.getNodeInfo(id);</span>
<span class="cstat-no" title="statement not covered" >            var info;</span>
<span class="cstat-no" title="statement not covered" >            if (!node) {</span>
<span class="cstat-no" title="statement not covered" >                log.audit({event: "nodes.info.set",id:id,error:"not_found"},req);</span>
<span class="cstat-no" title="statement not covered" >                res.status(404).end();</span>
            } else {
<span class="cstat-no" title="statement not covered" >                delete node.loaded;</span>
<span class="cstat-no" title="statement not covered" >                putNode(node, body.enabled).then(<span class="fstat-no" title="function not covered" >function(result) {</span></span>
<span class="cstat-no" title="statement not covered" >                    log.audit({event: "nodes.info.set",id:id,enabled:body.enabled},req);</span>
<span class="cstat-no" title="statement not covered" >                    res.json(result);</span>
                });
            }
        } catch(err) {
<span class="cstat-no" title="statement not covered" >            log.audit({event: "nodes.info.set",id:id,enabled:body.enabled,error:err.code||"unexpected_error",message:err.toString()},req);</span>
<span class="cstat-no" title="statement not covered" >            res.status(400).json({error:err.code||"unexpected_error", message:err.toString()});</span>
        }
    },
&nbsp;
    putModule: <span class="fstat-no" title="function not covered" >function(req,res) {</span>
<span class="cstat-no" title="statement not covered" >        if (!settings.available()) {</span>
<span class="cstat-no" title="statement not covered" >            log.audit({event: "nodes.module.set",error:"settings_unavailable"},req);</span>
<span class="cstat-no" title="statement not covered" >            res.status(400).json({error:"settings_unavailable", message:"Settings unavailable"});</span>
<span class="cstat-no" title="statement not covered" >            return;</span>
        }
<span class="cstat-no" title="statement not covered" >        var body = req.body;</span>
<span class="cstat-no" title="statement not covered" >        if (!body.hasOwnProperty("enabled")) {</span>
<span class="cstat-no" title="statement not covered" >            log.audit({event: "nodes.module.set",error:"invalid_request"},req);</span>
<span class="cstat-no" title="statement not covered" >            res.status(400).json({error:"invalid_request", message:"Invalid request"});</span>
<span class="cstat-no" title="statement not covered" >            return;</span>
        }
<span class="cstat-no" title="statement not covered" >        var mod = req.params[0];</span>
<span class="cstat-no" title="statement not covered" >        try {</span>
<span class="cstat-no" title="statement not covered" >            var module = redNodes.getModuleInfo(mod);</span>
<span class="cstat-no" title="statement not covered" >            if (!module) {</span>
<span class="cstat-no" title="statement not covered" >                log.audit({event: "nodes.module.set",module:mod,error:"not_found"},req);</span>
<span class="cstat-no" title="statement not covered" >                return res.status(404).end();</span>
            }
&nbsp;
<span class="cstat-no" title="statement not covered" >            var nodes = module.nodes;</span>
<span class="cstat-no" title="statement not covered" >            var promises = [];</span>
<span class="cstat-no" title="statement not covered" >            for (var i = 0; i &lt; nodes.length; ++i) {</span>
<span class="cstat-no" title="statement not covered" >                promises.push(putNode(nodes[i],body.enabled));</span>
            }
<span class="cstat-no" title="statement not covered" >            when.settle(promises).then(<span class="fstat-no" title="function not covered" >function() {</span></span>
<span class="cstat-no" title="statement not covered" >                res.json(redNodes.getModuleInfo(mod));</span>
            });
        } catch(err) {
<span class="cstat-no" title="statement not covered" >            log.audit({event: "nodes.module.set",module:mod,enabled:body.enabled,error:err.code||"unexpected_error",message:err.toString()},req);</span>
<span class="cstat-no" title="statement not covered" >            res.status(400).json({error:err.code||"unexpected_error", message:err.toString()});</span>
        }
    }
};
&nbsp;
<span class="fstat-no" title="function not covered" >function putNode(node, enabled) {</span>
<span class="cstat-no" title="statement not covered" >    var info;</span>
<span class="cstat-no" title="statement not covered" >    var promise;</span>
<span class="cstat-no" title="statement not covered" >    if (!node.err &amp;&amp; node.enabled === enabled) {</span>
<span class="cstat-no" title="statement not covered" >        promise = when.resolve(node);</span>
    } else {
<span class="cstat-no" title="statement not covered" >        if (enabled) {</span>
<span class="cstat-no" title="statement not covered" >            promise = redNodes.enableNode(node.id);</span>
        } else {
<span class="cstat-no" title="statement not covered" >            promise = redNodes.disableNode(node.id);</span>
        }
&nbsp;
<span class="cstat-no" title="statement not covered" >        return promise.then(<span class="fstat-no" title="function not covered" >function(info) {</span></span>
<span class="cstat-no" title="statement not covered" >            if (info.enabled === enabled &amp;&amp; !info.err) {</span>
<span class="cstat-no" title="statement not covered" >                comms.publish("node/"+(enabled?"enabled":"disabled"),info,false);</span>
<span class="cstat-no" title="statement not covered" >                log.info(" "+log._("api.nodes."+(enabled?"enabled":"disabled")));</span>
<span class="cstat-no" title="statement not covered" >                for (var i=0;i&lt;info.types.length;i++) {</span>
<span class="cstat-no" title="statement not covered" >                    log.info(" - "+info.types[i]);</span>
                }
            } else <span class="cstat-no" title="statement not covered" >if (enabled &amp;&amp; info.err) {</span>
<span class="cstat-no" title="statement not covered" >            log.warn(log._("api.nodes.error-enable"));</span>
<span class="cstat-no" title="statement not covered" >                log.warn(" - "+info.name+" : "+info.err);</span>
            }
<span class="cstat-no" title="statement not covered" >            return info;</span>
        });
    }
&nbsp;
<span class="cstat-no" title="statement not covered" >    return promise;</span>
}
&nbsp;
&nbsp;</pre></td></tr>
</table></pre>
</div>
<div class="footer">
    <div class="meta">Generated by <a href="https://github.com/kaizhu256/node-utility2" target="_blank">utility2</a> at Tue Apr 11 2017 17:25:15 GMT+0000 (UTC)</div>
</div>
</body>
</html>


<!doctype html>
<html lang="en">
<head>
    <title>Code coverage report for node-npmtest-node-red/node-red/red/api/theme.js</title>
    <meta charset="utf-8">
    <style>
        body, html {
            margin:0; padding: 0;
        }
        body {
            font-family: Arial, Helvetica;
            font-size: 10pt;
        }
        div.header, div.footer {
            background: #eee;
            padding: 1em;
        }
        div.header {
            height: 160px;
            padding: 0 1em 0 1em;
            z-index: 100;
            position: fixed;
            top: 0;
            border-bottom: 1px solid #666;
            width: 100%;
        }
        div.footer {
            border-top: 1px solid #666;
        }
        div.body {
            margin-top: 170px;
        }
        div.meta {
            font-size: 90%;
            text-align: center;
        }
        h1, h2, h3 {
            font-weight: normal;
        }
        h1 {
            font-size: 12pt;
        }
        h2 {
            font-size: 10pt;
        }
        pre {
            font-family: Menlo, Monaco, Consolas, Courier New, monospace;
            margin: 0;
            padding: 0;
            font-size: 14px;
            tab-size: 2;
        }

        div.path { font-size: 110%; }
        div.path a:link, div.path a:visited { color: #000; }
        table.coverage { border-collapse: collapse; margin:0; padding: 0 }

        table.coverage td {
            margin: 0;
            padding: 0;
            color: #111;
            vertical-align: top;
        }
        table.coverage td.line-count {
            width: 50px;
            text-align: right;
            padding-right: 5px;
        }
        table.coverage td.line-coverage {
            color: #777 !important;
            text-align: right;
            border-left: 1px solid #666;
            border-right: 1px solid #666;
        }

        table.coverage td.text {
        }

        table.coverage td span.cline-any {
            display: inline-block;
            padding: 0 5px;
            width: 40px;
        }
        table.coverage td span.cline-neutral {
            background: #eee;
        }
        table.coverage td span.cline-yes {
            background: #b5d592;
            color: #999;
        }
        table.coverage td span.cline-no {
            background: #fc8c84;
        }

        .cstat-yes { color: #111; }
        .cstat-no { background: #fc8c84; color: #111; }
        .fstat-no { background: #ffc520; color: #111 !important; }
        .cbranch-no { background:  yellow !important; color: #111; }

        .cstat-skip { background: #ddd; color: #111; }
        .fstat-skip { background: #ddd; color: #111 !important; }
        .cbranch-skip { background: #ddd !important; color: #111; }

        .missing-if-branch {
            display: inline-block;
            margin-right: 10px;
            position: relative;
            padding: 0 4px;
            background: black;
            color: yellow;
        }

        .skip-if-branch {
            display: none;
            margin-right: 10px;
            position: relative;
            padding: 0 4px;
            background: #ccc;
            color: white;
        }

        .missing-if-branch .typ, .skip-if-branch .typ {
            color: inherit !important;
        }

        .entity, .metric { font-weight: bold; }
        .metric { display: inline-block; border: 1px solid #333; padding: 0.3em; background: white; }
        .metric small { font-size: 80%; font-weight: normal; color: #666; }

        div.coverage-summary table { border-collapse: collapse; margin: 3em; font-size: 110%; }
        div.coverage-summary td, div.coverage-summary table  th { margin: 0; padding: 0.25em 1em; border-top: 1px solid #666; border-bottom: 1px solid #666; }
        div.coverage-summary th { text-align: left; border: 1px solid #666; background: #eee; font-weight: normal; }
        div.coverage-summary th.file { border-right: none !important; }
        div.coverage-summary th.pic { border-left: none !important; text-align: right; }
        div.coverage-summary th.pct { border-right: none !important; }
        div.coverage-summary th.abs { border-left: none !important; text-align: right; }
        div.coverage-summary td.pct { text-align: right; border-left: 1px solid #666; }
        div.coverage-summary td.abs { text-align: right; font-size: 90%; color: #444; border-right: 1px solid #666; }
        div.coverage-summary td.file { text-align: right; border-left: 1px solid #666; white-space: nowrap;  }
        div.coverage-summary td.pic { min-width: 120px !important;  }
        div.coverage-summary a:link { color: #000; }
        div.coverage-summary a:visited { color: #333; }
        div.coverage-summary tfoot td { border-top: 1px solid #666; }

        div.coverage-summary .yui3-datatable-sort-indicator, div.coverage-summary .dummy-sort-indicator {
            height: 10px;
            width: 7px;
            display: inline-block;
            margin-left: 0.5em;
        }
        div.coverage-summary .yui3-datatable-sort-indicator {
            background: no-repeat scroll 0 0 transparent;
        }
        div.coverage-summary .yui3-datatable-sorted .yui3-datatable-sort-indicator {
            background-position: 0 -20px;
        }
        div.coverage-summary .yui3-datatable-sorted-desc .yui3-datatable-sort-indicator {
            background-position: 0 -10px;
        }

        .high { background: #b5d592 !important; }
        .medium { background: #ffe87c !important; }
        .low { background: #fc8c84 !important; }

        span.cover-fill, span.cover-empty {
            display:inline-block;
            border:1px solid #444;
            background: white;
            height: 12px;
        }
        span.cover-fill {
            background: #ccc;
            border-right: 1px solid #444;
        }
        span.cover-empty {
            background: white;
            border-left: none;
        }
        span.cover-full {
            border-right: none !important;
        }
        pre.prettyprint {
            border: none !important;
            padding: 0 !important;
            margin: 0 !important;
        }
        .com { color: #999 !important; }
        .ignore-none { color: #999; font-weight: normal; }

    </style>
</head>
<body>
<div class="header low">
    <h1 style="font-weight: bold;">
        <a href="https://github.com/npmtest/node-npmtest-node-red">npmtest-node-red (v0.0.1)</a>
    </h1>
    <h1>Code coverage report for <span class="entity">node-npmtest-node-red/node-red/red/api/theme.js</span></h1>
    <h2>
        
        Statements: <span class="metric">14.81% <small>(12 / 81)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        
        Branches: <span class="metric">3.45% <small>(2 / 58)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        
        Functions: <span class="metric">0% <small>(0 / 6)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        
        Lines: <span class="metric">14.81% <small>(12 / 81)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        Ignored: <span class="metric"><span class="ignore-none">none</span></span> &nbsp;&nbsp;&nbsp;&nbsp;
    </h2>
    <div class="path"><a href="../../../../index.html">All files</a> &#187; <a href="index.html">node-npmtest-node-red/node-red/red/api/</a> &#187; theme.js</div>
</div>
<div class="body">
<pre><table class="coverage">
<tr><td class="line-count">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
164
165
166
167
168
169
170
171
172
173
174
175
176
177
178
179
180</td><td class="line-coverage"><span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span></td><td class="text"><pre class="prettyprint lang-js">/**
 * Copyright JS Foundation and other contributors, http://js.foundation
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 **/
&nbsp;
var express = require("express");
var util = require("util");
var path = require("path");
var fs = require("fs");
var clone = require("clone");
&nbsp;
var defaultContext = {
    page: {
        title: "Node-RED",
        favicon: "favicon.ico",
        tabicon: "red/images/node-red-icon-black.svg"
    },
    header: {
        title: "Node-RED",
        image: "red/images/node-red.png"
    },
    asset: {
        red: (process.env.NODE_ENV == "development")? <span class="branch-0 cbranch-no" title="branch not covered" >"red/red.js":</span>"red/red.min.js",
        main: (process.env.NODE_ENV == "development")? <span class="branch-0 cbranch-no" title="branch not covered" >"red/main.js":</span>"red/main.min.js",
&nbsp;
    }
};
&nbsp;
var theme = null;
var themeContext = clone(defaultContext);
var themeSettings = null;
var runtime = null;
&nbsp;
<span class="fstat-no" title="function not covered" >function serveFile(app,baseUrl,file) {</span>
<span class="cstat-no" title="statement not covered" >    try {</span>
<span class="cstat-no" title="statement not covered" >        var stats = fs.statSync(file);</span>
<span class="cstat-no" title="statement not covered" >        var url = baseUrl+path.basename(file);</span>
        //console.log(url,"-&gt;",file);
<span class="cstat-no" title="statement not covered" >        app.get(url,<span class="fstat-no" title="function not covered" >function(req, res) {</span></span>
<span class="cstat-no" title="statement not covered" >            res.sendFile(file);</span>
        });
<span class="cstat-no" title="statement not covered" >        return "theme"+url;</span>
    } catch(err) {
        //TODO: log filenotfound
<span class="cstat-no" title="statement not covered" >        return null;</span>
    }
}
&nbsp;
module.exports = {
    init: <span class="fstat-no" title="function not covered" >function(runtime) {</span>
<span class="cstat-no" title="statement not covered" >        var settings = runtime.settings;</span>
<span class="cstat-no" title="statement not covered" >        themeContext = clone(defaultContext);</span>
<span class="cstat-no" title="statement not covered" >        if (runtime.version) {</span>
<span class="cstat-no" title="statement not covered" >            themeContext.version = runtime.version();</span>
        }
<span class="cstat-no" title="statement not covered" >        themeSettings = null;</span>
<span class="cstat-no" title="statement not covered" >        theme = settings.editorTheme;</span>
    },
&nbsp;
    app: <span class="fstat-no" title="function not covered" >function() {</span>
<span class="cstat-no" title="statement not covered" >        var i;</span>
<span class="cstat-no" title="statement not covered" >        var url;</span>
<span class="cstat-no" title="statement not covered" >        themeSettings = {};</span>
&nbsp;
<span class="cstat-no" title="statement not covered" >        var themeApp = express();</span>
&nbsp;
<span class="cstat-no" title="statement not covered" >        if (theme.page) {</span>
<span class="cstat-no" title="statement not covered" >            if (theme.page.css) {</span>
<span class="cstat-no" title="statement not covered" >                var styles = theme.page.css;</span>
<span class="cstat-no" title="statement not covered" >                if (!util.isArray(styles)) {</span>
<span class="cstat-no" title="statement not covered" >                    styles = [styles];</span>
                }
<span class="cstat-no" title="statement not covered" >                themeContext.page.css = [];</span>
&nbsp;
<span class="cstat-no" title="statement not covered" >                for (i=0;i&lt;styles.length;i++) {</span>
<span class="cstat-no" title="statement not covered" >                    url = serveFile(themeApp,"/css/",styles[i]);</span>
<span class="cstat-no" title="statement not covered" >                    if (url) {</span>
<span class="cstat-no" title="statement not covered" >                        themeContext.page.css.push(url);</span>
                    }
                }
            }
&nbsp;
<span class="cstat-no" title="statement not covered" >            if (theme.page.favicon) {</span>
<span class="cstat-no" title="statement not covered" >                url = serveFile(themeApp,"/favicon/",theme.page.favicon)</span>
<span class="cstat-no" title="statement not covered" >                if (url) {</span>
<span class="cstat-no" title="statement not covered" >                    themeContext.page.favicon = url;</span>
                }
            }
&nbsp;
<span class="cstat-no" title="statement not covered" >            if (theme.page.tabicon) {</span>
<span class="cstat-no" title="statement not covered" >                url = serveFile(themeApp,"/tabicon/",theme.page.tabicon)</span>
<span class="cstat-no" title="statement not covered" >                if (url) {</span>
<span class="cstat-no" title="statement not covered" >                    themeContext.page.tabicon = url;</span>
                }
            }
&nbsp;
<span class="cstat-no" title="statement not covered" >            themeContext.page.title = theme.page.title || themeContext.page.title;</span>
        }
&nbsp;
<span class="cstat-no" title="statement not covered" >        if (theme.header) {</span>
&nbsp;
<span class="cstat-no" title="statement not covered" >            themeContext.header.title = theme.header.title || themeContext.header.title;</span>
&nbsp;
<span class="cstat-no" title="statement not covered" >            if (theme.header.hasOwnProperty("url")) {</span>
<span class="cstat-no" title="statement not covered" >                themeContext.header.url = theme.header.url;</span>
            }
&nbsp;
<span class="cstat-no" title="statement not covered" >            if (theme.header.hasOwnProperty("image")) {</span>
<span class="cstat-no" title="statement not covered" >                if (theme.header.image) {</span>
<span class="cstat-no" title="statement not covered" >                    url = serveFile(themeApp,"/header/",theme.header.image);</span>
<span class="cstat-no" title="statement not covered" >                    if (url) {</span>
<span class="cstat-no" title="statement not covered" >                        themeContext.header.image = url;</span>
                    }
                } else {
<span class="cstat-no" title="statement not covered" >                    themeContext.header.image = null;</span>
                }
            }
        }
&nbsp;
<span class="cstat-no" title="statement not covered" >        if (theme.deployButton) {</span>
<span class="cstat-no" title="statement not covered" >            if (theme.deployButton.type == "simple") {</span>
<span class="cstat-no" title="statement not covered" >                themeSettings.deployButton = {</span>
                    type: "simple"
                }
<span class="cstat-no" title="statement not covered" >                if (theme.deployButton.label) {</span>
<span class="cstat-no" title="statement not covered" >                    themeSettings.deployButton.label = theme.deployButton.label;</span>
                }
<span class="cstat-no" title="statement not covered" >                if (theme.deployButton.icon) {</span>
<span class="cstat-no" title="statement not covered" >                    url = serveFile(themeApp,"/deploy/",theme.deployButton.icon);</span>
<span class="cstat-no" title="statement not covered" >                    if (url) {</span>
<span class="cstat-no" title="statement not covered" >                        themeSettings.deployButton.icon = url;</span>
                    }
                }
            }
        }
&nbsp;
<span class="cstat-no" title="statement not covered" >        if (theme.hasOwnProperty("userMenu")) {</span>
<span class="cstat-no" title="statement not covered" >            themeSettings.userMenu = theme.userMenu;</span>
        }
&nbsp;
<span class="cstat-no" title="statement not covered" >        if (theme.login) {</span>
<span class="cstat-no" title="statement not covered" >            if (theme.login.image) {</span>
<span class="cstat-no" title="statement not covered" >                url = serveFile(themeApp,"/login/",theme.login.image);</span>
<span class="cstat-no" title="statement not covered" >                if (url) {</span>
<span class="cstat-no" title="statement not covered" >                    themeContext.login = {</span>
                        image: url
                    }
                }
            }
        }
&nbsp;
<span class="cstat-no" title="statement not covered" >        if (theme.hasOwnProperty("menu")) {</span>
<span class="cstat-no" title="statement not covered" >            themeSettings.menu = theme.menu;</span>
        }
&nbsp;
<span class="cstat-no" title="statement not covered" >        if (theme.hasOwnProperty("palette")) {</span>
<span class="cstat-no" title="statement not covered" >            themeSettings.palette = theme.palette;</span>
        }
<span class="cstat-no" title="statement not covered" >        return themeApp;</span>
    },
    context: <span class="fstat-no" title="function not covered" >function() {</span>
<span class="cstat-no" title="statement not covered" >        return themeContext;</span>
    },
    settings: <span class="fstat-no" title="function not covered" >function() {</span>
<span class="cstat-no" title="statement not covered" >        return themeSettings;</span>
    }
}
&nbsp;
&nbsp;</pre></td></tr>
</table></pre>
</div>
<div class="footer">
    <div class="meta">Generated by <a href="https://github.com/kaizhu256/node-utility2" target="_blank">utility2</a> at Tue Apr 11 2017 17:25:15 GMT+0000 (UTC)</div>
</div>
</body>
</html>


<!doctype html>
<html lang="en">
<head>
    <title>Code coverage report for node-npmtest-node-red/node-red/red/api/ui.js</title>
    <meta charset="utf-8">
    <style>
        body, html {
            margin:0; padding: 0;
        }
        body {
            font-family: Arial, Helvetica;
            font-size: 10pt;
        }
        div.header, div.footer {
            background: #eee;
            padding: 1em;
        }
        div.header {
            height: 160px;
            padding: 0 1em 0 1em;
            z-index: 100;
            position: fixed;
            top: 0;
            border-bottom: 1px solid #666;
            width: 100%;
        }
        div.footer {
            border-top: 1px solid #666;
        }
        div.body {
            margin-top: 170px;
        }
        div.meta {
            font-size: 90%;
            text-align: center;
        }
        h1, h2, h3 {
            font-weight: normal;
        }
        h1 {
            font-size: 12pt;
        }
        h2 {
            font-size: 10pt;
        }
        pre {
            font-family: Menlo, Monaco, Consolas, Courier New, monospace;
            margin: 0;
            padding: 0;
            font-size: 14px;
            tab-size: 2;
        }

        div.path { font-size: 110%; }
        div.path a:link, div.path a:visited { color: #000; }
        table.coverage { border-collapse: collapse; margin:0; padding: 0 }

        table.coverage td {
            margin: 0;
            padding: 0;
            color: #111;
            vertical-align: top;
        }
        table.coverage td.line-count {
            width: 50px;
            text-align: right;
            padding-right: 5px;
        }
        table.coverage td.line-coverage {
            color: #777 !important;
            text-align: right;
            border-left: 1px solid #666;
            border-right: 1px solid #666;
        }

        table.coverage td.text {
        }

        table.coverage td span.cline-any {
            display: inline-block;
            padding: 0 5px;
            width: 40px;
        }
        table.coverage td span.cline-neutral {
            background: #eee;
        }
        table.coverage td span.cline-yes {
            background: #b5d592;
            color: #999;
        }
        table.coverage td span.cline-no {
            background: #fc8c84;
        }

        .cstat-yes { color: #111; }
        .cstat-no { background: #fc8c84; color: #111; }
        .fstat-no { background: #ffc520; color: #111 !important; }
        .cbranch-no { background:  yellow !important; color: #111; }

        .cstat-skip { background: #ddd; color: #111; }
        .fstat-skip { background: #ddd; color: #111 !important; }
        .cbranch-skip { background: #ddd !important; color: #111; }

        .missing-if-branch {
            display: inline-block;
            margin-right: 10px;
            position: relative;
            padding: 0 4px;
            background: black;
            color: yellow;
        }

        .skip-if-branch {
            display: none;
            margin-right: 10px;
            position: relative;
            padding: 0 4px;
            background: #ccc;
            color: white;
        }

        .missing-if-branch .typ, .skip-if-branch .typ {
            color: inherit !important;
        }

        .entity, .metric { font-weight: bold; }
        .metric { display: inline-block; border: 1px solid #333; padding: 0.3em; background: white; }
        .metric small { font-size: 80%; font-weight: normal; color: #666; }

        div.coverage-summary table { border-collapse: collapse; margin: 3em; font-size: 110%; }
        div.coverage-summary td, div.coverage-summary table  th { margin: 0; padding: 0.25em 1em; border-top: 1px solid #666; border-bottom: 1px solid #666; }
        div.coverage-summary th { text-align: left; border: 1px solid #666; background: #eee; font-weight: normal; }
        div.coverage-summary th.file { border-right: none !important; }
        div.coverage-summary th.pic { border-left: none !important; text-align: right; }
        div.coverage-summary th.pct { border-right: none !important; }
        div.coverage-summary th.abs { border-left: none !important; text-align: right; }
        div.coverage-summary td.pct { text-align: right; border-left: 1px solid #666; }
        div.coverage-summary td.abs { text-align: right; font-size: 90%; color: #444; border-right: 1px solid #666; }
        div.coverage-summary td.file { text-align: right; border-left: 1px solid #666; white-space: nowrap;  }
        div.coverage-summary td.pic { min-width: 120px !important;  }
        div.coverage-summary a:link { color: #000; }
        div.coverage-summary a:visited { color: #333; }
        div.coverage-summary tfoot td { border-top: 1px solid #666; }

        div.coverage-summary .yui3-datatable-sort-indicator, div.coverage-summary .dummy-sort-indicator {
            height: 10px;
            width: 7px;
            display: inline-block;
            margin-left: 0.5em;
        }
        div.coverage-summary .yui3-datatable-sort-indicator {
            background: no-repeat scroll 0 0 transparent;
        }
        div.coverage-summary .yui3-datatable-sorted .yui3-datatable-sort-indicator {
            background-position: 0 -20px;
        }
        div.coverage-summary .yui3-datatable-sorted-desc .yui3-datatable-sort-indicator {
            background-position: 0 -10px;
        }

        .high { background: #b5d592 !important; }
        .medium { background: #ffe87c !important; }
        .low { background: #fc8c84 !important; }

        span.cover-fill, span.cover-empty {
            display:inline-block;
            border:1px solid #444;
            background: white;
            height: 12px;
        }
        span.cover-fill {
            background: #ccc;
            border-right: 1px solid #444;
        }
        span.cover-empty {
            background: white;
            border-left: none;
        }
        span.cover-full {
            border-right: none !important;
        }
        pre.prettyprint {
            border: none !important;
            padding: 0 !important;
            margin: 0 !important;
        }
        .com { color: #999 !important; }
        .ignore-none { color: #999; font-weight: normal; }

    </style>
</head>
<body>
<div class="header low">
    <h1 style="font-weight: bold;">
        <a href="https://github.com/npmtest/node-npmtest-node-red">npmtest-node-red (v0.0.1)</a>
    </h1>
    <h1>Code coverage report for <span class="entity">node-npmtest-node-red/node-red/red/api/ui.js</span></h1>
    <h2>
        
        Statements: <span class="metric">35.29% <small>(12 / 34)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        
        Branches: <span class="metric">0% <small>(0 / 4)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        
        Functions: <span class="metric">0% <small>(0 / 5)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        
        Lines: <span class="metric">35.29% <small>(12 / 34)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        Ignored: <span class="metric"><span class="ignore-none">none</span></span> &nbsp;&nbsp;&nbsp;&nbsp;
    </h2>
    <div class="path"><a href="../../../../index.html">All files</a> &#187; <a href="index.html">node-npmtest-node-red/node-red/red/api/</a> &#187; ui.js</div>
</div>
<div class="body">
<pre><table class="coverage">
<tr><td class="line-count">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80</td><td class="line-coverage"><span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span></td><td class="text"><pre class="prettyprint lang-js">/**
 * Copyright JS Foundation and other contributors, http://js.foundation
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 **/
var express = require('express');
var fs = require("fs");
var path = require("path");
&nbsp;
var theme = require("./theme");
&nbsp;
var Mustache = require("mustache");
&nbsp;
var icon_paths = [path.resolve(__dirname + '/../../public/icons')];
var iconCache = {};
//TODO: create a default icon
var defaultIcon = path.resolve(__dirname + '/../../public/icons/arrow-in.png');
var templateDir = path.resolve(__dirname+"/../../editor/templates");
var editorTemplate;
&nbsp;
<span class="fstat-no" title="function not covered" >function nodeIconDir(dir) {</span>
<span class="cstat-no" title="statement not covered" >    icon_paths.push(path.resolve(dir));</span>
}
&nbsp;
module.exports = {
    init: <span class="fstat-no" title="function not covered" >function(runtime) {</span>
<span class="cstat-no" title="statement not covered" >        editorTemplate = fs.readFileSync(path.join(templateDir,"index.mst"),"utf8");</span>
<span class="cstat-no" title="statement not covered" >        Mustache.parse(editorTemplate);</span>
        // TODO: this allows init to be called multiple times without
        //       registering multiple instances of the listener.
        //       It isn't.... ideal.
<span class="cstat-no" title="statement not covered" >        runtime.events.removeListener("node-icon-dir",nodeIconDir);</span>
<span class="cstat-no" title="statement not covered" >        runtime.events.on("node-icon-dir",nodeIconDir);</span>
    },
&nbsp;
    ensureSlash: <span class="fstat-no" title="function not covered" >function(req,res,next) {</span>
<span class="cstat-no" title="statement not covered" >        var parts = req.originalUrl.split("?");</span>
<span class="cstat-no" title="statement not covered" >        if (parts[0].slice(-1) != "/") {</span>
<span class="cstat-no" title="statement not covered" >            parts[0] += "/";</span>
<span class="cstat-no" title="statement not covered" >            var redirect = parts.join("?");</span>
<span class="cstat-no" title="statement not covered" >            res.redirect(301,redirect);</span>
        } else {
<span class="cstat-no" title="statement not covered" >            next();</span>
        }
    },
    icon: <span class="fstat-no" title="function not covered" >function(req,res) {</span>
<span class="cstat-no" title="statement not covered" >        if (iconCache[req.params.icon]) {</span>
<span class="cstat-no" title="statement not covered" >            res.sendFile(iconCache[req.params.icon]); </span>// if not found, express prints this to the console and serves 404
        } else {
<span class="cstat-no" title="statement not covered" >            for (var p=0;p&lt;icon_paths.length;p++) {</span>
<span class="cstat-no" title="statement not covered" >                var iconPath = path.join(icon_paths[p],req.params.icon);</span>
<span class="cstat-no" title="statement not covered" >                try {</span>
<span class="cstat-no" title="statement not covered" >                    fs.statSync(iconPath);</span>
<span class="cstat-no" title="statement not covered" >                    res.sendFile(iconPath);</span>
<span class="cstat-no" title="statement not covered" >                    iconCache[req.params.icon] = iconPath;</span>
<span class="cstat-no" title="statement not covered" >                    return;</span>
                } catch(err) {
                    // iconPath doesn't exist
                }
            }
<span class="cstat-no" title="statement not covered" >            res.sendFile(defaultIcon);</span>
        }
    },
    editor: <span class="fstat-no" title="function not covered" >function(req,res) {</span>
<span class="cstat-no" title="statement not covered" >        res.send(Mustache.render(editorTemplate,theme.context()));</span>
    },
    editorResources: express.static(__dirname + '/../../public')
};
&nbsp;
&nbsp;</pre></td></tr>
</table></pre>
</div>
<div class="footer">
    <div class="meta">Generated by <a href="https://github.com/kaizhu256/node-utility2" target="_blank">utility2</a> at Tue Apr 11 2017 17:25:15 GMT+0000 (UTC)</div>
</div>
</body>
</html>


<!doctype html>
<html lang="en">
<head>
    <title>Code coverage report for node-npmtest-node-red/node-red/red/api/auth/</title>
    <meta charset="utf-8">
    <style>
        body, html {
            margin:0; padding: 0;
        }
        body {
            font-family: Arial, Helvetica;
            font-size: 10pt;
        }
        div.header, div.footer {
            background: #eee;
            padding: 1em;
        }
        div.header {
            height: 160px;
            padding: 0 1em 0 1em;
            z-index: 100;
            position: fixed;
            top: 0;
            border-bottom: 1px solid #666;
            width: 100%;
        }
        div.footer {
            border-top: 1px solid #666;
        }
        div.body {
            margin-top: 170px;
        }
        div.meta {
            font-size: 90%;
            text-align: center;
        }
        h1, h2, h3 {
            font-weight: normal;
        }
        h1 {
            font-size: 12pt;
        }
        h2 {
            font-size: 10pt;
        }
        pre {
            font-family: Menlo, Monaco, Consolas, Courier New, monospace;
            margin: 0;
            padding: 0;
            font-size: 14px;
            tab-size: 2;
        }

        div.path { font-size: 110%; }
        div.path a:link, div.path a:visited { color: #000; }
        table.coverage { border-collapse: collapse; margin:0; padding: 0 }

        table.coverage td {
            margin: 0;
            padding: 0;
            color: #111;
            vertical-align: top;
        }
        table.coverage td.line-count {
            width: 50px;
            text-align: right;
            padding-right: 5px;
        }
        table.coverage td.line-coverage {
            color: #777 !important;
            text-align: right;
            border-left: 1px solid #666;
            border-right: 1px solid #666;
        }

        table.coverage td.text {
        }

        table.coverage td span.cline-any {
            display: inline-block;
            padding: 0 5px;
            width: 40px;
        }
        table.coverage td span.cline-neutral {
            background: #eee;
        }
        table.coverage td span.cline-yes {
            background: #b5d592;
            color: #999;
        }
        table.coverage td span.cline-no {
            background: #fc8c84;
        }

        .cstat-yes { color: #111; }
        .cstat-no { background: #fc8c84; color: #111; }
        .fstat-no { background: #ffc520; color: #111 !important; }
        .cbranch-no { background:  yellow !important; color: #111; }

        .cstat-skip { background: #ddd; color: #111; }
        .fstat-skip { background: #ddd; color: #111 !important; }
        .cbranch-skip { background: #ddd !important; color: #111; }

        .missing-if-branch {
            display: inline-block;
            margin-right: 10px;
            position: relative;
            padding: 0 4px;
            background: black;
            color: yellow;
        }

        .skip-if-branch {
            display: none;
            margin-right: 10px;
            position: relative;
            padding: 0 4px;
            background: #ccc;
            color: white;
        }

        .missing-if-branch .typ, .skip-if-branch .typ {
            color: inherit !important;
        }

        .entity, .metric { font-weight: bold; }
        .metric { display: inline-block; border: 1px solid #333; padding: 0.3em; background: white; }
        .metric small { font-size: 80%; font-weight: normal; color: #666; }

        div.coverage-summary table { border-collapse: collapse; margin: 3em; font-size: 110%; }
        div.coverage-summary td, div.coverage-summary table  th { margin: 0; padding: 0.25em 1em; border-top: 1px solid #666; border-bottom: 1px solid #666; }
        div.coverage-summary th { text-align: left; border: 1px solid #666; background: #eee; font-weight: normal; }
        div.coverage-summary th.file { border-right: none !important; }
        div.coverage-summary th.pic { border-left: none !important; text-align: right; }
        div.coverage-summary th.pct { border-right: none !important; }
        div.coverage-summary th.abs { border-left: none !important; text-align: right; }
        div.coverage-summary td.pct { text-align: right; border-left: 1px solid #666; }
        div.coverage-summary td.abs { text-align: right; font-size: 90%; color: #444; border-right: 1px solid #666; }
        div.coverage-summary td.file { text-align: right; border-left: 1px solid #666; white-space: nowrap;  }
        div.coverage-summary td.pic { min-width: 120px !important;  }
        div.coverage-summary a:link { color: #000; }
        div.coverage-summary a:visited { color: #333; }
        div.coverage-summary tfoot td { border-top: 1px solid #666; }

        div.coverage-summary .yui3-datatable-sort-indicator, div.coverage-summary .dummy-sort-indicator {
            height: 10px;
            width: 7px;
            display: inline-block;
            margin-left: 0.5em;
        }
        div.coverage-summary .yui3-datatable-sort-indicator {
            background: no-repeat scroll 0 0 transparent;
        }
        div.coverage-summary .yui3-datatable-sorted .yui3-datatable-sort-indicator {
            background-position: 0 -20px;
        }
        div.coverage-summary .yui3-datatable-sorted-desc .yui3-datatable-sort-indicator {
            background-position: 0 -10px;
        }

        .high { background: #b5d592 !important; }
        .medium { background: #ffe87c !important; }
        .low { background: #fc8c84 !important; }

        span.cover-fill, span.cover-empty {
            display:inline-block;
            border:1px solid #444;
            background: white;
            height: 12px;
        }
        span.cover-fill {
            background: #ccc;
            border-right: 1px solid #444;
        }
        span.cover-empty {
            background: white;
            border-left: none;
        }
        span.cover-full {
            border-right: none !important;
        }
        pre.prettyprint {
            border: none !important;
            padding: 0 !important;
            margin: 0 !important;
        }
        .com { color: #999 !important; }
        .ignore-none { color: #999; font-weight: normal; }

    </style>
</head>
<body>
<div class="header low">
    <h1 style="font-weight: bold;">
        <a href="https://github.com/npmtest/node-npmtest-node-red">npmtest-node-red (v0.0.1)</a>
    </h1>
    <h1>Code coverage report for <span class="entity">node-npmtest-node-red/node-red/red/api/auth/</span></h1>
    <h2>
        
        Statements: <span class="metric">29.69% <small>(76 / 256)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        
        Branches: <span class="metric">1.96% <small>(2 / 102)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        
        Functions: <span class="metric">1.96% <small>(1 / 51)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        
        Lines: <span class="metric">29.53% <small>(75 / 254)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        Ignored: <span class="metric">2 branches</span> &nbsp;&nbsp;&nbsp;&nbsp;
    </h2>
    <div class="path"><a href="../../../../../index.html">All files</a> &#187; node-npmtest-node-red/node-red/red/api/auth/</div>
</div>
<div class="body">
<div class="coverage-summary">
<table>
<thead>
<tr>
   <th data-col="file" data-fmt="html" data-html="true" class="file">File</th>
   <th data-col="pic" data-type="number" data-fmt="html" data-html="true" class="pic"></th>
   <th data-col="statements" data-type="number" data-fmt="pct" class="pct">Statements</th>
   <th data-col="statements_raw" data-type="number" data-fmt="html" class="abs"></th>
   <th data-col="branches" data-type="number" data-fmt="pct" class="pct">Branches</th>
   <th data-col="branches_raw" data-type="number" data-fmt="html" class="abs"></th>
   <th data-col="functions" data-type="number" data-fmt="pct" class="pct">Functions</th>
   <th data-col="functions_raw" data-type="number" data-fmt="html" class="abs"></th>
   <th data-col="lines" data-type="number" data-fmt="pct" class="pct">Lines</th>
   <th data-col="lines_raw" data-type="number" data-fmt="html" class="abs"></th>
</tr>
</thead>
<tbody><tr>
	<td class="file low" data-value="clients.js"><a href="clients.js.html">clients.js</a></td>
	<td data-value="42.86" class="pic low"><span class="cover-fill" style="width: 42px;"></span><span class="cover-empty" style="width:58px;"></span></td>
	<td data-value="42.86" class="pct low">42.86%</td>
	<td data-value="7" class="abs low">(3&nbsp;/&nbsp;7)</td>
	<td data-value="0" class="pct low">0%</td>
	<td data-value="2" class="abs low">(0&nbsp;/&nbsp;2)</td>
	<td data-value="0" class="pct low">0%</td>
	<td data-value="1" class="abs low">(0&nbsp;/&nbsp;1)</td>
	<td data-value="42.86" class="pct low">42.86%</td>
	<td data-value="7" class="abs low">(3&nbsp;/&nbsp;7)</td>
	</tr>

<tr>
	<td class="file low" data-value="index.js"><a href="index.js.html">index.js</a></td>
	<td data-value="40.74" class="pic low"><span class="cover-fill" style="width: 40px;"></span><span class="cover-empty" style="width:60px;"></span></td>
	<td data-value="40.74" class="pct low">40.74%</td>
	<td data-value="54" class="abs low">(22&nbsp;/&nbsp;54)</td>
	<td data-value="0" class="pct low">0%</td>
	<td data-value="18" class="abs low">(0&nbsp;/&nbsp;18)</td>
	<td data-value="0" class="pct low">0%</td>
	<td data-value="11" class="abs low">(0&nbsp;/&nbsp;11)</td>
	<td data-value="40.74" class="pct low">40.74%</td>
	<td data-value="54" class="abs low">(22&nbsp;/&nbsp;54)</td>
	</tr>

<tr>
	<td class="file low" data-value="permissions.js"><a href="permissions.js.html">permissions.js</a></td>
	<td data-value="18.52" class="pic low"><span class="cover-fill" style="width: 18px;"></span><span class="cover-empty" style="width:82px;"></span></td>
	<td data-value="18.52" class="pct low">18.52%</td>
	<td data-value="27" class="abs low">(5&nbsp;/&nbsp;27)</td>
	<td data-value="0" class="pct low">0%</td>
	<td data-value="24" class="abs low">(0&nbsp;/&nbsp;24)</td>
	<td data-value="0" class="pct low">0%</td>
	<td data-value="1" class="abs low">(0&nbsp;/&nbsp;1)</td>
	<td data-value="18.52" class="pct low">18.52%</td>
	<td data-value="27" class="abs low">(5&nbsp;/&nbsp;27)</td>
	</tr>

<tr>
	<td class="file low" data-value="strategies.js"><a href="strategies.js.html">strategies.js</a></td>
	<td data-value="33.33" class="pic low"><span class="cover-fill" style="width: 33px;"></span><span class="cover-empty" style="width:67px;"></span></td>
	<td data-value="33.33" class="pct low">33.33%</td>
	<td data-value="69" class="abs low">(23&nbsp;/&nbsp;69)</td>
	<td data-value="5" class="pct low">5%</td>
	<td data-value="20" class="abs low">(1&nbsp;/&nbsp;20)</td>
	<td data-value="6.67" class="pct low">6.67%</td>
	<td data-value="15" class="abs low">(1&nbsp;/&nbsp;15)</td>
	<td data-value="33.33" class="pct low">33.33%</td>
	<td data-value="69" class="abs low">(23&nbsp;/&nbsp;69)</td>
	</tr>

<tr>
	<td class="file low" data-value="tokens.js"><a href="tokens.js.html">tokens.js</a></td>
	<td data-value="18" class="pic low"><span class="cover-fill" style="width: 18px;"></span><span class="cover-empty" style="width:82px;"></span></td>
	<td data-value="18" class="pct low">18%</td>
	<td data-value="50" class="abs low">(9&nbsp;/&nbsp;50)</td>
	<td data-value="0" class="pct low">0%</td>
	<td data-value="18" class="abs low">(0&nbsp;/&nbsp;18)</td>
	<td data-value="0" class="pct low">0%</td>
	<td data-value="13" class="abs low">(0&nbsp;/&nbsp;13)</td>
	<td data-value="18.37" class="pct low">18.37%</td>
	<td data-value="49" class="abs low">(9&nbsp;/&nbsp;49)</td>
	</tr>

<tr>
	<td class="file low" data-value="users.js"><a href="users.js.html">users.js</a></td>
	<td data-value="28.57" class="pic low"><span class="cover-fill" style="width: 28px;"></span><span class="cover-empty" style="width:72px;"></span></td>
	<td data-value="28.57" class="pct low">28.57%</td>
	<td data-value="49" class="abs low">(14&nbsp;/&nbsp;49)</td>
	<td data-value="5" class="pct low">5%</td>
	<td data-value="20" class="abs low">(1&nbsp;/&nbsp;20)</td>
	<td data-value="0" class="pct low">0%</td>
	<td data-value="10" class="abs low">(0&nbsp;/&nbsp;10)</td>
	<td data-value="27.08" class="pct low">27.08%</td>
	<td data-value="48" class="abs low">(13&nbsp;/&nbsp;48)</td>
	</tr>

</tbody>
</table>
</div></div>
<div class="footer">
    <div class="meta">Generated by <a href="https://github.com/kaizhu256/node-utility2" target="_blank">utility2</a> at Tue Apr 11 2017 17:25:15 GMT+0000 (UTC)</div>
</div>
</body>
</html>


<!doctype html>
<html lang="en">
<head>
    <title>Code coverage report for node-npmtest-node-red/node-red/red/api/auth/clients.js</title>
    <meta charset="utf-8">
    <style>
        body, html {
            margin:0; padding: 0;
        }
        body {
            font-family: Arial, Helvetica;
            font-size: 10pt;
        }
        div.header, div.footer {
            background: #eee;
            padding: 1em;
        }
        div.header {
            height: 160px;
            padding: 0 1em 0 1em;
            z-index: 100;
            position: fixed;
            top: 0;
            border-bottom: 1px solid #666;
            width: 100%;
        }
        div.footer {
            border-top: 1px solid #666;
        }
        div.body {
            margin-top: 170px;
        }
        div.meta {
            font-size: 90%;
            text-align: center;
        }
        h1, h2, h3 {
            font-weight: normal;
        }
        h1 {
            font-size: 12pt;
        }
        h2 {
            font-size: 10pt;
        }
        pre {
            font-family: Menlo, Monaco, Consolas, Courier New, monospace;
            margin: 0;
            padding: 0;
            font-size: 14px;
            tab-size: 2;
        }

        div.path { font-size: 110%; }
        div.path a:link, div.path a:visited { color: #000; }
        table.coverage { border-collapse: collapse; margin:0; padding: 0 }

        table.coverage td {
            margin: 0;
            padding: 0;
            color: #111;
            vertical-align: top;
        }
        table.coverage td.line-count {
            width: 50px;
            text-align: right;
            padding-right: 5px;
        }
        table.coverage td.line-coverage {
            color: #777 !important;
            text-align: right;
            border-left: 1px solid #666;
            border-right: 1px solid #666;
        }

        table.coverage td.text {
        }

        table.coverage td span.cline-any {
            display: inline-block;
            padding: 0 5px;
            width: 40px;
        }
        table.coverage td span.cline-neutral {
            background: #eee;
        }
        table.coverage td span.cline-yes {
            background: #b5d592;
            color: #999;
        }
        table.coverage td span.cline-no {
            background: #fc8c84;
        }

        .cstat-yes { color: #111; }
        .cstat-no { background: #fc8c84; color: #111; }
        .fstat-no { background: #ffc520; color: #111 !important; }
        .cbranch-no { background:  yellow !important; color: #111; }

        .cstat-skip { background: #ddd; color: #111; }
        .fstat-skip { background: #ddd; color: #111 !important; }
        .cbranch-skip { background: #ddd !important; color: #111; }

        .missing-if-branch {
            display: inline-block;
            margin-right: 10px;
            position: relative;
            padding: 0 4px;
            background: black;
            color: yellow;
        }

        .skip-if-branch {
            display: none;
            margin-right: 10px;
            position: relative;
            padding: 0 4px;
            background: #ccc;
            color: white;
        }

        .missing-if-branch .typ, .skip-if-branch .typ {
            color: inherit !important;
        }

        .entity, .metric { font-weight: bold; }
        .metric { display: inline-block; border: 1px solid #333; padding: 0.3em; background: white; }
        .metric small { font-size: 80%; font-weight: normal; color: #666; }

        div.coverage-summary table { border-collapse: collapse; margin: 3em; font-size: 110%; }
        div.coverage-summary td, div.coverage-summary table  th { margin: 0; padding: 0.25em 1em; border-top: 1px solid #666; border-bottom: 1px solid #666; }
        div.coverage-summary th { text-align: left; border: 1px solid #666; background: #eee; font-weight: normal; }
        div.coverage-summary th.file { border-right: none !important; }
        div.coverage-summary th.pic { border-left: none !important; text-align: right; }
        div.coverage-summary th.pct { border-right: none !important; }
        div.coverage-summary th.abs { border-left: none !important; text-align: right; }
        div.coverage-summary td.pct { text-align: right; border-left: 1px solid #666; }
        div.coverage-summary td.abs { text-align: right; font-size: 90%; color: #444; border-right: 1px solid #666; }
        div.coverage-summary td.file { text-align: right; border-left: 1px solid #666; white-space: nowrap;  }
        div.coverage-summary td.pic { min-width: 120px !important;  }
        div.coverage-summary a:link { color: #000; }
        div.coverage-summary a:visited { color: #333; }
        div.coverage-summary tfoot td { border-top: 1px solid #666; }

        div.coverage-summary .yui3-datatable-sort-indicator, div.coverage-summary .dummy-sort-indicator {
            height: 10px;
            width: 7px;
            display: inline-block;
            margin-left: 0.5em;
        }
        div.coverage-summary .yui3-datatable-sort-indicator {
            background: no-repeat scroll 0 0 transparent;
        }
        div.coverage-summary .yui3-datatable-sorted .yui3-datatable-sort-indicator {
            background-position: 0 -20px;
        }
        div.coverage-summary .yui3-datatable-sorted-desc .yui3-datatable-sort-indicator {
            background-position: 0 -10px;
        }

        .high { background: #b5d592 !important; }
        .medium { background: #ffe87c !important; }
        .low { background: #fc8c84 !important; }

        span.cover-fill, span.cover-empty {
            display:inline-block;
            border:1px solid #444;
            background: white;
            height: 12px;
        }
        span.cover-fill {
            background: #ccc;
            border-right: 1px solid #444;
        }
        span.cover-empty {
            background: white;
            border-left: none;
        }
        span.cover-full {
            border-right: none !important;
        }
        pre.prettyprint {
            border: none !important;
            padding: 0 !important;
            margin: 0 !important;
        }
        .com { color: #999 !important; }
        .ignore-none { color: #999; font-weight: normal; }

    </style>
</head>
<body>
<div class="header low">
    <h1 style="font-weight: bold;">
        <a href="https://github.com/npmtest/node-npmtest-node-red">npmtest-node-red (v0.0.1)</a>
    </h1>
    <h1>Code coverage report for <span class="entity">node-npmtest-node-red/node-red/red/api/auth/clients.js</span></h1>
    <h2>
        
        Statements: <span class="metric">42.86% <small>(3 / 7)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        
        Branches: <span class="metric">0% <small>(0 / 2)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        
        Functions: <span class="metric">0% <small>(0 / 1)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        
        Lines: <span class="metric">42.86% <small>(3 / 7)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        Ignored: <span class="metric"><span class="ignore-none">none</span></span> &nbsp;&nbsp;&nbsp;&nbsp;
    </h2>
    <div class="path"><a href="../../../../../index.html">All files</a> &#187; <a href="index.html">node-npmtest-node-red/node-red/red/api/auth/</a> &#187; clients.js</div>
</div>
<div class="body">
<pre><table class="coverage">
<tr><td class="line-count">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35</td><td class="line-coverage"><span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span></td><td class="text"><pre class="prettyprint lang-js">/**
 * Copyright JS Foundation and other contributors, http://js.foundation
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 **/
 
var when = require("when");
&nbsp;
var clients = [
    {id:"node-red-editor",secret:"not_available"},
    {id:"node-red-admin",secret:"not_available"}
];
&nbsp;
module.exports = {
    get: <span class="fstat-no" title="function not covered" >function(id) {</span>
<span class="cstat-no" title="statement not covered" >        for (var i=0;i&lt;clients.length;i++) {</span>
<span class="cstat-no" title="statement not covered" >            if (clients[i].id == id) {</span>
<span class="cstat-no" title="statement not covered" >                return when.resolve(clients[i]);</span>
            }
        }
<span class="cstat-no" title="statement not covered" >        return when.resolve(null);</span>
    }
}
&nbsp;
&nbsp;</pre></td></tr>
</table></pre>
</div>
<div class="footer">
    <div class="meta">Generated by <a href="https://github.com/kaizhu256/node-utility2" target="_blank">utility2</a> at Tue Apr 11 2017 17:25:15 GMT+0000 (UTC)</div>
</div>
</body>
</html>


<!doctype html>
<html lang="en">
<head>
    <title>Code coverage report for node-npmtest-node-red/node-red/red/api/auth/index.js</title>
    <meta charset="utf-8">
    <style>
        body, html {
            margin:0; padding: 0;
        }
        body {
            font-family: Arial, Helvetica;
            font-size: 10pt;
        }
        div.header, div.footer {
            background: #eee;
            padding: 1em;
        }
        div.header {
            height: 160px;
            padding: 0 1em 0 1em;
            z-index: 100;
            position: fixed;
            top: 0;
            border-bottom: 1px solid #666;
            width: 100%;
        }
        div.footer {
            border-top: 1px solid #666;
        }
        div.body {
            margin-top: 170px;
        }
        div.meta {
            font-size: 90%;
            text-align: center;
        }
        h1, h2, h3 {
            font-weight: normal;
        }
        h1 {
            font-size: 12pt;
        }
        h2 {
            font-size: 10pt;
        }
        pre {
            font-family: Menlo, Monaco, Consolas, Courier New, monospace;
            margin: 0;
            padding: 0;
            font-size: 14px;
            tab-size: 2;
        }

        div.path { font-size: 110%; }
        div.path a:link, div.path a:visited { color: #000; }
        table.coverage { border-collapse: collapse; margin:0; padding: 0 }

        table.coverage td {
            margin: 0;
            padding: 0;
            color: #111;
            vertical-align: top;
        }
        table.coverage td.line-count {
            width: 50px;
            text-align: right;
            padding-right: 5px;
        }
        table.coverage td.line-coverage {
            color: #777 !important;
            text-align: right;
            border-left: 1px solid #666;
            border-right: 1px solid #666;
        }

        table.coverage td.text {
        }

        table.coverage td span.cline-any {
            display: inline-block;
            padding: 0 5px;
            width: 40px;
        }
        table.coverage td span.cline-neutral {
            background: #eee;
        }
        table.coverage td span.cline-yes {
            background: #b5d592;
            color: #999;
        }
        table.coverage td span.cline-no {
            background: #fc8c84;
        }

        .cstat-yes { color: #111; }
        .cstat-no { background: #fc8c84; color: #111; }
        .fstat-no { background: #ffc520; color: #111 !important; }
        .cbranch-no { background:  yellow !important; color: #111; }

        .cstat-skip { background: #ddd; color: #111; }
        .fstat-skip { background: #ddd; color: #111 !important; }
        .cbranch-skip { background: #ddd !important; color: #111; }

        .missing-if-branch {
            display: inline-block;
            margin-right: 10px;
            position: relative;
            padding: 0 4px;
            background: black;
            color: yellow;
        }

        .skip-if-branch {
            display: none;
            margin-right: 10px;
            position: relative;
            padding: 0 4px;
            background: #ccc;
            color: white;
        }

        .missing-if-branch .typ, .skip-if-branch .typ {
            color: inherit !important;
        }

        .entity, .metric { font-weight: bold; }
        .metric { display: inline-block; border: 1px solid #333; padding: 0.3em; background: white; }
        .metric small { font-size: 80%; font-weight: normal; color: #666; }

        div.coverage-summary table { border-collapse: collapse; margin: 3em; font-size: 110%; }
        div.coverage-summary td, div.coverage-summary table  th { margin: 0; padding: 0.25em 1em; border-top: 1px solid #666; border-bottom: 1px solid #666; }
        div.coverage-summary th { text-align: left; border: 1px solid #666; background: #eee; font-weight: normal; }
        div.coverage-summary th.file { border-right: none !important; }
        div.coverage-summary th.pic { border-left: none !important; text-align: right; }
        div.coverage-summary th.pct { border-right: none !important; }
        div.coverage-summary th.abs { border-left: none !important; text-align: right; }
        div.coverage-summary td.pct { text-align: right; border-left: 1px solid #666; }
        div.coverage-summary td.abs { text-align: right; font-size: 90%; color: #444; border-right: 1px solid #666; }
        div.coverage-summary td.file { text-align: right; border-left: 1px solid #666; white-space: nowrap;  }
        div.coverage-summary td.pic { min-width: 120px !important;  }
        div.coverage-summary a:link { color: #000; }
        div.coverage-summary a:visited { color: #333; }
        div.coverage-summary tfoot td { border-top: 1px solid #666; }

        div.coverage-summary .yui3-datatable-sort-indicator, div.coverage-summary .dummy-sort-indicator {
            height: 10px;
            width: 7px;
            display: inline-block;
            margin-left: 0.5em;
        }
        div.coverage-summary .yui3-datatable-sort-indicator {
            background: no-repeat scroll 0 0 transparent;
        }
        div.coverage-summary .yui3-datatable-sorted .yui3-datatable-sort-indicator {
            background-position: 0 -20px;
        }
        div.coverage-summary .yui3-datatable-sorted-desc .yui3-datatable-sort-indicator {
            background-position: 0 -10px;
        }

        .high { background: #b5d592 !important; }
        .medium { background: #ffe87c !important; }
        .low { background: #fc8c84 !important; }

        span.cover-fill, span.cover-empty {
            display:inline-block;
            border:1px solid #444;
            background: white;
            height: 12px;
        }
        span.cover-fill {
            background: #ccc;
            border-right: 1px solid #444;
        }
        span.cover-empty {
            background: white;
            border-left: none;
        }
        span.cover-full {
            border-right: none !important;
        }
        pre.prettyprint {
            border: none !important;
            padding: 0 !important;
            margin: 0 !important;
        }
        .com { color: #999 !important; }
        .ignore-none { color: #999; font-weight: normal; }

    </style>
</head>
<body>
<div class="header low">
    <h1 style="font-weight: bold;">
        <a href="https://github.com/npmtest/node-npmtest-node-red">npmtest-node-red (v0.0.1)</a>
    </h1>
    <h1>Code coverage report for <span class="entity">node-npmtest-node-red/node-red/red/api/auth/index.js</span></h1>
    <h2>
        
        Statements: <span class="metric">40.74% <small>(22 / 54)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        
        Branches: <span class="metric">0% <small>(0 / 18)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        
        Functions: <span class="metric">0% <small>(0 / 11)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        
        Lines: <span class="metric">40.74% <small>(22 / 54)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        Ignored: <span class="metric"><span class="ignore-none">none</span></span> &nbsp;&nbsp;&nbsp;&nbsp;
    </h2>
    <div class="path"><a href="../../../../../index.html">All files</a> &#187; <a href="index.html">node-npmtest-node-red/node-red/red/api/auth/</a> &#187; index.js</div>
</div>
<div class="body">
<pre><table class="coverage">
<tr><td class="line-count">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120</td><td class="line-coverage"><span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span></td><td class="text"><pre class="prettyprint lang-js">/**
 * Copyright JS Foundation and other contributors, http://js.foundation
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 **/
&nbsp;
var passport = require("passport");
var oauth2orize = require("oauth2orize");
&nbsp;
var strategies = require("./strategies");
var Tokens = require("./tokens");
var Users = require("./users");
var permissions = require("./permissions");
&nbsp;
var theme = require("../theme");
&nbsp;
var settings = null;
var log = null
&nbsp;
&nbsp;
passport.use(strategies.bearerStrategy.BearerStrategy);
passport.use(strategies.clientPasswordStrategy.ClientPasswordStrategy);
passport.use(strategies.anonymousStrategy);
&nbsp;
var server = oauth2orize.createServer();
&nbsp;
server.exchange(oauth2orize.exchange.password(strategies.passwordTokenExchange));
&nbsp;
<span class="fstat-no" title="function not covered" >function init(runtime) {</span>
<span class="cstat-no" title="statement not covered" >    settings = runtime.settings;</span>
<span class="cstat-no" title="statement not covered" >    log = runtime.log;</span>
<span class="cstat-no" title="statement not covered" >    if (settings.adminAuth) {</span>
<span class="cstat-no" title="statement not covered" >        Users.init(settings.adminAuth);</span>
<span class="cstat-no" title="statement not covered" >        Tokens.init(settings.adminAuth,runtime.storage);</span>
<span class="cstat-no" title="statement not covered" >        strategies.init(runtime);</span>
    }
}
&nbsp;
<span class="fstat-no" title="function not covered" >function needsPermission(permission) {</span>
<span class="cstat-no" title="statement not covered" >    return <span class="fstat-no" title="function not covered" >function(req,res,next) {</span></span>
<span class="cstat-no" title="statement not covered" >        if (settings &amp;&amp; settings.adminAuth) {</span>
<span class="cstat-no" title="statement not covered" >            return passport.authenticate(['bearer','anon'],{ session: false })(req,res,<span class="fstat-no" title="function not covered" >function() {</span></span>
<span class="cstat-no" title="statement not covered" >                if (!req.user) {</span>
<span class="cstat-no" title="statement not covered" >                    return next();</span>
                }
<span class="cstat-no" title="statement not covered" >                if (permissions.hasPermission(req.authInfo.scope,permission)) {</span>
<span class="cstat-no" title="statement not covered" >                    return next();</span>
                }
<span class="cstat-no" title="statement not covered" >                log.audit({event: "permission.fail", permissions: permission},req);</span>
<span class="cstat-no" title="statement not covered" >                return res.status(401).end();</span>
            });
        } else {
<span class="cstat-no" title="statement not covered" >            next();</span>
        }
    }
}
&nbsp;
<span class="fstat-no" title="function not covered" >function ensureClientSecret(req,res,next) {</span>
<span class="cstat-no" title="statement not covered" >    if (!req.body.client_secret) {</span>
<span class="cstat-no" title="statement not covered" >        req.body.client_secret = 'not_available';</span>
    }
<span class="cstat-no" title="statement not covered" >    next();</span>
}
<span class="fstat-no" title="function not covered" >function authenticateClient(req,res,next) {</span>
<span class="cstat-no" title="statement not covered" >    return passport.authenticate(['oauth2-client-password'], {session: false})(req,res,next);</span>
}
<span class="fstat-no" title="function not covered" >function getToken(req,res,next) {</span>
<span class="cstat-no" title="statement not covered" >    return server.token()(req,res,next);</span>
}
&nbsp;
<span class="fstat-no" title="function not covered" >function login(req,res) {</span>
<span class="cstat-no" title="statement not covered" >    var response = {};</span>
<span class="cstat-no" title="statement not covered" >    if (settings.adminAuth) {</span>
<span class="cstat-no" title="statement not covered" >        response = {</span>
            "type":"credentials",
            "prompts":[{id:"username",type:"text",label:"Username"},{id:"password",type:"password",label:"Password"}]
        }
<span class="cstat-no" title="statement not covered" >        if (theme.context().login &amp;&amp; theme.context().login.image) {</span>
<span class="cstat-no" title="statement not covered" >            response.image = theme.context().login.image;</span>
        }
    }
<span class="cstat-no" title="statement not covered" >    res.json(response);</span>
}
&nbsp;
<span class="fstat-no" title="function not covered" >function revoke(req,res) {</span>
<span class="cstat-no" title="statement not covered" >    var token = req.body.token;</span>
    // TODO: audit log
<span class="cstat-no" title="statement not covered" >    Tokens.revoke(token).then(<span class="fstat-no" title="function not covered" >function() {</span></span>
<span class="cstat-no" title="statement not covered" >        log.audit({event: "auth.login.revoke"},req);</span>
<span class="cstat-no" title="statement not covered" >        res.status(200).end();</span>
    });
}
&nbsp;
module.exports = {
    init: init,
    needsPermission: needsPermission,
    ensureClientSecret: ensureClientSecret,
    authenticateClient: authenticateClient,
    getToken: getToken,
    errorHandler: <span class="fstat-no" title="function not covered" >function(err,req,res,next) {</span>
        //TODO: audit log statment
        //console.log(err.stack);
        //log.log({level:"audit",type:"auth",msg:err.toString()});
<span class="cstat-no" title="statement not covered" >        return server.errorHandler()(err,req,res,next);</span>
    },
    login: login,
    revoke: revoke
}
&nbsp;
&nbsp;</pre></td></tr>
</table></pre>
</div>
<div class="footer">
    <div class="meta">Generated by <a href="https://github.com/kaizhu256/node-utility2" target="_blank">utility2</a> at Tue Apr 11 2017 17:25:15 GMT+0000 (UTC)</div>
</div>
</body>
</html>


<!doctype html>
<html lang="en">
<head>
    <title>Code coverage report for node-npmtest-node-red/node-red/red/api/auth/permissions.js</title>
    <meta charset="utf-8">
    <style>
        body, html {
            margin:0; padding: 0;
        }
        body {
            font-family: Arial, Helvetica;
            font-size: 10pt;
        }
        div.header, div.footer {
            background: #eee;
            padding: 1em;
        }
        div.header {
            height: 160px;
            padding: 0 1em 0 1em;
            z-index: 100;
            position: fixed;
            top: 0;
            border-bottom: 1px solid #666;
            width: 100%;
        }
        div.footer {
            border-top: 1px solid #666;
        }
        div.body {
            margin-top: 170px;
        }
        div.meta {
            font-size: 90%;
            text-align: center;
        }
        h1, h2, h3 {
            font-weight: normal;
        }
        h1 {
            font-size: 12pt;
        }
        h2 {
            font-size: 10pt;
        }
        pre {
            font-family: Menlo, Monaco, Consolas, Courier New, monospace;
            margin: 0;
            padding: 0;
            font-size: 14px;
            tab-size: 2;
        }

        div.path { font-size: 110%; }
        div.path a:link, div.path a:visited { color: #000; }
        table.coverage { border-collapse: collapse; margin:0; padding: 0 }

        table.coverage td {
            margin: 0;
            padding: 0;
            color: #111;
            vertical-align: top;
        }
        table.coverage td.line-count {
            width: 50px;
            text-align: right;
            padding-right: 5px;
        }
        table.coverage td.line-coverage {
            color: #777 !important;
            text-align: right;
            border-left: 1px solid #666;
            border-right: 1px solid #666;
        }

        table.coverage td.text {
        }

        table.coverage td span.cline-any {
            display: inline-block;
            padding: 0 5px;
            width: 40px;
        }
        table.coverage td span.cline-neutral {
            background: #eee;
        }
        table.coverage td span.cline-yes {
            background: #b5d592;
            color: #999;
        }
        table.coverage td span.cline-no {
            background: #fc8c84;
        }

        .cstat-yes { color: #111; }
        .cstat-no { background: #fc8c84; color: #111; }
        .fstat-no { background: #ffc520; color: #111 !important; }
        .cbranch-no { background:  yellow !important; color: #111; }

        .cstat-skip { background: #ddd; color: #111; }
        .fstat-skip { background: #ddd; color: #111 !important; }
        .cbranch-skip { background: #ddd !important; color: #111; }

        .missing-if-branch {
            display: inline-block;
            margin-right: 10px;
            position: relative;
            padding: 0 4px;
            background: black;
            color: yellow;
        }

        .skip-if-branch {
            display: none;
            margin-right: 10px;
            position: relative;
            padding: 0 4px;
            background: #ccc;
            color: white;
        }

        .missing-if-branch .typ, .skip-if-branch .typ {
            color: inherit !important;
        }

        .entity, .metric { font-weight: bold; }
        .metric { display: inline-block; border: 1px solid #333; padding: 0.3em; background: white; }
        .metric small { font-size: 80%; font-weight: normal; color: #666; }

        div.coverage-summary table { border-collapse: collapse; margin: 3em; font-size: 110%; }
        div.coverage-summary td, div.coverage-summary table  th { margin: 0; padding: 0.25em 1em; border-top: 1px solid #666; border-bottom: 1px solid #666; }
        div.coverage-summary th { text-align: left; border: 1px solid #666; background: #eee; font-weight: normal; }
        div.coverage-summary th.file { border-right: none !important; }
        div.coverage-summary th.pic { border-left: none !important; text-align: right; }
        div.coverage-summary th.pct { border-right: none !important; }
        div.coverage-summary th.abs { border-left: none !important; text-align: right; }
        div.coverage-summary td.pct { text-align: right; border-left: 1px solid #666; }
        div.coverage-summary td.abs { text-align: right; font-size: 90%; color: #444; border-right: 1px solid #666; }
        div.coverage-summary td.file { text-align: right; border-left: 1px solid #666; white-space: nowrap;  }
        div.coverage-summary td.pic { min-width: 120px !important;  }
        div.coverage-summary a:link { color: #000; }
        div.coverage-summary a:visited { color: #333; }
        div.coverage-summary tfoot td { border-top: 1px solid #666; }

        div.coverage-summary .yui3-datatable-sort-indicator, div.coverage-summary .dummy-sort-indicator {
            height: 10px;
            width: 7px;
            display: inline-block;
            margin-left: 0.5em;
        }
        div.coverage-summary .yui3-datatable-sort-indicator {
            background: no-repeat scroll 0 0 transparent;
        }
        div.coverage-summary .yui3-datatable-sorted .yui3-datatable-sort-indicator {
            background-position: 0 -20px;
        }
        div.coverage-summary .yui3-datatable-sorted-desc .yui3-datatable-sort-indicator {
            background-position: 0 -10px;
        }

        .high { background: #b5d592 !important; }
        .medium { background: #ffe87c !important; }
        .low { background: #fc8c84 !important; }

        span.cover-fill, span.cover-empty {
            display:inline-block;
            border:1px solid #444;
            background: white;
            height: 12px;
        }
        span.cover-fill {
            background: #ccc;
            border-right: 1px solid #444;
        }
        span.cover-empty {
            background: white;
            border-left: none;
        }
        span.cover-full {
            border-right: none !important;
        }
        pre.prettyprint {
            border: none !important;
            padding: 0 !important;
            margin: 0 !important;
        }
        .com { color: #999 !important; }
        .ignore-none { color: #999; font-weight: normal; }

    </style>
</head>
<body>
<div class="header low">
    <h1 style="font-weight: bold;">
        <a href="https://github.com/npmtest/node-npmtest-node-red">npmtest-node-red (v0.0.1)</a>
    </h1>
    <h1>Code coverage report for <span class="entity">node-npmtest-node-red/node-red/red/api/auth/permissions.js</span></h1>
    <h2>
        
        Statements: <span class="metric">18.52% <small>(5 / 27)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        
        Branches: <span class="metric">0% <small>(0 / 24)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        
        Functions: <span class="metric">0% <small>(0 / 1)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        
        Lines: <span class="metric">18.52% <small>(5 / 27)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        Ignored: <span class="metric"><span class="ignore-none">none</span></span> &nbsp;&nbsp;&nbsp;&nbsp;
    </h2>
    <div class="path"><a href="../../../../../index.html">All files</a> &#187; <a href="index.html">node-npmtest-node-red/node-red/red/api/auth/</a> &#187; permissions.js</div>
</div>
<div class="body">
<pre><table class="coverage">
<tr><td class="line-count">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67</td><td class="line-coverage"><span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span></td><td class="text"><pre class="prettyprint lang-js">/**
 * Copyright JS Foundation and other contributors, http://js.foundation
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 **/
&nbsp;
var util = require('util');
&nbsp;
var readRE = /^((.+)\.)?read$/
var writeRE = /^((.+)\.)?write$/
&nbsp;
<span class="fstat-no" title="function not covered" >function hasPermission(userScope,permission) {</span>
<span class="cstat-no" title="statement not covered" >    if (permission === "") {</span>
<span class="cstat-no" title="statement not covered" >        return true;</span>
    }
<span class="cstat-no" title="statement not covered" >    var i;</span>
&nbsp;
<span class="cstat-no" title="statement not covered" >    if (util.isArray(permission)) {</span>
        // Multiple permissions requested - check each one
<span class="cstat-no" title="statement not covered" >        for (i=0;i&lt;permission.length;i++) {</span>
<span class="cstat-no" title="statement not covered" >            if (!hasPermission(userScope,permission[i])) {</span>
<span class="cstat-no" title="statement not covered" >                return false;</span>
            }
        }
        // All permissions check out
<span class="cstat-no" title="statement not covered" >        return true;</span>
    }
&nbsp;
<span class="cstat-no" title="statement not covered" >    if (util.isArray(userScope)) {</span>
<span class="cstat-no" title="statement not covered" >        if (userScope.length === 0) {</span>
<span class="cstat-no" title="statement not covered" >            return false;</span>
        }
<span class="cstat-no" title="statement not covered" >        for (i=0;i&lt;userScope.length;i++) {</span>
<span class="cstat-no" title="statement not covered" >            if (hasPermission(userScope[i],permission)) {</span>
<span class="cstat-no" title="statement not covered" >                return true;</span>
            }
        }
<span class="cstat-no" title="statement not covered" >        return false;</span>
    }
&nbsp;
<span class="cstat-no" title="statement not covered" >    if (userScope === "*" || userScope === permission) {</span>
<span class="cstat-no" title="statement not covered" >        return true;</span>
    }
&nbsp;
<span class="cstat-no" title="statement not covered" >    if (userScope === "read" || userScope === "*.read") {</span>
<span class="cstat-no" title="statement not covered" >        return readRE.test(permission);</span>
    } else <span class="cstat-no" title="statement not covered" >if (userScope === "write" || userScope === "*.write") {</span>
<span class="cstat-no" title="statement not covered" >        return writeRE.test(permission);</span>
    }
<span class="cstat-no" title="statement not covered" >    return false;</span>
}
&nbsp;
module.exports = {
    hasPermission: hasPermission,
}
&nbsp;
&nbsp;</pre></td></tr>
</table></pre>
</div>
<div class="footer">
    <div class="meta">Generated by <a href="https://github.com/kaizhu256/node-utility2" target="_blank">utility2</a> at Tue Apr 11 2017 17:25:15 GMT+0000 (UTC)</div>
</div>
</body>
</html>


<!doctype html>
<html lang="en">
<head>
    <title>Code coverage report for node-npmtest-node-red/node-red/red/api/auth/strategies.js</title>
    <meta charset="utf-8">
    <style>
        body, html {
            margin:0; padding: 0;
        }
        body {
            font-family: Arial, Helvetica;
            font-size: 10pt;
        }
        div.header, div.footer {
            background: #eee;
            padding: 1em;
        }
        div.header {
            height: 160px;
            padding: 0 1em 0 1em;
            z-index: 100;
            position: fixed;
            top: 0;
            border-bottom: 1px solid #666;
            width: 100%;
        }
        div.footer {
            border-top: 1px solid #666;
        }
        div.body {
            margin-top: 170px;
        }
        div.meta {
            font-size: 90%;
            text-align: center;
        }
        h1, h2, h3 {
            font-weight: normal;
        }
        h1 {
            font-size: 12pt;
        }
        h2 {
            font-size: 10pt;
        }
        pre {
            font-family: Menlo, Monaco, Consolas, Courier New, monospace;
            margin: 0;
            padding: 0;
            font-size: 14px;
            tab-size: 2;
        }

        div.path { font-size: 110%; }
        div.path a:link, div.path a:visited { color: #000; }
        table.coverage { border-collapse: collapse; margin:0; padding: 0 }

        table.coverage td {
            margin: 0;
            padding: 0;
            color: #111;
            vertical-align: top;
        }
        table.coverage td.line-count {
            width: 50px;
            text-align: right;
            padding-right: 5px;
        }
        table.coverage td.line-coverage {
            color: #777 !important;
            text-align: right;
            border-left: 1px solid #666;
            border-right: 1px solid #666;
        }

        table.coverage td.text {
        }

        table.coverage td span.cline-any {
            display: inline-block;
            padding: 0 5px;
            width: 40px;
        }
        table.coverage td span.cline-neutral {
            background: #eee;
        }
        table.coverage td span.cline-yes {
            background: #b5d592;
            color: #999;
        }
        table.coverage td span.cline-no {
            background: #fc8c84;
        }

        .cstat-yes { color: #111; }
        .cstat-no { background: #fc8c84; color: #111; }
        .fstat-no { background: #ffc520; color: #111 !important; }
        .cbranch-no { background:  yellow !important; color: #111; }

        .cstat-skip { background: #ddd; color: #111; }
        .fstat-skip { background: #ddd; color: #111 !important; }
        .cbranch-skip { background: #ddd !important; color: #111; }

        .missing-if-branch {
            display: inline-block;
            margin-right: 10px;
            position: relative;
            padding: 0 4px;
            background: black;
            color: yellow;
        }

        .skip-if-branch {
            display: none;
            margin-right: 10px;
            position: relative;
            padding: 0 4px;
            background: #ccc;
            color: white;
        }

        .missing-if-branch .typ, .skip-if-branch .typ {
            color: inherit !important;
        }

        .entity, .metric { font-weight: bold; }
        .metric { display: inline-block; border: 1px solid #333; padding: 0.3em; background: white; }
        .metric small { font-size: 80%; font-weight: normal; color: #666; }

        div.coverage-summary table { border-collapse: collapse; margin: 3em; font-size: 110%; }
        div.coverage-summary td, div.coverage-summary table  th { margin: 0; padding: 0.25em 1em; border-top: 1px solid #666; border-bottom: 1px solid #666; }
        div.coverage-summary th { text-align: left; border: 1px solid #666; background: #eee; font-weight: normal; }
        div.coverage-summary th.file { border-right: none !important; }
        div.coverage-summary th.pic { border-left: none !important; text-align: right; }
        div.coverage-summary th.pct { border-right: none !important; }
        div.coverage-summary th.abs { border-left: none !important; text-align: right; }
        div.coverage-summary td.pct { text-align: right; border-left: 1px solid #666; }
        div.coverage-summary td.abs { text-align: right; font-size: 90%; color: #444; border-right: 1px solid #666; }
        div.coverage-summary td.file { text-align: right; border-left: 1px solid #666; white-space: nowrap;  }
        div.coverage-summary td.pic { min-width: 120px !important;  }
        div.coverage-summary a:link { color: #000; }
        div.coverage-summary a:visited { color: #333; }
        div.coverage-summary tfoot td { border-top: 1px solid #666; }

        div.coverage-summary .yui3-datatable-sort-indicator, div.coverage-summary .dummy-sort-indicator {
            height: 10px;
            width: 7px;
            display: inline-block;
            margin-left: 0.5em;
        }
        div.coverage-summary .yui3-datatable-sort-indicator {
            background: no-repeat scroll 0 0 transparent;
        }
        div.coverage-summary .yui3-datatable-sorted .yui3-datatable-sort-indicator {
            background-position: 0 -20px;
        }
        div.coverage-summary .yui3-datatable-sorted-desc .yui3-datatable-sort-indicator {
            background-position: 0 -10px;
        }

        .high { background: #b5d592 !important; }
        .medium { background: #ffe87c !important; }
        .low { background: #fc8c84 !important; }

        span.cover-fill, span.cover-empty {
            display:inline-block;
            border:1px solid #444;
            background: white;
            height: 12px;
        }
        span.cover-fill {
            background: #ccc;
            border-right: 1px solid #444;
        }
        span.cover-empty {
            background: white;
            border-left: none;
        }
        span.cover-full {
            border-right: none !important;
        }
        pre.prettyprint {
            border: none !important;
            padding: 0 !important;
            margin: 0 !important;
        }
        .com { color: #999 !important; }
        .ignore-none { color: #999; font-weight: normal; }

    </style>
</head>
<body>
<div class="header low">
    <h1 style="font-weight: bold;">
        <a href="https://github.com/npmtest/node-npmtest-node-red">npmtest-node-red (v0.0.1)</a>
    </h1>
    <h1>Code coverage report for <span class="entity">node-npmtest-node-red/node-red/red/api/auth/strategies.js</span></h1>
    <h2>
        
        Statements: <span class="metric">33.33% <small>(23 / 69)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        
        Branches: <span class="metric">5% <small>(1 / 20)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        
        Functions: <span class="metric">6.67% <small>(1 / 15)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        
        Lines: <span class="metric">33.33% <small>(23 / 69)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        Ignored: <span class="metric">1 branch</span> &nbsp;&nbsp;&nbsp;&nbsp;
    </h2>
    <div class="path"><a href="../../../../../index.html">All files</a> &#187; <a href="index.html">node-npmtest-node-red/node-red/red/api/auth/</a> &#187; strategies.js</div>
</div>
<div class="body">
<pre><table class="coverage">
<tr><td class="line-count">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136</td><td class="line-coverage"><span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span></td><td class="text"><pre class="prettyprint lang-js">/**
 * Copyright JS Foundation and other contributors, http://js.foundation
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 **/
&nbsp;
var BearerStrategy = require('passport-http-bearer').Strategy;
var ClientPasswordStrategy = require('passport-oauth2-client-password').Strategy;
&nbsp;
var passport = require("passport");
var crypto = require("crypto");
var util = require("util");
&nbsp;
var Tokens = require("./tokens");
var Users = require("./users");
var Clients = require("./clients");
var permissions = require("./permissions");
&nbsp;
var log;
&nbsp;
var bearerStrategy = <span class="fstat-no" title="function not covered" >function (accessToken, done) {</span>
    // is this a valid token?
<span class="cstat-no" title="statement not covered" >    Tokens.get(accessToken).then(<span class="fstat-no" title="function not covered" >function(token) {</span></span>
<span class="cstat-no" title="statement not covered" >        if (token) {</span>
<span class="cstat-no" title="statement not covered" >            Users.get(token.user).then(<span class="fstat-no" title="function not covered" >function(user) {</span></span>
<span class="cstat-no" title="statement not covered" >                if (user) {</span>
<span class="cstat-no" title="statement not covered" >                    done(null,user,{scope:token.scope});</span>
                } else {
<span class="cstat-no" title="statement not covered" >                    log.audit({event: "auth.invalid-token"});</span>
<span class="cstat-no" title="statement not covered" >                    done(null,false);</span>
                }
            });
        } else {
<span class="cstat-no" title="statement not covered" >            log.audit({event: "auth.invalid-token"});</span>
<span class="cstat-no" title="statement not covered" >            done(null,false);</span>
        }
    });
}
bearerStrategy.BearerStrategy = new BearerStrategy(bearerStrategy);
&nbsp;
var clientPasswordStrategy = <span class="fstat-no" title="function not covered" >function(clientId, clientSecret, done) {</span>
<span class="cstat-no" title="statement not covered" >    Clients.get(clientId).then(<span class="fstat-no" title="function not covered" >function(client) {</span></span>
<span class="cstat-no" title="statement not covered" >        if (client &amp;&amp; client.secret == clientSecret) {</span>
<span class="cstat-no" title="statement not covered" >            done(null,client);</span>
        } else {
<span class="cstat-no" title="statement not covered" >            log.audit({event: "auth.invalid-client",client:clientId});</span>
<span class="cstat-no" title="statement not covered" >            done(null,false);</span>
        }
    });
}
clientPasswordStrategy.ClientPasswordStrategy = new ClientPasswordStrategy(clientPasswordStrategy);
&nbsp;
var loginAttempts = [];
var loginSignInWindow = 600000; // 10 minutes
&nbsp;
&nbsp;
var passwordTokenExchange = <span class="fstat-no" title="function not covered" >function(client, username, password, scope, done) {</span>
<span class="cstat-no" title="statement not covered" >    var now = Date.now();</span>
<span class="cstat-no" title="statement not covered" >    loginAttempts = loginAttempts.filter(<span class="fstat-no" title="function not covered" >function(logEntry) {</span></span>
<span class="cstat-no" title="statement not covered" >        return logEntry.time + loginSignInWindow &gt; now;</span>
    });
<span class="cstat-no" title="statement not covered" >    loginAttempts.push({time:now, user:username});</span>
<span class="cstat-no" title="statement not covered" >    var attemptCount = 0;</span>
<span class="cstat-no" title="statement not covered" >    loginAttempts.forEach(<span class="fstat-no" title="function not covered" >function(logEntry) {</span></span>
        /* istanbul ignore else */
<span class="cstat-no" title="statement not covered" >        if (logEntry.user == username) {</span>
<span class="cstat-no" title="statement not covered" >            attemptCount++;</span>
        }
    });
<span class="cstat-no" title="statement not covered" >    if (attemptCount &gt; 5) {</span>
<span class="cstat-no" title="statement not covered" >        log.audit({event: "auth.login.fail.too-many-attempts",username:username,client:client.id});</span>
<span class="cstat-no" title="statement not covered" >        done(new Error("Too many login attempts. Wait 10 minutes and try again"),false);</span>
<span class="cstat-no" title="statement not covered" >        return;</span>
    }
&nbsp;
<span class="cstat-no" title="statement not covered" >    Users.authenticate(username,password).then(<span class="fstat-no" title="function not covered" >function(user) {</span></span>
<span class="cstat-no" title="statement not covered" >        if (user) {</span>
<span class="cstat-no" title="statement not covered" >            if (scope === "") {</span>
<span class="cstat-no" title="statement not covered" >                scope = user.permissions;</span>
            }
<span class="cstat-no" title="statement not covered" >            if (permissions.hasPermission(user.permissions,scope)) {</span>
<span class="cstat-no" title="statement not covered" >                loginAttempts = loginAttempts.filter(<span class="fstat-no" title="function not covered" >function(logEntry) {</span></span>
<span class="cstat-no" title="statement not covered" >                    return logEntry.user !== username;</span>
                });
<span class="cstat-no" title="statement not covered" >                Tokens.create(username,client.id,scope).then(<span class="fstat-no" title="function not covered" >function(tokens) {</span></span>
<span class="cstat-no" title="statement not covered" >                    log.audit({event: "auth.login",username:username,client:client.id,scope:scope});</span>
<span class="cstat-no" title="statement not covered" >                    done(null,tokens.accessToken,null,{expires_in:tokens.expires_in});</span>
                });
            } else {
<span class="cstat-no" title="statement not covered" >                log.audit({event: "auth.login.fail.permissions",username:username,client:client.id,scope:scope});</span>
<span class="cstat-no" title="statement not covered" >                done(null,false);</span>
            }
        } else {
<span class="cstat-no" title="statement not covered" >            log.audit({event: "auth.login.fail.credentials",username:username,client:client.id,scope:scope});</span>
<span class="cstat-no" title="statement not covered" >            done(null,false);</span>
        }
    });
}
&nbsp;
function AnonymousStrategy() {
  passport.Strategy.call(this);
  this.name = 'anon';
}
util.inherits(AnonymousStrategy, passport.Strategy);
AnonymousStrategy.prototype.authenticate = <span class="fstat-no" title="function not covered" >function(req) {</span>
<span class="cstat-no" title="statement not covered" >    var self = this;</span>
<span class="cstat-no" title="statement not covered" >    Users.default().then(<span class="fstat-no" title="function not covered" >function(anon) {</span></span>
<span class="cstat-no" title="statement not covered" >        if (anon) {</span>
<span class="cstat-no" title="statement not covered" >            self.success(anon,{scope:anon.permissions});</span>
        } else {
<span class="cstat-no" title="statement not covered" >            self.fail(401);</span>
        }
    });
}
&nbsp;
module.exports = {
    init: <span class="fstat-no" title="function not covered" >function(runtime) {</span>
<span class="cstat-no" title="statement not covered" >        log = runtime.log;</span>
    },
    bearerStrategy: bearerStrategy,
    clientPasswordStrategy: clientPasswordStrategy,
    passwordTokenExchange: passwordTokenExchange,
    anonymousStrategy: new AnonymousStrategy()
}
&nbsp;
&nbsp;</pre></td></tr>
</table></pre>
</div>
<div class="footer">
    <div class="meta">Generated by <a href="https://github.com/kaizhu256/node-utility2" target="_blank">utility2</a> at Tue Apr 11 2017 17:25:15 GMT+0000 (UTC)</div>
</div>
</body>
</html>


<!doctype html>
<html lang="en">
<head>
    <title>Code coverage report for node-npmtest-node-red/node-red/red/api/auth/tokens.js</title>
    <meta charset="utf-8">
    <style>
        body, html {
            margin:0; padding: 0;
        }
        body {
            font-family: Arial, Helvetica;
            font-size: 10pt;
        }
        div.header, div.footer {
            background: #eee;
            padding: 1em;
        }
        div.header {
            height: 160px;
            padding: 0 1em 0 1em;
            z-index: 100;
            position: fixed;
            top: 0;
            border-bottom: 1px solid #666;
            width: 100%;
        }
        div.footer {
            border-top: 1px solid #666;
        }
        div.body {
            margin-top: 170px;
        }
        div.meta {
            font-size: 90%;
            text-align: center;
        }
        h1, h2, h3 {
            font-weight: normal;
        }
        h1 {
            font-size: 12pt;
        }
        h2 {
            font-size: 10pt;
        }
        pre {
            font-family: Menlo, Monaco, Consolas, Courier New, monospace;
            margin: 0;
            padding: 0;
            font-size: 14px;
            tab-size: 2;
        }

        div.path { font-size: 110%; }
        div.path a:link, div.path a:visited { color: #000; }
        table.coverage { border-collapse: collapse; margin:0; padding: 0 }

        table.coverage td {
            margin: 0;
            padding: 0;
            color: #111;
            vertical-align: top;
        }
        table.coverage td.line-count {
            width: 50px;
            text-align: right;
            padding-right: 5px;
        }
        table.coverage td.line-coverage {
            color: #777 !important;
            text-align: right;
            border-left: 1px solid #666;
            border-right: 1px solid #666;
        }

        table.coverage td.text {
        }

        table.coverage td span.cline-any {
            display: inline-block;
            padding: 0 5px;
            width: 40px;
        }
        table.coverage td span.cline-neutral {
            background: #eee;
        }
        table.coverage td span.cline-yes {
            background: #b5d592;
            color: #999;
        }
        table.coverage td span.cline-no {
            background: #fc8c84;
        }

        .cstat-yes { color: #111; }
        .cstat-no { background: #fc8c84; color: #111; }
        .fstat-no { background: #ffc520; color: #111 !important; }
        .cbranch-no { background:  yellow !important; color: #111; }

        .cstat-skip { background: #ddd; color: #111; }
        .fstat-skip { background: #ddd; color: #111 !important; }
        .cbranch-skip { background: #ddd !important; color: #111; }

        .missing-if-branch {
            display: inline-block;
            margin-right: 10px;
            position: relative;
            padding: 0 4px;
            background: black;
            color: yellow;
        }

        .skip-if-branch {
            display: none;
            margin-right: 10px;
            position: relative;
            padding: 0 4px;
            background: #ccc;
            color: white;
        }

        .missing-if-branch .typ, .skip-if-branch .typ {
            color: inherit !important;
        }

        .entity, .metric { font-weight: bold; }
        .metric { display: inline-block; border: 1px solid #333; padding: 0.3em; background: white; }
        .metric small { font-size: 80%; font-weight: normal; color: #666; }

        div.coverage-summary table { border-collapse: collapse; margin: 3em; font-size: 110%; }
        div.coverage-summary td, div.coverage-summary table  th { margin: 0; padding: 0.25em 1em; border-top: 1px solid #666; border-bottom: 1px solid #666; }
        div.coverage-summary th { text-align: left; border: 1px solid #666; background: #eee; font-weight: normal; }
        div.coverage-summary th.file { border-right: none !important; }
        div.coverage-summary th.pic { border-left: none !important; text-align: right; }
        div.coverage-summary th.pct { border-right: none !important; }
        div.coverage-summary th.abs { border-left: none !important; text-align: right; }
        div.coverage-summary td.pct { text-align: right; border-left: 1px solid #666; }
        div.coverage-summary td.abs { text-align: right; font-size: 90%; color: #444; border-right: 1px solid #666; }
        div.coverage-summary td.file { text-align: right; border-left: 1px solid #666; white-space: nowrap;  }
        div.coverage-summary td.pic { min-width: 120px !important;  }
        div.coverage-summary a:link { color: #000; }
        div.coverage-summary a:visited { color: #333; }
        div.coverage-summary tfoot td { border-top: 1px solid #666; }

        div.coverage-summary .yui3-datatable-sort-indicator, div.coverage-summary .dummy-sort-indicator {
            height: 10px;
            width: 7px;
            display: inline-block;
            margin-left: 0.5em;
        }
        div.coverage-summary .yui3-datatable-sort-indicator {
            background: no-repeat scroll 0 0 transparent;
        }
        div.coverage-summary .yui3-datatable-sorted .yui3-datatable-sort-indicator {
            background-position: 0 -20px;
        }
        div.coverage-summary .yui3-datatable-sorted-desc .yui3-datatable-sort-indicator {
            background-position: 0 -10px;
        }

        .high { background: #b5d592 !important; }
        .medium { background: #ffe87c !important; }
        .low { background: #fc8c84 !important; }

        span.cover-fill, span.cover-empty {
            display:inline-block;
            border:1px solid #444;
            background: white;
            height: 12px;
        }
        span.cover-fill {
            background: #ccc;
            border-right: 1px solid #444;
        }
        span.cover-empty {
            background: white;
            border-left: none;
        }
        span.cover-full {
            border-right: none !important;
        }
        pre.prettyprint {
            border: none !important;
            padding: 0 !important;
            margin: 0 !important;
        }
        .com { color: #999 !important; }
        .ignore-none { color: #999; font-weight: normal; }

    </style>
</head>
<body>
<div class="header low">
    <h1 style="font-weight: bold;">
        <a href="https://github.com/npmtest/node-npmtest-node-red">npmtest-node-red (v0.0.1)</a>
    </h1>
    <h1>Code coverage report for <span class="entity">node-npmtest-node-red/node-red/red/api/auth/tokens.js</span></h1>
    <h2>
        
        Statements: <span class="metric">18% <small>(9 / 50)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        
        Branches: <span class="metric">0% <small>(0 / 18)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        
        Functions: <span class="metric">0% <small>(0 / 13)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        
        Lines: <span class="metric">18.37% <small>(9 / 49)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        Ignored: <span class="metric"><span class="ignore-none">none</span></span> &nbsp;&nbsp;&nbsp;&nbsp;
    </h2>
    <div class="path"><a href="../../../../../index.html">All files</a> &#187; <a href="index.html">node-npmtest-node-red/node-red/red/api/auth/</a> &#187; tokens.js</div>
</div>
<div class="body">
<pre><table class="coverage">
<tr><td class="line-count">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114</td><td class="line-coverage"><span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span></td><td class="text"><pre class="prettyprint lang-js">/**
 * Copyright JS Foundation and other contributors, http://js.foundation
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 **/
&nbsp;
var when = require("when");
&nbsp;
<span class="fstat-no" title="function not covered" >function generateToken(length) {</span>
<span class="cstat-no" title="statement not covered" >    var c = "ABCDEFGHIJKLMNOPQRSTUZWXYZabcdefghijklmnopqrstuvwxyz1234567890";</span>
<span class="cstat-no" title="statement not covered" >    var token = [];</span>
<span class="cstat-no" title="statement not covered" >    for (var i=0;i&lt;length;i++) {</span>
<span class="cstat-no" title="statement not covered" >        token.push(c[Math.floor(Math.random()*c.length)]);</span>
    }
<span class="cstat-no" title="statement not covered" >    return token.join("");</span>
}
&nbsp;
&nbsp;
var storage;
&nbsp;
var sessionExpiryTime
&nbsp;
var sessions = {};
&nbsp;
var loadedSessions = null;
&nbsp;
<span class="fstat-no" title="function not covered" >function expireSessions() {</span>
<span class="cstat-no" title="statement not covered" >    var now = Date.now();</span>
<span class="cstat-no" title="statement not covered" >    var modified = false;</span>
<span class="cstat-no" title="statement not covered" >    for (var t in sessions) {</span>
<span class="cstat-no" title="statement not covered" >        if (sessions.hasOwnProperty(t)) {</span>
<span class="cstat-no" title="statement not covered" >            var session = sessions[t];</span>
<span class="cstat-no" title="statement not covered" >            if (!session.hasOwnProperty("expires") || session.expires &lt; now) {</span>
<span class="cstat-no" title="statement not covered" >                delete sessions[t];</span>
<span class="cstat-no" title="statement not covered" >                modified = true;</span>
            }
        }
    }
<span class="cstat-no" title="statement not covered" >    if (modified) {</span>
<span class="cstat-no" title="statement not covered" >        return storage.saveSessions(sessions);</span>
    } else {
<span class="cstat-no" title="statement not covered" >        return when.resolve();</span>
    }
}
<span class="fstat-no" title="function not covered" >function loadSessions() {</span>
<span class="cstat-no" title="statement not covered" >    if (loadedSessions === null) {</span>
<span class="cstat-no" title="statement not covered" >        loadedSessions = storage.getSessions().then(<span class="fstat-no" title="function not covered" >function(_sessions) {</span></span>
<span class="cstat-no" title="statement not covered" >             sessions = _sessions||{};</span>
<span class="cstat-no" title="statement not covered" >             return expireSessions();</span>
        });
    }
<span class="cstat-no" title="statement not covered" >    return loadedSessions;</span>
}
&nbsp;
module.exports = {
    init: <span class="fstat-no" title="function not covered" >function(adminAuthSettings, _storage) {</span>
<span class="cstat-no" title="statement not covered" >        storage = _storage;</span>
<span class="cstat-no" title="statement not covered" >        sessionExpiryTime = adminAuthSettings.sessionExpiryTime || 604800; </span>// 1 week in seconds
        // At this point, storage will not have been initialised, so defer loading
        // the sessions until there's a request for them.
<span class="cstat-no" title="statement not covered" >        loadedSessions = null;</span>
<span class="cstat-no" title="statement not covered" >        return when.resolve();</span>
    },
    get: <span class="fstat-no" title="function not covered" >function(token) {</span>
<span class="cstat-no" title="statement not covered" >        return loadSessions().then(<span class="fstat-no" title="function not covered" >function() {</span></span>
<span class="cstat-no" title="statement not covered" >            if (sessions[token]) {</span>
<span class="cstat-no" title="statement not covered" >                if (sessions[token].expires &lt; Date.now()) {</span>
<span class="cstat-no" title="statement not covered" >                    return expireSessions().then(<span class="fstat-no" title="function not covered" >function() {</span> <span class="cstat-no" title="statement not covered" >return null }</span>);</span>
                }
            }
<span class="cstat-no" title="statement not covered" >            return when.resolve(sessions[token]);</span>
        });
    },
    create: <span class="fstat-no" title="function not covered" >function(user,client,scope) {</span>
<span class="cstat-no" title="statement not covered" >        return loadSessions().then(<span class="fstat-no" title="function not covered" >function() {</span></span>
<span class="cstat-no" title="statement not covered" >            var accessToken = generateToken(128);</span>
&nbsp;
<span class="cstat-no" title="statement not covered" >            var accessTokenExpiresAt = Date.now() + (sessionExpiryTime*1000);</span>
&nbsp;
<span class="cstat-no" title="statement not covered" >            var session = {</span>
                user:user,
                client:client,
                scope:scope,
                accessToken: accessToken,
                expires: accessTokenExpiresAt
            };
<span class="cstat-no" title="statement not covered" >            sessions[accessToken] = session;</span>
<span class="cstat-no" title="statement not covered" >            return storage.saveSessions(sessions).then(<span class="fstat-no" title="function not covered" >function() {</span></span>
<span class="cstat-no" title="statement not covered" >                return {</span>
                    accessToken: accessToken,
                    expires_in: sessionExpiryTime
                }
            });
        });
    },
    revoke: <span class="fstat-no" title="function not covered" >function(token) {</span>
<span class="cstat-no" title="statement not covered" >        return loadSessions().then(<span class="fstat-no" title="function not covered" >function() {</span></span>
<span class="cstat-no" title="statement not covered" >            delete sessions[token];</span>
<span class="cstat-no" title="statement not covered" >            return storage.saveSessions(sessions);</span>
        });
    }
}
&nbsp;
&nbsp;</pre></td></tr>
</table></pre>
</div>
<div class="footer">
    <div class="meta">Generated by <a href="https://github.com/kaizhu256/node-utility2" target="_blank">utility2</a> at Tue Apr 11 2017 17:25:15 GMT+0000 (UTC)</div>
</div>
</body>
</html>


<!doctype html>
<html lang="en">
<head>
    <title>Code coverage report for node-npmtest-node-red/node-red/red/api/auth/users.js</title>
    <meta charset="utf-8">
    <style>
        body, html {
            margin:0; padding: 0;
        }
        body {
            font-family: Arial, Helvetica;
            font-size: 10pt;
        }
        div.header, div.footer {
            background: #eee;
            padding: 1em;
        }
        div.header {
            height: 160px;
            padding: 0 1em 0 1em;
            z-index: 100;
            position: fixed;
            top: 0;
            border-bottom: 1px solid #666;
            width: 100%;
        }
        div.footer {
            border-top: 1px solid #666;
        }
        div.body {
            margin-top: 170px;
        }
        div.meta {
            font-size: 90%;
            text-align: center;
        }
        h1, h2, h3 {
            font-weight: normal;
        }
        h1 {
            font-size: 12pt;
        }
        h2 {
            font-size: 10pt;
        }
        pre {
            font-family: Menlo, Monaco, Consolas, Courier New, monospace;
            margin: 0;
            padding: 0;
            font-size: 14px;
            tab-size: 2;
        }

        div.path { font-size: 110%; }
        div.path a:link, div.path a:visited { color: #000; }
        table.coverage { border-collapse: collapse; margin:0; padding: 0 }

        table.coverage td {
            margin: 0;
            padding: 0;
            color: #111;
            vertical-align: top;
        }
        table.coverage td.line-count {
            width: 50px;
            text-align: right;
            padding-right: 5px;
        }
        table.coverage td.line-coverage {
            color: #777 !important;
            text-align: right;
            border-left: 1px solid #666;
            border-right: 1px solid #666;
        }

        table.coverage td.text {
        }

        table.coverage td span.cline-any {
            display: inline-block;
            padding: 0 5px;
            width: 40px;
        }
        table.coverage td span.cline-neutral {
            background: #eee;
        }
        table.coverage td span.cline-yes {
            background: #b5d592;
            color: #999;
        }
        table.coverage td span.cline-no {
            background: #fc8c84;
        }

        .cstat-yes { color: #111; }
        .cstat-no { background: #fc8c84; color: #111; }
        .fstat-no { background: #ffc520; color: #111 !important; }
        .cbranch-no { background:  yellow !important; color: #111; }

        .cstat-skip { background: #ddd; color: #111; }
        .fstat-skip { background: #ddd; color: #111 !important; }
        .cbranch-skip { background: #ddd !important; color: #111; }

        .missing-if-branch {
            display: inline-block;
            margin-right: 10px;
            position: relative;
            padding: 0 4px;
            background: black;
            color: yellow;
        }

        .skip-if-branch {
            display: none;
            margin-right: 10px;
            position: relative;
            padding: 0 4px;
            background: #ccc;
            color: white;
        }

        .missing-if-branch .typ, .skip-if-branch .typ {
            color: inherit !important;
        }

        .entity, .metric { font-weight: bold; }
        .metric { display: inline-block; border: 1px solid #333; padding: 0.3em; background: white; }
        .metric small { font-size: 80%; font-weight: normal; color: #666; }

        div.coverage-summary table { border-collapse: collapse; margin: 3em; font-size: 110%; }
        div.coverage-summary td, div.coverage-summary table  th { margin: 0; padding: 0.25em 1em; border-top: 1px solid #666; border-bottom: 1px solid #666; }
        div.coverage-summary th { text-align: left; border: 1px solid #666; background: #eee; font-weight: normal; }
        div.coverage-summary th.file { border-right: none !important; }
        div.coverage-summary th.pic { border-left: none !important; text-align: right; }
        div.coverage-summary th.pct { border-right: none !important; }
        div.coverage-summary th.abs { border-left: none !important; text-align: right; }
        div.coverage-summary td.pct { text-align: right; border-left: 1px solid #666; }
        div.coverage-summary td.abs { text-align: right; font-size: 90%; color: #444; border-right: 1px solid #666; }
        div.coverage-summary td.file { text-align: right; border-left: 1px solid #666; white-space: nowrap;  }
        div.coverage-summary td.pic { min-width: 120px !important;  }
        div.coverage-summary a:link { color: #000; }
        div.coverage-summary a:visited { color: #333; }
        div.coverage-summary tfoot td { border-top: 1px solid #666; }

        div.coverage-summary .yui3-datatable-sort-indicator, div.coverage-summary .dummy-sort-indicator {
            height: 10px;
            width: 7px;
            display: inline-block;
            margin-left: 0.5em;
        }
        div.coverage-summary .yui3-datatable-sort-indicator {
            background: no-repeat scroll 0 0 transparent;
        }
        div.coverage-summary .yui3-datatable-sorted .yui3-datatable-sort-indicator {
            background-position: 0 -20px;
        }
        div.coverage-summary .yui3-datatable-sorted-desc .yui3-datatable-sort-indicator {
            background-position: 0 -10px;
        }

        .high { background: #b5d592 !important; }
        .medium { background: #ffe87c !important; }
        .low { background: #fc8c84 !important; }

        span.cover-fill, span.cover-empty {
            display:inline-block;
            border:1px solid #444;
            background: white;
            height: 12px;
        }
        span.cover-fill {
            background: #ccc;
            border-right: 1px solid #444;
        }
        span.cover-empty {
            background: white;
            border-left: none;
        }
        span.cover-full {
            border-right: none !important;
        }
        pre.prettyprint {
            border: none !important;
            padding: 0 !important;
            margin: 0 !important;
        }
        .com { color: #999 !important; }
        .ignore-none { color: #999; font-weight: normal; }

    </style>
</head>
<body>
<div class="header low">
    <h1 style="font-weight: bold;">
        <a href="https://github.com/npmtest/node-npmtest-node-red">npmtest-node-red (v0.0.1)</a>
    </h1>
    <h1>Code coverage report for <span class="entity">node-npmtest-node-red/node-red/red/api/auth/users.js</span></h1>
    <h2>
        
        Statements: <span class="metric">28.57% <small>(14 / 49)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        
        Branches: <span class="metric">5% <small>(1 / 20)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        
        Functions: <span class="metric">0% <small>(0 / 10)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        
        Lines: <span class="metric">27.08% <small>(13 / 48)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        Ignored: <span class="metric">1 branch</span> &nbsp;&nbsp;&nbsp;&nbsp;
    </h2>
    <div class="path"><a href="../../../../../index.html">All files</a> &#187; <a href="index.html">node-npmtest-node-red/node-red/red/api/auth/</a> &#187; users.js</div>
</div>
<div class="body">
<pre><table class="coverage">
<tr><td class="line-count">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103</td><td class="line-coverage"><span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span></td><td class="text"><pre class="prettyprint lang-js">/**
* Copyright JS Foundation and other contributors, http://js.foundation
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
**/
&nbsp;
var when = require("when");
var util = require("util");
var bcrypt;
try { bcrypt = require('bcrypt'); }
catch(e) { <span class="cstat-no" title="statement not covered" >bcrypt = require('bcryptjs'); </span>}
var users = {};
var passwords = {};
var defaultUser = null;
&nbsp;
<span class="fstat-no" title="function not covered" >function authenticate(username,password) {</span>
<span class="cstat-no" title="statement not covered" >    var user = users[username];</span>
<span class="cstat-no" title="statement not covered" >    if (user) {</span>
<span class="cstat-no" title="statement not covered" >        return when.promise(<span class="fstat-no" title="function not covered" >function(resolve,reject) {</span></span>
<span class="cstat-no" title="statement not covered" >            bcrypt.compare(password, passwords[username], <span class="fstat-no" title="function not covered" >function(err, res) {</span></span>
<span class="cstat-no" title="statement not covered" >                resolve(res?user:null);</span>
            });
        });
    }
<span class="cstat-no" title="statement not covered" >    return when.resolve(null);</span>
}
<span class="fstat-no" title="function not covered" >function get(username) {</span>
<span class="cstat-no" title="statement not covered" >    return when.resolve(users[username]);</span>
}
<span class="fstat-no" title="function not covered" >function getDefaultUser() {</span>
<span class="cstat-no" title="statement not covered" >    return when.resolve(null);</span>
}
&nbsp;
var api = {
    get: get,
    authenticate: authenticate,
    default: getDefaultUser
}
&nbsp;
<span class="fstat-no" title="function not covered" >function init(config) {</span>
<span class="cstat-no" title="statement not covered" >    users = {};</span>
<span class="cstat-no" title="statement not covered" >    passwords = {};</span>
<span class="cstat-no" title="statement not covered" >    defaultUser = null;</span>
<span class="cstat-no" title="statement not covered" >    if (config.type == "credentials") {</span>
<span class="cstat-no" title="statement not covered" >        if (config.users) {</span>
<span class="cstat-no" title="statement not covered" >            if (typeof config.users === "function") {</span>
<span class="cstat-no" title="statement not covered" >                api.get = config.users;</span>
            } else {
<span class="cstat-no" title="statement not covered" >                var us = config.users;</span>
                /* istanbul ignore else */
<span class="cstat-no" title="statement not covered" >                if (!util.isArray(us)) {</span>
<span class="cstat-no" title="statement not covered" >                    us = [us];</span>
                }
<span class="cstat-no" title="statement not covered" >                for (var i=0;i&lt;us.length;i++) {</span>
<span class="cstat-no" title="statement not covered" >                    var u = us[i];</span>
<span class="cstat-no" title="statement not covered" >                    users[u.username] = {</span>
                        "username":u.username,
                        "permissions":u.permissions
                    };
<span class="cstat-no" title="statement not covered" >                    passwords[u.username] = u.password;</span>
                }
            }
        }
<span class="cstat-no" title="statement not covered" >        if (config.authenticate &amp;&amp; typeof config.authenticate === "function") {</span>
<span class="cstat-no" title="statement not covered" >            api.authenticate = config.authenticate;</span>
        } else {
<span class="cstat-no" title="statement not covered" >            api.authenticate = authenticate;</span>
        }
    }
<span class="cstat-no" title="statement not covered" >    if (config.default) {</span>
<span class="cstat-no" title="statement not covered" >        if (typeof config.default === "function") {</span>
<span class="cstat-no" title="statement not covered" >            api.default = config.default;</span>
        } else {
<span class="cstat-no" title="statement not covered" >            api.default = <span class="fstat-no" title="function not covered" >function() {</span></span>
<span class="cstat-no" title="statement not covered" >                return when.resolve({</span>
                    "anonymous": true,
                    "permissions":config.default.permissions
                });
            }
        }
    } else {
<span class="cstat-no" title="statement not covered" >        api.default = getDefaultUser;</span>
    }
}
&nbsp;
module.exports = {
    init: init,
    get: <span class="fstat-no" title="function not covered" >function(username) {</span> <span class="cstat-no" title="statement not covered" >return api.get(username) }</span>,
    authenticate: <span class="fstat-no" title="function not covered" >function(username,password) {</span> <span class="cstat-no" title="statement not covered" >return api.authenticate(username,password) }</span>,
    default: <span class="fstat-no" title="function not covered" >function() {</span> <span class="cstat-no" title="statement not covered" >return api.default(); </span>}
};
&nbsp;
&nbsp;</pre></td></tr>
</table></pre>
</div>
<div class="footer">
    <div class="meta">Generated by <a href="https://github.com/kaizhu256/node-utility2" target="_blank">utility2</a> at Tue Apr 11 2017 17:25:15 GMT+0000 (UTC)</div>
</div>
</body>
</html>


<!doctype html>
<html lang="en">
<head>
    <title>Code coverage report for node-npmtest-node-red/node-red/red/runtime/</title>
    <meta charset="utf-8">
    <style>
        body, html {
            margin:0; padding: 0;
        }
        body {
            font-family: Arial, Helvetica;
            font-size: 10pt;
        }
        div.header, div.footer {
            background: #eee;
            padding: 1em;
        }
        div.header {
            height: 160px;
            padding: 0 1em 0 1em;
            z-index: 100;
            position: fixed;
            top: 0;
            border-bottom: 1px solid #666;
            width: 100%;
        }
        div.footer {
            border-top: 1px solid #666;
        }
        div.body {
            margin-top: 170px;
        }
        div.meta {
            font-size: 90%;
            text-align: center;
        }
        h1, h2, h3 {
            font-weight: normal;
        }
        h1 {
            font-size: 12pt;
        }
        h2 {
            font-size: 10pt;
        }
        pre {
            font-family: Menlo, Monaco, Consolas, Courier New, monospace;
            margin: 0;
            padding: 0;
            font-size: 14px;
            tab-size: 2;
        }

        div.path { font-size: 110%; }
        div.path a:link, div.path a:visited { color: #000; }
        table.coverage { border-collapse: collapse; margin:0; padding: 0 }

        table.coverage td {
            margin: 0;
            padding: 0;
            color: #111;
            vertical-align: top;
        }
        table.coverage td.line-count {
            width: 50px;
            text-align: right;
            padding-right: 5px;
        }
        table.coverage td.line-coverage {
            color: #777 !important;
            text-align: right;
            border-left: 1px solid #666;
            border-right: 1px solid #666;
        }

        table.coverage td.text {
        }

        table.coverage td span.cline-any {
            display: inline-block;
            padding: 0 5px;
            width: 40px;
        }
        table.coverage td span.cline-neutral {
            background: #eee;
        }
        table.coverage td span.cline-yes {
            background: #b5d592;
            color: #999;
        }
        table.coverage td span.cline-no {
            background: #fc8c84;
        }

        .cstat-yes { color: #111; }
        .cstat-no { background: #fc8c84; color: #111; }
        .fstat-no { background: #ffc520; color: #111 !important; }
        .cbranch-no { background:  yellow !important; color: #111; }

        .cstat-skip { background: #ddd; color: #111; }
        .fstat-skip { background: #ddd; color: #111 !important; }
        .cbranch-skip { background: #ddd !important; color: #111; }

        .missing-if-branch {
            display: inline-block;
            margin-right: 10px;
            position: relative;
            padding: 0 4px;
            background: black;
            color: yellow;
        }

        .skip-if-branch {
            display: none;
            margin-right: 10px;
            position: relative;
            padding: 0 4px;
            background: #ccc;
            color: white;
        }

        .missing-if-branch .typ, .skip-if-branch .typ {
            color: inherit !important;
        }

        .entity, .metric { font-weight: bold; }
        .metric { display: inline-block; border: 1px solid #333; padding: 0.3em; background: white; }
        .metric small { font-size: 80%; font-weight: normal; color: #666; }

        div.coverage-summary table { border-collapse: collapse; margin: 3em; font-size: 110%; }
        div.coverage-summary td, div.coverage-summary table  th { margin: 0; padding: 0.25em 1em; border-top: 1px solid #666; border-bottom: 1px solid #666; }
        div.coverage-summary th { text-align: left; border: 1px solid #666; background: #eee; font-weight: normal; }
        div.coverage-summary th.file { border-right: none !important; }
        div.coverage-summary th.pic { border-left: none !important; text-align: right; }
        div.coverage-summary th.pct { border-right: none !important; }
        div.coverage-summary th.abs { border-left: none !important; text-align: right; }
        div.coverage-summary td.pct { text-align: right; border-left: 1px solid #666; }
        div.coverage-summary td.abs { text-align: right; font-size: 90%; color: #444; border-right: 1px solid #666; }
        div.coverage-summary td.file { text-align: right; border-left: 1px solid #666; white-space: nowrap;  }
        div.coverage-summary td.pic { min-width: 120px !important;  }
        div.coverage-summary a:link { color: #000; }
        div.coverage-summary a:visited { color: #333; }
        div.coverage-summary tfoot td { border-top: 1px solid #666; }

        div.coverage-summary .yui3-datatable-sort-indicator, div.coverage-summary .dummy-sort-indicator {
            height: 10px;
            width: 7px;
            display: inline-block;
            margin-left: 0.5em;
        }
        div.coverage-summary .yui3-datatable-sort-indicator {
            background: no-repeat scroll 0 0 transparent;
        }
        div.coverage-summary .yui3-datatable-sorted .yui3-datatable-sort-indicator {
            background-position: 0 -20px;
        }
        div.coverage-summary .yui3-datatable-sorted-desc .yui3-datatable-sort-indicator {
            background-position: 0 -10px;
        }

        .high { background: #b5d592 !important; }
        .medium { background: #ffe87c !important; }
        .low { background: #fc8c84 !important; }

        span.cover-fill, span.cover-empty {
            display:inline-block;
            border:1px solid #444;
            background: white;
            height: 12px;
        }
        span.cover-fill {
            background: #ccc;
            border-right: 1px solid #444;
        }
        span.cover-empty {
            background: white;
            border-left: none;
        }
        span.cover-full {
            border-right: none !important;
        }
        pre.prettyprint {
            border: none !important;
            padding: 0 !important;
            margin: 0 !important;
        }
        .com { color: #999 !important; }
        .ignore-none { color: #999; font-weight: normal; }

    </style>
</head>
<body>
<div class="header low">
    <h1 style="font-weight: bold;">
        <a href="https://github.com/npmtest/node-npmtest-node-red">npmtest-node-red (v0.0.1)</a>
    </h1>
    <h1>Code coverage report for <span class="entity">node-npmtest-node-red/node-red/red/runtime/</span></h1>
    <h2>
        
        Statements: <span class="metric">15.45% <small>(74 / 479)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        
        Branches: <span class="metric">0.96% <small>(3 / 311)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        
        Functions: <span class="metric">0% <small>(0 / 75)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        
        Lines: <span class="metric">15.58% <small>(74 / 475)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        Ignored: <span class="metric">3 branches</span> &nbsp;&nbsp;&nbsp;&nbsp;
    </h2>
    <div class="path"><a href="../../../../index.html">All files</a> &#187; node-npmtest-node-red/node-red/red/runtime/</div>
</div>
<div class="body">
<div class="coverage-summary">
<table>
<thead>
<tr>
   <th data-col="file" data-fmt="html" data-html="true" class="file">File</th>
   <th data-col="pic" data-type="number" data-fmt="html" data-html="true" class="pic"></th>
   <th data-col="statements" data-type="number" data-fmt="pct" class="pct">Statements</th>
   <th data-col="statements_raw" data-type="number" data-fmt="html" class="abs"></th>
   <th data-col="branches" data-type="number" data-fmt="pct" class="pct">Branches</th>
   <th data-col="branches_raw" data-type="number" data-fmt="html" class="abs"></th>
   <th data-col="functions" data-type="number" data-fmt="pct" class="pct">Functions</th>
   <th data-col="functions_raw" data-type="number" data-fmt="html" class="abs"></th>
   <th data-col="lines" data-type="number" data-fmt="pct" class="pct">Lines</th>
   <th data-col="lines_raw" data-type="number" data-fmt="html" class="abs"></th>
</tr>
</thead>
<tbody><tr>
	<td class="file high" data-value="events.js"><a href="events.js.html">events.js</a></td>
	<td data-value="100" class="pic high"><span class="cover-fill cover-full" style="width: 100px;"></span><span class="cover-empty" style="width:0px;"></span></td>
	<td data-value="100" class="pct high">100%</td>
	<td data-value="2" class="abs high">(2&nbsp;/&nbsp;2)</td>
	<td data-value="100" class="pct high">100%</td>
	<td data-value="0" class="abs high">(0&nbsp;/&nbsp;0)</td>
	<td data-value="100" class="pct high">100%</td>
	<td data-value="0" class="abs high">(0&nbsp;/&nbsp;0)</td>
	<td data-value="100" class="pct high">100%</td>
	<td data-value="2" class="abs high">(2&nbsp;/&nbsp;2)</td>
	</tr>

<tr>
	<td class="file low" data-value="i18n.js"><a href="i18n.js.html">i18n.js</a></td>
	<td data-value="26.79" class="pic low"><span class="cover-fill" style="width: 26px;"></span><span class="cover-empty" style="width:74px;"></span></td>
	<td data-value="26.79" class="pct low">26.79%</td>
	<td data-value="56" class="abs low">(15&nbsp;/&nbsp;56)</td>
	<td data-value="0" class="pct low">0%</td>
	<td data-value="22" class="abs low">(0&nbsp;/&nbsp;22)</td>
	<td data-value="0" class="pct low">0%</td>
	<td data-value="13" class="abs low">(0&nbsp;/&nbsp;13)</td>
	<td data-value="26.79" class="pct low">26.79%</td>
	<td data-value="56" class="abs low">(15&nbsp;/&nbsp;56)</td>
	</tr>

<tr>
	<td class="file low" data-value="index.js"><a href="index.js.html">index.js</a></td>
	<td data-value="23.96" class="pic low"><span class="cover-fill" style="width: 23px;"></span><span class="cover-empty" style="width:77px;"></span></td>
	<td data-value="23.96" class="pct low">23.96%</td>
	<td data-value="96" class="abs low">(23&nbsp;/&nbsp;96)</td>
	<td data-value="0" class="pct low">0%</td>
	<td data-value="34" class="abs low">(0&nbsp;/&nbsp;34)</td>
	<td data-value="0" class="pct low">0%</td>
	<td data-value="25" class="abs low">(0&nbsp;/&nbsp;25)</td>
	<td data-value="24.47" class="pct low">24.47%</td>
	<td data-value="94" class="abs low">(23&nbsp;/&nbsp;94)</td>
	</tr>

<tr>
	<td class="file low" data-value="log.js"><a href="log.js.html">log.js</a></td>
	<td data-value="21.67" class="pic low"><span class="cover-fill" style="width: 21px;"></span><span class="cover-empty" style="width:79px;"></span></td>
	<td data-value="21.67" class="pct low">21.67%</td>
	<td data-value="60" class="abs low">(13&nbsp;/&nbsp;60)</td>
	<td data-value="0" class="pct low">0%</td>
	<td data-value="57" class="abs low">(0&nbsp;/&nbsp;57)</td>
	<td data-value="0" class="pct low">0%</td>
	<td data-value="16" class="abs low">(0&nbsp;/&nbsp;16)</td>
	<td data-value="21.67" class="pct low">21.67%</td>
	<td data-value="60" class="abs low">(13&nbsp;/&nbsp;60)</td>
	</tr>

<tr>
	<td class="file low" data-value="settings.js"><a href="settings.js.html">settings.js</a></td>
	<td data-value="17.31" class="pic low"><span class="cover-fill" style="width: 17px;"></span><span class="cover-empty" style="width:83px;"></span></td>
	<td data-value="17.31" class="pct low">17.31%</td>
	<td data-value="52" class="abs low">(9&nbsp;/&nbsp;52)</td>
	<td data-value="8.33" class="pct low">8.33%</td>
	<td data-value="24" class="abs low">(2&nbsp;/&nbsp;24)</td>
	<td data-value="0" class="pct low">0%</td>
	<td data-value="11" class="abs low">(0&nbsp;/&nbsp;11)</td>
	<td data-value="18" class="pct low">18%</td>
	<td data-value="50" class="abs low">(9&nbsp;/&nbsp;50)</td>
	</tr>

<tr>
	<td class="file low" data-value="util.js"><a href="util.js.html">util.js</a></td>
	<td data-value="5.63" class="pic low"><span class="cover-fill" style="width: 5px;"></span><span class="cover-empty" style="width:95px;"></span></td>
	<td data-value="5.63" class="pct low">5.63%</td>
	<td data-value="213" class="abs low">(12&nbsp;/&nbsp;213)</td>
	<td data-value="0.57" class="pct low">0.57%</td>
	<td data-value="174" class="abs low">(1&nbsp;/&nbsp;174)</td>
	<td data-value="0" class="pct low">0%</td>
	<td data-value="10" class="abs low">(0&nbsp;/&nbsp;10)</td>
	<td data-value="5.63" class="pct low">5.63%</td>
	<td data-value="213" class="abs low">(12&nbsp;/&nbsp;213)</td>
	</tr>

</tbody>
</table>
</div></div>
<div class="footer">
    <div class="meta">Generated by <a href="https://github.com/kaizhu256/node-utility2" target="_blank">utility2</a> at Tue Apr 11 2017 17:25:15 GMT+0000 (UTC)</div>
</div>
</body>
</html>


<!doctype html>
<html lang="en">
<head>
    <title>Code coverage report for node-npmtest-node-red/node-red/red/runtime/events.js</title>
    <meta charset="utf-8">
    <style>
        body, html {
            margin:0; padding: 0;
        }
        body {
            font-family: Arial, Helvetica;
            font-size: 10pt;
        }
        div.header, div.footer {
            background: #eee;
            padding: 1em;
        }
        div.header {
            height: 160px;
            padding: 0 1em 0 1em;
            z-index: 100;
            position: fixed;
            top: 0;
            border-bottom: 1px solid #666;
            width: 100%;
        }
        div.footer {
            border-top: 1px solid #666;
        }
        div.body {
            margin-top: 170px;
        }
        div.meta {
            font-size: 90%;
            text-align: center;
        }
        h1, h2, h3 {
            font-weight: normal;
        }
        h1 {
            font-size: 12pt;
        }
        h2 {
            font-size: 10pt;
        }
        pre {
            font-family: Menlo, Monaco, Consolas, Courier New, monospace;
            margin: 0;
            padding: 0;
            font-size: 14px;
            tab-size: 2;
        }

        div.path { font-size: 110%; }
        div.path a:link, div.path a:visited { color: #000; }
        table.coverage { border-collapse: collapse; margin:0; padding: 0 }

        table.coverage td {
            margin: 0;
            padding: 0;
            color: #111;
            vertical-align: top;
        }
        table.coverage td.line-count {
            width: 50px;
            text-align: right;
            padding-right: 5px;
        }
        table.coverage td.line-coverage {
            color: #777 !important;
            text-align: right;
            border-left: 1px solid #666;
            border-right: 1px solid #666;
        }

        table.coverage td.text {
        }

        table.coverage td span.cline-any {
            display: inline-block;
            padding: 0 5px;
            width: 40px;
        }
        table.coverage td span.cline-neutral {
            background: #eee;
        }
        table.coverage td span.cline-yes {
            background: #b5d592;
            color: #999;
        }
        table.coverage td span.cline-no {
            background: #fc8c84;
        }

        .cstat-yes { color: #111; }
        .cstat-no { background: #fc8c84; color: #111; }
        .fstat-no { background: #ffc520; color: #111 !important; }
        .cbranch-no { background:  yellow !important; color: #111; }

        .cstat-skip { background: #ddd; color: #111; }
        .fstat-skip { background: #ddd; color: #111 !important; }
        .cbranch-skip { background: #ddd !important; color: #111; }

        .missing-if-branch {
            display: inline-block;
            margin-right: 10px;
            position: relative;
            padding: 0 4px;
            background: black;
            color: yellow;
        }

        .skip-if-branch {
            display: none;
            margin-right: 10px;
            position: relative;
            padding: 0 4px;
            background: #ccc;
            color: white;
        }

        .missing-if-branch .typ, .skip-if-branch .typ {
            color: inherit !important;
        }

        .entity, .metric { font-weight: bold; }
        .metric { display: inline-block; border: 1px solid #333; padding: 0.3em; background: white; }
        .metric small { font-size: 80%; font-weight: normal; color: #666; }

        div.coverage-summary table { border-collapse: collapse; margin: 3em; font-size: 110%; }
        div.coverage-summary td, div.coverage-summary table  th { margin: 0; padding: 0.25em 1em; border-top: 1px solid #666; border-bottom: 1px solid #666; }
        div.coverage-summary th { text-align: left; border: 1px solid #666; background: #eee; font-weight: normal; }
        div.coverage-summary th.file { border-right: none !important; }
        div.coverage-summary th.pic { border-left: none !important; text-align: right; }
        div.coverage-summary th.pct { border-right: none !important; }
        div.coverage-summary th.abs { border-left: none !important; text-align: right; }
        div.coverage-summary td.pct { text-align: right; border-left: 1px solid #666; }
        div.coverage-summary td.abs { text-align: right; font-size: 90%; color: #444; border-right: 1px solid #666; }
        div.coverage-summary td.file { text-align: right; border-left: 1px solid #666; white-space: nowrap;  }
        div.coverage-summary td.pic { min-width: 120px !important;  }
        div.coverage-summary a:link { color: #000; }
        div.coverage-summary a:visited { color: #333; }
        div.coverage-summary tfoot td { border-top: 1px solid #666; }

        div.coverage-summary .yui3-datatable-sort-indicator, div.coverage-summary .dummy-sort-indicator {
            height: 10px;
            width: 7px;
            display: inline-block;
            margin-left: 0.5em;
        }
        div.coverage-summary .yui3-datatable-sort-indicator {
            background: no-repeat scroll 0 0 transparent;
        }
        div.coverage-summary .yui3-datatable-sorted .yui3-datatable-sort-indicator {
            background-position: 0 -20px;
        }
        div.coverage-summary .yui3-datatable-sorted-desc .yui3-datatable-sort-indicator {
            background-position: 0 -10px;
        }

        .high { background: #b5d592 !important; }
        .medium { background: #ffe87c !important; }
        .low { background: #fc8c84 !important; }

        span.cover-fill, span.cover-empty {
            display:inline-block;
            border:1px solid #444;
            background: white;
            height: 12px;
        }
        span.cover-fill {
            background: #ccc;
            border-right: 1px solid #444;
        }
        span.cover-empty {
            background: white;
            border-left: none;
        }
        span.cover-full {
            border-right: none !important;
        }
        pre.prettyprint {
            border: none !important;
            padding: 0 !important;
            margin: 0 !important;
        }
        .com { color: #999 !important; }
        .ignore-none { color: #999; font-weight: normal; }

    </style>
</head>
<body>
<div class="header high">
    <h1 style="font-weight: bold;">
        <a href="https://github.com/npmtest/node-npmtest-node-red">npmtest-node-red (v0.0.1)</a>
    </h1>
    <h1>Code coverage report for <span class="entity">node-npmtest-node-red/node-red/red/runtime/events.js</span></h1>
    <h2>
        
        Statements: <span class="metric">100% <small>(2 / 2)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        
        Branches: <span class="metric">100% <small>(0 / 0)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        
        Functions: <span class="metric">100% <small>(0 / 0)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        
        Lines: <span class="metric">100% <small>(2 / 2)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        Ignored: <span class="metric"><span class="ignore-none">none</span></span> &nbsp;&nbsp;&nbsp;&nbsp;
    </h2>
    <div class="path"><a href="../../../../index.html">All files</a> &#187; <a href="index.html">node-npmtest-node-red/node-red/red/runtime/</a> &#187; events.js</div>
</div>
<div class="body">
<pre><table class="coverage">
<tr><td class="line-count">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21</td><td class="line-coverage"><span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span></td><td class="text"><pre class="prettyprint lang-js">/**
 * Copyright JS Foundation and other contributors, http://js.foundation
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 **/
&nbsp;
var events = require("events"); 
&nbsp;
module.exports = new events.EventEmitter(); 
&nbsp;
&nbsp;</pre></td></tr>
</table></pre>
</div>
<div class="footer">
    <div class="meta">Generated by <a href="https://github.com/kaizhu256/node-utility2" target="_blank">utility2</a> at Tue Apr 11 2017 17:25:15 GMT+0000 (UTC)</div>
</div>
</body>
</html>


<!doctype html>
<html lang="en">
<head>
    <title>Code coverage report for node-npmtest-node-red/node-red/red/runtime/i18n.js</title>
    <meta charset="utf-8">
    <style>
        body, html {
            margin:0; padding: 0;
        }
        body {
            font-family: Arial, Helvetica;
            font-size: 10pt;
        }
        div.header, div.footer {
            background: #eee;
            padding: 1em;
        }
        div.header {
            height: 160px;
            padding: 0 1em 0 1em;
            z-index: 100;
            position: fixed;
            top: 0;
            border-bottom: 1px solid #666;
            width: 100%;
        }
        div.footer {
            border-top: 1px solid #666;
        }
        div.body {
            margin-top: 170px;
        }
        div.meta {
            font-size: 90%;
            text-align: center;
        }
        h1, h2, h3 {
            font-weight: normal;
        }
        h1 {
            font-size: 12pt;
        }
        h2 {
            font-size: 10pt;
        }
        pre {
            font-family: Menlo, Monaco, Consolas, Courier New, monospace;
            margin: 0;
            padding: 0;
            font-size: 14px;
            tab-size: 2;
        }

        div.path { font-size: 110%; }
        div.path a:link, div.path a:visited { color: #000; }
        table.coverage { border-collapse: collapse; margin:0; padding: 0 }

        table.coverage td {
            margin: 0;
            padding: 0;
            color: #111;
            vertical-align: top;
        }
        table.coverage td.line-count {
            width: 50px;
            text-align: right;
            padding-right: 5px;
        }
        table.coverage td.line-coverage {
            color: #777 !important;
            text-align: right;
            border-left: 1px solid #666;
            border-right: 1px solid #666;
        }

        table.coverage td.text {
        }

        table.coverage td span.cline-any {
            display: inline-block;
            padding: 0 5px;
            width: 40px;
        }
        table.coverage td span.cline-neutral {
            background: #eee;
        }
        table.coverage td span.cline-yes {
            background: #b5d592;
            color: #999;
        }
        table.coverage td span.cline-no {
            background: #fc8c84;
        }

        .cstat-yes { color: #111; }
        .cstat-no { background: #fc8c84; color: #111; }
        .fstat-no { background: #ffc520; color: #111 !important; }
        .cbranch-no { background:  yellow !important; color: #111; }

        .cstat-skip { background: #ddd; color: #111; }
        .fstat-skip { background: #ddd; color: #111 !important; }
        .cbranch-skip { background: #ddd !important; color: #111; }

        .missing-if-branch {
            display: inline-block;
            margin-right: 10px;
            position: relative;
            padding: 0 4px;
            background: black;
            color: yellow;
        }

        .skip-if-branch {
            display: none;
            margin-right: 10px;
            position: relative;
            padding: 0 4px;
            background: #ccc;
            color: white;
        }

        .missing-if-branch .typ, .skip-if-branch .typ {
            color: inherit !important;
        }

        .entity, .metric { font-weight: bold; }
        .metric { display: inline-block; border: 1px solid #333; padding: 0.3em; background: white; }
        .metric small { font-size: 80%; font-weight: normal; color: #666; }

        div.coverage-summary table { border-collapse: collapse; margin: 3em; font-size: 110%; }
        div.coverage-summary td, div.coverage-summary table  th { margin: 0; padding: 0.25em 1em; border-top: 1px solid #666; border-bottom: 1px solid #666; }
        div.coverage-summary th { text-align: left; border: 1px solid #666; background: #eee; font-weight: normal; }
        div.coverage-summary th.file { border-right: none !important; }
        div.coverage-summary th.pic { border-left: none !important; text-align: right; }
        div.coverage-summary th.pct { border-right: none !important; }
        div.coverage-summary th.abs { border-left: none !important; text-align: right; }
        div.coverage-summary td.pct { text-align: right; border-left: 1px solid #666; }
        div.coverage-summary td.abs { text-align: right; font-size: 90%; color: #444; border-right: 1px solid #666; }
        div.coverage-summary td.file { text-align: right; border-left: 1px solid #666; white-space: nowrap;  }
        div.coverage-summary td.pic { min-width: 120px !important;  }
        div.coverage-summary a:link { color: #000; }
        div.coverage-summary a:visited { color: #333; }
        div.coverage-summary tfoot td { border-top: 1px solid #666; }

        div.coverage-summary .yui3-datatable-sort-indicator, div.coverage-summary .dummy-sort-indicator {
            height: 10px;
            width: 7px;
            display: inline-block;
            margin-left: 0.5em;
        }
        div.coverage-summary .yui3-datatable-sort-indicator {
            background: no-repeat scroll 0 0 transparent;
        }
        div.coverage-summary .yui3-datatable-sorted .yui3-datatable-sort-indicator {
            background-position: 0 -20px;
        }
        div.coverage-summary .yui3-datatable-sorted-desc .yui3-datatable-sort-indicator {
            background-position: 0 -10px;
        }

        .high { background: #b5d592 !important; }
        .medium { background: #ffe87c !important; }
        .low { background: #fc8c84 !important; }

        span.cover-fill, span.cover-empty {
            display:inline-block;
            border:1px solid #444;
            background: white;
            height: 12px;
        }
        span.cover-fill {
            background: #ccc;
            border-right: 1px solid #444;
        }
        span.cover-empty {
            background: white;
            border-left: none;
        }
        span.cover-full {
            border-right: none !important;
        }
        pre.prettyprint {
            border: none !important;
            padding: 0 !important;
            margin: 0 !important;
        }
        .com { color: #999 !important; }
        .ignore-none { color: #999; font-weight: normal; }

    </style>
</head>
<body>
<div class="header low">
    <h1 style="font-weight: bold;">
        <a href="https://github.com/npmtest/node-npmtest-node-red">npmtest-node-red (v0.0.1)</a>
    </h1>
    <h1>Code coverage report for <span class="entity">node-npmtest-node-red/node-red/red/runtime/i18n.js</span></h1>
    <h2>
        
        Statements: <span class="metric">26.79% <small>(15 / 56)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        
        Branches: <span class="metric">0% <small>(0 / 22)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        
        Functions: <span class="metric">0% <small>(0 / 13)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        
        Lines: <span class="metric">26.79% <small>(15 / 56)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        Ignored: <span class="metric"><span class="ignore-none">none</span></span> &nbsp;&nbsp;&nbsp;&nbsp;
    </h2>
    <div class="path"><a href="../../../../index.html">All files</a> &#187; <a href="index.html">node-npmtest-node-red/node-red/red/runtime/</a> &#187; i18n.js</div>
</div>
<div class="body">
<pre><table class="coverage">
<tr><td class="line-count">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134</td><td class="line-coverage"><span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span></td><td class="text"><pre class="prettyprint lang-js">/**
 * Copyright JS Foundation and other contributors, http://js.foundation
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 **/
&nbsp;
var i18n = require("i18next");
var when = require("when");
var path = require("path");
var fs = require("fs");
&nbsp;
var defaultLang = "en-US";
&nbsp;
var resourceMap = {};
var resourceCache = {};
&nbsp;
<span class="fstat-no" title="function not covered" >function registerMessageCatalogs(catalogs) {</span>
<span class="cstat-no" title="statement not covered" >    var promises = catalogs.map(<span class="fstat-no" title="function not covered" >function(catalog) {</span></span>
<span class="cstat-no" title="statement not covered" >        return registerMessageCatalog(catalog.namespace,catalog.dir,catalog.file);</span>
    });
<span class="cstat-no" title="statement not covered" >    return when.settle(promises);</span>
}
&nbsp;
<span class="fstat-no" title="function not covered" >function registerMessageCatalog(namespace,dir,file) {</span>
<span class="cstat-no" title="statement not covered" >    return when.promise(<span class="fstat-no" title="function not covered" >function(resolve,reject) {</span></span>
<span class="cstat-no" title="statement not covered" >        resourceMap[namespace] = { basedir:dir, file:file};</span>
<span class="cstat-no" title="statement not covered" >        i18n.loadNamespace(namespace,<span class="fstat-no" title="function not covered" >function() {</span></span>
<span class="cstat-no" title="statement not covered" >            resolve();</span>
        });
    });
}
&nbsp;
<span class="fstat-no" title="function not covered" >function mergeCatalog(fallback,catalog) {</span>
<span class="cstat-no" title="statement not covered" >    for (var k in fallback) {</span>
<span class="cstat-no" title="statement not covered" >        if (fallback.hasOwnProperty(k)) {</span>
<span class="cstat-no" title="statement not covered" >            if (!catalog[k]) {</span>
<span class="cstat-no" title="statement not covered" >                catalog[k] = fallback[k];</span>
            } else <span class="cstat-no" title="statement not covered" >if (typeof fallback[k] === 'object') {</span>
<span class="cstat-no" title="statement not covered" >                mergeCatalog(fallback[k],catalog[k]);</span>
            }
        }
    }
}
&nbsp;
var MessageFileLoader = {
    fetchOne: <span class="fstat-no" title="function not covered" >function(lng, ns, callback) {</span>
<span class="cstat-no" title="statement not covered" >        if (resourceMap[ns]) {</span>
<span class="cstat-no" title="statement not covered" >            var file = path.join(resourceMap[ns].basedir,lng,resourceMap[ns].file);</span>
            //console.log(file);
<span class="cstat-no" title="statement not covered" >            fs.readFile(file,"utf8",<span class="fstat-no" title="function not covered" >function(err,content) {</span></span>
<span class="cstat-no" title="statement not covered" >                if (err) {</span>
<span class="cstat-no" title="statement not covered" >                    callback(err);</span>
                } else {
<span class="cstat-no" title="statement not covered" >                    try {</span>
<span class="cstat-no" title="statement not covered" >                        resourceCache[ns] = resourceCache[ns]||{};</span>
<span class="cstat-no" title="statement not covered" >                        resourceCache[ns][lng] = JSON.parse(content.replace(/^\uFEFF/, ''));</span>
                        //console.log(resourceCache[ns][lng]);
<span class="cstat-no" title="statement not covered" >                        if (lng !== defaultLang) {</span>
<span class="cstat-no" title="statement not covered" >                            mergeCatalog(resourceCache[ns][defaultLang],resourceCache[ns][lng]);</span>
                        }
<span class="cstat-no" title="statement not covered" >                        callback(null, resourceCache[ns][lng]);</span>
                    } catch(e) {
<span class="cstat-no" title="statement not covered" >                        callback(e);</span>
                    }
                }
            });
        } else {
<span class="cstat-no" title="statement not covered" >            callback(new Error("Unrecognised namespace"));</span>
        }
    }
&nbsp;
}
&nbsp;
<span class="fstat-no" title="function not covered" >function init() {</span>
<span class="cstat-no" title="statement not covered" >    return when.promise(<span class="fstat-no" title="function not covered" >function(resolve,reject) {</span></span>
<span class="cstat-no" title="statement not covered" >        i18n.backend(MessageFileLoader);</span>
<span class="cstat-no" title="statement not covered" >        i18n.init({</span>
            ns: {
                namespaces: [],
                defaultNs: "runtime"
            },
            fallbackLng: [defaultLang]
        },<span class="fstat-no" title="function not covered" >function() {</span>
<span class="cstat-no" title="statement not covered" >            resolve();</span>
        });
    });
}
&nbsp;
<span class="fstat-no" title="function not covered" >function getCatalog(namespace,lang) {</span>
<span class="cstat-no" title="statement not covered" >    var result = null;</span>
<span class="cstat-no" title="statement not covered" >    if (resourceCache.hasOwnProperty(namespace)) {</span>
<span class="cstat-no" title="statement not covered" >        result = resourceCache[namespace][lang];</span>
<span class="cstat-no" title="statement not covered" >        if (!result) {</span>
<span class="cstat-no" title="statement not covered" >            var langParts = lang.split("-");</span>
<span class="cstat-no" title="statement not covered" >            if (langParts.length == 2) {</span>
<span class="cstat-no" title="statement not covered" >                result = resourceCache[namespace][langParts[0]];</span>
            }
<span class="cstat-no" title="statement not covered" >            if (!result) {</span>
<span class="cstat-no" title="statement not covered" >                return resourceCache[namespace][defaultLang];</span>
            }
        }
    }
<span class="cstat-no" title="statement not covered" >    return result;</span>
}
&nbsp;
var obj = module.exports = {
    init: init,
    registerMessageCatalog: registerMessageCatalog,
    registerMessageCatalogs: registerMessageCatalogs,
    catalog: getCatalog,
    i: i18n,
    defaultLang: defaultLang
}
&nbsp;
obj['_'] = <span class="fstat-no" title="function not covered" >function() {</span>
    //var opts = {};
    //if (def) {
    //    opts.defaultValue = def;
    //}
    //console.log(arguments);
<span class="cstat-no" title="statement not covered" >    return i18n.t.apply(null,arguments);</span>
}
&nbsp;
&nbsp;</pre></td></tr>
</table></pre>
</div>
<div class="footer">
    <div class="meta">Generated by <a href="https://github.com/kaizhu256/node-utility2" target="_blank">utility2</a> at Tue Apr 11 2017 17:25:15 GMT+0000 (UTC)</div>
</div>
</body>
</html>


<!doctype html>
<html lang="en">
<head>
    <title>Code coverage report for node-npmtest-node-red/node-red/red/runtime/index.js</title>
    <meta charset="utf-8">
    <style>
        body, html {
            margin:0; padding: 0;
        }
        body {
            font-family: Arial, Helvetica;
            font-size: 10pt;
        }
        div.header, div.footer {
            background: #eee;
            padding: 1em;
        }
        div.header {
            height: 160px;
            padding: 0 1em 0 1em;
            z-index: 100;
            position: fixed;
            top: 0;
            border-bottom: 1px solid #666;
            width: 100%;
        }
        div.footer {
            border-top: 1px solid #666;
        }
        div.body {
            margin-top: 170px;
        }
        div.meta {
            font-size: 90%;
            text-align: center;
        }
        h1, h2, h3 {
            font-weight: normal;
        }
        h1 {
            font-size: 12pt;
        }
        h2 {
            font-size: 10pt;
        }
        pre {
            font-family: Menlo, Monaco, Consolas, Courier New, monospace;
            margin: 0;
            padding: 0;
            font-size: 14px;
            tab-size: 2;
        }

        div.path { font-size: 110%; }
        div.path a:link, div.path a:visited { color: #000; }
        table.coverage { border-collapse: collapse; margin:0; padding: 0 }

        table.coverage td {
            margin: 0;
            padding: 0;
            color: #111;
            vertical-align: top;
        }
        table.coverage td.line-count {
            width: 50px;
            text-align: right;
            padding-right: 5px;
        }
        table.coverage td.line-coverage {
            color: #777 !important;
            text-align: right;
            border-left: 1px solid #666;
            border-right: 1px solid #666;
        }

        table.coverage td.text {
        }

        table.coverage td span.cline-any {
            display: inline-block;
            padding: 0 5px;
            width: 40px;
        }
        table.coverage td span.cline-neutral {
            background: #eee;
        }
        table.coverage td span.cline-yes {
            background: #b5d592;
            color: #999;
        }
        table.coverage td span.cline-no {
            background: #fc8c84;
        }

        .cstat-yes { color: #111; }
        .cstat-no { background: #fc8c84; color: #111; }
        .fstat-no { background: #ffc520; color: #111 !important; }
        .cbranch-no { background:  yellow !important; color: #111; }

        .cstat-skip { background: #ddd; color: #111; }
        .fstat-skip { background: #ddd; color: #111 !important; }
        .cbranch-skip { background: #ddd !important; color: #111; }

        .missing-if-branch {
            display: inline-block;
            margin-right: 10px;
            position: relative;
            padding: 0 4px;
            background: black;
            color: yellow;
        }

        .skip-if-branch {
            display: none;
            margin-right: 10px;
            position: relative;
            padding: 0 4px;
            background: #ccc;
            color: white;
        }

        .missing-if-branch .typ, .skip-if-branch .typ {
            color: inherit !important;
        }

        .entity, .metric { font-weight: bold; }
        .metric { display: inline-block; border: 1px solid #333; padding: 0.3em; background: white; }
        .metric small { font-size: 80%; font-weight: normal; color: #666; }

        div.coverage-summary table { border-collapse: collapse; margin: 3em; font-size: 110%; }
        div.coverage-summary td, div.coverage-summary table  th { margin: 0; padding: 0.25em 1em; border-top: 1px solid #666; border-bottom: 1px solid #666; }
        div.coverage-summary th { text-align: left; border: 1px solid #666; background: #eee; font-weight: normal; }
        div.coverage-summary th.file { border-right: none !important; }
        div.coverage-summary th.pic { border-left: none !important; text-align: right; }
        div.coverage-summary th.pct { border-right: none !important; }
        div.coverage-summary th.abs { border-left: none !important; text-align: right; }
        div.coverage-summary td.pct { text-align: right; border-left: 1px solid #666; }
        div.coverage-summary td.abs { text-align: right; font-size: 90%; color: #444; border-right: 1px solid #666; }
        div.coverage-summary td.file { text-align: right; border-left: 1px solid #666; white-space: nowrap;  }
        div.coverage-summary td.pic { min-width: 120px !important;  }
        div.coverage-summary a:link { color: #000; }
        div.coverage-summary a:visited { color: #333; }
        div.coverage-summary tfoot td { border-top: 1px solid #666; }

        div.coverage-summary .yui3-datatable-sort-indicator, div.coverage-summary .dummy-sort-indicator {
            height: 10px;
            width: 7px;
            display: inline-block;
            margin-left: 0.5em;
        }
        div.coverage-summary .yui3-datatable-sort-indicator {
            background: no-repeat scroll 0 0 transparent;
        }
        div.coverage-summary .yui3-datatable-sorted .yui3-datatable-sort-indicator {
            background-position: 0 -20px;
        }
        div.coverage-summary .yui3-datatable-sorted-desc .yui3-datatable-sort-indicator {
            background-position: 0 -10px;
        }

        .high { background: #b5d592 !important; }
        .medium { background: #ffe87c !important; }
        .low { background: #fc8c84 !important; }

        span.cover-fill, span.cover-empty {
            display:inline-block;
            border:1px solid #444;
            background: white;
            height: 12px;
        }
        span.cover-fill {
            background: #ccc;
            border-right: 1px solid #444;
        }
        span.cover-empty {
            background: white;
            border-left: none;
        }
        span.cover-full {
            border-right: none !important;
        }
        pre.prettyprint {
            border: none !important;
            padding: 0 !important;
            margin: 0 !important;
        }
        .com { color: #999 !important; }
        .ignore-none { color: #999; font-weight: normal; }

    </style>
</head>
<body>
<div class="header low">
    <h1 style="font-weight: bold;">
        <a href="https://github.com/npmtest/node-npmtest-node-red">npmtest-node-red (v0.0.1)</a>
    </h1>
    <h1>Code coverage report for <span class="entity">node-npmtest-node-red/node-red/red/runtime/index.js</span></h1>
    <h2>
        
        Statements: <span class="metric">23.96% <small>(23 / 96)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        
        Branches: <span class="metric">0% <small>(0 / 34)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        
        Functions: <span class="metric">0% <small>(0 / 25)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        
        Lines: <span class="metric">24.47% <small>(23 / 94)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        Ignored: <span class="metric"><span class="ignore-none">none</span></span> &nbsp;&nbsp;&nbsp;&nbsp;
    </h2>
    <div class="path"><a href="../../../../index.html">All files</a> &#187; <a href="index.html">node-npmtest-node-red/node-red/red/runtime/</a> &#187; index.js</div>
</div>
<div class="body">
<pre><table class="coverage">
<tr><td class="line-count">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
164
165
166
167
168
169
170
171
172
173
174
175
176
177
178
179
180
181
182
183
184
185
186
187
188
189
190
191
192
193
194
195
196
197
198
199
200
201
202
203
204
205
206
207
208
209</td><td class="line-coverage"><span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span></td><td class="text"><pre class="prettyprint lang-js">/**
 * Copyright JS Foundation and other contributors, http://js.foundation
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 **/
&nbsp;
var when = require('when');
&nbsp;
var redNodes = require("./nodes");
var storage = require("./storage");
var log = require("./log");
var i18n = require("./i18n");
var events = require("./events");
var settings = require("./settings");
&nbsp;
var express = require("express");
var path = require('path');
var fs = require("fs");
var os = require("os");
&nbsp;
var runtimeMetricInterval = null;
&nbsp;
var started = false;
&nbsp;
var stubbedExpressApp = {
    get: <span class="fstat-no" title="function not covered" >function() {</span>},
    post: <span class="fstat-no" title="function not covered" >function() {</span>},
    put: <span class="fstat-no" title="function not covered" >function() {</span>},
    delete: <span class="fstat-no" title="function not covered" >function() {</span>}
}
var adminApi = {
    library: {
        register: <span class="fstat-no" title="function not covered" >function() {</span>}
    },
    auth: {
        needsPermission: <span class="fstat-no" title="function not covered" >function() {</span>}
    },
    comms: {
        publish: <span class="fstat-no" title="function not covered" >function() {</span>}
    },
    adminApp: stubbedExpressApp,
    server: {}
}
&nbsp;
var nodeApp;
&nbsp;
<span class="fstat-no" title="function not covered" >function init(userSettings,_adminApi) {</span>
<span class="cstat-no" title="statement not covered" >    userSettings.version = getVersion();</span>
<span class="cstat-no" title="statement not covered" >    log.init(userSettings);</span>
<span class="cstat-no" title="statement not covered" >    settings.init(userSettings);</span>
&nbsp;
<span class="cstat-no" title="statement not covered" >    nodeApp = express();</span>
&nbsp;
<span class="cstat-no" title="statement not covered" >    if (_adminApi) {</span>
<span class="cstat-no" title="statement not covered" >        adminApi = _adminApi;</span>
    }
<span class="cstat-no" title="statement not covered" >    redNodes.init(runtime);</span>
}
&nbsp;
var version;
&nbsp;
<span class="fstat-no" title="function not covered" >function getVersion() {</span>
<span class="cstat-no" title="statement not covered" >    if (!version) {</span>
<span class="cstat-no" title="statement not covered" >        version = require(path.join(__dirname,"..","..","package.json")).version;</span>
        /* istanbul ignore else */
<span class="cstat-no" title="statement not covered" >        try {</span>
<span class="cstat-no" title="statement not covered" >            fs.statSync(path.join(__dirname,"..","..",".git"));</span>
<span class="cstat-no" title="statement not covered" >            version += "-git";</span>
        } catch(err) {
            // No git directory
        }
    }
<span class="cstat-no" title="statement not covered" >    return version;</span>
}
&nbsp;
<span class="fstat-no" title="function not covered" >function start() {</span>
<span class="cstat-no" title="statement not covered" >    return i18n.init()</span>
        .then(<span class="fstat-no" title="function not covered" >function() {</span>
<span class="cstat-no" title="statement not covered" >            return i18n.registerMessageCatalog("runtime",path.resolve(path.join(__dirname,"locales")),"runtime.json")</span>
        })
        .then(<span class="fstat-no" title="function not covered" >function() {</span> <span class="cstat-no" title="statement not covered" >return storage.init(runtime)}</span>)
        .then(<span class="fstat-no" title="function not covered" >function() {</span> <span class="cstat-no" title="statement not covered" >return settings.load(storage)}</span>)
        .then(<span class="fstat-no" title="function not covered" >function() {</span>
&nbsp;
<span class="cstat-no" title="statement not covered" >            if (log.metric()) {</span>
<span class="cstat-no" title="statement not covered" >                runtimeMetricInterval = setInterval(<span class="fstat-no" title="function not covered" >function() {</span></span>
<span class="cstat-no" title="statement not covered" >                    reportMetrics();</span>
                }, settings.runtimeMetricInterval||15000);
            }
<span class="cstat-no" title="statement not covered" >            log.info("\n\n"+log._("runtime.welcome")+"\n===================\n");</span>
<span class="cstat-no" title="statement not covered" >            if (settings.version) {</span>
<span class="cstat-no" title="statement not covered" >                log.info(log._("runtime.version",{component:"Node-RED",version:"v"+settings.version}));</span>
            }
<span class="cstat-no" title="statement not covered" >            log.info(log._("runtime.version",{component:"Node.js ",version:process.version}));</span>
<span class="cstat-no" title="statement not covered" >            if (settings.UNSUPPORTED_VERSION) {</span>
<span class="cstat-no" title="statement not covered" >                log.error("*****************************************************************");</span>
<span class="cstat-no" title="statement not covered" >                log.error("* "+log._("runtime.unsupported_version",{component:"Node.js",version:process.version,requires: "&gt;=4"})+" *");</span>
<span class="cstat-no" title="statement not covered" >                log.error("*****************************************************************");</span>
<span class="cstat-no" title="statement not covered" >                events.emit("runtime-event",{id:"runtime-unsupported-version",type:"error",text:"notification.errors.unsupportedVersion"});</span>
            }
<span class="cstat-no" title="statement not covered" >            log.info(os.type()+" "+os.release()+" "+os.arch()+" "+os.endianness());</span>
<span class="cstat-no" title="statement not covered" >            return redNodes.load().then(<span class="fstat-no" title="function not covered" >function() {</span></span>
&nbsp;
<span class="cstat-no" title="statement not covered" >                var i;</span>
<span class="cstat-no" title="statement not covered" >                var nodeErrors = redNodes.getNodeList(<span class="fstat-no" title="function not covered" >function(n) {</span> <span class="cstat-no" title="statement not covered" >return n.err!=null;}</span>);</span>
<span class="cstat-no" title="statement not covered" >                var nodeMissing = redNodes.getNodeList(<span class="fstat-no" title="function not covered" >function(n) {</span> <span class="cstat-no" title="statement not covered" >return n.module &amp;&amp; n.enabled &amp;&amp; !n.loaded &amp;&amp; !n.err;}</span>);</span>
<span class="cstat-no" title="statement not covered" >                if (nodeErrors.length &gt; 0) {</span>
<span class="cstat-no" title="statement not covered" >                    log.warn("------------------------------------------------------");</span>
<span class="cstat-no" title="statement not covered" >                    for (i=0;i&lt;nodeErrors.length;i+=1) {</span>
<span class="cstat-no" title="statement not covered" >                        log.warn("["+nodeErrors[i].name+"] "+nodeErrors[i].err);</span>
                    }
<span class="cstat-no" title="statement not covered" >                    log.warn("------------------------------------------------------");</span>
                }
<span class="cstat-no" title="statement not covered" >                if (nodeMissing.length &gt; 0) {</span>
<span class="cstat-no" title="statement not covered" >                    log.warn(log._("server.missing-modules"));</span>
<span class="cstat-no" title="statement not covered" >                    var missingModules = {};</span>
<span class="cstat-no" title="statement not covered" >                    for (i=0;i&lt;nodeMissing.length;i++) {</span>
<span class="cstat-no" title="statement not covered" >                        var missing = nodeMissing[i];</span>
<span class="cstat-no" title="statement not covered" >                        missingModules[missing.module] = (missingModules[missing.module]||[]).concat(missing.types);</span>
                    }
<span class="cstat-no" title="statement not covered" >                    var promises = [];</span>
<span class="cstat-no" title="statement not covered" >                    for (i in missingModules) {</span>
<span class="cstat-no" title="statement not covered" >                        if (missingModules.hasOwnProperty(i)) {</span>
<span class="cstat-no" title="statement not covered" >                            log.warn(" - "+i+": "+missingModules[i].join(", "));</span>
<span class="cstat-no" title="statement not covered" >                            if (settings.autoInstallModules &amp;&amp; i != "node-red") {</span>
<span class="cstat-no" title="statement not covered" >                                redNodes.installModule(i).otherwise(<span class="fstat-no" title="function not covered" >function(err) {</span></span>
                                    // Error already reported. Need the otherwise handler
                                    // to stop the error propagating any further
                                });
                            }
                        }
                    }
<span class="cstat-no" title="statement not covered" >                    if (!settings.autoInstallModules) {</span>
<span class="cstat-no" title="statement not covered" >                        log.info(log._("server.removing-modules"));</span>
<span class="cstat-no" title="statement not covered" >                        redNodes.cleanModuleList();</span>
                    }
                }
<span class="cstat-no" title="statement not covered" >                if (settings.settingsFile) {</span>
<span class="cstat-no" title="statement not covered" >                    log.info(log._("runtime.paths.settings",{path:settings.settingsFile}));</span>
                }
<span class="cstat-no" title="statement not covered" >                redNodes.loadFlows().then(redNodes.startFlows);</span>
<span class="cstat-no" title="statement not covered" >                started = true;</span>
            }).otherwise(<span class="fstat-no" title="function not covered" >function(err) {</span>
<span class="cstat-no" title="statement not covered" >                console.log(err);</span>
            });
        });
}
&nbsp;
<span class="fstat-no" title="function not covered" >function reportMetrics() {</span>
<span class="cstat-no" title="statement not covered" >    var memUsage = process.memoryUsage();</span>
&nbsp;
<span class="cstat-no" title="statement not covered" >    log.log({</span>
        level: log.METRIC,
        event: "runtime.memory.rss",
        value: memUsage.rss
    });
<span class="cstat-no" title="statement not covered" >    log.log({</span>
        level: log.METRIC,
        event: "runtime.memory.heapTotal",
        value: memUsage.heapTotal
    });
<span class="cstat-no" title="statement not covered" >    log.log({</span>
        level: log.METRIC,
        event: "runtime.memory.heapUsed",
        value: memUsage.heapUsed
    });
}
&nbsp;
<span class="fstat-no" title="function not covered" >function stop() {</span>
<span class="cstat-no" title="statement not covered" >    if (runtimeMetricInterval) {</span>
<span class="cstat-no" title="statement not covered" >        clearInterval(runtimeMetricInterval);</span>
<span class="cstat-no" title="statement not covered" >        runtimeMetricInterval = null;</span>
    }
<span class="cstat-no" title="statement not covered" >    started = false;</span>
<span class="cstat-no" title="statement not covered" >    return redNodes.stopFlows();</span>
}
&nbsp;
var runtime = module.exports = {
    init: init,
    start: start,
    stop: stop,
&nbsp;
    version: getVersion,
&nbsp;
    log: log,
    i18n: i18n,
    settings: settings,
    storage: storage,
    events: events,
    nodes: redNodes,
    util: require("./util"),
    get adminApi<span class="fstat-no" title="function not covered" >() {</span> <span class="cstat-no" title="statement not covered" >return adminApi }</span>,
    get nodeApp<span class="fstat-no" title="function not covered" >() {</span> <span class="cstat-no" title="statement not covered" >return nodeApp }</span>,
    isStarted: <span class="fstat-no" title="function not covered" >function() {</span>
<span class="cstat-no" title="statement not covered" >        return started;</span>
    }
}
&nbsp;
&nbsp;</pre></td></tr>
</table></pre>
</div>
<div class="footer">
    <div class="meta">Generated by <a href="https://github.com/kaizhu256/node-utility2" target="_blank">utility2</a> at Tue Apr 11 2017 17:25:15 GMT+0000 (UTC)</div>
</div>
</body>
</html>


<!doctype html>
<html lang="en">
<head>
    <title>Code coverage report for node-npmtest-node-red/node-red/red/runtime/log.js</title>
    <meta charset="utf-8">
    <style>
        body, html {
            margin:0; padding: 0;
        }
        body {
            font-family: Arial, Helvetica;
            font-size: 10pt;
        }
        div.header, div.footer {
            background: #eee;
            padding: 1em;
        }
        div.header {
            height: 160px;
            padding: 0 1em 0 1em;
            z-index: 100;
            position: fixed;
            top: 0;
            border-bottom: 1px solid #666;
            width: 100%;
        }
        div.footer {
            border-top: 1px solid #666;
        }
        div.body {
            margin-top: 170px;
        }
        div.meta {
            font-size: 90%;
            text-align: center;
        }
        h1, h2, h3 {
            font-weight: normal;
        }
        h1 {
            font-size: 12pt;
        }
        h2 {
            font-size: 10pt;
        }
        pre {
            font-family: Menlo, Monaco, Consolas, Courier New, monospace;
            margin: 0;
            padding: 0;
            font-size: 14px;
            tab-size: 2;
        }

        div.path { font-size: 110%; }
        div.path a:link, div.path a:visited { color: #000; }
        table.coverage { border-collapse: collapse; margin:0; padding: 0 }

        table.coverage td {
            margin: 0;
            padding: 0;
            color: #111;
            vertical-align: top;
        }
        table.coverage td.line-count {
            width: 50px;
            text-align: right;
            padding-right: 5px;
        }
        table.coverage td.line-coverage {
            color: #777 !important;
            text-align: right;
            border-left: 1px solid #666;
            border-right: 1px solid #666;
        }

        table.coverage td.text {
        }

        table.coverage td span.cline-any {
            display: inline-block;
            padding: 0 5px;
            width: 40px;
        }
        table.coverage td span.cline-neutral {
            background: #eee;
        }
        table.coverage td span.cline-yes {
            background: #b5d592;
            color: #999;
        }
        table.coverage td span.cline-no {
            background: #fc8c84;
        }

        .cstat-yes { color: #111; }
        .cstat-no { background: #fc8c84; color: #111; }
        .fstat-no { background: #ffc520; color: #111 !important; }
        .cbranch-no { background:  yellow !important; color: #111; }

        .cstat-skip { background: #ddd; color: #111; }
        .fstat-skip { background: #ddd; color: #111 !important; }
        .cbranch-skip { background: #ddd !important; color: #111; }

        .missing-if-branch {
            display: inline-block;
            margin-right: 10px;
            position: relative;
            padding: 0 4px;
            background: black;
            color: yellow;
        }

        .skip-if-branch {
            display: none;
            margin-right: 10px;
            position: relative;
            padding: 0 4px;
            background: #ccc;
            color: white;
        }

        .missing-if-branch .typ, .skip-if-branch .typ {
            color: inherit !important;
        }

        .entity, .metric { font-weight: bold; }
        .metric { display: inline-block; border: 1px solid #333; padding: 0.3em; background: white; }
        .metric small { font-size: 80%; font-weight: normal; color: #666; }

        div.coverage-summary table { border-collapse: collapse; margin: 3em; font-size: 110%; }
        div.coverage-summary td, div.coverage-summary table  th { margin: 0; padding: 0.25em 1em; border-top: 1px solid #666; border-bottom: 1px solid #666; }
        div.coverage-summary th { text-align: left; border: 1px solid #666; background: #eee; font-weight: normal; }
        div.coverage-summary th.file { border-right: none !important; }
        div.coverage-summary th.pic { border-left: none !important; text-align: right; }
        div.coverage-summary th.pct { border-right: none !important; }
        div.coverage-summary th.abs { border-left: none !important; text-align: right; }
        div.coverage-summary td.pct { text-align: right; border-left: 1px solid #666; }
        div.coverage-summary td.abs { text-align: right; font-size: 90%; color: #444; border-right: 1px solid #666; }
        div.coverage-summary td.file { text-align: right; border-left: 1px solid #666; white-space: nowrap;  }
        div.coverage-summary td.pic { min-width: 120px !important;  }
        div.coverage-summary a:link { color: #000; }
        div.coverage-summary a:visited { color: #333; }
        div.coverage-summary tfoot td { border-top: 1px solid #666; }

        div.coverage-summary .yui3-datatable-sort-indicator, div.coverage-summary .dummy-sort-indicator {
            height: 10px;
            width: 7px;
            display: inline-block;
            margin-left: 0.5em;
        }
        div.coverage-summary .yui3-datatable-sort-indicator {
            background: no-repeat scroll 0 0 transparent;
        }
        div.coverage-summary .yui3-datatable-sorted .yui3-datatable-sort-indicator {
            background-position: 0 -20px;
        }
        div.coverage-summary .yui3-datatable-sorted-desc .yui3-datatable-sort-indicator {
            background-position: 0 -10px;
        }

        .high { background: #b5d592 !important; }
        .medium { background: #ffe87c !important; }
        .low { background: #fc8c84 !important; }

        span.cover-fill, span.cover-empty {
            display:inline-block;
            border:1px solid #444;
            background: white;
            height: 12px;
        }
        span.cover-fill {
            background: #ccc;
            border-right: 1px solid #444;
        }
        span.cover-empty {
            background: white;
            border-left: none;
        }
        span.cover-full {
            border-right: none !important;
        }
        pre.prettyprint {
            border: none !important;
            padding: 0 !important;
            margin: 0 !important;
        }
        .com { color: #999 !important; }
        .ignore-none { color: #999; font-weight: normal; }

    </style>
</head>
<body>
<div class="header low">
    <h1 style="font-weight: bold;">
        <a href="https://github.com/npmtest/node-npmtest-node-red">npmtest-node-red (v0.0.1)</a>
    </h1>
    <h1>Code coverage report for <span class="entity">node-npmtest-node-red/node-red/red/runtime/log.js</span></h1>
    <h2>
        
        Statements: <span class="metric">21.67% <small>(13 / 60)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        
        Branches: <span class="metric">0% <small>(0 / 57)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        
        Functions: <span class="metric">0% <small>(0 / 16)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        
        Lines: <span class="metric">21.67% <small>(13 / 60)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        Ignored: <span class="metric"><span class="ignore-none">none</span></span> &nbsp;&nbsp;&nbsp;&nbsp;
    </h2>
    <div class="path"><a href="../../../../index.html">All files</a> &#187; <a href="index.html">node-npmtest-node-red/node-red/red/runtime/</a> &#187; log.js</div>
</div>
<div class="body">
<pre><table class="coverage">
<tr><td class="line-count">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161</td><td class="line-coverage"><span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span></td><td class="text"><pre class="prettyprint lang-js">/**
 * Copyright JS Foundation and other contributors, http://js.foundation
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 **/
&nbsp;
var util = require("util");
var EventEmitter = require("events").EventEmitter;
&nbsp;
var i18n = require("./i18n");
&nbsp;
var levels = {
    off:    1,
    fatal:  10,
    error:  20,
    warn:   30,
    info:   40,
    debug:  50,
    trace:  60,
    audit:  98,
    metric: 99
};
&nbsp;
var levelNames = {
    10: "fatal",
    20: "error",
    30: "warn",
    40: "info",
    50: "debug",
    60: "trace",
    98: "audit",
    99: "metric"
};
&nbsp;
var logHandlers = [];
&nbsp;
var metricsEnabled = false;
&nbsp;
var LogHandler = <span class="fstat-no" title="function not covered" >function(settings) {</span>
<span class="cstat-no" title="statement not covered" >    this.logLevel  = settings ? levels[settings.level]||levels.info : levels.info;</span>
<span class="cstat-no" title="statement not covered" >    this.metricsOn = settings ? settings.metrics||false : false;</span>
<span class="cstat-no" title="statement not covered" >    this.auditOn = settings ? settings.audit||false : false;</span>
&nbsp;
<span class="cstat-no" title="statement not covered" >    metricsEnabled = metricsEnabled || this.metricsOn;</span>
&nbsp;
<span class="cstat-no" title="statement not covered" >    this.handler   = (settings &amp;&amp; settings.handler) ? settings.handler(settings) : consoleLogger;</span>
<span class="cstat-no" title="statement not covered" >    this.on("log",<span class="fstat-no" title="function not covered" >function(msg) {</span></span>
<span class="cstat-no" title="statement not covered" >        if (this.shouldReportMessage(msg.level)) {</span>
<span class="cstat-no" title="statement not covered" >            this.handler(msg);</span>
        }
    });
}
util.inherits(LogHandler, EventEmitter);
&nbsp;
LogHandler.prototype.shouldReportMessage = <span class="fstat-no" title="function not covered" >function(msglevel) {</span>
<span class="cstat-no" title="statement not covered" >    return (msglevel == log.METRIC &amp;&amp; this.metricsOn) ||</span>
           (msglevel == log.AUDIT &amp;&amp; this.auditOn) ||
           msglevel &lt;= this.logLevel;
}
&nbsp;
var consoleLogger = <span class="fstat-no" title="function not covered" >function(msg) {</span>
<span class="cstat-no" title="statement not covered" >    if (msg.level == log.METRIC || msg.level == log.AUDIT) {</span>
<span class="cstat-no" title="statement not covered" >        util.log("["+levelNames[msg.level]+"] "+JSON.stringify(msg));</span>
    } else {
<span class="cstat-no" title="statement not covered" >        var message = msg.msg;</span>
<span class="cstat-no" title="statement not covered" >        if (typeof message === 'object' &amp;&amp; message.toString() === '[object Object]' &amp;&amp; message.message) {</span>
<span class="cstat-no" title="statement not covered" >            message = message.message;</span>
        }
<span class="cstat-no" title="statement not covered" >        util.log("["+levelNames[msg.level]+"] "+(msg.type?"["+msg.type+":"+(msg.name||msg.id)+"] ":"")+message);</span>
    }
}
&nbsp;
var log = module.exports = {
    FATAL:  10,
    ERROR:  20,
    WARN:   30,
    INFO:   40,
    DEBUG:  50,
    TRACE:  60,
    AUDIT:  98,
    METRIC: 99,
&nbsp;
    init: <span class="fstat-no" title="function not covered" >function(settings) {</span>
<span class="cstat-no" title="statement not covered" >        metricsEnabled = false;</span>
<span class="cstat-no" title="statement not covered" >        logHandlers = [];</span>
<span class="cstat-no" title="statement not covered" >        var loggerSettings = {};</span>
<span class="cstat-no" title="statement not covered" >        if (settings.logging) {</span>
<span class="cstat-no" title="statement not covered" >            var keys = Object.keys(settings.logging);</span>
<span class="cstat-no" title="statement not covered" >            if (keys.length === 0) {</span>
<span class="cstat-no" title="statement not covered" >                log.addHandler(new LogHandler());</span>
            } else {
<span class="cstat-no" title="statement not covered" >                for (var i=0, l=keys.length; i&lt;l; i++) {</span>
<span class="cstat-no" title="statement not covered" >                    var config = settings.logging[keys[i]];</span>
<span class="cstat-no" title="statement not covered" >                    loggerSettings = config || {};</span>
<span class="cstat-no" title="statement not covered" >                    if ((keys[i] === "console") || config.handler) {</span>
<span class="cstat-no" title="statement not covered" >                        log.addHandler(new LogHandler(loggerSettings));</span>
                    }
                }
            }
        } else {
<span class="cstat-no" title="statement not covered" >            log.addHandler(new LogHandler());</span>
        }
    },
    addHandler: <span class="fstat-no" title="function not covered" >function(func) {</span>
<span class="cstat-no" title="statement not covered" >        logHandlers.push(func);</span>
    },
    removeHandler: <span class="fstat-no" title="function not covered" >function(func) {</span>
<span class="cstat-no" title="statement not covered" >        var index = logHandlers.indexOf(func);</span>
<span class="cstat-no" title="statement not covered" >        if (index &gt; -1) {</span>
<span class="cstat-no" title="statement not covered" >            logHandlers.splice(index,1);</span>
        }
    },
    log: <span class="fstat-no" title="function not covered" >function(msg) {</span>
<span class="cstat-no" title="statement not covered" >        msg.timestamp = Date.now();</span>
<span class="cstat-no" title="statement not covered" >        logHandlers.forEach(<span class="fstat-no" title="function not covered" >function(handler) {</span></span>
<span class="cstat-no" title="statement not covered" >            handler.emit("log",msg);</span>
        });
    },
    info: <span class="fstat-no" title="function not covered" >function(msg) {</span>
<span class="cstat-no" title="statement not covered" >        log.log({level:log.INFO,msg:msg});</span>
    },
    warn: <span class="fstat-no" title="function not covered" >function(msg) {</span>
<span class="cstat-no" title="statement not covered" >        log.log({level:log.WARN,msg:msg});</span>
    },
    error: <span class="fstat-no" title="function not covered" >function(msg) {</span>
<span class="cstat-no" title="statement not covered" >        log.log({level:log.ERROR,msg:msg});</span>
    },
    trace: <span class="fstat-no" title="function not covered" >function(msg) {</span>
<span class="cstat-no" title="statement not covered" >        log.log({level:log.TRACE,msg:msg});</span>
    },
    debug: <span class="fstat-no" title="function not covered" >function(msg) {</span>
<span class="cstat-no" title="statement not covered" >        log.log({level:log.DEBUG,msg:msg});</span>
    },
    metric: <span class="fstat-no" title="function not covered" >function() {</span>
<span class="cstat-no" title="statement not covered" >        return metricsEnabled;</span>
    },
&nbsp;
    audit: <span class="fstat-no" title="function not covered" >function(msg,req) {</span>
<span class="cstat-no" title="statement not covered" >        msg.level = log.AUDIT;</span>
<span class="cstat-no" title="statement not covered" >        if (req) {</span>
<span class="cstat-no" title="statement not covered" >            msg.user = req.user;</span>
<span class="cstat-no" title="statement not covered" >            msg.path = req.path;</span>
<span class="cstat-no" title="statement not covered" >            msg.ip = (req.headers &amp;&amp; req.headers['x-forwarded-for']) || (req.connection &amp;&amp; req.connection.remoteAddress) || undefined;</span>
        }
<span class="cstat-no" title="statement not covered" >        log.log(msg);</span>
    }
}
&nbsp;
log["_"] = i18n._;
&nbsp;
&nbsp;</pre></td></tr>
</table></pre>
</div>
<div class="footer">
    <div class="meta">Generated by <a href="https://github.com/kaizhu256/node-utility2" target="_blank">utility2</a> at Tue Apr 11 2017 17:25:15 GMT+0000 (UTC)</div>
</div>
</body>
</html>


<!doctype html>
<html lang="en">
<head>
    <title>Code coverage report for node-npmtest-node-red/node-red/red/runtime/settings.js</title>
    <meta charset="utf-8">
    <style>
        body, html {
            margin:0; padding: 0;
        }
        body {
            font-family: Arial, Helvetica;
            font-size: 10pt;
        }
        div.header, div.footer {
            background: #eee;
            padding: 1em;
        }
        div.header {
            height: 160px;
            padding: 0 1em 0 1em;
            z-index: 100;
            position: fixed;
            top: 0;
            border-bottom: 1px solid #666;
            width: 100%;
        }
        div.footer {
            border-top: 1px solid #666;
        }
        div.body {
            margin-top: 170px;
        }
        div.meta {
            font-size: 90%;
            text-align: center;
        }
        h1, h2, h3 {
            font-weight: normal;
        }
        h1 {
            font-size: 12pt;
        }
        h2 {
            font-size: 10pt;
        }
        pre {
            font-family: Menlo, Monaco, Consolas, Courier New, monospace;
            margin: 0;
            padding: 0;
            font-size: 14px;
            tab-size: 2;
        }

        div.path { font-size: 110%; }
        div.path a:link, div.path a:visited { color: #000; }
        table.coverage { border-collapse: collapse; margin:0; padding: 0 }

        table.coverage td {
            margin: 0;
            padding: 0;
            color: #111;
            vertical-align: top;
        }
        table.coverage td.line-count {
            width: 50px;
            text-align: right;
            padding-right: 5px;
        }
        table.coverage td.line-coverage {
            color: #777 !important;
            text-align: right;
            border-left: 1px solid #666;
            border-right: 1px solid #666;
        }

        table.coverage td.text {
        }

        table.coverage td span.cline-any {
            display: inline-block;
            padding: 0 5px;
            width: 40px;
        }
        table.coverage td span.cline-neutral {
            background: #eee;
        }
        table.coverage td span.cline-yes {
            background: #b5d592;
            color: #999;
        }
        table.coverage td span.cline-no {
            background: #fc8c84;
        }

        .cstat-yes { color: #111; }
        .cstat-no { background: #fc8c84; color: #111; }
        .fstat-no { background: #ffc520; color: #111 !important; }
        .cbranch-no { background:  yellow !important; color: #111; }

        .cstat-skip { background: #ddd; color: #111; }
        .fstat-skip { background: #ddd; color: #111 !important; }
        .cbranch-skip { background: #ddd !important; color: #111; }

        .missing-if-branch {
            display: inline-block;
            margin-right: 10px;
            position: relative;
            padding: 0 4px;
            background: black;
            color: yellow;
        }

        .skip-if-branch {
            display: none;
            margin-right: 10px;
            position: relative;
            padding: 0 4px;
            background: #ccc;
            color: white;
        }

        .missing-if-branch .typ, .skip-if-branch .typ {
            color: inherit !important;
        }

        .entity, .metric { font-weight: bold; }
        .metric { display: inline-block; border: 1px solid #333; padding: 0.3em; background: white; }
        .metric small { font-size: 80%; font-weight: normal; color: #666; }

        div.coverage-summary table { border-collapse: collapse; margin: 3em; font-size: 110%; }
        div.coverage-summary td, div.coverage-summary table  th { margin: 0; padding: 0.25em 1em; border-top: 1px solid #666; border-bottom: 1px solid #666; }
        div.coverage-summary th { text-align: left; border: 1px solid #666; background: #eee; font-weight: normal; }
        div.coverage-summary th.file { border-right: none !important; }
        div.coverage-summary th.pic { border-left: none !important; text-align: right; }
        div.coverage-summary th.pct { border-right: none !important; }
        div.coverage-summary th.abs { border-left: none !important; text-align: right; }
        div.coverage-summary td.pct { text-align: right; border-left: 1px solid #666; }
        div.coverage-summary td.abs { text-align: right; font-size: 90%; color: #444; border-right: 1px solid #666; }
        div.coverage-summary td.file { text-align: right; border-left: 1px solid #666; white-space: nowrap;  }
        div.coverage-summary td.pic { min-width: 120px !important;  }
        div.coverage-summary a:link { color: #000; }
        div.coverage-summary a:visited { color: #333; }
        div.coverage-summary tfoot td { border-top: 1px solid #666; }

        div.coverage-summary .yui3-datatable-sort-indicator, div.coverage-summary .dummy-sort-indicator {
            height: 10px;
            width: 7px;
            display: inline-block;
            margin-left: 0.5em;
        }
        div.coverage-summary .yui3-datatable-sort-indicator {
            background: no-repeat scroll 0 0 transparent;
        }
        div.coverage-summary .yui3-datatable-sorted .yui3-datatable-sort-indicator {
            background-position: 0 -20px;
        }
        div.coverage-summary .yui3-datatable-sorted-desc .yui3-datatable-sort-indicator {
            background-position: 0 -10px;
        }

        .high { background: #b5d592 !important; }
        .medium { background: #ffe87c !important; }
        .low { background: #fc8c84 !important; }

        span.cover-fill, span.cover-empty {
            display:inline-block;
            border:1px solid #444;
            background: white;
            height: 12px;
        }
        span.cover-fill {
            background: #ccc;
            border-right: 1px solid #444;
        }
        span.cover-empty {
            background: white;
            border-left: none;
        }
        span.cover-full {
            border-right: none !important;
        }
        pre.prettyprint {
            border: none !important;
            padding: 0 !important;
            margin: 0 !important;
        }
        .com { color: #999 !important; }
        .ignore-none { color: #999; font-weight: normal; }

    </style>
</head>
<body>
<div class="header low">
    <h1 style="font-weight: bold;">
        <a href="https://github.com/npmtest/node-npmtest-node-red">npmtest-node-red (v0.0.1)</a>
    </h1>
    <h1>Code coverage report for <span class="entity">node-npmtest-node-red/node-red/red/runtime/settings.js</span></h1>
    <h2>
        
        Statements: <span class="metric">17.31% <small>(9 / 52)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        
        Branches: <span class="metric">8.33% <small>(2 / 24)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        
        Functions: <span class="metric">0% <small>(0 / 11)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        
        Lines: <span class="metric">18% <small>(9 / 50)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        Ignored: <span class="metric">2 branches</span> &nbsp;&nbsp;&nbsp;&nbsp;
    </h2>
    <div class="path"><a href="../../../../index.html">All files</a> &#187; <a href="index.html">node-npmtest-node-red/node-red/red/runtime/</a> &#187; settings.js</div>
</div>
<div class="body">
<pre><table class="coverage">
<tr><td class="line-count">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107</td><td class="line-coverage"><span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span></td><td class="text"><pre class="prettyprint lang-js">/**
 * Copyright JS Foundation and other contributors, http://js.foundation
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 **/
&nbsp;
var when = require("when");
var clone = require("clone");
var assert = require("assert");
var log = require("./log");
&nbsp;
var userSettings = null;
var globalSettings = null;
var storage = null;
&nbsp;
var persistentSettings = {
    init: <span class="fstat-no" title="function not covered" >function(settings) {</span>
<span class="cstat-no" title="statement not covered" >        userSettings = settings;</span>
<span class="cstat-no" title="statement not covered" >        for (var i in settings) {</span>
            /* istanbul ignore else */
<span class="cstat-no" title="statement not covered" >            if (settings.hasOwnProperty(i) &amp;&amp; i !== 'load' &amp;&amp; i !== 'get' &amp;&amp; i !== 'set' &amp;&amp; i !== 'available' &amp;&amp; i !== 'reset') {</span>
                // Don't allow any of the core functions get replaced via settings
<span class="cstat-no" title="statement not covered" >                (<span class="fstat-no" title="function not covered" >function() {</span></span>
<span class="cstat-no" title="statement not covered" >                    var j = i;</span>
<span class="cstat-no" title="statement not covered" >                    persistentSettings.__defineGetter__(j,<span class="fstat-no" title="function not covered" >function() {</span> <span class="cstat-no" title="statement not covered" >return userSettings[j]; </span>});</span>
<span class="cstat-no" title="statement not covered" >                    persistentSettings.__defineSetter__(j,<span class="fstat-no" title="function not covered" >function() {</span> <span class="cstat-no" title="statement not covered" >throw new Error("Property '"+j+"' is read-only"); </span>});</span>
                })();
            }
        }
<span class="cstat-no" title="statement not covered" >        globalSettings = null;</span>
    },
    load: <span class="fstat-no" title="function not covered" >function(_storage) {</span>
<span class="cstat-no" title="statement not covered" >        storage = _storage;</span>
<span class="cstat-no" title="statement not covered" >        return storage.getSettings().then(<span class="fstat-no" title="function not covered" >function(_settings) {</span></span>
<span class="cstat-no" title="statement not covered" >            globalSettings = _settings;</span>
        });
    },
    get: <span class="fstat-no" title="function not covered" >function(prop) {</span>
<span class="cstat-no" title="statement not covered" >        if (userSettings.hasOwnProperty(prop)) {</span>
<span class="cstat-no" title="statement not covered" >            return clone(userSettings[prop]);</span>
        }
<span class="cstat-no" title="statement not covered" >        if (globalSettings === null) {</span>
<span class="cstat-no" title="statement not covered" >            throw new Error(log._("settings.not-available"));</span>
        }
<span class="cstat-no" title="statement not covered" >        return clone(globalSettings[prop]);</span>
    },
&nbsp;
    set: <span class="fstat-no" title="function not covered" >function(prop,value) {</span>
<span class="cstat-no" title="statement not covered" >        if (userSettings.hasOwnProperty(prop)) {</span>
<span class="cstat-no" title="statement not covered" >            throw new Error(log._("settings.property-read-only", {prop:prop}));</span>
        }
<span class="cstat-no" title="statement not covered" >        if (globalSettings === null) {</span>
<span class="cstat-no" title="statement not covered" >            throw new Error(log._("settings.not-available"));</span>
        }
<span class="cstat-no" title="statement not covered" >        var current = globalSettings[prop];</span>
<span class="cstat-no" title="statement not covered" >        globalSettings[prop] = value;</span>
<span class="cstat-no" title="statement not covered" >        try {</span>
<span class="cstat-no" title="statement not covered" >            assert.deepEqual(current,value);</span>
<span class="cstat-no" title="statement not covered" >            return when.resolve();</span>
        } catch(err) {
<span class="cstat-no" title="statement not covered" >            return storage.saveSettings(globalSettings);</span>
        }
    },
    delete: <span class="fstat-no" title="function not covered" >function(prop) {</span>
<span class="cstat-no" title="statement not covered" >        if (userSettings.hasOwnProperty(prop)) {</span>
<span class="cstat-no" title="statement not covered" >            throw new Error(log._("settings.property-read-only", {prop:prop}));</span>
        }
<span class="cstat-no" title="statement not covered" >        if (globalSettings === null) {</span>
<span class="cstat-no" title="statement not covered" >            throw new Error(log._("settings.not-available"));</span>
        }
<span class="cstat-no" title="statement not covered" >        if (globalSettings.hasOwnProperty(prop)) {</span>
<span class="cstat-no" title="statement not covered" >            delete globalSettings[prop];</span>
<span class="cstat-no" title="statement not covered" >            return storage.saveSettings(globalSettings);</span>
        }
<span class="cstat-no" title="statement not covered" >        return when.resolve();</span>
    },
&nbsp;
    available: <span class="fstat-no" title="function not covered" >function() {</span>
<span class="cstat-no" title="statement not covered" >        return (globalSettings !== null);</span>
    },
&nbsp;
    reset: <span class="fstat-no" title="function not covered" >function() {</span>
<span class="cstat-no" title="statement not covered" >        for (var i in userSettings) {</span>
            /* istanbul ignore else */
<span class="cstat-no" title="statement not covered" >            if (userSettings.hasOwnProperty(i)) {</span>
<span class="cstat-no" title="statement not covered" >                delete persistentSettings[i];</span>
            }
        }
<span class="cstat-no" title="statement not covered" >        userSettings = null;</span>
<span class="cstat-no" title="statement not covered" >        globalSettings = null;</span>
<span class="cstat-no" title="statement not covered" >        storage = null;</span>
    }
}
&nbsp;
module.exports = persistentSettings;
&nbsp;
&nbsp;</pre></td></tr>
</table></pre>
</div>
<div class="footer">
    <div class="meta">Generated by <a href="https://github.com/kaizhu256/node-utility2" target="_blank">utility2</a> at Tue Apr 11 2017 17:25:15 GMT+0000 (UTC)</div>
</div>
</body>
</html>


<!doctype html>
<html lang="en">
<head>
    <title>Code coverage report for node-npmtest-node-red/node-red/red/runtime/util.js</title>
    <meta charset="utf-8">
    <style>
        body, html {
            margin:0; padding: 0;
        }
        body {
            font-family: Arial, Helvetica;
            font-size: 10pt;
        }
        div.header, div.footer {
            background: #eee;
            padding: 1em;
        }
        div.header {
            height: 160px;
            padding: 0 1em 0 1em;
            z-index: 100;
            position: fixed;
            top: 0;
            border-bottom: 1px solid #666;
            width: 100%;
        }
        div.footer {
            border-top: 1px solid #666;
        }
        div.body {
            margin-top: 170px;
        }
        div.meta {
            font-size: 90%;
            text-align: center;
        }
        h1, h2, h3 {
            font-weight: normal;
        }
        h1 {
            font-size: 12pt;
        }
        h2 {
            font-size: 10pt;
        }
        pre {
            font-family: Menlo, Monaco, Consolas, Courier New, monospace;
            margin: 0;
            padding: 0;
            font-size: 14px;
            tab-size: 2;
        }

        div.path { font-size: 110%; }
        div.path a:link, div.path a:visited { color: #000; }
        table.coverage { border-collapse: collapse; margin:0; padding: 0 }

        table.coverage td {
            margin: 0;
            padding: 0;
            color: #111;
            vertical-align: top;
        }
        table.coverage td.line-count {
            width: 50px;
            text-align: right;
            padding-right: 5px;
        }
        table.coverage td.line-coverage {
            color: #777 !important;
            text-align: right;
            border-left: 1px solid #666;
            border-right: 1px solid #666;
        }

        table.coverage td.text {
        }

        table.coverage td span.cline-any {
            display: inline-block;
            padding: 0 5px;
            width: 40px;
        }
        table.coverage td span.cline-neutral {
            background: #eee;
        }
        table.coverage td span.cline-yes {
            background: #b5d592;
            color: #999;
        }
        table.coverage td span.cline-no {
            background: #fc8c84;
        }

        .cstat-yes { color: #111; }
        .cstat-no { background: #fc8c84; color: #111; }
        .fstat-no { background: #ffc520; color: #111 !important; }
        .cbranch-no { background:  yellow !important; color: #111; }

        .cstat-skip { background: #ddd; color: #111; }
        .fstat-skip { background: #ddd; color: #111 !important; }
        .cbranch-skip { background: #ddd !important; color: #111; }

        .missing-if-branch {
            display: inline-block;
            margin-right: 10px;
            position: relative;
            padding: 0 4px;
            background: black;
            color: yellow;
        }

        .skip-if-branch {
            display: none;
            margin-right: 10px;
            position: relative;
            padding: 0 4px;
            background: #ccc;
            color: white;
        }

        .missing-if-branch .typ, .skip-if-branch .typ {
            color: inherit !important;
        }

        .entity, .metric { font-weight: bold; }
        .metric { display: inline-block; border: 1px solid #333; padding: 0.3em; background: white; }
        .metric small { font-size: 80%; font-weight: normal; color: #666; }

        div.coverage-summary table { border-collapse: collapse; margin: 3em; font-size: 110%; }
        div.coverage-summary td, div.coverage-summary table  th { margin: 0; padding: 0.25em 1em; border-top: 1px solid #666; border-bottom: 1px solid #666; }
        div.coverage-summary th { text-align: left; border: 1px solid #666; background: #eee; font-weight: normal; }
        div.coverage-summary th.file { border-right: none !important; }
        div.coverage-summary th.pic { border-left: none !important; text-align: right; }
        div.coverage-summary th.pct { border-right: none !important; }
        div.coverage-summary th.abs { border-left: none !important; text-align: right; }
        div.coverage-summary td.pct { text-align: right; border-left: 1px solid #666; }
        div.coverage-summary td.abs { text-align: right; font-size: 90%; color: #444; border-right: 1px solid #666; }
        div.coverage-summary td.file { text-align: right; border-left: 1px solid #666; white-space: nowrap;  }
        div.coverage-summary td.pic { min-width: 120px !important;  }
        div.coverage-summary a:link { color: #000; }
        div.coverage-summary a:visited { color: #333; }
        div.coverage-summary tfoot td { border-top: 1px solid #666; }

        div.coverage-summary .yui3-datatable-sort-indicator, div.coverage-summary .dummy-sort-indicator {
            height: 10px;
            width: 7px;
            display: inline-block;
            margin-left: 0.5em;
        }
        div.coverage-summary .yui3-datatable-sort-indicator {
            background: no-repeat scroll 0 0 transparent;
        }
        div.coverage-summary .yui3-datatable-sorted .yui3-datatable-sort-indicator {
            background-position: 0 -20px;
        }
        div.coverage-summary .yui3-datatable-sorted-desc .yui3-datatable-sort-indicator {
            background-position: 0 -10px;
        }

        .high { background: #b5d592 !important; }
        .medium { background: #ffe87c !important; }
        .low { background: #fc8c84 !important; }

        span.cover-fill, span.cover-empty {
            display:inline-block;
            border:1px solid #444;
            background: white;
            height: 12px;
        }
        span.cover-fill {
            background: #ccc;
            border-right: 1px solid #444;
        }
        span.cover-empty {
            background: white;
            border-left: none;
        }
        span.cover-full {
            border-right: none !important;
        }
        pre.prettyprint {
            border: none !important;
            padding: 0 !important;
            margin: 0 !important;
        }
        .com { color: #999 !important; }
        .ignore-none { color: #999; font-weight: normal; }

    </style>
</head>
<body>
<div class="header low">
    <h1 style="font-weight: bold;">
        <a href="https://github.com/npmtest/node-npmtest-node-red">npmtest-node-red (v0.0.1)</a>
    </h1>
    <h1>Code coverage report for <span class="entity">node-npmtest-node-red/node-red/red/runtime/util.js</span></h1>
    <h2>
        
        Statements: <span class="metric">5.63% <small>(12 / 213)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        
        Branches: <span class="metric">0.57% <small>(1 / 174)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        
        Functions: <span class="metric">0% <small>(0 / 10)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        
        Lines: <span class="metric">5.63% <small>(12 / 213)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        Ignored: <span class="metric">1 branch</span> &nbsp;&nbsp;&nbsp;&nbsp;
    </h2>
    <div class="path"><a href="../../../../index.html">All files</a> &#187; <a href="index.html">node-npmtest-node-red/node-red/red/runtime/</a> &#187; util.js</div>
</div>
<div class="body">
<pre><table class="coverage">
<tr><td class="line-count">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
164
165
166
167
168
169
170
171
172
173
174
175
176
177
178
179
180
181
182
183
184
185
186
187
188
189
190
191
192
193
194
195
196
197
198
199
200
201
202
203
204
205
206
207
208
209
210
211
212
213
214
215
216
217
218
219
220
221
222
223
224
225
226
227
228
229
230
231
232
233
234
235
236
237
238
239
240
241
242
243
244
245
246
247
248
249
250
251
252
253
254
255
256
257
258
259
260
261
262
263
264
265
266
267
268
269
270
271
272
273
274
275
276
277
278
279
280
281
282
283
284
285
286
287
288
289
290
291
292
293
294
295
296
297
298
299
300
301
302
303
304
305
306
307
308
309
310
311
312
313
314
315
316
317
318
319
320
321
322
323
324
325
326
327
328
329
330
331
332
333
334
335
336
337
338
339
340
341
342
343
344</td><td class="line-coverage"><span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span></td><td class="text"><pre class="prettyprint lang-js">/**
 * Copyright JS Foundation and other contributors, http://js.foundation
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 **/
&nbsp;
var clone = require("clone");
var jsonata = require("jsonata");
&nbsp;
<span class="fstat-no" title="function not covered" >function generateId() {</span>
<span class="cstat-no" title="statement not covered" >    return (1+Math.random()*4294967295).toString(16);</span>
}
&nbsp;
<span class="fstat-no" title="function not covered" >function ensureString(o) {</span>
<span class="cstat-no" title="statement not covered" >    if (Buffer.isBuffer(o)) {</span>
<span class="cstat-no" title="statement not covered" >        return o.toString();</span>
    } else <span class="cstat-no" title="statement not covered" >if (typeof o === "object") {</span>
<span class="cstat-no" title="statement not covered" >        return JSON.stringify(o);</span>
    } else <span class="cstat-no" title="statement not covered" >if (typeof o === "string") {</span>
<span class="cstat-no" title="statement not covered" >        return o;</span>
    }
<span class="cstat-no" title="statement not covered" >    return ""+o;</span>
}
&nbsp;
<span class="fstat-no" title="function not covered" >function ensureBuffer(o) {</span>
<span class="cstat-no" title="statement not covered" >    if (Buffer.isBuffer(o)) {</span>
<span class="cstat-no" title="statement not covered" >        return o;</span>
    } else <span class="cstat-no" title="statement not covered" >if (typeof o === "object") {</span>
<span class="cstat-no" title="statement not covered" >        o = JSON.stringify(o);</span>
    } else <span class="cstat-no" title="statement not covered" >if (typeof o !== "string") {</span>
<span class="cstat-no" title="statement not covered" >        o = ""+o;</span>
    }
<span class="cstat-no" title="statement not covered" >    return new Buffer(o);</span>
}
&nbsp;
<span class="fstat-no" title="function not covered" >function cloneMessage(msg) {</span>
    // Temporary fix for #97
    // TODO: remove this http-node-specific fix somehow
<span class="cstat-no" title="statement not covered" >    var req = msg.req;</span>
<span class="cstat-no" title="statement not covered" >    var res = msg.res;</span>
<span class="cstat-no" title="statement not covered" >    delete msg.req;</span>
<span class="cstat-no" title="statement not covered" >    delete msg.res;</span>
<span class="cstat-no" title="statement not covered" >    var m = clone(msg);</span>
<span class="cstat-no" title="statement not covered" >    if (req) {</span>
<span class="cstat-no" title="statement not covered" >        m.req = req;</span>
<span class="cstat-no" title="statement not covered" >        msg.req = req;</span>
    }
<span class="cstat-no" title="statement not covered" >    if (res) {</span>
<span class="cstat-no" title="statement not covered" >        m.res = res;</span>
<span class="cstat-no" title="statement not covered" >        msg.res = res;</span>
    }
<span class="cstat-no" title="statement not covered" >    return m;</span>
}
&nbsp;
<span class="fstat-no" title="function not covered" >function compareObjects(obj1,obj2) {</span>
<span class="cstat-no" title="statement not covered" >    var i;</span>
<span class="cstat-no" title="statement not covered" >    if (obj1 === obj2) {</span>
<span class="cstat-no" title="statement not covered" >        return true;</span>
    }
<span class="cstat-no" title="statement not covered" >    if (obj1 == null || obj2 == null) {</span>
<span class="cstat-no" title="statement not covered" >        return false;</span>
    }
&nbsp;
<span class="cstat-no" title="statement not covered" >    var isArray1 = Array.isArray(obj1);</span>
<span class="cstat-no" title="statement not covered" >    var isArray2 = Array.isArray(obj2);</span>
<span class="cstat-no" title="statement not covered" >    if (isArray1 != isArray2) {</span>
<span class="cstat-no" title="statement not covered" >        return false;</span>
    }
<span class="cstat-no" title="statement not covered" >    if (isArray1 &amp;&amp; isArray2) {</span>
<span class="cstat-no" title="statement not covered" >        if (obj1.length !== obj2.length) {</span>
<span class="cstat-no" title="statement not covered" >            return false;</span>
        }
<span class="cstat-no" title="statement not covered" >        for (i=0;i&lt;obj1.length;i++) {</span>
<span class="cstat-no" title="statement not covered" >            if (!compareObjects(obj1[i],obj2[i])) {</span>
<span class="cstat-no" title="statement not covered" >                return false;</span>
            }
        }
<span class="cstat-no" title="statement not covered" >        return true;</span>
    }
<span class="cstat-no" title="statement not covered" >    var isBuffer1 = Buffer.isBuffer(obj1);</span>
<span class="cstat-no" title="statement not covered" >    var isBuffer2 = Buffer.isBuffer(obj2);</span>
<span class="cstat-no" title="statement not covered" >    if (isBuffer1 != isBuffer2) {</span>
<span class="cstat-no" title="statement not covered" >        return false;</span>
    }
<span class="cstat-no" title="statement not covered" >    if (isBuffer1 &amp;&amp; isBuffer2) {</span>
<span class="cstat-no" title="statement not covered" >        if (obj1.equals) {</span>
            // For node 0.12+ - use the native equals
<span class="cstat-no" title="statement not covered" >            return obj1.equals(obj2);</span>
        } else {
<span class="cstat-no" title="statement not covered" >            if (obj1.length !== obj2.length) {</span>
<span class="cstat-no" title="statement not covered" >                return false;</span>
            }
<span class="cstat-no" title="statement not covered" >            for (i=0;i&lt;obj1.length;i++) {</span>
<span class="cstat-no" title="statement not covered" >                if (obj1.readUInt8(i) !== obj2.readUInt8(i)) {</span>
<span class="cstat-no" title="statement not covered" >                    return false;</span>
                }
            }
<span class="cstat-no" title="statement not covered" >            return true;</span>
        }
    }
&nbsp;
<span class="cstat-no" title="statement not covered" >    if (typeof obj1 !== 'object' || typeof obj2 !== 'object') {</span>
<span class="cstat-no" title="statement not covered" >        return false;</span>
    }
<span class="cstat-no" title="statement not covered" >    var keys1 = Object.keys(obj1);</span>
<span class="cstat-no" title="statement not covered" >    var keys2 = Object.keys(obj2);</span>
<span class="cstat-no" title="statement not covered" >    if (keys1.length != keys2.length) {</span>
<span class="cstat-no" title="statement not covered" >        return false;</span>
    }
<span class="cstat-no" title="statement not covered" >    for (var k in obj1) {</span>
        /* istanbul ignore else */
<span class="cstat-no" title="statement not covered" >        if (obj1.hasOwnProperty(k)) {</span>
<span class="cstat-no" title="statement not covered" >            if (!compareObjects(obj1[k],obj2[k])) {</span>
<span class="cstat-no" title="statement not covered" >                return false;</span>
            }
        }
    }
<span class="cstat-no" title="statement not covered" >    return true;</span>
}
&nbsp;
<span class="fstat-no" title="function not covered" >function normalisePropertyExpression(str) {</span>
    // This must be kept in sync with validatePropertyExpression
    // in editor/js/ui/utils.js
&nbsp;
<span class="cstat-no" title="statement not covered" >    var length = str.length;</span>
<span class="cstat-no" title="statement not covered" >    if (length === 0) {</span>
<span class="cstat-no" title="statement not covered" >        throw new Error("Invalid property expression: zero-length");</span>
    }
<span class="cstat-no" title="statement not covered" >    var parts = [];</span>
<span class="cstat-no" title="statement not covered" >    var start = 0;</span>
<span class="cstat-no" title="statement not covered" >    var inString = false;</span>
<span class="cstat-no" title="statement not covered" >    var inBox = false;</span>
<span class="cstat-no" title="statement not covered" >    var quoteChar;</span>
<span class="cstat-no" title="statement not covered" >    var v;</span>
<span class="cstat-no" title="statement not covered" >    for (var i=0;i&lt;length;i++) {</span>
<span class="cstat-no" title="statement not covered" >        var c = str[i];</span>
<span class="cstat-no" title="statement not covered" >        if (!inString) {</span>
<span class="cstat-no" title="statement not covered" >            if (c === "'" || c === '"') {</span>
<span class="cstat-no" title="statement not covered" >                if (i != start) {</span>
<span class="cstat-no" title="statement not covered" >                    throw new Error("Invalid property expression: unexpected "+c+" at position "+i);</span>
                }
<span class="cstat-no" title="statement not covered" >                inString = true;</span>
<span class="cstat-no" title="statement not covered" >                quoteChar = c;</span>
<span class="cstat-no" title="statement not covered" >                start = i+1;</span>
            } else <span class="cstat-no" title="statement not covered" >if (c === '.') {</span>
<span class="cstat-no" title="statement not covered" >                if (i===0) {</span>
<span class="cstat-no" title="statement not covered" >                    throw new Error("Invalid property expression: unexpected . at position 0");</span>
                }
<span class="cstat-no" title="statement not covered" >                if (start != i) {</span>
<span class="cstat-no" title="statement not covered" >                    v = str.substring(start,i);</span>
<span class="cstat-no" title="statement not covered" >                    if (/^\d+$/.test(v)) {</span>
<span class="cstat-no" title="statement not covered" >                        parts.push(parseInt(v));</span>
                    } else {
<span class="cstat-no" title="statement not covered" >                        parts.push(v);</span>
                    }
                }
<span class="cstat-no" title="statement not covered" >                if (i===length-1) {</span>
<span class="cstat-no" title="statement not covered" >                    throw new Error("Invalid property expression: unterminated expression");</span>
                }
                // Next char is first char of an identifier: a-z 0-9 $ _
<span class="cstat-no" title="statement not covered" >                if (!/[a-z0-9\$\_]/i.test(str[i+1])) {</span>
<span class="cstat-no" title="statement not covered" >                    throw new Error("Invalid property expression: unexpected "+str[i+1]+" at position "+(i+1));</span>
                }
<span class="cstat-no" title="statement not covered" >                start = i+1;</span>
            } else <span class="cstat-no" title="statement not covered" >if (c === '[') {</span>
<span class="cstat-no" title="statement not covered" >                if (i === 0) {</span>
<span class="cstat-no" title="statement not covered" >                    throw new Error("Invalid property expression: unexpected "+c+" at position "+i);</span>
                }
<span class="cstat-no" title="statement not covered" >                if (start != i) {</span>
<span class="cstat-no" title="statement not covered" >                    parts.push(str.substring(start,i));</span>
                }
<span class="cstat-no" title="statement not covered" >                if (i===length-1) {</span>
<span class="cstat-no" title="statement not covered" >                    throw new Error("Invalid property expression: unterminated expression");</span>
                }
                // Next char is either a quote or a number
<span class="cstat-no" title="statement not covered" >                if (!/["'\d]/.test(str[i+1])) {</span>
<span class="cstat-no" title="statement not covered" >                    throw new Error("Invalid property expression: unexpected "+str[i+1]+" at position "+(i+1));</span>
                }
<span class="cstat-no" title="statement not covered" >                start = i+1;</span>
<span class="cstat-no" title="statement not covered" >                inBox = true;</span>
            } else <span class="cstat-no" title="statement not covered" >if (c === ']') {</span>
<span class="cstat-no" title="statement not covered" >                if (!inBox) {</span>
<span class="cstat-no" title="statement not covered" >                    throw new Error("Invalid property expression: unexpected "+c+" at position "+i);</span>
                }
<span class="cstat-no" title="statement not covered" >                if (start != i) {</span>
<span class="cstat-no" title="statement not covered" >                    v = str.substring(start,i);</span>
<span class="cstat-no" title="statement not covered" >                    if (/^\d+$/.test(v)) {</span>
<span class="cstat-no" title="statement not covered" >                        parts.push(parseInt(v));</span>
                    } else {
<span class="cstat-no" title="statement not covered" >                        throw new Error("Invalid property expression: unexpected array expression at position "+start);</span>
                    }
                }
<span class="cstat-no" title="statement not covered" >                start = i+1;</span>
<span class="cstat-no" title="statement not covered" >                inBox = false;</span>
            } else <span class="cstat-no" title="statement not covered" >if (c === ' ') {</span>
<span class="cstat-no" title="statement not covered" >                throw new Error("Invalid property expression: unexpected ' ' at position "+i);</span>
            }
        } else {
<span class="cstat-no" title="statement not covered" >            if (c === quoteChar) {</span>
<span class="cstat-no" title="statement not covered" >                if (i-start === 0) {</span>
<span class="cstat-no" title="statement not covered" >                    throw new Error("Invalid property expression: zero-length string at position "+start);</span>
                }
<span class="cstat-no" title="statement not covered" >                parts.push(str.substring(start,i));</span>
                // If inBox, next char must be a ]. Otherwise it may be [ or .
<span class="cstat-no" title="statement not covered" >                if (inBox &amp;&amp; !/\]/.test(str[i+1])) {</span>
<span class="cstat-no" title="statement not covered" >                    throw new Error("Invalid property expression: unexpected array expression at position "+start);</span>
                } else <span class="cstat-no" title="statement not covered" >if (!inBox &amp;&amp; i+1!==length &amp;&amp; !/[\[\.]/.test(str[i+1])) {</span>
<span class="cstat-no" title="statement not covered" >                    throw new Error("Invalid property expression: unexpected "+str[i+1]+" expression at position "+(i+1));</span>
                }
<span class="cstat-no" title="statement not covered" >                start = i+1;</span>
<span class="cstat-no" title="statement not covered" >                inString = false;</span>
            }
        }
&nbsp;
    }
<span class="cstat-no" title="statement not covered" >    if (inBox || inString) {</span>
<span class="cstat-no" title="statement not covered" >        throw new Error("Invalid property expression: unterminated expression");</span>
    }
<span class="cstat-no" title="statement not covered" >    if (start &lt; length) {</span>
<span class="cstat-no" title="statement not covered" >        parts.push(str.substring(start));</span>
    }
<span class="cstat-no" title="statement not covered" >    return parts;</span>
}
&nbsp;
<span class="fstat-no" title="function not covered" >function getMessageProperty(msg,expr) {</span>
<span class="cstat-no" title="statement not covered" >    var result = null;</span>
<span class="cstat-no" title="statement not covered" >    if (expr.indexOf('msg.')===0) {</span>
<span class="cstat-no" title="statement not covered" >        expr = expr.substring(4);</span>
    }
<span class="cstat-no" title="statement not covered" >    var msgPropParts = normalisePropertyExpression(expr);</span>
<span class="cstat-no" title="statement not covered" >    var m;</span>
<span class="cstat-no" title="statement not covered" >    msgPropParts.reduce(<span class="fstat-no" title="function not covered" >function(obj, key) {</span></span>
<span class="cstat-no" title="statement not covered" >        result = (typeof obj[key] !== "undefined" ? obj[key] : undefined);</span>
<span class="cstat-no" title="statement not covered" >        return result;</span>
    }, msg);
<span class="cstat-no" title="statement not covered" >    return result;</span>
}
&nbsp;
<span class="fstat-no" title="function not covered" >function setMessageProperty(msg,prop,value,createMissing) {</span>
<span class="cstat-no" title="statement not covered" >    if (typeof createMissing === 'undefined') {</span>
<span class="cstat-no" title="statement not covered" >        createMissing = (typeof value !== 'undefined');</span>
    }
<span class="cstat-no" title="statement not covered" >    if (prop.indexOf('msg.')===0) {</span>
<span class="cstat-no" title="statement not covered" >        prop = prop.substring(4);</span>
    }
<span class="cstat-no" title="statement not covered" >    var msgPropParts = normalisePropertyExpression(prop);</span>
<span class="cstat-no" title="statement not covered" >    var depth = 0;</span>
<span class="cstat-no" title="statement not covered" >    var length = msgPropParts.length;</span>
<span class="cstat-no" title="statement not covered" >    var obj = msg;</span>
<span class="cstat-no" title="statement not covered" >    var key;</span>
<span class="cstat-no" title="statement not covered" >    for (var i=0;i&lt;length-1;i++) {</span>
<span class="cstat-no" title="statement not covered" >        key = msgPropParts[i];</span>
<span class="cstat-no" title="statement not covered" >        if (typeof key === 'string' || (typeof key === 'number' &amp;&amp; !Array.isArray(obj))) {</span>
<span class="cstat-no" title="statement not covered" >            if (obj.hasOwnProperty(key)) {</span>
<span class="cstat-no" title="statement not covered" >                obj = obj[key];</span>
            } else <span class="cstat-no" title="statement not covered" >if (createMissing) {</span>
<span class="cstat-no" title="statement not covered" >                if (typeof msgPropParts[i+1] === 'string') {</span>
<span class="cstat-no" title="statement not covered" >                    obj[key] = {};</span>
                } else {
<span class="cstat-no" title="statement not covered" >                    obj[key] = [];</span>
                }
<span class="cstat-no" title="statement not covered" >                obj = obj[key];</span>
            } else {
<span class="cstat-no" title="statement not covered" >                return null;</span>
            }
        } else <span class="cstat-no" title="statement not covered" >if (typeof key === 'number') {</span>
            // obj is an array
<span class="cstat-no" title="statement not covered" >            if (obj[key] === undefined) {</span>
<span class="cstat-no" title="statement not covered" >                if (createMissing) {</span>
<span class="cstat-no" title="statement not covered" >                    if (typeof msgPropParts[i+1] === 'string') {</span>
<span class="cstat-no" title="statement not covered" >                        obj[key] = {};</span>
                    } else {
<span class="cstat-no" title="statement not covered" >                        obj[key] = [];</span>
                    }
<span class="cstat-no" title="statement not covered" >                    obj = obj[key];</span>
                } else {
<span class="cstat-no" title="statement not covered" >                    return null</span>
                }
            } else {
<span class="cstat-no" title="statement not covered" >                obj = obj[key];</span>
            }
        }
    }
<span class="cstat-no" title="statement not covered" >    key = msgPropParts[length-1];</span>
<span class="cstat-no" title="statement not covered" >    if (typeof value === "undefined") {</span>
<span class="cstat-no" title="statement not covered" >        if (typeof key === 'number' &amp;&amp; Array.isArray(obj)) {</span>
<span class="cstat-no" title="statement not covered" >            obj.splice(key,1);</span>
        } else {
<span class="cstat-no" title="statement not covered" >            delete obj[key]</span>
        }
    } else {
<span class="cstat-no" title="statement not covered" >        obj[key] = value;</span>
    }
}
&nbsp;
<span class="fstat-no" title="function not covered" >function evaluateNodeProperty(value, type, node, msg) {</span>
<span class="cstat-no" title="statement not covered" >    if (type === 'str') {</span>
<span class="cstat-no" title="statement not covered" >        return ""+value;</span>
    } else <span class="cstat-no" title="statement not covered" >if (type === 'num') {</span>
<span class="cstat-no" title="statement not covered" >        return Number(value);</span>
    } else <span class="cstat-no" title="statement not covered" >if (type === 'json') {</span>
<span class="cstat-no" title="statement not covered" >        return JSON.parse(value);</span>
    } else <span class="cstat-no" title="statement not covered" >if (type === 're') {</span>
<span class="cstat-no" title="statement not covered" >        return new RegExp(value);</span>
    } else <span class="cstat-no" title="statement not covered" >if (type === 'date') {</span>
<span class="cstat-no" title="statement not covered" >        return Date.now();</span>
    } else <span class="cstat-no" title="statement not covered" >if (type === 'msg' &amp;&amp; msg) {</span>
<span class="cstat-no" title="statement not covered" >        return getMessageProperty(msg,value);</span>
    } else <span class="cstat-no" title="statement not covered" >if (type === 'flow' &amp;&amp; node) {</span>
<span class="cstat-no" title="statement not covered" >        return node.context().flow.get(value);</span>
    } else <span class="cstat-no" title="statement not covered" >if (type === 'global' &amp;&amp; node) {</span>
<span class="cstat-no" title="statement not covered" >        return node.context().global.get(value);</span>
    } else <span class="cstat-no" title="statement not covered" >if (type === 'bool') {</span>
<span class="cstat-no" title="statement not covered" >        return /^true$/i.test(value);</span>
    } else <span class="cstat-no" title="statement not covered" >if (type === 'jsonata') {</span>
<span class="cstat-no" title="statement not covered" >        return jsonata(value).evaluate({msg:msg});</span>
    }
<span class="cstat-no" title="statement not covered" >    return value;</span>
}
&nbsp;
&nbsp;
module.exports = {
    ensureString: ensureString,
    ensureBuffer: ensureBuffer,
    cloneMessage: cloneMessage,
    compareObjects: compareObjects,
    generateId: generateId,
    getMessageProperty: getMessageProperty,
    setMessageProperty: setMessageProperty,
    evaluateNodeProperty: evaluateNodeProperty,
    normalisePropertyExpression: normalisePropertyExpression
};
&nbsp;
&nbsp;</pre></td></tr>
</table></pre>
</div>
<div class="footer">
    <div class="meta">Generated by <a href="https://github.com/kaizhu256/node-utility2" target="_blank">utility2</a> at Tue Apr 11 2017 17:25:15 GMT+0000 (UTC)</div>
</div>
</body>
</html>


<!doctype html>
<html lang="en">
<head>
    <title>Code coverage report for node-npmtest-node-red/node-red/red/runtime/nodes/</title>
    <meta charset="utf-8">
    <style>
        body, html {
            margin:0; padding: 0;
        }
        body {
            font-family: Arial, Helvetica;
            font-size: 10pt;
        }
        div.header, div.footer {
            background: #eee;
            padding: 1em;
        }
        div.header {
            height: 160px;
            padding: 0 1em 0 1em;
            z-index: 100;
            position: fixed;
            top: 0;
            border-bottom: 1px solid #666;
            width: 100%;
        }
        div.footer {
            border-top: 1px solid #666;
        }
        div.body {
            margin-top: 170px;
        }
        div.meta {
            font-size: 90%;
            text-align: center;
        }
        h1, h2, h3 {
            font-weight: normal;
        }
        h1 {
            font-size: 12pt;
        }
        h2 {
            font-size: 10pt;
        }
        pre {
            font-family: Menlo, Monaco, Consolas, Courier New, monospace;
            margin: 0;
            padding: 0;
            font-size: 14px;
            tab-size: 2;
        }

        div.path { font-size: 110%; }
        div.path a:link, div.path a:visited { color: #000; }
        table.coverage { border-collapse: collapse; margin:0; padding: 0 }

        table.coverage td {
            margin: 0;
            padding: 0;
            color: #111;
            vertical-align: top;
        }
        table.coverage td.line-count {
            width: 50px;
            text-align: right;
            padding-right: 5px;
        }
        table.coverage td.line-coverage {
            color: #777 !important;
            text-align: right;
            border-left: 1px solid #666;
            border-right: 1px solid #666;
        }

        table.coverage td.text {
        }

        table.coverage td span.cline-any {
            display: inline-block;
            padding: 0 5px;
            width: 40px;
        }
        table.coverage td span.cline-neutral {
            background: #eee;
        }
        table.coverage td span.cline-yes {
            background: #b5d592;
            color: #999;
        }
        table.coverage td span.cline-no {
            background: #fc8c84;
        }

        .cstat-yes { color: #111; }
        .cstat-no { background: #fc8c84; color: #111; }
        .fstat-no { background: #ffc520; color: #111 !important; }
        .cbranch-no { background:  yellow !important; color: #111; }

        .cstat-skip { background: #ddd; color: #111; }
        .fstat-skip { background: #ddd; color: #111 !important; }
        .cbranch-skip { background: #ddd !important; color: #111; }

        .missing-if-branch {
            display: inline-block;
            margin-right: 10px;
            position: relative;
            padding: 0 4px;
            background: black;
            color: yellow;
        }

        .skip-if-branch {
            display: none;
            margin-right: 10px;
            position: relative;
            padding: 0 4px;
            background: #ccc;
            color: white;
        }

        .missing-if-branch .typ, .skip-if-branch .typ {
            color: inherit !important;
        }

        .entity, .metric { font-weight: bold; }
        .metric { display: inline-block; border: 1px solid #333; padding: 0.3em; background: white; }
        .metric small { font-size: 80%; font-weight: normal; color: #666; }

        div.coverage-summary table { border-collapse: collapse; margin: 3em; font-size: 110%; }
        div.coverage-summary td, div.coverage-summary table  th { margin: 0; padding: 0.25em 1em; border-top: 1px solid #666; border-bottom: 1px solid #666; }
        div.coverage-summary th { text-align: left; border: 1px solid #666; background: #eee; font-weight: normal; }
        div.coverage-summary th.file { border-right: none !important; }
        div.coverage-summary th.pic { border-left: none !important; text-align: right; }
        div.coverage-summary th.pct { border-right: none !important; }
        div.coverage-summary th.abs { border-left: none !important; text-align: right; }
        div.coverage-summary td.pct { text-align: right; border-left: 1px solid #666; }
        div.coverage-summary td.abs { text-align: right; font-size: 90%; color: #444; border-right: 1px solid #666; }
        div.coverage-summary td.file { text-align: right; border-left: 1px solid #666; white-space: nowrap;  }
        div.coverage-summary td.pic { min-width: 120px !important;  }
        div.coverage-summary a:link { color: #000; }
        div.coverage-summary a:visited { color: #333; }
        div.coverage-summary tfoot td { border-top: 1px solid #666; }

        div.coverage-summary .yui3-datatable-sort-indicator, div.coverage-summary .dummy-sort-indicator {
            height: 10px;
            width: 7px;
            display: inline-block;
            margin-left: 0.5em;
        }
        div.coverage-summary .yui3-datatable-sort-indicator {
            background: no-repeat scroll 0 0 transparent;
        }
        div.coverage-summary .yui3-datatable-sorted .yui3-datatable-sort-indicator {
            background-position: 0 -20px;
        }
        div.coverage-summary .yui3-datatable-sorted-desc .yui3-datatable-sort-indicator {
            background-position: 0 -10px;
        }

        .high { background: #b5d592 !important; }
        .medium { background: #ffe87c !important; }
        .low { background: #fc8c84 !important; }

        span.cover-fill, span.cover-empty {
            display:inline-block;
            border:1px solid #444;
            background: white;
            height: 12px;
        }
        span.cover-fill {
            background: #ccc;
            border-right: 1px solid #444;
        }
        span.cover-empty {
            background: white;
            border-left: none;
        }
        span.cover-full {
            border-right: none !important;
        }
        pre.prettyprint {
            border: none !important;
            padding: 0 !important;
            margin: 0 !important;
        }
        .com { color: #999 !important; }
        .ignore-none { color: #999; font-weight: normal; }

    </style>
</head>
<body>
<div class="header low">
    <h1 style="font-weight: bold;">
        <a href="https://github.com/npmtest/node-npmtest-node-red">npmtest-node-red (v0.0.1)</a>
    </h1>
    <h1>Code coverage report for <span class="entity">node-npmtest-node-red/node-red/red/runtime/nodes/</span></h1>
    <h2>
        
        Statements: <span class="metric">16.88% <small>(66 / 391)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        
        Branches: <span class="metric">3.33% <small>(6 / 180)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        
        Functions: <span class="metric">0% <small>(0 / 45)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        
        Lines: <span class="metric">16.88% <small>(66 / 391)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        Ignored: <span class="metric">6 branches</span> &nbsp;&nbsp;&nbsp;&nbsp;
    </h2>
    <div class="path"><a href="../../../../../index.html">All files</a> &#187; node-npmtest-node-red/node-red/red/runtime/nodes/</div>
</div>
<div class="body">
<div class="coverage-summary">
<table>
<thead>
<tr>
   <th data-col="file" data-fmt="html" data-html="true" class="file">File</th>
   <th data-col="pic" data-type="number" data-fmt="html" data-html="true" class="pic"></th>
   <th data-col="statements" data-type="number" data-fmt="pct" class="pct">Statements</th>
   <th data-col="statements_raw" data-type="number" data-fmt="html" class="abs"></th>
   <th data-col="branches" data-type="number" data-fmt="pct" class="pct">Branches</th>
   <th data-col="branches_raw" data-type="number" data-fmt="html" class="abs"></th>
   <th data-col="functions" data-type="number" data-fmt="pct" class="pct">Functions</th>
   <th data-col="functions_raw" data-type="number" data-fmt="html" class="abs"></th>
   <th data-col="lines" data-type="number" data-fmt="pct" class="pct">Lines</th>
   <th data-col="lines_raw" data-type="number" data-fmt="html" class="abs"></th>
</tr>
</thead>
<tbody><tr>
	<td class="file low" data-value="Node.js"><a href="Node.js.html">Node.js</a></td>
	<td data-value="16.31" class="pic low"><span class="cover-fill" style="width: 16px;"></span><span class="cover-empty" style="width:84px;"></span></td>
	<td data-value="16.31" class="pct low">16.31%</td>
	<td data-value="141" class="abs low">(23&nbsp;/&nbsp;141)</td>
	<td data-value="7.69" class="pct low">7.69%</td>
	<td data-value="78" class="abs low">(6&nbsp;/&nbsp;78)</td>
	<td data-value="0" class="pct low">0%</td>
	<td data-value="18" class="abs low">(0&nbsp;/&nbsp;18)</td>
	<td data-value="16.31" class="pct low">16.31%</td>
	<td data-value="141" class="abs low">(23&nbsp;/&nbsp;141)</td>
	</tr>

<tr>
	<td class="file low" data-value="context.js"><a href="context.js.html">context.js</a></td>
	<td data-value="23.81" class="pic low"><span class="cover-fill" style="width: 23px;"></span><span class="cover-empty" style="width:77px;"></span></td>
	<td data-value="23.81" class="pct low">23.81%</td>
	<td data-value="42" class="abs low">(10&nbsp;/&nbsp;42)</td>
	<td data-value="0" class="pct low">0%</td>
	<td data-value="20" class="abs low">(0&nbsp;/&nbsp;20)</td>
	<td data-value="0" class="pct low">0%</td>
	<td data-value="7" class="abs low">(0&nbsp;/&nbsp;7)</td>
	<td data-value="23.81" class="pct low">23.81%</td>
	<td data-value="42" class="abs low">(10&nbsp;/&nbsp;42)</td>
	</tr>

<tr>
	<td class="file low" data-value="credentials.js"><a href="credentials.js.html">credentials.js</a></td>
	<td data-value="9.03" class="pic low"><span class="cover-fill" style="width: 9px;"></span><span class="cover-empty" style="width:91px;"></span></td>
	<td data-value="9.03" class="pct low">9.03%</td>
	<td data-value="155" class="abs low">(14&nbsp;/&nbsp;155)</td>
	<td data-value="0" class="pct low">0%</td>
	<td data-value="66" class="abs low">(0&nbsp;/&nbsp;66)</td>
	<td data-value="0" class="pct low">0%</td>
	<td data-value="15" class="abs low">(0&nbsp;/&nbsp;15)</td>
	<td data-value="9.03" class="pct low">9.03%</td>
	<td data-value="155" class="abs low">(14&nbsp;/&nbsp;155)</td>
	</tr>

<tr>
	<td class="file low" data-value="index.js"><a href="index.js.html">index.js</a></td>
	<td data-value="35.85" class="pic low"><span class="cover-fill" style="width: 35px;"></span><span class="cover-empty" style="width:65px;"></span></td>
	<td data-value="35.85" class="pct low">35.85%</td>
	<td data-value="53" class="abs low">(19&nbsp;/&nbsp;53)</td>
	<td data-value="0" class="pct low">0%</td>
	<td data-value="16" class="abs low">(0&nbsp;/&nbsp;16)</td>
	<td data-value="0" class="pct low">0%</td>
	<td data-value="5" class="abs low">(0&nbsp;/&nbsp;5)</td>
	<td data-value="35.85" class="pct low">35.85%</td>
	<td data-value="53" class="abs low">(19&nbsp;/&nbsp;53)</td>
	</tr>

</tbody>
</table>
</div></div>
<div class="footer">
    <div class="meta">Generated by <a href="https://github.com/kaizhu256/node-utility2" target="_blank">utility2</a> at Tue Apr 11 2017 17:25:15 GMT+0000 (UTC)</div>
</div>
</body>
</html>


<!doctype html>
<html lang="en">
<head>
    <title>Code coverage report for node-npmtest-node-red/node-red/red/runtime/nodes/Node.js</title>
    <meta charset="utf-8">
    <style>
        body, html {
            margin:0; padding: 0;
        }
        body {
            font-family: Arial, Helvetica;
            font-size: 10pt;
        }
        div.header, div.footer {
            background: #eee;
            padding: 1em;
        }
        div.header {
            height: 160px;
            padding: 0 1em 0 1em;
            z-index: 100;
            position: fixed;
            top: 0;
            border-bottom: 1px solid #666;
            width: 100%;
        }
        div.footer {
            border-top: 1px solid #666;
        }
        div.body {
            margin-top: 170px;
        }
        div.meta {
            font-size: 90%;
            text-align: center;
        }
        h1, h2, h3 {
            font-weight: normal;
        }
        h1 {
            font-size: 12pt;
        }
        h2 {
            font-size: 10pt;
        }
        pre {
            font-family: Menlo, Monaco, Consolas, Courier New, monospace;
            margin: 0;
            padding: 0;
            font-size: 14px;
            tab-size: 2;
        }

        div.path { font-size: 110%; }
        div.path a:link, div.path a:visited { color: #000; }
        table.coverage { border-collapse: collapse; margin:0; padding: 0 }

        table.coverage td {
            margin: 0;
            padding: 0;
            color: #111;
            vertical-align: top;
        }
        table.coverage td.line-count {
            width: 50px;
            text-align: right;
            padding-right: 5px;
        }
        table.coverage td.line-coverage {
            color: #777 !important;
            text-align: right;
            border-left: 1px solid #666;
            border-right: 1px solid #666;
        }

        table.coverage td.text {
        }

        table.coverage td span.cline-any {
            display: inline-block;
            padding: 0 5px;
            width: 40px;
        }
        table.coverage td span.cline-neutral {
            background: #eee;
        }
        table.coverage td span.cline-yes {
            background: #b5d592;
            color: #999;
        }
        table.coverage td span.cline-no {
            background: #fc8c84;
        }

        .cstat-yes { color: #111; }
        .cstat-no { background: #fc8c84; color: #111; }
        .fstat-no { background: #ffc520; color: #111 !important; }
        .cbranch-no { background:  yellow !important; color: #111; }

        .cstat-skip { background: #ddd; color: #111; }
        .fstat-skip { background: #ddd; color: #111 !important; }
        .cbranch-skip { background: #ddd !important; color: #111; }

        .missing-if-branch {
            display: inline-block;
            margin-right: 10px;
            position: relative;
            padding: 0 4px;
            background: black;
            color: yellow;
        }

        .skip-if-branch {
            display: none;
            margin-right: 10px;
            position: relative;
            padding: 0 4px;
            background: #ccc;
            color: white;
        }

        .missing-if-branch .typ, .skip-if-branch .typ {
            color: inherit !important;
        }

        .entity, .metric { font-weight: bold; }
        .metric { display: inline-block; border: 1px solid #333; padding: 0.3em; background: white; }
        .metric small { font-size: 80%; font-weight: normal; color: #666; }

        div.coverage-summary table { border-collapse: collapse; margin: 3em; font-size: 110%; }
        div.coverage-summary td, div.coverage-summary table  th { margin: 0; padding: 0.25em 1em; border-top: 1px solid #666; border-bottom: 1px solid #666; }
        div.coverage-summary th { text-align: left; border: 1px solid #666; background: #eee; font-weight: normal; }
        div.coverage-summary th.file { border-right: none !important; }
        div.coverage-summary th.pic { border-left: none !important; text-align: right; }
        div.coverage-summary th.pct { border-right: none !important; }
        div.coverage-summary th.abs { border-left: none !important; text-align: right; }
        div.coverage-summary td.pct { text-align: right; border-left: 1px solid #666; }
        div.coverage-summary td.abs { text-align: right; font-size: 90%; color: #444; border-right: 1px solid #666; }
        div.coverage-summary td.file { text-align: right; border-left: 1px solid #666; white-space: nowrap;  }
        div.coverage-summary td.pic { min-width: 120px !important;  }
        div.coverage-summary a:link { color: #000; }
        div.coverage-summary a:visited { color: #333; }
        div.coverage-summary tfoot td { border-top: 1px solid #666; }

        div.coverage-summary .yui3-datatable-sort-indicator, div.coverage-summary .dummy-sort-indicator {
            height: 10px;
            width: 7px;
            display: inline-block;
            margin-left: 0.5em;
        }
        div.coverage-summary .yui3-datatable-sort-indicator {
            background: no-repeat scroll 0 0 transparent;
        }
        div.coverage-summary .yui3-datatable-sorted .yui3-datatable-sort-indicator {
            background-position: 0 -20px;
        }
        div.coverage-summary .yui3-datatable-sorted-desc .yui3-datatable-sort-indicator {
            background-position: 0 -10px;
        }

        .high { background: #b5d592 !important; }
        .medium { background: #ffe87c !important; }
        .low { background: #fc8c84 !important; }

        span.cover-fill, span.cover-empty {
            display:inline-block;
            border:1px solid #444;
            background: white;
            height: 12px;
        }
        span.cover-fill {
            background: #ccc;
            border-right: 1px solid #444;
        }
        span.cover-empty {
            background: white;
            border-left: none;
        }
        span.cover-full {
            border-right: none !important;
        }
        pre.prettyprint {
            border: none !important;
            padding: 0 !important;
            margin: 0 !important;
        }
        .com { color: #999 !important; }
        .ignore-none { color: #999; font-weight: normal; }

    </style>
</head>
<body>
<div class="header low">
    <h1 style="font-weight: bold;">
        <a href="https://github.com/npmtest/node-npmtest-node-red">npmtest-node-red (v0.0.1)</a>
    </h1>
    <h1>Code coverage report for <span class="entity">node-npmtest-node-red/node-red/red/runtime/nodes/Node.js</span></h1>
    <h2>
        
        Statements: <span class="metric">16.31% <small>(23 / 141)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        
        Branches: <span class="metric">7.69% <small>(6 / 78)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        
        Functions: <span class="metric">0% <small>(0 / 18)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        
        Lines: <span class="metric">16.31% <small>(23 / 141)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        Ignored: <span class="metric">6 branches</span> &nbsp;&nbsp;&nbsp;&nbsp;
    </h2>
    <div class="path"><a href="../../../../../index.html">All files</a> &#187; <a href="index.html">node-npmtest-node-red/node-red/red/runtime/nodes/</a> &#187; Node.js</div>
</div>
<div class="body">
<pre><table class="coverage">
<tr><td class="line-count">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
164
165
166
167
168
169
170
171
172
173
174
175
176
177
178
179
180
181
182
183
184
185
186
187
188
189
190
191
192
193
194
195
196
197
198
199
200
201
202
203
204
205
206
207
208
209
210
211
212
213
214
215
216
217
218
219
220
221
222
223
224
225
226
227
228
229
230
231
232
233
234
235
236
237
238
239
240
241
242
243
244
245
246
247
248
249
250
251
252
253
254
255
256
257
258
259
260
261
262
263
264
265
266
267
268
269
270
271
272
273</td><td class="line-coverage"><span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span></td><td class="text"><pre class="prettyprint lang-js">/**
 * Copyright JS Foundation and other contributors, http://js.foundation
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 **/
&nbsp;
var util = require("util");
var EventEmitter = require("events").EventEmitter;
var when = require("when");
&nbsp;
var redUtil = require("../util");
var Log = require("../log");
var context = require("./context");
var flows = require("./flows");
&nbsp;
<span class="fstat-no" title="function not covered" >function Node(n) {</span>
<span class="cstat-no" title="statement not covered" >    this.id = n.id;</span>
<span class="cstat-no" title="statement not covered" >    this.type = n.type;</span>
<span class="cstat-no" title="statement not covered" >    this.z = n.z;</span>
<span class="cstat-no" title="statement not covered" >    this._closeCallbacks = [];</span>
&nbsp;
<span class="cstat-no" title="statement not covered" >    if (n.name) {</span>
<span class="cstat-no" title="statement not covered" >        this.name = n.name;</span>
    }
<span class="cstat-no" title="statement not covered" >    if (n._alias) {</span>
<span class="cstat-no" title="statement not covered" >        this._alias = n._alias;</span>
    }
<span class="cstat-no" title="statement not covered" >    this.updateWires(n.wires);</span>
}
&nbsp;
util.inherits(Node, EventEmitter);
&nbsp;
Node.prototype.updateWires = <span class="fstat-no" title="function not covered" >function(wires) {</span>
    //console.log("UPDATE",this.id);
<span class="cstat-no" title="statement not covered" >    this.wires = wires || [];</span>
<span class="cstat-no" title="statement not covered" >    delete this._wire;</span>
&nbsp;
<span class="cstat-no" title="statement not covered" >    var wc = 0;</span>
<span class="cstat-no" title="statement not covered" >    this.wires.forEach(<span class="fstat-no" title="function not covered" >function(w) {</span></span>
<span class="cstat-no" title="statement not covered" >        wc+=w.length;</span>
    });
<span class="cstat-no" title="statement not covered" >    this._wireCount = wc;</span>
<span class="cstat-no" title="statement not covered" >    if (wc === 0) {</span>
        // With nothing wired to the node, no-op send
<span class="cstat-no" title="statement not covered" >        this.send = <span class="fstat-no" title="function not covered" >function(msg) {</span>}</span>
    } else {
<span class="cstat-no" title="statement not covered" >        this.send = Node.prototype.send;</span>
<span class="cstat-no" title="statement not covered" >        if (this.wires.length === 1 &amp;&amp; this.wires[0].length === 1) {</span>
            // Single wire, so we can shortcut the send when
            // a single message is sent
<span class="cstat-no" title="statement not covered" >            this._wire = this.wires[0][0];</span>
        }
    }
&nbsp;
}
Node.prototype.context = <span class="fstat-no" title="function not covered" >function() {</span>
<span class="cstat-no" title="statement not covered" >    if (!this._context) {</span>
<span class="cstat-no" title="statement not covered" >         this._context = context.get(this._alias||this.id,this.z);</span>
    }
<span class="cstat-no" title="statement not covered" >    return this._context;</span>
}
&nbsp;
Node.prototype._on = Node.prototype.on;
&nbsp;
Node.prototype.on = <span class="fstat-no" title="function not covered" >function(event, callback) {</span>
<span class="cstat-no" title="statement not covered" >    var node = this;</span>
<span class="cstat-no" title="statement not covered" >    if (event == "close") {</span>
<span class="cstat-no" title="statement not covered" >        this._closeCallbacks.push(callback);</span>
    } else {
<span class="cstat-no" title="statement not covered" >        this._on(event, callback);</span>
    }
};
&nbsp;
Node.prototype.close = <span class="fstat-no" title="function not covered" >function() {</span>
<span class="cstat-no" title="statement not covered" >    var promises = [];</span>
<span class="cstat-no" title="statement not covered" >    var node = this;</span>
<span class="cstat-no" title="statement not covered" >    for (var i=0;i&lt;this._closeCallbacks.length;i++) {</span>
<span class="cstat-no" title="statement not covered" >        var callback = this._closeCallbacks[i];</span>
<span class="cstat-no" title="statement not covered" >        if (callback.length == 1) {</span>
<span class="cstat-no" title="statement not covered" >            promises.push(</span>
                when.promise(<span class="fstat-no" title="function not covered" >function(resolve) {</span>
<span class="cstat-no" title="statement not covered" >                    callback.call(node, <span class="fstat-no" title="function not covered" >function() {</span></span>
<span class="cstat-no" title="statement not covered" >                        resolve();</span>
                    });
                })
            );
        } else {
<span class="cstat-no" title="statement not covered" >            callback.call(node);</span>
        }
    }
<span class="cstat-no" title="statement not covered" >    if (promises.length &gt; 0) {</span>
<span class="cstat-no" title="statement not covered" >        return when.settle(promises).then(<span class="fstat-no" title="function not covered" >function() {</span></span>
<span class="cstat-no" title="statement not covered" >            if (this._context) {</span>
<span class="cstat-no" title="statement not covered" >                 context.delete(this._alias||this.id,this.z);</span>
            }
        });
    } else {
<span class="cstat-no" title="statement not covered" >        if (this._context) {</span>
<span class="cstat-no" title="statement not covered" >             context.delete(this._alias||this.id,this.z);</span>
        }
<span class="cstat-no" title="statement not covered" >        return;</span>
    }
};
&nbsp;
Node.prototype.send = <span class="fstat-no" title="function not covered" >function(msg) {</span>
<span class="cstat-no" title="statement not covered" >    var msgSent = false;</span>
<span class="cstat-no" title="statement not covered" >    var node;</span>
&nbsp;
<span class="cstat-no" title="statement not covered" >    if (msg === null || typeof msg === "undefined") {</span>
<span class="cstat-no" title="statement not covered" >        return;</span>
    } else <span class="cstat-no" title="statement not covered" >if (!util.isArray(msg)) {</span>
<span class="cstat-no" title="statement not covered" >        if (this._wire) {</span>
            // A single message and a single wire on output 0
            // TODO: pre-load flows.get calls - cannot do in constructor
            //       as not all nodes are defined at that point
<span class="cstat-no" title="statement not covered" >            if (!msg._msgid) {</span>
<span class="cstat-no" title="statement not covered" >                msg._msgid = redUtil.generateId();</span>
            }
<span class="cstat-no" title="statement not covered" >            this.metric("send",msg);</span>
<span class="cstat-no" title="statement not covered" >            node = flows.get(this._wire);</span>
            /* istanbul ignore else */
<span class="cstat-no" title="statement not covered" >            if (node) {</span>
<span class="cstat-no" title="statement not covered" >                node.receive(msg);</span>
            }
<span class="cstat-no" title="statement not covered" >            return;</span>
        } else {
<span class="cstat-no" title="statement not covered" >            msg = [msg];</span>
        }
    }
&nbsp;
<span class="cstat-no" title="statement not covered" >    var numOutputs = this.wires.length;</span>
&nbsp;
    // Build a list of send events so that all cloning is done before
    // any calls to node.receive
<span class="cstat-no" title="statement not covered" >    var sendEvents = [];</span>
&nbsp;
<span class="cstat-no" title="statement not covered" >    var sentMessageId = null;</span>
&nbsp;
    // for each output of node eg. [msgs to output 0, msgs to output 1, ...]
<span class="cstat-no" title="statement not covered" >    for (var i = 0; i &lt; numOutputs; i++) {</span>
<span class="cstat-no" title="statement not covered" >        var wires = this.wires[i]; </span>// wires leaving output i
        /* istanbul ignore else */
<span class="cstat-no" title="statement not covered" >        if (i &lt; msg.length) {</span>
<span class="cstat-no" title="statement not covered" >            var msgs = msg[i]; </span>// msgs going to output i
<span class="cstat-no" title="statement not covered" >            if (msgs !== null &amp;&amp; typeof msgs !== "undefined") {</span>
<span class="cstat-no" title="statement not covered" >                if (!util.isArray(msgs)) {</span>
<span class="cstat-no" title="statement not covered" >                    msgs = [msgs];</span>
                }
<span class="cstat-no" title="statement not covered" >                var k = 0;</span>
                // for each recipent node of that output
<span class="cstat-no" title="statement not covered" >                for (var j = 0; j &lt; wires.length; j++) {</span>
<span class="cstat-no" title="statement not covered" >                    node = flows.get(wires[j]); </span>// node at end of wire j
<span class="cstat-no" title="statement not covered" >                    if (node) {</span>
                        // for each msg to send eg. [[m1, m2, ...], ...]
<span class="cstat-no" title="statement not covered" >                        for (k = 0; k &lt; msgs.length; k++) {</span>
<span class="cstat-no" title="statement not covered" >                            var m = msgs[k];</span>
<span class="cstat-no" title="statement not covered" >                            if (m !== null &amp;&amp; m !== undefined) {</span>
                                /* istanbul ignore else */
<span class="cstat-no" title="statement not covered" >                                if (!sentMessageId) {</span>
<span class="cstat-no" title="statement not covered" >                                    sentMessageId = m._msgid;</span>
                                }
<span class="cstat-no" title="statement not covered" >                                if (msgSent) {</span>
<span class="cstat-no" title="statement not covered" >                                    var clonedmsg = redUtil.cloneMessage(m);</span>
<span class="cstat-no" title="statement not covered" >                                    sendEvents.push({n:node,m:clonedmsg});</span>
                                } else {
<span class="cstat-no" title="statement not covered" >                                    sendEvents.push({n:node,m:m});</span>
<span class="cstat-no" title="statement not covered" >                                    msgSent = true;</span>
                                }
                            }
                        }
                    }
                }
            }
        }
    }
    /* istanbul ignore else */
<span class="cstat-no" title="statement not covered" >    if (!sentMessageId) {</span>
<span class="cstat-no" title="statement not covered" >        sentMessageId = redUtil.generateId();</span>
    }
<span class="cstat-no" title="statement not covered" >    this.metric("send",{_msgid:sentMessageId});</span>
&nbsp;
<span class="cstat-no" title="statement not covered" >    for (i=0;i&lt;sendEvents.length;i++) {</span>
<span class="cstat-no" title="statement not covered" >        var ev = sendEvents[i];</span>
        /* istanbul ignore else */
<span class="cstat-no" title="statement not covered" >        if (!ev.m._msgid) {</span>
<span class="cstat-no" title="statement not covered" >            ev.m._msgid = sentMessageId;</span>
        }
<span class="cstat-no" title="statement not covered" >        ev.n.receive(ev.m);</span>
    }
};
&nbsp;
Node.prototype.receive = <span class="fstat-no" title="function not covered" >function(msg) {</span>
<span class="cstat-no" title="statement not covered" >    if (!msg) {</span>
<span class="cstat-no" title="statement not covered" >        msg = {};</span>
    }
<span class="cstat-no" title="statement not covered" >    if (!msg._msgid) {</span>
<span class="cstat-no" title="statement not covered" >        msg._msgid = redUtil.generateId();</span>
    }
<span class="cstat-no" title="statement not covered" >    this.metric("receive",msg);</span>
<span class="cstat-no" title="statement not covered" >    try {</span>
<span class="cstat-no" title="statement not covered" >        this.emit("input", msg);</span>
    } catch(err) {
<span class="cstat-no" title="statement not covered" >        this.error(err,msg);</span>
    }
};
&nbsp;
<span class="fstat-no" title="function not covered" >function log_helper(self, level, msg) {</span>
<span class="cstat-no" title="statement not covered" >    var o = {</span>
        level: level,
        id: self.id,
        type: self.type,
        msg: msg
    };
<span class="cstat-no" title="statement not covered" >    if (self.name) {</span>
<span class="cstat-no" title="statement not covered" >        o.name = self.name;</span>
    }
<span class="cstat-no" title="statement not covered" >    Log.log(o);</span>
}
&nbsp;
Node.prototype.log = <span class="fstat-no" title="function not covered" >function(msg) {</span>
<span class="cstat-no" title="statement not covered" >    log_helper(this, Log.INFO, msg);</span>
};
&nbsp;
Node.prototype.warn = <span class="fstat-no" title="function not covered" >function(msg) {</span>
<span class="cstat-no" title="statement not covered" >    log_helper(this, Log.WARN, msg);</span>
};
&nbsp;
Node.prototype.error = <span class="fstat-no" title="function not covered" >function(logMessage,msg) {</span>
<span class="cstat-no" title="statement not covered" >    if (typeof logMessage != 'boolean') {</span>
<span class="cstat-no" title="statement not covered" >        logMessage = logMessage || "";</span>
    }
<span class="cstat-no" title="statement not covered" >    log_helper(this, Log.ERROR, logMessage);</span>
    /* istanbul ignore else */
<span class="cstat-no" title="statement not covered" >    if (msg) {</span>
<span class="cstat-no" title="statement not covered" >        flows.handleError(this,logMessage,msg);</span>
    }
};
&nbsp;
/**
 * If called with no args, returns whether metric collection is enabled
 */
Node.prototype.metric = <span class="fstat-no" title="function not covered" >function(eventname, msg, metricValue) {</span>
<span class="cstat-no" title="statement not covered" >    if (typeof eventname === "undefined") {</span>
<span class="cstat-no" title="statement not covered" >        return Log.metric();</span>
    }
<span class="cstat-no" title="statement not covered" >    var metrics = {};</span>
<span class="cstat-no" title="statement not covered" >    metrics.level = Log.METRIC;</span>
<span class="cstat-no" title="statement not covered" >    metrics.nodeid = this.id;</span>
<span class="cstat-no" title="statement not covered" >    metrics.event = "node."+this.type+"."+eventname;</span>
<span class="cstat-no" title="statement not covered" >    metrics.msgid = msg._msgid;</span>
<span class="cstat-no" title="statement not covered" >    metrics.value = metricValue;</span>
<span class="cstat-no" title="statement not covered" >    Log.log(metrics);</span>
}
&nbsp;
/**
 * status: { fill:"red|green", shape:"dot|ring", text:"blah" }
 */
Node.prototype.status = <span class="fstat-no" title="function not covered" >function(status) {</span>
<span class="cstat-no" title="statement not covered" >    flows.handleStatus(this,status);</span>
};
module.exports = Node;
&nbsp;
&nbsp;</pre></td></tr>
</table></pre>
</div>
<div class="footer">
    <div class="meta">Generated by <a href="https://github.com/kaizhu256/node-utility2" target="_blank">utility2</a> at Tue Apr 11 2017 17:25:15 GMT+0000 (UTC)</div>
</div>
</body>
</html>


<!doctype html>
<html lang="en">
<head>
    <title>Code coverage report for node-npmtest-node-red/node-red/red/runtime/nodes/context.js</title>
    <meta charset="utf-8">
    <style>
        body, html {
            margin:0; padding: 0;
        }
        body {
            font-family: Arial, Helvetica;
            font-size: 10pt;
        }
        div.header, div.footer {
            background: #eee;
            padding: 1em;
        }
        div.header {
            height: 160px;
            padding: 0 1em 0 1em;
            z-index: 100;
            position: fixed;
            top: 0;
            border-bottom: 1px solid #666;
            width: 100%;
        }
        div.footer {
            border-top: 1px solid #666;
        }
        div.body {
            margin-top: 170px;
        }
        div.meta {
            font-size: 90%;
            text-align: center;
        }
        h1, h2, h3 {
            font-weight: normal;
        }
        h1 {
            font-size: 12pt;
        }
        h2 {
            font-size: 10pt;
        }
        pre {
            font-family: Menlo, Monaco, Consolas, Courier New, monospace;
            margin: 0;
            padding: 0;
            font-size: 14px;
            tab-size: 2;
        }

        div.path { font-size: 110%; }
        div.path a:link, div.path a:visited { color: #000; }
        table.coverage { border-collapse: collapse; margin:0; padding: 0 }

        table.coverage td {
            margin: 0;
            padding: 0;
            color: #111;
            vertical-align: top;
        }
        table.coverage td.line-count {
            width: 50px;
            text-align: right;
            padding-right: 5px;
        }
        table.coverage td.line-coverage {
            color: #777 !important;
            text-align: right;
            border-left: 1px solid #666;
            border-right: 1px solid #666;
        }

        table.coverage td.text {
        }

        table.coverage td span.cline-any {
            display: inline-block;
            padding: 0 5px;
            width: 40px;
        }
        table.coverage td span.cline-neutral {
            background: #eee;
        }
        table.coverage td span.cline-yes {
            background: #b5d592;
            color: #999;
        }
        table.coverage td span.cline-no {
            background: #fc8c84;
        }

        .cstat-yes { color: #111; }
        .cstat-no { background: #fc8c84; color: #111; }
        .fstat-no { background: #ffc520; color: #111 !important; }
        .cbranch-no { background:  yellow !important; color: #111; }

        .cstat-skip { background: #ddd; color: #111; }
        .fstat-skip { background: #ddd; color: #111 !important; }
        .cbranch-skip { background: #ddd !important; color: #111; }

        .missing-if-branch {
            display: inline-block;
            margin-right: 10px;
            position: relative;
            padding: 0 4px;
            background: black;
            color: yellow;
        }

        .skip-if-branch {
            display: none;
            margin-right: 10px;
            position: relative;
            padding: 0 4px;
            background: #ccc;
            color: white;
        }

        .missing-if-branch .typ, .skip-if-branch .typ {
            color: inherit !important;
        }

        .entity, .metric { font-weight: bold; }
        .metric { display: inline-block; border: 1px solid #333; padding: 0.3em; background: white; }
        .metric small { font-size: 80%; font-weight: normal; color: #666; }

        div.coverage-summary table { border-collapse: collapse; margin: 3em; font-size: 110%; }
        div.coverage-summary td, div.coverage-summary table  th { margin: 0; padding: 0.25em 1em; border-top: 1px solid #666; border-bottom: 1px solid #666; }
        div.coverage-summary th { text-align: left; border: 1px solid #666; background: #eee; font-weight: normal; }
        div.coverage-summary th.file { border-right: none !important; }
        div.coverage-summary th.pic { border-left: none !important; text-align: right; }
        div.coverage-summary th.pct { border-right: none !important; }
        div.coverage-summary th.abs { border-left: none !important; text-align: right; }
        div.coverage-summary td.pct { text-align: right; border-left: 1px solid #666; }
        div.coverage-summary td.abs { text-align: right; font-size: 90%; color: #444; border-right: 1px solid #666; }
        div.coverage-summary td.file { text-align: right; border-left: 1px solid #666; white-space: nowrap;  }
        div.coverage-summary td.pic { min-width: 120px !important;  }
        div.coverage-summary a:link { color: #000; }
        div.coverage-summary a:visited { color: #333; }
        div.coverage-summary tfoot td { border-top: 1px solid #666; }

        div.coverage-summary .yui3-datatable-sort-indicator, div.coverage-summary .dummy-sort-indicator {
            height: 10px;
            width: 7px;
            display: inline-block;
            margin-left: 0.5em;
        }
        div.coverage-summary .yui3-datatable-sort-indicator {
            background: no-repeat scroll 0 0 transparent;
        }
        div.coverage-summary .yui3-datatable-sorted .yui3-datatable-sort-indicator {
            background-position: 0 -20px;
        }
        div.coverage-summary .yui3-datatable-sorted-desc .yui3-datatable-sort-indicator {
            background-position: 0 -10px;
        }

        .high { background: #b5d592 !important; }
        .medium { background: #ffe87c !important; }
        .low { background: #fc8c84 !important; }

        span.cover-fill, span.cover-empty {
            display:inline-block;
            border:1px solid #444;
            background: white;
            height: 12px;
        }
        span.cover-fill {
            background: #ccc;
            border-right: 1px solid #444;
        }
        span.cover-empty {
            background: white;
            border-left: none;
        }
        span.cover-full {
            border-right: none !important;
        }
        pre.prettyprint {
            border: none !important;
            padding: 0 !important;
            margin: 0 !important;
        }
        .com { color: #999 !important; }
        .ignore-none { color: #999; font-weight: normal; }

    </style>
</head>
<body>
<div class="header low">
    <h1 style="font-weight: bold;">
        <a href="https://github.com/npmtest/node-npmtest-node-red">npmtest-node-red (v0.0.1)</a>
    </h1>
    <h1>Code coverage report for <span class="entity">node-npmtest-node-red/node-red/red/runtime/nodes/context.js</span></h1>
    <h2>
        
        Statements: <span class="metric">23.81% <small>(10 / 42)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        
        Branches: <span class="metric">0% <small>(0 / 20)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        
        Functions: <span class="metric">0% <small>(0 / 7)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        
        Lines: <span class="metric">23.81% <small>(10 / 42)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        Ignored: <span class="metric"><span class="ignore-none">none</span></span> &nbsp;&nbsp;&nbsp;&nbsp;
    </h2>
    <div class="path"><a href="../../../../../index.html">All files</a> &#187; <a href="index.html">node-npmtest-node-red/node-red/red/runtime/nodes/</a> &#187; context.js</div>
</div>
<div class="body">
<pre><table class="coverage">
<tr><td class="line-count">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83</td><td class="line-coverage"><span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span></td><td class="text"><pre class="prettyprint lang-js">/**
 * Copyright JS Foundation and other contributors, http://js.foundation
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 **/
&nbsp;
var clone = require("clone");
var when = require("when");
var util = require("../util");
&nbsp;
<span class="fstat-no" title="function not covered" >function createContext(id,seed) {</span>
<span class="cstat-no" title="statement not covered" >    var data = seed || {};</span>
<span class="cstat-no" title="statement not covered" >    var obj = seed || {};</span>
<span class="cstat-no" title="statement not covered" >    obj.get = <span class="fstat-no" title="function not covered" >function get(key) {</span></span>
<span class="cstat-no" title="statement not covered" >        return util.getMessageProperty(data,key);</span>
    };
<span class="cstat-no" title="statement not covered" >    obj.set = <span class="fstat-no" title="function not covered" >function set(key, value) {</span></span>
<span class="cstat-no" title="statement not covered" >        util.setMessageProperty(data,key,value);</span>
    }
<span class="cstat-no" title="statement not covered" >    return obj;</span>
}
&nbsp;
var contexts = {};
var globalContext = null;
&nbsp;
<span class="fstat-no" title="function not covered" >function getContext(localId,flowId) {</span>
<span class="cstat-no" title="statement not covered" >    var contextId = localId;</span>
<span class="cstat-no" title="statement not covered" >    if (flowId) {</span>
<span class="cstat-no" title="statement not covered" >        contextId = localId+":"+flowId;</span>
    }
<span class="cstat-no" title="statement not covered" >    if (contexts.hasOwnProperty(contextId)) {</span>
<span class="cstat-no" title="statement not covered" >        return contexts[contextId];</span>
    }
<span class="cstat-no" title="statement not covered" >    var newContext = createContext(contextId);</span>
<span class="cstat-no" title="statement not covered" >    if (flowId) {</span>
<span class="cstat-no" title="statement not covered" >        newContext.flow = getContext(flowId);</span>
<span class="cstat-no" title="statement not covered" >        if (globalContext) {</span>
<span class="cstat-no" title="statement not covered" >            newContext.global = globalContext;</span>
        }
    }
<span class="cstat-no" title="statement not covered" >    contexts[contextId] = newContext;</span>
<span class="cstat-no" title="statement not covered" >    return newContext;</span>
}
<span class="fstat-no" title="function not covered" >function deleteContext(id,flowId) {</span>
<span class="cstat-no" title="statement not covered" >    var contextId = id;</span>
<span class="cstat-no" title="statement not covered" >    if (flowId) {</span>
<span class="cstat-no" title="statement not covered" >        contextId = id+":"+flowId;</span>
    }
<span class="cstat-no" title="statement not covered" >    delete contexts[contextId];</span>
}
<span class="fstat-no" title="function not covered" >function clean(flowConfig) {</span>
<span class="cstat-no" title="statement not covered" >    var activeIds = {};</span>
<span class="cstat-no" title="statement not covered" >    var contextId;</span>
<span class="cstat-no" title="statement not covered" >    var node;</span>
<span class="cstat-no" title="statement not covered" >    for (var id in contexts) {</span>
<span class="cstat-no" title="statement not covered" >        if (contexts.hasOwnProperty(id)) {</span>
<span class="cstat-no" title="statement not covered" >            var idParts = id.split(":");</span>
<span class="cstat-no" title="statement not covered" >            if (!flowConfig.allNodes.hasOwnProperty(idParts[0])) {</span>
<span class="cstat-no" title="statement not covered" >                delete contexts[id];</span>
            }
        }
    }
}
module.exports = {
    init: <span class="fstat-no" title="function not covered" >function(settings) {</span>
<span class="cstat-no" title="statement not covered" >        globalContext = createContext("global",settings.functionGlobalContext || {});</span>
    },
    get: getContext,
    delete: deleteContext,
    clean:clean
};
&nbsp;
&nbsp;</pre></td></tr>
</table></pre>
</div>
<div class="footer">
    <div class="meta">Generated by <a href="https://github.com/kaizhu256/node-utility2" target="_blank">utility2</a> at Tue Apr 11 2017 17:25:15 GMT+0000 (UTC)</div>
</div>
</body>
</html>


<!doctype html>
<html lang="en">
<head>
    <title>Code coverage report for node-npmtest-node-red/node-red/red/runtime/nodes/credentials.js</title>
    <meta charset="utf-8">
    <style>
        body, html {
            margin:0; padding: 0;
        }
        body {
            font-family: Arial, Helvetica;
            font-size: 10pt;
        }
        div.header, div.footer {
            background: #eee;
            padding: 1em;
        }
        div.header {
            height: 160px;
            padding: 0 1em 0 1em;
            z-index: 100;
            position: fixed;
            top: 0;
            border-bottom: 1px solid #666;
            width: 100%;
        }
        div.footer {
            border-top: 1px solid #666;
        }
        div.body {
            margin-top: 170px;
        }
        div.meta {
            font-size: 90%;
            text-align: center;
        }
        h1, h2, h3 {
            font-weight: normal;
        }
        h1 {
            font-size: 12pt;
        }
        h2 {
            font-size: 10pt;
        }
        pre {
            font-family: Menlo, Monaco, Consolas, Courier New, monospace;
            margin: 0;
            padding: 0;
            font-size: 14px;
            tab-size: 2;
        }

        div.path { font-size: 110%; }
        div.path a:link, div.path a:visited { color: #000; }
        table.coverage { border-collapse: collapse; margin:0; padding: 0 }

        table.coverage td {
            margin: 0;
            padding: 0;
            color: #111;
            vertical-align: top;
        }
        table.coverage td.line-count {
            width: 50px;
            text-align: right;
            padding-right: 5px;
        }
        table.coverage td.line-coverage {
            color: #777 !important;
            text-align: right;
            border-left: 1px solid #666;
            border-right: 1px solid #666;
        }

        table.coverage td.text {
        }

        table.coverage td span.cline-any {
            display: inline-block;
            padding: 0 5px;
            width: 40px;
        }
        table.coverage td span.cline-neutral {
            background: #eee;
        }
        table.coverage td span.cline-yes {
            background: #b5d592;
            color: #999;
        }
        table.coverage td span.cline-no {
            background: #fc8c84;
        }

        .cstat-yes { color: #111; }
        .cstat-no { background: #fc8c84; color: #111; }
        .fstat-no { background: #ffc520; color: #111 !important; }
        .cbranch-no { background:  yellow !important; color: #111; }

        .cstat-skip { background: #ddd; color: #111; }
        .fstat-skip { background: #ddd; color: #111 !important; }
        .cbranch-skip { background: #ddd !important; color: #111; }

        .missing-if-branch {
            display: inline-block;
            margin-right: 10px;
            position: relative;
            padding: 0 4px;
            background: black;
            color: yellow;
        }

        .skip-if-branch {
            display: none;
            margin-right: 10px;
            position: relative;
            padding: 0 4px;
            background: #ccc;
            color: white;
        }

        .missing-if-branch .typ, .skip-if-branch .typ {
            color: inherit !important;
        }

        .entity, .metric { font-weight: bold; }
        .metric { display: inline-block; border: 1px solid #333; padding: 0.3em; background: white; }
        .metric small { font-size: 80%; font-weight: normal; color: #666; }

        div.coverage-summary table { border-collapse: collapse; margin: 3em; font-size: 110%; }
        div.coverage-summary td, div.coverage-summary table  th { margin: 0; padding: 0.25em 1em; border-top: 1px solid #666; border-bottom: 1px solid #666; }
        div.coverage-summary th { text-align: left; border: 1px solid #666; background: #eee; font-weight: normal; }
        div.coverage-summary th.file { border-right: none !important; }
        div.coverage-summary th.pic { border-left: none !important; text-align: right; }
        div.coverage-summary th.pct { border-right: none !important; }
        div.coverage-summary th.abs { border-left: none !important; text-align: right; }
        div.coverage-summary td.pct { text-align: right; border-left: 1px solid #666; }
        div.coverage-summary td.abs { text-align: right; font-size: 90%; color: #444; border-right: 1px solid #666; }
        div.coverage-summary td.file { text-align: right; border-left: 1px solid #666; white-space: nowrap;  }
        div.coverage-summary td.pic { min-width: 120px !important;  }
        div.coverage-summary a:link { color: #000; }
        div.coverage-summary a:visited { color: #333; }
        div.coverage-summary tfoot td { border-top: 1px solid #666; }

        div.coverage-summary .yui3-datatable-sort-indicator, div.coverage-summary .dummy-sort-indicator {
            height: 10px;
            width: 7px;
            display: inline-block;
            margin-left: 0.5em;
        }
        div.coverage-summary .yui3-datatable-sort-indicator {
            background: no-repeat scroll 0 0 transparent;
        }
        div.coverage-summary .yui3-datatable-sorted .yui3-datatable-sort-indicator {
            background-position: 0 -20px;
        }
        div.coverage-summary .yui3-datatable-sorted-desc .yui3-datatable-sort-indicator {
            background-position: 0 -10px;
        }

        .high { background: #b5d592 !important; }
        .medium { background: #ffe87c !important; }
        .low { background: #fc8c84 !important; }

        span.cover-fill, span.cover-empty {
            display:inline-block;
            border:1px solid #444;
            background: white;
            height: 12px;
        }
        span.cover-fill {
            background: #ccc;
            border-right: 1px solid #444;
        }
        span.cover-empty {
            background: white;
            border-left: none;
        }
        span.cover-full {
            border-right: none !important;
        }
        pre.prettyprint {
            border: none !important;
            padding: 0 !important;
            margin: 0 !important;
        }
        .com { color: #999 !important; }
        .ignore-none { color: #999; font-weight: normal; }

    </style>
</head>
<body>
<div class="header low">
    <h1 style="font-weight: bold;">
        <a href="https://github.com/npmtest/node-npmtest-node-red">npmtest-node-red (v0.0.1)</a>
    </h1>
    <h1>Code coverage report for <span class="entity">node-npmtest-node-red/node-red/red/runtime/nodes/credentials.js</span></h1>
    <h2>
        
        Statements: <span class="metric">9.03% <small>(14 / 155)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        
        Branches: <span class="metric">0% <small>(0 / 66)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        
        Functions: <span class="metric">0% <small>(0 / 15)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        
        Lines: <span class="metric">9.03% <small>(14 / 155)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        Ignored: <span class="metric"><span class="ignore-none">none</span></span> &nbsp;&nbsp;&nbsp;&nbsp;
    </h2>
    <div class="path"><a href="../../../../../index.html">All files</a> &#187; <a href="index.html">node-npmtest-node-red/node-red/red/runtime/nodes/</a> &#187; credentials.js</div>
</div>
<div class="body">
<pre><table class="coverage">
<tr><td class="line-count">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
164
165
166
167
168
169
170
171
172
173
174
175
176
177
178
179
180
181
182
183
184
185
186
187
188
189
190
191
192
193
194
195
196
197
198
199
200
201
202
203
204
205
206
207
208
209
210
211
212
213
214
215
216
217
218
219
220
221
222
223
224
225
226
227
228
229
230
231
232
233
234
235
236
237
238
239
240
241
242
243
244
245
246
247
248
249
250
251
252
253
254
255
256
257
258
259
260
261
262
263
264
265
266
267
268
269
270
271
272
273
274
275
276
277
278
279
280
281
282
283
284
285
286
287
288
289
290
291
292
293
294
295
296
297
298
299
300
301
302
303
304
305
306
307
308
309
310
311
312
313
314
315
316
317
318
319
320
321</td><td class="line-coverage"><span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span></td><td class="text"><pre class="prettyprint lang-js">/**
 * Copyright JS Foundation and other contributors, http://js.foundation
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 **/
&nbsp;
var when = require("when");
var crypto = require('crypto');
var settings;
var log;
&nbsp;
var encryptedCredentials = null;
var credentialCache = {};
var credentialsDef = {};
var dirty = false;
&nbsp;
var removeDefaultKey = false;
var encryptionEnabled = null;
var encryptionAlgorithm = "aes-256-ctr";
var encryptionKey;
&nbsp;
<span class="fstat-no" title="function not covered" >function decryptCredentials(key,credentials) {</span>
<span class="cstat-no" title="statement not covered" >    var creds = credentials["$"];</span>
<span class="cstat-no" title="statement not covered" >    var initVector = new Buffer(creds.substring(0, 32),'hex');</span>
<span class="cstat-no" title="statement not covered" >    creds = creds.substring(32);</span>
<span class="cstat-no" title="statement not covered" >    var decipher = crypto.createDecipheriv(encryptionAlgorithm, key, initVector);</span>
<span class="cstat-no" title="statement not covered" >    var decrypted = decipher.update(creds, 'base64', 'utf8') + decipher.final('utf8');</span>
<span class="cstat-no" title="statement not covered" >    return JSON.parse(decrypted);</span>
}
&nbsp;
var api = module.exports = {
    init: <span class="fstat-no" title="function not covered" >function(runtime) {</span>
<span class="cstat-no" title="statement not covered" >        log = runtime.log;</span>
<span class="cstat-no" title="statement not covered" >        settings = runtime.settings;</span>
<span class="cstat-no" title="statement not covered" >        dirty = false;</span>
<span class="cstat-no" title="statement not covered" >        credentialCache = {};</span>
<span class="cstat-no" title="statement not covered" >        credentialsDef = {};</span>
<span class="cstat-no" title="statement not covered" >        encryptionEnabled = null;</span>
    },
&nbsp;
    /**
     * Sets the credentials from storage.
     */
    load: <span class="fstat-no" title="function not covered" >function (credentials) {</span>
<span class="cstat-no" title="statement not covered" >        dirty = false;</span>
        /*
          - if encryptionEnabled === null, check the current configuration
        */
<span class="cstat-no" title="statement not covered" >        var credentialsEncrypted = credentials.hasOwnProperty("$") &amp;&amp; Object.keys(credentials).length === 1;</span>
<span class="cstat-no" title="statement not covered" >        var setupEncryptionPromise = when.resolve();</span>
<span class="cstat-no" title="statement not covered" >        if (encryptionEnabled === null) {</span>
<span class="cstat-no" title="statement not covered" >            var defaultKey;</span>
<span class="cstat-no" title="statement not covered" >            try {</span>
<span class="cstat-no" title="statement not covered" >                defaultKey = settings.get('_credentialSecret');</span>
            } catch(err) {
            }
<span class="cstat-no" title="statement not covered" >            if (defaultKey) {</span>
<span class="cstat-no" title="statement not covered" >                defaultKey = crypto.createHash('sha256').update(defaultKey).digest();</span>
            }
<span class="cstat-no" title="statement not covered" >            var userKey;</span>
<span class="cstat-no" title="statement not covered" >            try {</span>
<span class="cstat-no" title="statement not covered" >                userKey = settings.get('credentialSecret');</span>
            } catch(err) {
<span class="cstat-no" title="statement not covered" >                userKey = false;</span>
            }
<span class="cstat-no" title="statement not covered" >            if (userKey === false) {</span>
<span class="cstat-no" title="statement not covered" >                log.debug("red/runtime/nodes/credentials.load : user disabled encryption");</span>
                // User has disabled encryption
<span class="cstat-no" title="statement not covered" >                encryptionEnabled = false;</span>
                // Check if we have a generated _credSecret to decrypt with and remove
<span class="cstat-no" title="statement not covered" >                if (defaultKey) {</span>
<span class="cstat-no" title="statement not covered" >                    log.debug("red/runtime/nodes/credentials.load : default key present. Will migrate");</span>
<span class="cstat-no" title="statement not covered" >                    if (credentialsEncrypted) {</span>
<span class="cstat-no" title="statement not covered" >                        try {</span>
<span class="cstat-no" title="statement not covered" >                            credentials = decryptCredentials(defaultKey,credentials)</span>
                        } catch(err) {
<span class="cstat-no" title="statement not covered" >                            credentials = {};</span>
<span class="cstat-no" title="statement not covered" >                            log.warn(log._("nodes.credentials.error",{message:err.toString()}))</span>
                        }
                    }
<span class="cstat-no" title="statement not covered" >                    dirty = true;</span>
<span class="cstat-no" title="statement not covered" >                    removeDefaultKey = true;</span>
                }
            } else <span class="cstat-no" title="statement not covered" >if (typeof userKey === 'string') {</span>
<span class="cstat-no" title="statement not covered" >                log.debug("red/runtime/nodes/credentials.load : user provided key");</span>
                // User has provided own encryption key, get the 32-byte hash of it
<span class="cstat-no" title="statement not covered" >                encryptionKey = crypto.createHash('sha256').update(userKey).digest();</span>
<span class="cstat-no" title="statement not covered" >                encryptionEnabled = true;</span>
&nbsp;
<span class="cstat-no" title="statement not covered" >                if (defaultKey) {</span>
<span class="cstat-no" title="statement not covered" >                    log.debug("red/runtime/nodes/credentials.load : default key present. Will migrate");</span>
                    // User has provided their own key, but we already have a default key
                    // Decrypt using default key
<span class="cstat-no" title="statement not covered" >                    if (credentialsEncrypted) {</span>
<span class="cstat-no" title="statement not covered" >                        try {</span>
<span class="cstat-no" title="statement not covered" >                            credentials = decryptCredentials(defaultKey,credentials)</span>
                        } catch(err) {
<span class="cstat-no" title="statement not covered" >                            credentials = {};</span>
<span class="cstat-no" title="statement not covered" >                            log.warn(log._("nodes.credentials.error",{message:err.toString()}))</span>
                        }
                    }
<span class="cstat-no" title="statement not covered" >                    dirty = true;</span>
<span class="cstat-no" title="statement not covered" >                    removeDefaultKey = true;</span>
                }
            } else {
<span class="cstat-no" title="statement not covered" >                log.debug("red/runtime/nodes/credentials.load : no user key present");</span>
                // User has not provide their own key
<span class="cstat-no" title="statement not covered" >                encryptionKey = defaultKey;</span>
<span class="cstat-no" title="statement not covered" >                encryptionEnabled = true;</span>
<span class="cstat-no" title="statement not covered" >                if (encryptionKey === undefined) {</span>
<span class="cstat-no" title="statement not covered" >                    log.debug("red/runtime/nodes/credentials.load : no default key present - generating one");</span>
                    // No user-provided key, no generated key
                    // Generate a new key
<span class="cstat-no" title="statement not covered" >                    defaultKey = crypto.randomBytes(32).toString('hex');</span>
<span class="cstat-no" title="statement not covered" >                    try {</span>
<span class="cstat-no" title="statement not covered" >                        setupEncryptionPromise = settings.set('_credentialSecret',defaultKey);</span>
<span class="cstat-no" title="statement not covered" >                        encryptionKey = crypto.createHash('sha256').update(defaultKey).digest();</span>
                    } catch(err) {
<span class="cstat-no" title="statement not covered" >                        log.debug("red/runtime/nodes/credentials.load : settings unavailable - disabling encryption");</span>
                        // Settings unavailable
<span class="cstat-no" title="statement not covered" >                        encryptionEnabled = false;</span>
<span class="cstat-no" title="statement not covered" >                        encryptionKey = null;</span>
                    }
<span class="cstat-no" title="statement not covered" >                    dirty = true;</span>
                } else {
<span class="cstat-no" title="statement not covered" >                    log.debug("red/runtime/nodes/credentials.load : using default key");</span>
                }
            }
        }
<span class="cstat-no" title="statement not covered" >        if (encryptionEnabled &amp;&amp; !dirty) {</span>
<span class="cstat-no" title="statement not covered" >            encryptedCredentials = credentials;</span>
        }
<span class="cstat-no" title="statement not covered" >        return setupEncryptionPromise.then(<span class="fstat-no" title="function not covered" >function() {</span></span>
<span class="cstat-no" title="statement not covered" >            if (credentials.hasOwnProperty("$")) {</span>
                // These are encrypted credentials
<span class="cstat-no" title="statement not covered" >                try {</span>
<span class="cstat-no" title="statement not covered" >                    credentialCache = decryptCredentials(encryptionKey,credentials)</span>
                } catch(err) {
<span class="cstat-no" title="statement not covered" >                    credentialCache = {};</span>
<span class="cstat-no" title="statement not covered" >                    dirty = true;</span>
<span class="cstat-no" title="statement not covered" >                    log.warn(log._("nodes.credentials.error",{message:err.toString()}))</span>
                }
            } else {
<span class="cstat-no" title="statement not covered" >                credentialCache = credentials;</span>
            }
        });
    },
&nbsp;
    /**
     * Adds a set of credentials for the given node id.
     * @param id the node id for the credentials
     * @param creds an object of credential key/value pairs
     * @return a promise for backwards compatibility TODO: can this be removed?
     */
    add: <span class="fstat-no" title="function not covered" >function (id, creds) {</span>
<span class="cstat-no" title="statement not covered" >        if (!credentialCache.hasOwnProperty(id) || JSON.stringify(creds) !== JSON.stringify(credentialCache[id])) {</span>
<span class="cstat-no" title="statement not covered" >            credentialCache[id] = creds;</span>
<span class="cstat-no" title="statement not covered" >            dirty = true;</span>
        }
<span class="cstat-no" title="statement not covered" >        return when.resolve();</span>
    },
&nbsp;
    /**
     * Gets the credentials for the given node id.
     * @param id the node id for the credentials
     * @return the credentials
     */
    get: <span class="fstat-no" title="function not covered" >function (id) {</span>
<span class="cstat-no" title="statement not covered" >        return credentialCache[id];</span>
    },
&nbsp;
    /**
     * Deletes the credentials for the given node id.
     * @param id the node id for the credentials
     * @return a promise for the saving of credentials to storage
     */
    delete: <span class="fstat-no" title="function not covered" >function (id) {</span>
<span class="cstat-no" title="statement not covered" >        delete credentialCache[id];</span>
<span class="cstat-no" title="statement not covered" >        dirty = true;</span>
    },
&nbsp;
    /**
     * Deletes any credentials for nodes that no longer exist
     * @param config a flow config
     * @return a promise for the saving of credentials to storage
     */
    clean: <span class="fstat-no" title="function not covered" >function (config) {</span>
<span class="cstat-no" title="statement not covered" >        var existingIds = {};</span>
<span class="cstat-no" title="statement not covered" >        config.forEach(<span class="fstat-no" title="function not covered" >function(n) {</span></span>
<span class="cstat-no" title="statement not covered" >            existingIds[n.id] = true;</span>
<span class="cstat-no" title="statement not covered" >            if (n.credentials) {</span>
<span class="cstat-no" title="statement not covered" >                api.extract(n);</span>
            }
        });
<span class="cstat-no" title="statement not covered" >        var deletedCredentials = false;</span>
<span class="cstat-no" title="statement not covered" >        for (var c in credentialCache) {</span>
<span class="cstat-no" title="statement not covered" >            if (credentialCache.hasOwnProperty(c)) {</span>
<span class="cstat-no" title="statement not covered" >                if (!existingIds[c]) {</span>
<span class="cstat-no" title="statement not covered" >                    deletedCredentials = true;</span>
<span class="cstat-no" title="statement not covered" >                    delete credentialCache[c];</span>
                }
            }
        }
<span class="cstat-no" title="statement not covered" >        if (deletedCredentials) {</span>
<span class="cstat-no" title="statement not covered" >            dirty = true;</span>
        }
<span class="cstat-no" title="statement not covered" >        return when.resolve();</span>
    },
&nbsp;
    /**
     * Registers a node credential definition.
     * @param type the node type
     * @param definition the credential definition
     */
    register: <span class="fstat-no" title="function not covered" >function (type, definition) {</span>
<span class="cstat-no" title="statement not covered" >        var dashedType = type.replace(/\s+/g, '-');</span>
<span class="cstat-no" title="statement not covered" >        credentialsDef[dashedType] = definition;</span>
    },
&nbsp;
    /**
     * Extracts and stores any credential updates in the provided node.
     * The provided node may have a .credentials property that contains
     * new credentials for the node.
     * This function loops through the credentials in the definition for
     * the node-type and applies any of the updates provided in the node.
     *
     * This function does not save the credentials to disk as it is expected
     * to be called multiple times when a new flow is deployed.
     *
     * @param node the node to extract credentials from
     */
    extract: <span class="fstat-no" title="function not covered" >function(node) {</span>
<span class="cstat-no" title="statement not covered" >        var nodeID = node.id;</span>
<span class="cstat-no" title="statement not covered" >        var nodeType = node.type;</span>
<span class="cstat-no" title="statement not covered" >        var newCreds = node.credentials;</span>
<span class="cstat-no" title="statement not covered" >        if (newCreds) {</span>
<span class="cstat-no" title="statement not covered" >            delete node.credentials;</span>
<span class="cstat-no" title="statement not covered" >            var savedCredentials = credentialCache[nodeID] || {};</span>
<span class="cstat-no" title="statement not covered" >            var dashedType = nodeType.replace(/\s+/g, '-');</span>
<span class="cstat-no" title="statement not covered" >            var definition = credentialsDef[dashedType];</span>
<span class="cstat-no" title="statement not covered" >            if (!definition) {</span>
<span class="cstat-no" title="statement not covered" >                log.warn(log._("nodes.credentials.not-registered",{type:nodeType}));</span>
<span class="cstat-no" title="statement not covered" >                return;</span>
            }
&nbsp;
<span class="cstat-no" title="statement not covered" >            for (var cred in definition) {</span>
<span class="cstat-no" title="statement not covered" >                if (definition.hasOwnProperty(cred)) {</span>
<span class="cstat-no" title="statement not covered" >                    if (newCreds[cred] === undefined) {</span>
<span class="cstat-no" title="statement not covered" >                        continue;</span>
                    }
<span class="cstat-no" title="statement not covered" >                    if (definition[cred].type == "password" &amp;&amp; newCreds[cred] == '__PWRD__') {</span>
<span class="cstat-no" title="statement not covered" >                        continue;</span>
                    }
<span class="cstat-no" title="statement not covered" >                    if (0 === newCreds[cred].length || /^\s*$/.test(newCreds[cred])) {</span>
<span class="cstat-no" title="statement not covered" >                        delete savedCredentials[cred];</span>
<span class="cstat-no" title="statement not covered" >                        dirty = true;</span>
<span class="cstat-no" title="statement not covered" >                        continue;</span>
                    }
<span class="cstat-no" title="statement not covered" >                    if (!savedCredentials.hasOwnProperty(cred) || JSON.stringify(savedCredentials[cred]) !== JSON.stringify(newCreds[cred])) {</span>
<span class="cstat-no" title="statement not covered" >                        savedCredentials[cred] = newCreds[cred];</span>
<span class="cstat-no" title="statement not covered" >                        dirty = true;</span>
                    }
                }
            }
<span class="cstat-no" title="statement not covered" >            credentialCache[nodeID] = savedCredentials;</span>
        }
    },
&nbsp;
    /**
     * Gets the credential definition for the given node type
     * @param type the node type
     * @return the credential definition
     */
    getDefinition: <span class="fstat-no" title="function not covered" >function (type) {</span>
<span class="cstat-no" title="statement not covered" >        return credentialsDef[type];</span>
    },
&nbsp;
    dirty: <span class="fstat-no" title="function not covered" >function() {</span>
<span class="cstat-no" title="statement not covered" >        return dirty;</span>
    },
&nbsp;
    export: <span class="fstat-no" title="function not covered" >function() {</span>
<span class="cstat-no" title="statement not covered" >        var result = credentialCache;</span>
<span class="cstat-no" title="statement not covered" >        if (encryptionEnabled) {</span>
<span class="cstat-no" title="statement not covered" >            if (dirty) {</span>
<span class="cstat-no" title="statement not covered" >                try {</span>
<span class="cstat-no" title="statement not covered" >                    log.debug("red/runtime/nodes/credentials.export : encrypting");</span>
<span class="cstat-no" title="statement not covered" >                    var initVector = crypto.randomBytes(16);</span>
<span class="cstat-no" title="statement not covered" >                    var cipher = crypto.createCipheriv(encryptionAlgorithm, encryptionKey, initVector);</span>
<span class="cstat-no" title="statement not covered" >                    result = {"$":initVector.toString('hex') + cipher.update(JSON.stringify(credentialCache), 'utf8', 'base64') + cipher.final('base64')};</span>
                } catch(err) {
<span class="cstat-no" title="statement not covered" >                    log.warn(log._("nodes.credentials.error-saving",{message:err.toString()}))</span>
                }
            } else {
<span class="cstat-no" title="statement not covered" >                result = encryptedCredentials;</span>
            }
        }
<span class="cstat-no" title="statement not covered" >        dirty = false;</span>
<span class="cstat-no" title="statement not covered" >        if (removeDefaultKey) {</span>
<span class="cstat-no" title="statement not covered" >            log.debug("red/runtime/nodes/credentials.export : removing unused default key");</span>
<span class="cstat-no" title="statement not covered" >            return settings.delete('_credentialSecret').then(<span class="fstat-no" title="function not covered" >function() {</span></span>
<span class="cstat-no" title="statement not covered" >                removeDefaultKey = false;</span>
<span class="cstat-no" title="statement not covered" >                return result;</span>
            })
        } else {
<span class="cstat-no" title="statement not covered" >            return when.resolve(result);</span>
        }
    }
}
&nbsp;
&nbsp;</pre></td></tr>
</table></pre>
</div>
<div class="footer">
    <div class="meta">Generated by <a href="https://github.com/kaizhu256/node-utility2" target="_blank">utility2</a> at Tue Apr 11 2017 17:25:15 GMT+0000 (UTC)</div>
</div>
</body>
</html>


<!doctype html>
<html lang="en">
<head>
    <title>Code coverage report for node-npmtest-node-red/node-red/red/runtime/nodes/index.js</title>
    <meta charset="utf-8">
    <style>
        body, html {
            margin:0; padding: 0;
        }
        body {
            font-family: Arial, Helvetica;
            font-size: 10pt;
        }
        div.header, div.footer {
            background: #eee;
            padding: 1em;
        }
        div.header {
            height: 160px;
            padding: 0 1em 0 1em;
            z-index: 100;
            position: fixed;
            top: 0;
            border-bottom: 1px solid #666;
            width: 100%;
        }
        div.footer {
            border-top: 1px solid #666;
        }
        div.body {
            margin-top: 170px;
        }
        div.meta {
            font-size: 90%;
            text-align: center;
        }
        h1, h2, h3 {
            font-weight: normal;
        }
        h1 {
            font-size: 12pt;
        }
        h2 {
            font-size: 10pt;
        }
        pre {
            font-family: Menlo, Monaco, Consolas, Courier New, monospace;
            margin: 0;
            padding: 0;
            font-size: 14px;
            tab-size: 2;
        }

        div.path { font-size: 110%; }
        div.path a:link, div.path a:visited { color: #000; }
        table.coverage { border-collapse: collapse; margin:0; padding: 0 }

        table.coverage td {
            margin: 0;
            padding: 0;
            color: #111;
            vertical-align: top;
        }
        table.coverage td.line-count {
            width: 50px;
            text-align: right;
            padding-right: 5px;
        }
        table.coverage td.line-coverage {
            color: #777 !important;
            text-align: right;
            border-left: 1px solid #666;
            border-right: 1px solid #666;
        }

        table.coverage td.text {
        }

        table.coverage td span.cline-any {
            display: inline-block;
            padding: 0 5px;
            width: 40px;
        }
        table.coverage td span.cline-neutral {
            background: #eee;
        }
        table.coverage td span.cline-yes {
            background: #b5d592;
            color: #999;
        }
        table.coverage td span.cline-no {
            background: #fc8c84;
        }

        .cstat-yes { color: #111; }
        .cstat-no { background: #fc8c84; color: #111; }
        .fstat-no { background: #ffc520; color: #111 !important; }
        .cbranch-no { background:  yellow !important; color: #111; }

        .cstat-skip { background: #ddd; color: #111; }
        .fstat-skip { background: #ddd; color: #111 !important; }
        .cbranch-skip { background: #ddd !important; color: #111; }

        .missing-if-branch {
            display: inline-block;
            margin-right: 10px;
            position: relative;
            padding: 0 4px;
            background: black;
            color: yellow;
        }

        .skip-if-branch {
            display: none;
            margin-right: 10px;
            position: relative;
            padding: 0 4px;
            background: #ccc;
            color: white;
        }

        .missing-if-branch .typ, .skip-if-branch .typ {
            color: inherit !important;
        }

        .entity, .metric { font-weight: bold; }
        .metric { display: inline-block; border: 1px solid #333; padding: 0.3em; background: white; }
        .metric small { font-size: 80%; font-weight: normal; color: #666; }

        div.coverage-summary table { border-collapse: collapse; margin: 3em; font-size: 110%; }
        div.coverage-summary td, div.coverage-summary table  th { margin: 0; padding: 0.25em 1em; border-top: 1px solid #666; border-bottom: 1px solid #666; }
        div.coverage-summary th { text-align: left; border: 1px solid #666; background: #eee; font-weight: normal; }
        div.coverage-summary th.file { border-right: none !important; }
        div.coverage-summary th.pic { border-left: none !important; text-align: right; }
        div.coverage-summary th.pct { border-right: none !important; }
        div.coverage-summary th.abs { border-left: none !important; text-align: right; }
        div.coverage-summary td.pct { text-align: right; border-left: 1px solid #666; }
        div.coverage-summary td.abs { text-align: right; font-size: 90%; color: #444; border-right: 1px solid #666; }
        div.coverage-summary td.file { text-align: right; border-left: 1px solid #666; white-space: nowrap;  }
        div.coverage-summary td.pic { min-width: 120px !important;  }
        div.coverage-summary a:link { color: #000; }
        div.coverage-summary a:visited { color: #333; }
        div.coverage-summary tfoot td { border-top: 1px solid #666; }

        div.coverage-summary .yui3-datatable-sort-indicator, div.coverage-summary .dummy-sort-indicator {
            height: 10px;
            width: 7px;
            display: inline-block;
            margin-left: 0.5em;
        }
        div.coverage-summary .yui3-datatable-sort-indicator {
            background: no-repeat scroll 0 0 transparent;
        }
        div.coverage-summary .yui3-datatable-sorted .yui3-datatable-sort-indicator {
            background-position: 0 -20px;
        }
        div.coverage-summary .yui3-datatable-sorted-desc .yui3-datatable-sort-indicator {
            background-position: 0 -10px;
        }

        .high { background: #b5d592 !important; }
        .medium { background: #ffe87c !important; }
        .low { background: #fc8c84 !important; }

        span.cover-fill, span.cover-empty {
            display:inline-block;
            border:1px solid #444;
            background: white;
            height: 12px;
        }
        span.cover-fill {
            background: #ccc;
            border-right: 1px solid #444;
        }
        span.cover-empty {
            background: white;
            border-left: none;
        }
        span.cover-full {
            border-right: none !important;
        }
        pre.prettyprint {
            border: none !important;
            padding: 0 !important;
            margin: 0 !important;
        }
        .com { color: #999 !important; }
        .ignore-none { color: #999; font-weight: normal; }

    </style>
</head>
<body>
<div class="header low">
    <h1 style="font-weight: bold;">
        <a href="https://github.com/npmtest/node-npmtest-node-red">npmtest-node-red (v0.0.1)</a>
    </h1>
    <h1>Code coverage report for <span class="entity">node-npmtest-node-red/node-red/red/runtime/nodes/index.js</span></h1>
    <h2>
        
        Statements: <span class="metric">35.85% <small>(19 / 53)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        
        Branches: <span class="metric">0% <small>(0 / 16)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        
        Functions: <span class="metric">0% <small>(0 / 5)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        
        Lines: <span class="metric">35.85% <small>(19 / 53)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        Ignored: <span class="metric"><span class="ignore-none">none</span></span> &nbsp;&nbsp;&nbsp;&nbsp;
    </h2>
    <div class="path"><a href="../../../../../index.html">All files</a> &#187; <a href="index.html">node-npmtest-node-red/node-red/red/runtime/nodes/</a> &#187; index.js</div>
</div>
<div class="body">
<pre><table class="coverage">
<tr><td class="line-count">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163</td><td class="line-coverage"><span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span></td><td class="text"><pre class="prettyprint lang-js">/**
 * Copyright JS Foundation and other contributors, http://js.foundation
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 **/
&nbsp;
var when = require("when");
var path = require("path");
var fs = require("fs");
&nbsp;
var registry = require("./registry");
var credentials = require("./credentials");
var flows = require("./flows");
var flowUtil = require("./flows/util")
var context = require("./context");
var Node = require("./Node");
var log = require("../log");
&nbsp;
var events = require("../events");
&nbsp;
var child_process = require('child_process');
&nbsp;
var settings;
&nbsp;
/**
 * Registers a node constructor
 * @param nodeSet - the nodeSet providing the node (module/set)
 * @param type - the string type name
 * @param constructor - the constructor function for this node type
 * @param opts - optional additional options for the node
 */
<span class="fstat-no" title="function not covered" >function registerType(nodeSet,type,constructor,opts) {</span>
<span class="cstat-no" title="statement not covered" >    if (typeof type !== "string") {</span>
        // This is someone calling the api directly, rather than via the
        // RED object provided to a node. Log a warning
<span class="cstat-no" title="statement not covered" >        log.warn("["+nodeSet+"] Deprecated call to RED.runtime.nodes.registerType - node-set name must be provided as first argument");</span>
<span class="cstat-no" title="statement not covered" >        opts = constructor;</span>
<span class="cstat-no" title="statement not covered" >        constructor = type;</span>
<span class="cstat-no" title="statement not covered" >        type = nodeSet;</span>
<span class="cstat-no" title="statement not covered" >        nodeSet = "";</span>
    }
<span class="cstat-no" title="statement not covered" >    if (opts &amp;&amp; opts.credentials) {</span>
<span class="cstat-no" title="statement not covered" >        credentials.register(type,opts.credentials);</span>
    }
<span class="cstat-no" title="statement not covered" >    registry.registerType(nodeSet,type,constructor);</span>
}
&nbsp;
/**
 * Called from a Node's constructor function, invokes the super-class
 * constructor and attaches any credentials to the node.
 * @param node the node object being created
 * @param def the instance definition for the node
 */
<span class="fstat-no" title="function not covered" >function createNode(node,def) {</span>
<span class="cstat-no" title="statement not covered" >    Node.call(node,def);</span>
<span class="cstat-no" title="statement not covered" >    var id = node.id;</span>
<span class="cstat-no" title="statement not covered" >    if (def._alias) {</span>
<span class="cstat-no" title="statement not covered" >        id = def._alias;</span>
    }
<span class="cstat-no" title="statement not covered" >    var creds = credentials.get(id);</span>
<span class="cstat-no" title="statement not covered" >    if (creds) {</span>
        //console.log("Attaching credentials to ",node.id);
        // allow $(foo) syntax to substitute env variables for credentials also...
<span class="cstat-no" title="statement not covered" >        for (var p in creds) {</span>
<span class="cstat-no" title="statement not covered" >            if (creds.hasOwnProperty(p)) {</span>
<span class="cstat-no" title="statement not covered" >                flowUtil.mapEnvVarProperties(creds,p);</span>
            }
        }
<span class="cstat-no" title="statement not covered" >        node.credentials = creds;</span>
    } else <span class="cstat-no" title="statement not covered" >if (credentials.getDefinition(node.type)) {</span>
<span class="cstat-no" title="statement not covered" >        node.credentials = {};</span>
    }
}
&nbsp;
<span class="fstat-no" title="function not covered" >function init(runtime) {</span>
<span class="cstat-no" title="statement not covered" >    settings = runtime.settings;</span>
<span class="cstat-no" title="statement not covered" >    credentials.init(runtime);</span>
<span class="cstat-no" title="statement not covered" >    flows.init(runtime);</span>
<span class="cstat-no" title="statement not covered" >    registry.init(runtime);</span>
<span class="cstat-no" title="statement not covered" >    context.init(runtime.settings);</span>
}
&nbsp;
<span class="fstat-no" title="function not covered" >function disableNode(id) {</span>
<span class="cstat-no" title="statement not covered" >    flows.checkTypeInUse(id);</span>
<span class="cstat-no" title="statement not covered" >    return registry.disableNode(id);</span>
}
&nbsp;
<span class="fstat-no" title="function not covered" >function uninstallModule(module) {</span>
<span class="cstat-no" title="statement not covered" >    var info = registry.getModuleInfo(module);</span>
<span class="cstat-no" title="statement not covered" >    if (!info) {</span>
<span class="cstat-no" title="statement not covered" >        throw new Error(log._("nodes.index.unrecognised-module", {module:module}));</span>
    } else {
<span class="cstat-no" title="statement not covered" >        for (var i=0;i&lt;info.nodes.length;i++) {</span>
<span class="cstat-no" title="statement not covered" >            flows.checkTypeInUse(module+"/"+info.nodes[i].name);</span>
        }
<span class="cstat-no" title="statement not covered" >        return registry.uninstallModule(module);</span>
    }
}
&nbsp;
module.exports = {
    // Lifecycle
    init: init,
    load: registry.load,
&nbsp;
    // Node registry
    createNode: createNode,
    getNode: flows.get,
    eachNode: flows.eachNode,
&nbsp;
    paletteEditorEnabled: registry.paletteEditorEnabled,
    installModule: registry.installModule,
    uninstallModule: uninstallModule,
&nbsp;
    enableNode: registry.enableNode,
    disableNode: disableNode,
&nbsp;
    // Node type registry
    registerType: registerType,
    getType: registry.get,
&nbsp;
    getNodeInfo: registry.getNodeInfo,
    getNodeList: registry.getNodeList,
&nbsp;
    getModuleInfo: registry.getModuleInfo,
&nbsp;
    getNodeConfigs: registry.getNodeConfigs,
    getNodeConfig: registry.getNodeConfig,
&nbsp;
    clearRegistry: registry.clear,
    cleanModuleList: registry.cleanModuleList,
&nbsp;
    // Flow handling
    loadFlows:  flows.load,
    startFlows: flows.startFlows,
    stopFlows:  flows.stopFlows,
    setFlows:   flows.setFlows,
    getFlows:   flows.getFlows,
&nbsp;
    addFlow:     flows.addFlow,
    getFlow:     flows.getFlow,
    updateFlow:  flows.updateFlow,
    removeFlow:  flows.removeFlow,
    // disableFlow: flows.disableFlow,
    // enableFlow:  flows.enableFlow,
&nbsp;
    // Credentials
    addCredentials: credentials.add,
    getCredentials: credentials.get,
    deleteCredentials: credentials.delete,
    getCredentialDefinition: credentials.getDefinition
};
&nbsp;
&nbsp;</pre></td></tr>
</table></pre>
</div>
<div class="footer">
    <div class="meta">Generated by <a href="https://github.com/kaizhu256/node-utility2" target="_blank">utility2</a> at Tue Apr 11 2017 17:25:15 GMT+0000 (UTC)</div>
</div>
</body>
</html>


<!doctype html>
<html lang="en">
<head>
    <title>Code coverage report for node-npmtest-node-red/node-red/red/runtime/nodes/flows/</title>
    <meta charset="utf-8">
    <style>
        body, html {
            margin:0; padding: 0;
        }
        body {
            font-family: Arial, Helvetica;
            font-size: 10pt;
        }
        div.header, div.footer {
            background: #eee;
            padding: 1em;
        }
        div.header {
            height: 160px;
            padding: 0 1em 0 1em;
            z-index: 100;
            position: fixed;
            top: 0;
            border-bottom: 1px solid #666;
            width: 100%;
        }
        div.footer {
            border-top: 1px solid #666;
        }
        div.body {
            margin-top: 170px;
        }
        div.meta {
            font-size: 90%;
            text-align: center;
        }
        h1, h2, h3 {
            font-weight: normal;
        }
        h1 {
            font-size: 12pt;
        }
        h2 {
            font-size: 10pt;
        }
        pre {
            font-family: Menlo, Monaco, Consolas, Courier New, monospace;
            margin: 0;
            padding: 0;
            font-size: 14px;
            tab-size: 2;
        }

        div.path { font-size: 110%; }
        div.path a:link, div.path a:visited { color: #000; }
        table.coverage { border-collapse: collapse; margin:0; padding: 0 }

        table.coverage td {
            margin: 0;
            padding: 0;
            color: #111;
            vertical-align: top;
        }
        table.coverage td.line-count {
            width: 50px;
            text-align: right;
            padding-right: 5px;
        }
        table.coverage td.line-coverage {
            color: #777 !important;
            text-align: right;
            border-left: 1px solid #666;
            border-right: 1px solid #666;
        }

        table.coverage td.text {
        }

        table.coverage td span.cline-any {
            display: inline-block;
            padding: 0 5px;
            width: 40px;
        }
        table.coverage td span.cline-neutral {
            background: #eee;
        }
        table.coverage td span.cline-yes {
            background: #b5d592;
            color: #999;
        }
        table.coverage td span.cline-no {
            background: #fc8c84;
        }

        .cstat-yes { color: #111; }
        .cstat-no { background: #fc8c84; color: #111; }
        .fstat-no { background: #ffc520; color: #111 !important; }
        .cbranch-no { background:  yellow !important; color: #111; }

        .cstat-skip { background: #ddd; color: #111; }
        .fstat-skip { background: #ddd; color: #111 !important; }
        .cbranch-skip { background: #ddd !important; color: #111; }

        .missing-if-branch {
            display: inline-block;
            margin-right: 10px;
            position: relative;
            padding: 0 4px;
            background: black;
            color: yellow;
        }

        .skip-if-branch {
            display: none;
            margin-right: 10px;
            position: relative;
            padding: 0 4px;
            background: #ccc;
            color: white;
        }

        .missing-if-branch .typ, .skip-if-branch .typ {
            color: inherit !important;
        }

        .entity, .metric { font-weight: bold; }
        .metric { display: inline-block; border: 1px solid #333; padding: 0.3em; background: white; }
        .metric small { font-size: 80%; font-weight: normal; color: #666; }

        div.coverage-summary table { border-collapse: collapse; margin: 3em; font-size: 110%; }
        div.coverage-summary td, div.coverage-summary table  th { margin: 0; padding: 0.25em 1em; border-top: 1px solid #666; border-bottom: 1px solid #666; }
        div.coverage-summary th { text-align: left; border: 1px solid #666; background: #eee; font-weight: normal; }
        div.coverage-summary th.file { border-right: none !important; }
        div.coverage-summary th.pic { border-left: none !important; text-align: right; }
        div.coverage-summary th.pct { border-right: none !important; }
        div.coverage-summary th.abs { border-left: none !important; text-align: right; }
        div.coverage-summary td.pct { text-align: right; border-left: 1px solid #666; }
        div.coverage-summary td.abs { text-align: right; font-size: 90%; color: #444; border-right: 1px solid #666; }
        div.coverage-summary td.file { text-align: right; border-left: 1px solid #666; white-space: nowrap;  }
        div.coverage-summary td.pic { min-width: 120px !important;  }
        div.coverage-summary a:link { color: #000; }
        div.coverage-summary a:visited { color: #333; }
        div.coverage-summary tfoot td { border-top: 1px solid #666; }

        div.coverage-summary .yui3-datatable-sort-indicator, div.coverage-summary .dummy-sort-indicator {
            height: 10px;
            width: 7px;
            display: inline-block;
            margin-left: 0.5em;
        }
        div.coverage-summary .yui3-datatable-sort-indicator {
            background: no-repeat scroll 0 0 transparent;
        }
        div.coverage-summary .yui3-datatable-sorted .yui3-datatable-sort-indicator {
            background-position: 0 -20px;
        }
        div.coverage-summary .yui3-datatable-sorted-desc .yui3-datatable-sort-indicator {
            background-position: 0 -10px;
        }

        .high { background: #b5d592 !important; }
        .medium { background: #ffe87c !important; }
        .low { background: #fc8c84 !important; }

        span.cover-fill, span.cover-empty {
            display:inline-block;
            border:1px solid #444;
            background: white;
            height: 12px;
        }
        span.cover-fill {
            background: #ccc;
            border-right: 1px solid #444;
        }
        span.cover-empty {
            background: white;
            border-left: none;
        }
        span.cover-full {
            border-right: none !important;
        }
        pre.prettyprint {
            border: none !important;
            padding: 0 !important;
            margin: 0 !important;
        }
        .com { color: #999 !important; }
        .ignore-none { color: #999; font-weight: normal; }

    </style>
</head>
<body>
<div class="header low">
    <h1 style="font-weight: bold;">
        <a href="https://github.com/npmtest/node-npmtest-node-red">npmtest-node-red (v0.0.1)</a>
    </h1>
    <h1>Code coverage report for <span class="entity">node-npmtest-node-red/node-red/red/runtime/nodes/flows/</span></h1>
    <h2>
        
        Statements: <span class="metric">6.89% <small>(58 / 842)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        
        Branches: <span class="metric">0% <small>(0 / 551)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        
        Functions: <span class="metric">0% <small>(0 / 88)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        
        Lines: <span class="metric">6.94% <small>(58 / 836)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        Ignored: <span class="metric"><span class="ignore-none">none</span></span> &nbsp;&nbsp;&nbsp;&nbsp;
    </h2>
    <div class="path"><a href="../../../../../../index.html">All files</a> &#187; node-npmtest-node-red/node-red/red/runtime/nodes/flows/</div>
</div>
<div class="body">
<div class="coverage-summary">
<table>
<thead>
<tr>
   <th data-col="file" data-fmt="html" data-html="true" class="file">File</th>
   <th data-col="pic" data-type="number" data-fmt="html" data-html="true" class="pic"></th>
   <th data-col="statements" data-type="number" data-fmt="pct" class="pct">Statements</th>
   <th data-col="statements_raw" data-type="number" data-fmt="html" class="abs"></th>
   <th data-col="branches" data-type="number" data-fmt="pct" class="pct">Branches</th>
   <th data-col="branches_raw" data-type="number" data-fmt="html" class="abs"></th>
   <th data-col="functions" data-type="number" data-fmt="pct" class="pct">Functions</th>
   <th data-col="functions_raw" data-type="number" data-fmt="html" class="abs"></th>
   <th data-col="lines" data-type="number" data-fmt="pct" class="pct">Lines</th>
   <th data-col="lines_raw" data-type="number" data-fmt="html" class="abs"></th>
</tr>
</thead>
<tbody><tr>
	<td class="file low" data-value="Flow.js"><a href="Flow.js.html">Flow.js</a></td>
	<td data-value="3.76" class="pic low"><span class="cover-fill" style="width: 3px;"></span><span class="cover-empty" style="width:97px;"></span></td>
	<td data-value="3.76" class="pct low">3.76%</td>
	<td data-value="266" class="abs low">(10&nbsp;/&nbsp;266)</td>
	<td data-value="0" class="pct low">0%</td>
	<td data-value="148" class="abs low">(0&nbsp;/&nbsp;148)</td>
	<td data-value="0" class="pct low">0%</td>
	<td data-value="24" class="abs low">(0&nbsp;/&nbsp;24)</td>
	<td data-value="3.82" class="pct low">3.82%</td>
	<td data-value="262" class="abs low">(10&nbsp;/&nbsp;262)</td>
	</tr>

<tr>
	<td class="file low" data-value="index.js"><a href="index.js.html">index.js</a></td>
	<td data-value="11.33" class="pic low"><span class="cover-fill" style="width: 11px;"></span><span class="cover-empty" style="width:89px;"></span></td>
	<td data-value="11.33" class="pct low">11.33%</td>
	<td data-value="353" class="abs low">(40&nbsp;/&nbsp;353)</td>
	<td data-value="0" class="pct low">0%</td>
	<td data-value="215" class="abs low">(0&nbsp;/&nbsp;215)</td>
	<td data-value="0" class="pct low">0%</td>
	<td data-value="51" class="abs low">(0&nbsp;/&nbsp;51)</td>
	<td data-value="11.33" class="pct low">11.33%</td>
	<td data-value="353" class="abs low">(40&nbsp;/&nbsp;353)</td>
	</tr>

<tr>
	<td class="file low" data-value="util.js"><a href="util.js.html">util.js</a></td>
	<td data-value="3.59" class="pic low"><span class="cover-fill" style="width: 3px;"></span><span class="cover-empty" style="width:97px;"></span></td>
	<td data-value="3.59" class="pct low">3.59%</td>
	<td data-value="223" class="abs low">(8&nbsp;/&nbsp;223)</td>
	<td data-value="0" class="pct low">0%</td>
	<td data-value="188" class="abs low">(0&nbsp;/&nbsp;188)</td>
	<td data-value="0" class="pct low">0%</td>
	<td data-value="13" class="abs low">(0&nbsp;/&nbsp;13)</td>
	<td data-value="3.62" class="pct low">3.62%</td>
	<td data-value="221" class="abs low">(8&nbsp;/&nbsp;221)</td>
	</tr>

</tbody>
</table>
</div></div>
<div class="footer">
    <div class="meta">Generated by <a href="https://github.com/kaizhu256/node-utility2" target="_blank">utility2</a> at Tue Apr 11 2017 17:25:15 GMT+0000 (UTC)</div>
</div>
</body>
</html>


<!doctype html>
<html lang="en">
<head>
    <title>Code coverage report for node-npmtest-node-red/node-red/red/runtime/nodes/flows/Flow.js</title>
    <meta charset="utf-8">
    <style>
        body, html {
            margin:0; padding: 0;
        }
        body {
            font-family: Arial, Helvetica;
            font-size: 10pt;
        }
        div.header, div.footer {
            background: #eee;
            padding: 1em;
        }
        div.header {
            height: 160px;
            padding: 0 1em 0 1em;
            z-index: 100;
            position: fixed;
            top: 0;
            border-bottom: 1px solid #666;
            width: 100%;
        }
        div.footer {
            border-top: 1px solid #666;
        }
        div.body {
            margin-top: 170px;
        }
        div.meta {
            font-size: 90%;
            text-align: center;
        }
        h1, h2, h3 {
            font-weight: normal;
        }
        h1 {
            font-size: 12pt;
        }
        h2 {
            font-size: 10pt;
        }
        pre {
            font-family: Menlo, Monaco, Consolas, Courier New, monospace;
            margin: 0;
            padding: 0;
            font-size: 14px;
            tab-size: 2;
        }

        div.path { font-size: 110%; }
        div.path a:link, div.path a:visited { color: #000; }
        table.coverage { border-collapse: collapse; margin:0; padding: 0 }

        table.coverage td {
            margin: 0;
            padding: 0;
            color: #111;
            vertical-align: top;
        }
        table.coverage td.line-count {
            width: 50px;
            text-align: right;
            padding-right: 5px;
        }
        table.coverage td.line-coverage {
            color: #777 !important;
            text-align: right;
            border-left: 1px solid #666;
            border-right: 1px solid #666;
        }

        table.coverage td.text {
        }

        table.coverage td span.cline-any {
            display: inline-block;
            padding: 0 5px;
            width: 40px;
        }
        table.coverage td span.cline-neutral {
            background: #eee;
        }
        table.coverage td span.cline-yes {
            background: #b5d592;
            color: #999;
        }
        table.coverage td span.cline-no {
            background: #fc8c84;
        }

        .cstat-yes { color: #111; }
        .cstat-no { background: #fc8c84; color: #111; }
        .fstat-no { background: #ffc520; color: #111 !important; }
        .cbranch-no { background:  yellow !important; color: #111; }

        .cstat-skip { background: #ddd; color: #111; }
        .fstat-skip { background: #ddd; color: #111 !important; }
        .cbranch-skip { background: #ddd !important; color: #111; }

        .missing-if-branch {
            display: inline-block;
            margin-right: 10px;
            position: relative;
            padding: 0 4px;
            background: black;
            color: yellow;
        }

        .skip-if-branch {
            display: none;
            margin-right: 10px;
            position: relative;
            padding: 0 4px;
            background: #ccc;
            color: white;
        }

        .missing-if-branch .typ, .skip-if-branch .typ {
            color: inherit !important;
        }

        .entity, .metric { font-weight: bold; }
        .metric { display: inline-block; border: 1px solid #333; padding: 0.3em; background: white; }
        .metric small { font-size: 80%; font-weight: normal; color: #666; }

        div.coverage-summary table { border-collapse: collapse; margin: 3em; font-size: 110%; }
        div.coverage-summary td, div.coverage-summary table  th { margin: 0; padding: 0.25em 1em; border-top: 1px solid #666; border-bottom: 1px solid #666; }
        div.coverage-summary th { text-align: left; border: 1px solid #666; background: #eee; font-weight: normal; }
        div.coverage-summary th.file { border-right: none !important; }
        div.coverage-summary th.pic { border-left: none !important; text-align: right; }
        div.coverage-summary th.pct { border-right: none !important; }
        div.coverage-summary th.abs { border-left: none !important; text-align: right; }
        div.coverage-summary td.pct { text-align: right; border-left: 1px solid #666; }
        div.coverage-summary td.abs { text-align: right; font-size: 90%; color: #444; border-right: 1px solid #666; }
        div.coverage-summary td.file { text-align: right; border-left: 1px solid #666; white-space: nowrap;  }
        div.coverage-summary td.pic { min-width: 120px !important;  }
        div.coverage-summary a:link { color: #000; }
        div.coverage-summary a:visited { color: #333; }
        div.coverage-summary tfoot td { border-top: 1px solid #666; }

        div.coverage-summary .yui3-datatable-sort-indicator, div.coverage-summary .dummy-sort-indicator {
            height: 10px;
            width: 7px;
            display: inline-block;
            margin-left: 0.5em;
        }
        div.coverage-summary .yui3-datatable-sort-indicator {
            background: no-repeat scroll 0 0 transparent;
        }
        div.coverage-summary .yui3-datatable-sorted .yui3-datatable-sort-indicator {
            background-position: 0 -20px;
        }
        div.coverage-summary .yui3-datatable-sorted-desc .yui3-datatable-sort-indicator {
            background-position: 0 -10px;
        }

        .high { background: #b5d592 !important; }
        .medium { background: #ffe87c !important; }
        .low { background: #fc8c84 !important; }

        span.cover-fill, span.cover-empty {
            display:inline-block;
            border:1px solid #444;
            background: white;
            height: 12px;
        }
        span.cover-fill {
            background: #ccc;
            border-right: 1px solid #444;
        }
        span.cover-empty {
            background: white;
            border-left: none;
        }
        span.cover-full {
            border-right: none !important;
        }
        pre.prettyprint {
            border: none !important;
            padding: 0 !important;
            margin: 0 !important;
        }
        .com { color: #999 !important; }
        .ignore-none { color: #999; font-weight: normal; }

    </style>
</head>
<body>
<div class="header low">
    <h1 style="font-weight: bold;">
        <a href="https://github.com/npmtest/node-npmtest-node-red">npmtest-node-red (v0.0.1)</a>
    </h1>
    <h1>Code coverage report for <span class="entity">node-npmtest-node-red/node-red/red/runtime/nodes/flows/Flow.js</span></h1>
    <h2>
        
        Statements: <span class="metric">3.76% <small>(10 / 266)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        
        Branches: <span class="metric">0% <small>(0 / 148)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        
        Functions: <span class="metric">0% <small>(0 / 24)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        
        Lines: <span class="metric">3.82% <small>(10 / 262)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        Ignored: <span class="metric"><span class="ignore-none">none</span></span> &nbsp;&nbsp;&nbsp;&nbsp;
    </h2>
    <div class="path"><a href="../../../../../../index.html">All files</a> &#187; <a href="index.html">node-npmtest-node-red/node-red/red/runtime/nodes/flows/</a> &#187; Flow.js</div>
</div>
<div class="body">
<pre><table class="coverage">
<tr><td class="line-count">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
164
165
166
167
168
169
170
171
172
173
174
175
176
177
178
179
180
181
182
183
184
185
186
187
188
189
190
191
192
193
194
195
196
197
198
199
200
201
202
203
204
205
206
207
208
209
210
211
212
213
214
215
216
217
218
219
220
221
222
223
224
225
226
227
228
229
230
231
232
233
234
235
236
237
238
239
240
241
242
243
244
245
246
247
248
249
250
251
252
253
254
255
256
257
258
259
260
261
262
263
264
265
266
267
268
269
270
271
272
273
274
275
276
277
278
279
280
281
282
283
284
285
286
287
288
289
290
291
292
293
294
295
296
297
298
299
300
301
302
303
304
305
306
307
308
309
310
311
312
313
314
315
316
317
318
319
320
321
322
323
324
325
326
327
328
329
330
331
332
333
334
335
336
337
338
339
340
341
342
343
344
345
346
347
348
349
350
351
352
353
354
355
356
357
358
359
360
361
362
363
364
365
366
367
368
369
370
371
372
373
374
375
376
377
378
379
380
381
382
383
384
385
386
387
388
389
390
391
392
393
394
395
396
397
398
399
400
401
402
403
404
405
406
407
408
409
410
411
412
413
414
415
416
417
418
419
420
421
422
423
424
425
426
427
428
429
430
431
432
433
434
435
436
437
438
439
440
441
442
443
444
445
446
447
448
449
450
451
452
453
454
455
456
457
458
459
460
461
462
463
464
465
466
467
468
469
470
471
472
473</td><td class="line-coverage"><span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span></td><td class="text"><pre class="prettyprint lang-js">/**
 * Copyright JS Foundation and other contributors, http://js.foundation
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 **/
&nbsp;
var when = require("when");
var clone = require("clone");
var typeRegistry = require("../registry");
var Log = require("../../log");
var redUtil = require("../../util");
var flowUtil = require("./util");
&nbsp;
<span class="fstat-no" title="function not covered" >function Flow(global,flow) {</span>
<span class="cstat-no" title="statement not covered" >    if (typeof flow === 'undefined') {</span>
<span class="cstat-no" title="statement not covered" >        flow = global;</span>
    }
<span class="cstat-no" title="statement not covered" >    var activeNodes = {};</span>
<span class="cstat-no" title="statement not covered" >    var subflowInstanceNodes = {};</span>
<span class="cstat-no" title="statement not covered" >    var catchNodeMap = {};</span>
<span class="cstat-no" title="statement not covered" >    var statusNodeMap = {};</span>
&nbsp;
<span class="cstat-no" title="statement not covered" >    this.start = <span class="fstat-no" title="function not covered" >function(diff) {</span></span>
<span class="cstat-no" title="statement not covered" >        var node;</span>
<span class="cstat-no" title="statement not covered" >        var newNode;</span>
<span class="cstat-no" title="statement not covered" >        var id;</span>
<span class="cstat-no" title="statement not covered" >        catchNodeMap = {};</span>
<span class="cstat-no" title="statement not covered" >        statusNodeMap = {};</span>
&nbsp;
<span class="cstat-no" title="statement not covered" >        var configNodes = Object.keys(flow.configs);</span>
<span class="cstat-no" title="statement not covered" >        var configNodeAttempts = {};</span>
<span class="cstat-no" title="statement not covered" >        while (configNodes.length &gt; 0) {</span>
<span class="cstat-no" title="statement not covered" >            id = configNodes.shift();</span>
<span class="cstat-no" title="statement not covered" >            node = flow.configs[id];</span>
<span class="cstat-no" title="statement not covered" >            if (!activeNodes[id]) {</span>
<span class="cstat-no" title="statement not covered" >                var readyToCreate = true;</span>
                // This node doesn't exist.
                // Check it doesn't reference another non-existent config node
<span class="cstat-no" title="statement not covered" >                for (var prop in node) {</span>
<span class="cstat-no" title="statement not covered" >                    if (node.hasOwnProperty(prop) &amp;&amp; prop !== 'id' &amp;&amp; prop !== 'wires' &amp;&amp; prop !== '_users' &amp;&amp; flow.configs[node[prop]]) {</span>
<span class="cstat-no" title="statement not covered" >                        if (!activeNodes[node[prop]]) {</span>
                            // References a non-existent config node
                            // Add it to the back of the list to try again later
<span class="cstat-no" title="statement not covered" >                            configNodes.push(id);</span>
<span class="cstat-no" title="statement not covered" >                            configNodeAttempts[id] = (configNodeAttempts[id]||0)+1;</span>
<span class="cstat-no" title="statement not covered" >                            if (configNodeAttempts[id] === 100) {</span>
<span class="cstat-no" title="statement not covered" >                                throw new Error("Circular config node dependency detected: "+id);</span>
                            }
<span class="cstat-no" title="statement not covered" >                            readyToCreate = false;</span>
<span class="cstat-no" title="statement not covered" >                            break;</span>
                        }
                    }
                }
<span class="cstat-no" title="statement not covered" >                if (readyToCreate) {</span>
<span class="cstat-no" title="statement not covered" >                    newNode = createNode(node.type,node);</span>
<span class="cstat-no" title="statement not covered" >                    if (newNode) {</span>
<span class="cstat-no" title="statement not covered" >                        activeNodes[id] = newNode;</span>
                    }
                }
            }
        }
&nbsp;
<span class="cstat-no" title="statement not covered" >        if (diff &amp;&amp; diff.rewired) {</span>
<span class="cstat-no" title="statement not covered" >            for (var j=0;j&lt;diff.rewired.length;j++) {</span>
<span class="cstat-no" title="statement not covered" >                var rewireNode = activeNodes[diff.rewired[j]];</span>
<span class="cstat-no" title="statement not covered" >                if (rewireNode) {</span>
<span class="cstat-no" title="statement not covered" >                    rewireNode.updateWires(flow.nodes[rewireNode.id].wires);</span>
                }
            }
        }
&nbsp;
<span class="cstat-no" title="statement not covered" >        for (id in flow.nodes) {</span>
<span class="cstat-no" title="statement not covered" >            if (flow.nodes.hasOwnProperty(id)) {</span>
<span class="cstat-no" title="statement not covered" >                node = flow.nodes[id];</span>
<span class="cstat-no" title="statement not covered" >                if (!node.subflow) {</span>
<span class="cstat-no" title="statement not covered" >                    if (!activeNodes[id]) {</span>
<span class="cstat-no" title="statement not covered" >                        newNode = createNode(node.type,node);</span>
<span class="cstat-no" title="statement not covered" >                        if (newNode) {</span>
<span class="cstat-no" title="statement not covered" >                            activeNodes[id] = newNode;</span>
                        }
                    }
                } else {
<span class="cstat-no" title="statement not covered" >                    if (!subflowInstanceNodes[id]) {</span>
<span class="cstat-no" title="statement not covered" >                        try {</span>
<span class="cstat-no" title="statement not covered" >                            var nodes = createSubflow(flow.subflows[node.subflow]||global.subflows[node.subflow],node,flow.subflows,global.subflows,activeNodes);</span>
<span class="cstat-no" title="statement not covered" >                            subflowInstanceNodes[id] = nodes.map(<span class="fstat-no" title="function not covered" >function(n) {</span> <span class="cstat-no" title="statement not covered" >return n.id}</span>);</span>
<span class="cstat-no" title="statement not covered" >                            for (var i=0;i&lt;nodes.length;i++) {</span>
<span class="cstat-no" title="statement not covered" >                                if (nodes[i]) {</span>
<span class="cstat-no" title="statement not covered" >                                    activeNodes[nodes[i].id] = nodes[i];</span>
                                }
                            }
                        } catch(err) {
<span class="cstat-no" title="statement not covered" >                            console.log(err.stack)</span>
                        }
                    }
                }
            }
        }
&nbsp;
<span class="cstat-no" title="statement not covered" >        for (id in activeNodes) {</span>
<span class="cstat-no" title="statement not covered" >            if (activeNodes.hasOwnProperty(id)) {</span>
<span class="cstat-no" title="statement not covered" >                node = activeNodes[id];</span>
<span class="cstat-no" title="statement not covered" >                if (node.type === "catch") {</span>
<span class="cstat-no" title="statement not covered" >                    catchNodeMap[node.z] = catchNodeMap[node.z] || [];</span>
<span class="cstat-no" title="statement not covered" >                    catchNodeMap[node.z].push(node);</span>
                } else <span class="cstat-no" title="statement not covered" >if (node.type === "status") {</span>
<span class="cstat-no" title="statement not covered" >                    statusNodeMap[node.z] = statusNodeMap[node.z] || [];</span>
<span class="cstat-no" title="statement not covered" >                    statusNodeMap[node.z].push(node);</span>
                }
            }
        }
    }
&nbsp;
<span class="cstat-no" title="statement not covered" >    this.stop = <span class="fstat-no" title="function not covered" >function(stopList) {</span></span>
<span class="cstat-no" title="statement not covered" >        return when.promise(<span class="fstat-no" title="function not covered" >function(resolve) {</span></span>
<span class="cstat-no" title="statement not covered" >            var i;</span>
<span class="cstat-no" title="statement not covered" >            if (stopList) {</span>
<span class="cstat-no" title="statement not covered" >                for (i=0;i&lt;stopList.length;i++) {</span>
<span class="cstat-no" title="statement not covered" >                    if (subflowInstanceNodes[stopList[i]]) {</span>
                        // The first in the list is the instance node we already
                        // know about
<span class="cstat-no" title="statement not covered" >                        stopList = stopList.concat(subflowInstanceNodes[stopList[i]].slice(1))</span>
                    }
                }
            } else {
<span class="cstat-no" title="statement not covered" >                stopList = Object.keys(activeNodes);</span>
            }
<span class="cstat-no" title="statement not covered" >            var promises = [];</span>
<span class="cstat-no" title="statement not covered" >            for (i=0;i&lt;stopList.length;i++) {</span>
<span class="cstat-no" title="statement not covered" >                var node = activeNodes[stopList[i]];</span>
<span class="cstat-no" title="statement not covered" >                if (node) {</span>
<span class="cstat-no" title="statement not covered" >                    delete activeNodes[stopList[i]];</span>
<span class="cstat-no" title="statement not covered" >                    if (subflowInstanceNodes[stopList[i]]) {</span>
<span class="cstat-no" title="statement not covered" >                        delete subflowInstanceNodes[stopList[i]];</span>
                    }
<span class="cstat-no" title="statement not covered" >                    try {</span>
<span class="cstat-no" title="statement not covered" >                        var p = node.close();</span>
<span class="cstat-no" title="statement not covered" >                        if (p) {</span>
<span class="cstat-no" title="statement not covered" >                            promises.push(p);</span>
                        }
                    } catch(err) {
<span class="cstat-no" title="statement not covered" >                        node.error(err);</span>
                    }
                }
            }
<span class="cstat-no" title="statement not covered" >            when.settle(promises).then(<span class="fstat-no" title="function not covered" >function() {</span></span>
<span class="cstat-no" title="statement not covered" >                resolve();</span>
            });
        });
    }
&nbsp;
<span class="cstat-no" title="statement not covered" >    this.update = <span class="fstat-no" title="function not covered" >function(_global,_flow) {</span></span>
<span class="cstat-no" title="statement not covered" >        global = _global;</span>
<span class="cstat-no" title="statement not covered" >        flow = _flow;</span>
    }
&nbsp;
<span class="cstat-no" title="statement not covered" >    this.getNode = <span class="fstat-no" title="function not covered" >function(id) {</span></span>
<span class="cstat-no" title="statement not covered" >        return activeNodes[id];</span>
    }
&nbsp;
<span class="cstat-no" title="statement not covered" >    this.getActiveNodes = <span class="fstat-no" title="function not covered" >function() {</span></span>
<span class="cstat-no" title="statement not covered" >        return activeNodes;</span>
    }
&nbsp;
<span class="cstat-no" title="statement not covered" >    this.handleStatus = <span class="fstat-no" title="function not covered" >function(node,statusMessage) {</span></span>
<span class="cstat-no" title="statement not covered" >        var targetStatusNodes = null;</span>
<span class="cstat-no" title="statement not covered" >        var reportingNode = node;</span>
<span class="cstat-no" title="statement not covered" >        var handled = false;</span>
<span class="cstat-no" title="statement not covered" >        while (reportingNode &amp;&amp; !handled) {</span>
<span class="cstat-no" title="statement not covered" >            targetStatusNodes = statusNodeMap[reportingNode.z];</span>
<span class="cstat-no" title="statement not covered" >            if (targetStatusNodes) {</span>
<span class="cstat-no" title="statement not covered" >                targetStatusNodes.forEach(<span class="fstat-no" title="function not covered" >function(targetStatusNode) {</span></span>
<span class="cstat-no" title="statement not covered" >                    if (targetStatusNode.scope &amp;&amp; targetStatusNode.scope.indexOf(node.id) === -1) {</span>
<span class="cstat-no" title="statement not covered" >                        return;</span>
                    }
<span class="cstat-no" title="statement not covered" >                    var message = {</span>
                        status: {
                            text: "",
                            source: {
                                id: node.id,
                                type: node.type,
                                name: node.name
                            }
                        }
                    };
<span class="cstat-no" title="statement not covered" >                    if (statusMessage.hasOwnProperty("text")) {</span>
<span class="cstat-no" title="statement not covered" >                        message.status.text = statusMessage.text.toString();</span>
                    }
<span class="cstat-no" title="statement not covered" >                    targetStatusNode.receive(message);</span>
<span class="cstat-no" title="statement not covered" >                    handled = true;</span>
                });
            }
<span class="cstat-no" title="statement not covered" >            if (!handled) {</span>
<span class="cstat-no" title="statement not covered" >                reportingNode = activeNodes[reportingNode.z];</span>
            }
        }
    }
&nbsp;
<span class="cstat-no" title="statement not covered" >    this.handleError = <span class="fstat-no" title="function not covered" >function(node,logMessage,msg) {</span></span>
<span class="cstat-no" title="statement not covered" >        var count = 1;</span>
<span class="cstat-no" title="statement not covered" >        if (msg &amp;&amp; msg.hasOwnProperty("error")) {</span>
<span class="cstat-no" title="statement not covered" >            if (msg.error.hasOwnProperty("source")) {</span>
<span class="cstat-no" title="statement not covered" >                if (msg.error.source.id === node.id) {</span>
<span class="cstat-no" title="statement not covered" >                    count = msg.error.source.count+1;</span>
<span class="cstat-no" title="statement not covered" >                    if (count === 10) {</span>
<span class="cstat-no" title="statement not covered" >                        node.warn(Log._("nodes.flow.error-loop"));</span>
<span class="cstat-no" title="statement not covered" >                        return;</span>
                    }
                }
            }
        }
<span class="cstat-no" title="statement not covered" >        var targetCatchNodes = null;</span>
<span class="cstat-no" title="statement not covered" >        var throwingNode = node;</span>
<span class="cstat-no" title="statement not covered" >        var handled = false;</span>
<span class="cstat-no" title="statement not covered" >        while (throwingNode &amp;&amp; !handled) {</span>
<span class="cstat-no" title="statement not covered" >            targetCatchNodes = catchNodeMap[throwingNode.z];</span>
<span class="cstat-no" title="statement not covered" >            if (targetCatchNodes) {</span>
<span class="cstat-no" title="statement not covered" >                targetCatchNodes.forEach(<span class="fstat-no" title="function not covered" >function(targetCatchNode) {</span></span>
<span class="cstat-no" title="statement not covered" >                    if (targetCatchNode.scope &amp;&amp; targetCatchNode.scope.indexOf(throwingNode.id) === -1) {</span>
<span class="cstat-no" title="statement not covered" >                        return;</span>
                    }
<span class="cstat-no" title="statement not covered" >                    var errorMessage;</span>
<span class="cstat-no" title="statement not covered" >                    if (msg) {</span>
<span class="cstat-no" title="statement not covered" >                        errorMessage = redUtil.cloneMessage(msg);</span>
                    } else {
<span class="cstat-no" title="statement not covered" >                        errorMessage = {};</span>
                    }
<span class="cstat-no" title="statement not covered" >                    if (errorMessage.hasOwnProperty("error")) {</span>
<span class="cstat-no" title="statement not covered" >                        errorMessage._error = errorMessage.error;</span>
                    }
<span class="cstat-no" title="statement not covered" >                    errorMessage.error = {</span>
                        message: logMessage.toString(),
                        source: {
                            id: node.id,
                            type: node.type,
                            name: node.name,
                            count: count
                        }
                    };
<span class="cstat-no" title="statement not covered" >                    if (logMessage.hasOwnProperty('stack')) {</span>
<span class="cstat-no" title="statement not covered" >                        errorMessage.error.stack = logMessage.stack;</span>
                    }
<span class="cstat-no" title="statement not covered" >                    targetCatchNode.receive(errorMessage);</span>
<span class="cstat-no" title="statement not covered" >                    handled = true;</span>
                });
            }
<span class="cstat-no" title="statement not covered" >            if (!handled) {</span>
<span class="cstat-no" title="statement not covered" >                throwingNode = activeNodes[throwingNode.z];</span>
            }
        }
    }
}
&nbsp;
<span class="fstat-no" title="function not covered" >function createNode(type,config) {</span>
<span class="cstat-no" title="statement not covered" >    var nn = null;</span>
<span class="cstat-no" title="statement not covered" >    var nt = typeRegistry.get(type);</span>
<span class="cstat-no" title="statement not covered" >    if (nt) {</span>
<span class="cstat-no" title="statement not covered" >        var conf = clone(config);</span>
<span class="cstat-no" title="statement not covered" >        delete conf.credentials;</span>
<span class="cstat-no" title="statement not covered" >        for (var p in conf) {</span>
<span class="cstat-no" title="statement not covered" >            if (conf.hasOwnProperty(p)) {</span>
<span class="cstat-no" title="statement not covered" >                flowUtil.mapEnvVarProperties(conf,p);</span>
            }
        }
<span class="cstat-no" title="statement not covered" >        try {</span>
<span class="cstat-no" title="statement not covered" >            nn = new nt(conf);</span>
        }
        catch (err) {
<span class="cstat-no" title="statement not covered" >            Log.log({</span>
                level: Log.ERROR,
                id:conf.id,
                type: type,
                msg: err
            });
        }
    } else {
<span class="cstat-no" title="statement not covered" >        Log.error(Log._("nodes.flow.unknown-type", {type:type}));</span>
    }
<span class="cstat-no" title="statement not covered" >    return nn;</span>
}
&nbsp;
<span class="fstat-no" title="function not covered" >function createSubflow(sf,sfn,subflows,globalSubflows,activeNodes) {</span>
    //console.log("CREATE SUBFLOW",sf.id,sfn.id);
<span class="cstat-no" title="statement not covered" >    var nodes = [];</span>
<span class="cstat-no" title="statement not covered" >    var node_map = {};</span>
<span class="cstat-no" title="statement not covered" >    var newNodes = [];</span>
<span class="cstat-no" title="statement not covered" >    var node;</span>
<span class="cstat-no" title="statement not covered" >    var wires;</span>
<span class="cstat-no" title="statement not covered" >    var i,j,k;</span>
&nbsp;
<span class="cstat-no" title="statement not covered" >    var createNodeInSubflow = <span class="fstat-no" title="function not covered" >function(def) {</span></span>
<span class="cstat-no" title="statement not covered" >        node = clone(def);</span>
<span class="cstat-no" title="statement not covered" >        var nid = redUtil.generateId();</span>
<span class="cstat-no" title="statement not covered" >        node_map[node.id] = node;</span>
<span class="cstat-no" title="statement not covered" >        node._alias = node.id;</span>
<span class="cstat-no" title="statement not covered" >        node.id = nid;</span>
<span class="cstat-no" title="statement not covered" >        node.z = sfn.id;</span>
<span class="cstat-no" title="statement not covered" >        newNodes.push(node);</span>
    }
&nbsp;
    // Clone all of the subflow node definitions and give them new IDs
<span class="cstat-no" title="statement not covered" >    for (i in sf.configs) {</span>
<span class="cstat-no" title="statement not covered" >        if (sf.configs.hasOwnProperty(i)) {</span>
<span class="cstat-no" title="statement not covered" >            createNodeInSubflow(sf.configs[i]);</span>
        }
    }
    // Clone all of the subflow node definitions and give them new IDs
<span class="cstat-no" title="statement not covered" >    for (i in sf.nodes) {</span>
<span class="cstat-no" title="statement not covered" >        if (sf.nodes.hasOwnProperty(i)) {</span>
<span class="cstat-no" title="statement not covered" >            createNodeInSubflow(sf.nodes[i]);</span>
        }
    }
&nbsp;
    // Look for any catch/status nodes and update their scope ids
    // Update all subflow interior wiring to reflect new node IDs
<span class="cstat-no" title="statement not covered" >    for (i=0;i&lt;newNodes.length;i++) {</span>
<span class="cstat-no" title="statement not covered" >        node = newNodes[i];</span>
<span class="cstat-no" title="statement not covered" >        if (node.wires) {</span>
<span class="cstat-no" title="statement not covered" >            var outputs = node.wires;</span>
<span class="cstat-no" title="statement not covered" >            for (j=0;j&lt;outputs.length;j++) {</span>
<span class="cstat-no" title="statement not covered" >                wires = outputs[j];</span>
<span class="cstat-no" title="statement not covered" >                for (k=0;k&lt;wires.length;k++) {</span>
<span class="cstat-no" title="statement not covered" >                    outputs[j][k] = node_map[outputs[j][k]].id</span>
                }
            }
<span class="cstat-no" title="statement not covered" >            if ((node.type === 'catch' || node.type === 'status') &amp;&amp; node.scope) {</span>
<span class="cstat-no" title="statement not covered" >                node.scope = node.scope.map(<span class="fstat-no" title="function not covered" >function(id) {</span></span>
<span class="cstat-no" title="statement not covered" >                    return node_map[id]?node_map[id].id:""</span>
                })
            } else {
<span class="cstat-no" title="statement not covered" >                for (var prop in node) {</span>
<span class="cstat-no" title="statement not covered" >                    if (node.hasOwnProperty(prop) &amp;&amp; prop !== '_alias') {</span>
<span class="cstat-no" title="statement not covered" >                        if (node_map[node[prop]]) {</span>
                            //console.log("Mapped",node.type,node.id,prop,node_map[node[prop]].id);
<span class="cstat-no" title="statement not covered" >                            node[prop] = node_map[node[prop]].id;</span>
                        }
                    }
                }
            }
        }
    }
&nbsp;
    // Create a subflow node to accept inbound messages and route appropriately
<span class="cstat-no" title="statement not covered" >    var Node = require("../Node");</span>
<span class="cstat-no" title="statement not covered" >    var subflowInstance = {</span>
        id: sfn.id,
        type: sfn.type,
        z: sfn.z,
        name: sfn.name,
        wires: []
    }
<span class="cstat-no" title="statement not covered" >    if (sf.in) {</span>
<span class="cstat-no" title="statement not covered" >        subflowInstance.wires = sf.in.map(<span class="fstat-no" title="function not covered" >function(n) {</span> <span class="cstat-no" title="statement not covered" >return n.wires.map(<span class="fstat-no" title="function not covered" >function(w) {</span> <span class="cstat-no" title="statement not covered" >return node_map[w.id].id;}</span>)}</span>)</span>
<span class="cstat-no" title="statement not covered" >        subflowInstance._originalWires = clone(subflowInstance.wires);</span>
    }
<span class="cstat-no" title="statement not covered" >    var subflowNode = new Node(subflowInstance);</span>
&nbsp;
<span class="cstat-no" title="statement not covered" >    subflowNode.on("input", <span class="fstat-no" title="function not covered" >function(msg) {</span> <span class="cstat-no" title="statement not covered" >this.send(msg);}</span>);</span>
&nbsp;
&nbsp;
<span class="cstat-no" title="statement not covered" >    subflowNode._updateWires = subflowNode.updateWires;</span>
&nbsp;
<span class="cstat-no" title="statement not covered" >    subflowNode.updateWires = <span class="fstat-no" title="function not covered" >function(newWires) {</span></span>
        // Wire the subflow outputs
<span class="cstat-no" title="statement not covered" >        if (sf.out) {</span>
<span class="cstat-no" title="statement not covered" >            var node,wires,i,j;</span>
            // Restore the original wiring to the internal nodes
<span class="cstat-no" title="statement not covered" >            subflowInstance.wires = clone(subflowInstance._originalWires);</span>
<span class="cstat-no" title="statement not covered" >            for (i=0;i&lt;sf.out.length;i++) {</span>
<span class="cstat-no" title="statement not covered" >                wires = sf.out[i].wires;</span>
<span class="cstat-no" title="statement not covered" >                for (j=0;j&lt;wires.length;j++) {</span>
<span class="cstat-no" title="statement not covered" >                    if (wires[j].id != sf.id) {</span>
<span class="cstat-no" title="statement not covered" >                        node = node_map[wires[j].id];</span>
<span class="cstat-no" title="statement not covered" >                        if (node._originalWires) {</span>
<span class="cstat-no" title="statement not covered" >                            node.wires = clone(node._originalWires);</span>
                        }
                    }
                }
            }
&nbsp;
<span class="cstat-no" title="statement not covered" >            var modifiedNodes = {};</span>
<span class="cstat-no" title="statement not covered" >            var subflowInstanceModified = false;</span>
&nbsp;
<span class="cstat-no" title="statement not covered" >            for (i=0;i&lt;sf.out.length;i++) {</span>
<span class="cstat-no" title="statement not covered" >                wires = sf.out[i].wires;</span>
<span class="cstat-no" title="statement not covered" >                for (j=0;j&lt;wires.length;j++) {</span>
<span class="cstat-no" title="statement not covered" >                    if (wires[j].id === sf.id) {</span>
<span class="cstat-no" title="statement not covered" >                        subflowInstance.wires[wires[j].port] = subflowInstance.wires[wires[j].port].concat(newWires[i]);</span>
<span class="cstat-no" title="statement not covered" >                        subflowInstanceModified = true;</span>
                    } else {
<span class="cstat-no" title="statement not covered" >                        node = node_map[wires[j].id];</span>
<span class="cstat-no" title="statement not covered" >                        node.wires[wires[j].port] = node.wires[wires[j].port].concat(newWires[i]);</span>
<span class="cstat-no" title="statement not covered" >                        modifiedNodes[node.id] = node;</span>
                    }
                }
            }
<span class="cstat-no" title="statement not covered" >            Object.keys(modifiedNodes).forEach(<span class="fstat-no" title="function not covered" >function(id) {</span></span>
<span class="cstat-no" title="statement not covered" >                var node = modifiedNodes[id];</span>
<span class="cstat-no" title="statement not covered" >                subflowNode.instanceNodes[id].updateWires(node.wires);</span>
            });
<span class="cstat-no" title="statement not covered" >            if (subflowInstanceModified) {</span>
<span class="cstat-no" title="statement not covered" >                subflowNode._updateWires(subflowInstance.wires);</span>
            }
        }
    }
&nbsp;
<span class="cstat-no" title="statement not covered" >    nodes.push(subflowNode);</span>
&nbsp;
    // Wire the subflow outputs
<span class="cstat-no" title="statement not covered" >    if (sf.out) {</span>
<span class="cstat-no" title="statement not covered" >        var modifiedNodes = {};</span>
<span class="cstat-no" title="statement not covered" >        for (i=0;i&lt;sf.out.length;i++) {</span>
<span class="cstat-no" title="statement not covered" >            wires = sf.out[i].wires;</span>
<span class="cstat-no" title="statement not covered" >            for (j=0;j&lt;wires.length;j++) {</span>
<span class="cstat-no" title="statement not covered" >                if (wires[j].id === sf.id) {</span>
                    // A subflow input wired straight to a subflow output
<span class="cstat-no" title="statement not covered" >                    subflowInstance.wires[wires[j].port] = subflowInstance.wires[wires[j].port].concat(sfn.wires[i])</span>
<span class="cstat-no" title="statement not covered" >                    subflowNode._updateWires(subflowInstance.wires);</span>
                } else {
<span class="cstat-no" title="statement not covered" >                    node = node_map[wires[j].id];</span>
<span class="cstat-no" title="statement not covered" >                    modifiedNodes[node.id] = node;</span>
<span class="cstat-no" title="statement not covered" >                    if (!node._originalWires) {</span>
<span class="cstat-no" title="statement not covered" >                        node._originalWires = clone(node.wires);</span>
                    }
<span class="cstat-no" title="statement not covered" >                    node.wires[wires[j].port] = (node.wires[wires[j].port]||[]).concat(sfn.wires[i]);</span>
                }
            }
        }
    }
&nbsp;
    // Instantiate the nodes
<span class="cstat-no" title="statement not covered" >    for (i=0;i&lt;newNodes.length;i++) {</span>
<span class="cstat-no" title="statement not covered" >        node = newNodes[i];</span>
<span class="cstat-no" title="statement not covered" >        var type = node.type;</span>
&nbsp;
<span class="cstat-no" title="statement not covered" >        var m = /^subflow:(.+)$/.exec(type);</span>
<span class="cstat-no" title="statement not covered" >        if (!m) {</span>
<span class="cstat-no" title="statement not covered" >            var newNode = createNode(type,node);</span>
<span class="cstat-no" title="statement not covered" >            if (newNode) {</span>
<span class="cstat-no" title="statement not covered" >                activeNodes[node.id] = newNode;</span>
<span class="cstat-no" title="statement not covered" >                nodes.push(newNode);</span>
            }
        } else {
<span class="cstat-no" title="statement not covered" >            var subflowId = m[1];</span>
<span class="cstat-no" title="statement not covered" >            nodes = nodes.concat(createSubflow(subflows[subflowId]||globalSubflows[subflowId],node,subflows,globalSubflows,activeNodes));</span>
        }
    }
&nbsp;
<span class="cstat-no" title="statement not covered" >    subflowNode.instanceNodes = {};</span>
&nbsp;
<span class="cstat-no" title="statement not covered" >    nodes.forEach(<span class="fstat-no" title="function not covered" >function(node) {</span></span>
<span class="cstat-no" title="statement not covered" >        subflowNode.instanceNodes[node.id] = node;</span>
    });
<span class="cstat-no" title="statement not covered" >    return nodes;</span>
}
&nbsp;
module.exports = {
    create: <span class="fstat-no" title="function not covered" >function(global,conf) {</span>
<span class="cstat-no" title="statement not covered" >        return new Flow(global,conf);</span>
    }
}
&nbsp;
&nbsp;</pre></td></tr>
</table></pre>
</div>
<div class="footer">
    <div class="meta">Generated by <a href="https://github.com/kaizhu256/node-utility2" target="_blank">utility2</a> at Tue Apr 11 2017 17:25:15 GMT+0000 (UTC)</div>
</div>
</body>
</html>


<!doctype html>
<html lang="en">
<head>
    <title>Code coverage report for node-npmtest-node-red/node-red/red/runtime/nodes/flows/index.js</title>
    <meta charset="utf-8">
    <style>
        body, html {
            margin:0; padding: 0;
        }
        body {
            font-family: Arial, Helvetica;
            font-size: 10pt;
        }
        div.header, div.footer {
            background: #eee;
            padding: 1em;
        }
        div.header {
            height: 160px;
            padding: 0 1em 0 1em;
            z-index: 100;
            position: fixed;
            top: 0;
            border-bottom: 1px solid #666;
            width: 100%;
        }
        div.footer {
            border-top: 1px solid #666;
        }
        div.body {
            margin-top: 170px;
        }
        div.meta {
            font-size: 90%;
            text-align: center;
        }
        h1, h2, h3 {
            font-weight: normal;
        }
        h1 {
            font-size: 12pt;
        }
        h2 {
            font-size: 10pt;
        }
        pre {
            font-family: Menlo, Monaco, Consolas, Courier New, monospace;
            margin: 0;
            padding: 0;
            font-size: 14px;
            tab-size: 2;
        }

        div.path { font-size: 110%; }
        div.path a:link, div.path a:visited { color: #000; }
        table.coverage { border-collapse: collapse; margin:0; padding: 0 }

        table.coverage td {
            margin: 0;
            padding: 0;
            color: #111;
            vertical-align: top;
        }
        table.coverage td.line-count {
            width: 50px;
            text-align: right;
            padding-right: 5px;
        }
        table.coverage td.line-coverage {
            color: #777 !important;
            text-align: right;
            border-left: 1px solid #666;
            border-right: 1px solid #666;
        }

        table.coverage td.text {
        }

        table.coverage td span.cline-any {
            display: inline-block;
            padding: 0 5px;
            width: 40px;
        }
        table.coverage td span.cline-neutral {
            background: #eee;
        }
        table.coverage td span.cline-yes {
            background: #b5d592;
            color: #999;
        }
        table.coverage td span.cline-no {
            background: #fc8c84;
        }

        .cstat-yes { color: #111; }
        .cstat-no { background: #fc8c84; color: #111; }
        .fstat-no { background: #ffc520; color: #111 !important; }
        .cbranch-no { background:  yellow !important; color: #111; }

        .cstat-skip { background: #ddd; color: #111; }
        .fstat-skip { background: #ddd; color: #111 !important; }
        .cbranch-skip { background: #ddd !important; color: #111; }

        .missing-if-branch {
            display: inline-block;
            margin-right: 10px;
            position: relative;
            padding: 0 4px;
            background: black;
            color: yellow;
        }

        .skip-if-branch {
            display: none;
            margin-right: 10px;
            position: relative;
            padding: 0 4px;
            background: #ccc;
            color: white;
        }

        .missing-if-branch .typ, .skip-if-branch .typ {
            color: inherit !important;
        }

        .entity, .metric { font-weight: bold; }
        .metric { display: inline-block; border: 1px solid #333; padding: 0.3em; background: white; }
        .metric small { font-size: 80%; font-weight: normal; color: #666; }

        div.coverage-summary table { border-collapse: collapse; margin: 3em; font-size: 110%; }
        div.coverage-summary td, div.coverage-summary table  th { margin: 0; padding: 0.25em 1em; border-top: 1px solid #666; border-bottom: 1px solid #666; }
        div.coverage-summary th { text-align: left; border: 1px solid #666; background: #eee; font-weight: normal; }
        div.coverage-summary th.file { border-right: none !important; }
        div.coverage-summary th.pic { border-left: none !important; text-align: right; }
        div.coverage-summary th.pct { border-right: none !important; }
        div.coverage-summary th.abs { border-left: none !important; text-align: right; }
        div.coverage-summary td.pct { text-align: right; border-left: 1px solid #666; }
        div.coverage-summary td.abs { text-align: right; font-size: 90%; color: #444; border-right: 1px solid #666; }
        div.coverage-summary td.file { text-align: right; border-left: 1px solid #666; white-space: nowrap;  }
        div.coverage-summary td.pic { min-width: 120px !important;  }
        div.coverage-summary a:link { color: #000; }
        div.coverage-summary a:visited { color: #333; }
        div.coverage-summary tfoot td { border-top: 1px solid #666; }

        div.coverage-summary .yui3-datatable-sort-indicator, div.coverage-summary .dummy-sort-indicator {
            height: 10px;
            width: 7px;
            display: inline-block;
            margin-left: 0.5em;
        }
        div.coverage-summary .yui3-datatable-sort-indicator {
            background: no-repeat scroll 0 0 transparent;
        }
        div.coverage-summary .yui3-datatable-sorted .yui3-datatable-sort-indicator {
            background-position: 0 -20px;
        }
        div.coverage-summary .yui3-datatable-sorted-desc .yui3-datatable-sort-indicator {
            background-position: 0 -10px;
        }

        .high { background: #b5d592 !important; }
        .medium { background: #ffe87c !important; }
        .low { background: #fc8c84 !important; }

        span.cover-fill, span.cover-empty {
            display:inline-block;
            border:1px solid #444;
            background: white;
            height: 12px;
        }
        span.cover-fill {
            background: #ccc;
            border-right: 1px solid #444;
        }
        span.cover-empty {
            background: white;
            border-left: none;
        }
        span.cover-full {
            border-right: none !important;
        }
        pre.prettyprint {
            border: none !important;
            padding: 0 !important;
            margin: 0 !important;
        }
        .com { color: #999 !important; }
        .ignore-none { color: #999; font-weight: normal; }

    </style>
</head>
<body>
<div class="header low">
    <h1 style="font-weight: bold;">
        <a href="https://github.com/npmtest/node-npmtest-node-red">npmtest-node-red (v0.0.1)</a>
    </h1>
    <h1>Code coverage report for <span class="entity">node-npmtest-node-red/node-red/red/runtime/nodes/flows/index.js</span></h1>
    <h2>
        
        Statements: <span class="metric">11.33% <small>(40 / 353)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        
        Branches: <span class="metric">0% <small>(0 / 215)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        
        Functions: <span class="metric">0% <small>(0 / 51)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        
        Lines: <span class="metric">11.33% <small>(40 / 353)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        Ignored: <span class="metric"><span class="ignore-none">none</span></span> &nbsp;&nbsp;&nbsp;&nbsp;
    </h2>
    <div class="path"><a href="../../../../../../index.html">All files</a> &#187; <a href="index.html">node-npmtest-node-red/node-red/red/runtime/nodes/flows/</a> &#187; index.js</div>
</div>
<div class="body">
<pre><table class="coverage">
<tr><td class="line-count">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
164
165
166
167
168
169
170
171
172
173
174
175
176
177
178
179
180
181
182
183
184
185
186
187
188
189
190
191
192
193
194
195
196
197
198
199
200
201
202
203
204
205
206
207
208
209
210
211
212
213
214
215
216
217
218
219
220
221
222
223
224
225
226
227
228
229
230
231
232
233
234
235
236
237
238
239
240
241
242
243
244
245
246
247
248
249
250
251
252
253
254
255
256
257
258
259
260
261
262
263
264
265
266
267
268
269
270
271
272
273
274
275
276
277
278
279
280
281
282
283
284
285
286
287
288
289
290
291
292
293
294
295
296
297
298
299
300
301
302
303
304
305
306
307
308
309
310
311
312
313
314
315
316
317
318
319
320
321
322
323
324
325
326
327
328
329
330
331
332
333
334
335
336
337
338
339
340
341
342
343
344
345
346
347
348
349
350
351
352
353
354
355
356
357
358
359
360
361
362
363
364
365
366
367
368
369
370
371
372
373
374
375
376
377
378
379
380
381
382
383
384
385
386
387
388
389
390
391
392
393
394
395
396
397
398
399
400
401
402
403
404
405
406
407
408
409
410
411
412
413
414
415
416
417
418
419
420
421
422
423
424
425
426
427
428
429
430
431
432
433
434
435
436
437
438
439
440
441
442
443
444
445
446
447
448
449
450
451
452
453
454
455
456
457
458
459
460
461
462
463
464
465
466
467
468
469
470
471
472
473
474
475
476
477
478
479
480
481
482
483
484
485
486
487
488
489
490
491
492
493
494
495
496
497
498
499
500
501
502
503
504
505
506
507
508
509
510
511
512
513
514
515
516
517
518
519
520
521
522
523
524
525
526
527
528
529
530
531
532
533
534
535
536
537
538
539
540
541
542
543
544
545
546
547
548
549
550
551
552
553
554
555
556
557
558
559
560
561
562
563
564
565
566
567
568
569
570
571
572
573
574
575
576
577
578
579
580
581
582
583
584
585
586
587
588
589
590
591
592
593
594
595
596
597
598
599
600
601
602
603
604
605
606
607
608
609
610
611
612
613
614
615
616
617
618
619
620
621
622
623
624
625
626
627
628
629
630
631
632
633
634
635
636
637
638
639
640
641
642
643
644
645
646
647
648
649
650</td><td class="line-coverage"><span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span></td><td class="text"><pre class="prettyprint lang-js">/**
 * Copyright JS Foundation and other contributors, http://js.foundation
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 **/
&nbsp;
var clone = require("clone");
var when = require("when");
&nbsp;
var Flow = require('./Flow');
&nbsp;
var typeRegistry = require("../registry");
var context = require("../context")
var credentials = require("../credentials");
&nbsp;
var flowUtil = require("./util");
var log = require("../../log");
var events = require("../../events");
var redUtil = require("../../util");
var deprecated = require("../registry/deprecated");
&nbsp;
var storage = null;
var settings = null;
&nbsp;
var activeConfig = null;
var activeFlowConfig = null;
&nbsp;
var activeFlows = {};
var started = false;
&nbsp;
var activeNodesToFlow = {};
var subflowInstanceNodeMap = {};
&nbsp;
var typeEventRegistered = false;
&nbsp;
<span class="fstat-no" title="function not covered" >function init(runtime) {</span>
<span class="cstat-no" title="statement not covered" >    if (started) {</span>
<span class="cstat-no" title="statement not covered" >        throw new Error("Cannot init without a stop");</span>
    }
<span class="cstat-no" title="statement not covered" >    settings = runtime.settings;</span>
<span class="cstat-no" title="statement not covered" >    storage = runtime.storage;</span>
<span class="cstat-no" title="statement not covered" >    started = false;</span>
<span class="cstat-no" title="statement not covered" >    if (!typeEventRegistered) {</span>
<span class="cstat-no" title="statement not covered" >        events.on('type-registered',<span class="fstat-no" title="function not covered" >function(type) {</span></span>
<span class="cstat-no" title="statement not covered" >            if (activeFlowConfig &amp;&amp; activeFlowConfig.missingTypes.length &gt; 0) {</span>
<span class="cstat-no" title="statement not covered" >                var i = activeFlowConfig.missingTypes.indexOf(type);</span>
<span class="cstat-no" title="statement not covered" >                if (i != -1) {</span>
<span class="cstat-no" title="statement not covered" >                    log.info(log._("nodes.flows.registered-missing", {type:type}));</span>
<span class="cstat-no" title="statement not covered" >                    activeFlowConfig.missingTypes.splice(i,1);</span>
<span class="cstat-no" title="statement not covered" >                    if (activeFlowConfig.missingTypes.length === 0 &amp;&amp; started) {</span>
<span class="cstat-no" title="statement not covered" >                        events.emit("runtime-event",{id:"runtime-state"});</span>
<span class="cstat-no" title="statement not covered" >                        start();</span>
                    }
                }
            }
        });
<span class="cstat-no" title="statement not covered" >        typeEventRegistered = true;</span>
    }
}
&nbsp;
<span class="fstat-no" title="function not covered" >function loadFlows() {</span>
<span class="cstat-no" title="statement not covered" >    return storage.getFlows().then(<span class="fstat-no" title="function not covered" >function(config) {</span></span>
<span class="cstat-no" title="statement not covered" >        log.debug("loaded flow revision: "+config.rev);</span>
<span class="cstat-no" title="statement not covered" >        return credentials.load(config.credentials).then(<span class="fstat-no" title="function not covered" >function() {</span></span>
<span class="cstat-no" title="statement not covered" >            return config;</span>
        });
    }).otherwise(<span class="fstat-no" title="function not covered" >function(err) {</span>
<span class="cstat-no" title="statement not covered" >        log.warn(log._("nodes.flows.error",{message:err.toString()}));</span>
<span class="cstat-no" title="statement not covered" >        console.log(err.stack);</span>
    });
}
<span class="fstat-no" title="function not covered" >function load() {</span>
<span class="cstat-no" title="statement not covered" >    return setFlows(null,"load",false);</span>
}
&nbsp;
/*
 * _config - new node array configuration
 * type - full/nodes/flows/load (default full)
 * muteLog - don't emit the standard log messages (used for individual flow api)
 */
<span class="fstat-no" title="function not covered" >function setFlows(_config,type,muteLog) {</span>
<span class="cstat-no" title="statement not covered" >    type = type||"full";</span>
&nbsp;
<span class="cstat-no" title="statement not covered" >    var configSavePromise = null;</span>
<span class="cstat-no" title="statement not covered" >    var config = null;</span>
<span class="cstat-no" title="statement not covered" >    var diff;</span>
<span class="cstat-no" title="statement not covered" >    var newFlowConfig;</span>
<span class="cstat-no" title="statement not covered" >    var isLoad = false;</span>
<span class="cstat-no" title="statement not covered" >    if (type === "load") {</span>
<span class="cstat-no" title="statement not covered" >        isLoad = true;</span>
<span class="cstat-no" title="statement not covered" >        configSavePromise = loadFlows().then(<span class="fstat-no" title="function not covered" >function(_config) {</span></span>
<span class="cstat-no" title="statement not covered" >            config = clone(_config.flows);</span>
<span class="cstat-no" title="statement not covered" >            newFlowConfig = flowUtil.parseConfig(clone(config));</span>
<span class="cstat-no" title="statement not covered" >            type = "full";</span>
<span class="cstat-no" title="statement not covered" >            return _config.rev;</span>
        });
    } else {
<span class="cstat-no" title="statement not covered" >        config = clone(_config);</span>
<span class="cstat-no" title="statement not covered" >        newFlowConfig = flowUtil.parseConfig(clone(config));</span>
<span class="cstat-no" title="statement not covered" >        if (type !== 'full') {</span>
<span class="cstat-no" title="statement not covered" >            diff = flowUtil.diffConfigs(activeFlowConfig,newFlowConfig);</span>
        }
<span class="cstat-no" title="statement not covered" >        credentials.clean(config);</span>
<span class="cstat-no" title="statement not covered" >        var credsDirty = credentials.dirty();</span>
<span class="cstat-no" title="statement not covered" >        configSavePromise = credentials.export().then(<span class="fstat-no" title="function not covered" >function(creds) {</span></span>
<span class="cstat-no" title="statement not covered" >            var saveConfig = {</span>
                flows: config,
                credentialsDirty:credsDirty,
                credentials: creds
            }
<span class="cstat-no" title="statement not covered" >            return storage.saveFlows(saveConfig);</span>
        });
    }
&nbsp;
<span class="cstat-no" title="statement not covered" >    return configSavePromise</span>
        .then(<span class="fstat-no" title="function not covered" >function(flowRevision) {</span>
<span class="cstat-no" title="statement not covered" >            if (!isLoad) {</span>
<span class="cstat-no" title="statement not covered" >                log.debug("saved flow revision: "+flowRevision);</span>
            }
<span class="cstat-no" title="statement not covered" >            activeConfig = {</span>
                flows:config,
                rev:flowRevision
            };
<span class="cstat-no" title="statement not covered" >            activeFlowConfig = newFlowConfig;</span>
<span class="cstat-no" title="statement not covered" >            if (started) {</span>
<span class="cstat-no" title="statement not covered" >                return stop(type,diff,muteLog).then(<span class="fstat-no" title="function not covered" >function() {</span></span>
<span class="cstat-no" title="statement not covered" >                    context.clean(activeFlowConfig);</span>
<span class="cstat-no" title="statement not covered" >                    start(type,diff,muteLog);</span>
<span class="cstat-no" title="statement not covered" >                    return flowRevision;</span>
                }).otherwise(<span class="fstat-no" title="function not covered" >function(err) {</span>
                })
            }
        });
}
&nbsp;
<span class="fstat-no" title="function not covered" >function getNode(id) {</span>
<span class="cstat-no" title="statement not covered" >    var node;</span>
<span class="cstat-no" title="statement not covered" >    if (activeNodesToFlow[id] &amp;&amp; activeFlows[activeNodesToFlow[id]]) {</span>
<span class="cstat-no" title="statement not covered" >        return activeFlows[activeNodesToFlow[id]].getNode(id);</span>
    }
<span class="cstat-no" title="statement not covered" >    for (var flowId in activeFlows) {</span>
<span class="cstat-no" title="statement not covered" >        if (activeFlows.hasOwnProperty(flowId)) {</span>
<span class="cstat-no" title="statement not covered" >            node = activeFlows[flowId].getNode(id);</span>
<span class="cstat-no" title="statement not covered" >            if (node) {</span>
<span class="cstat-no" title="statement not covered" >                return node;</span>
            }
        }
    }
<span class="cstat-no" title="statement not covered" >    return null;</span>
}
&nbsp;
<span class="fstat-no" title="function not covered" >function eachNode(cb) {</span>
<span class="cstat-no" title="statement not covered" >    for (var id in activeFlowConfig.allNodes) {</span>
<span class="cstat-no" title="statement not covered" >        if (activeFlowConfig.allNodes.hasOwnProperty(id)) {</span>
<span class="cstat-no" title="statement not covered" >            cb(activeFlowConfig.allNodes[id]);</span>
        }
    }
}
&nbsp;
<span class="fstat-no" title="function not covered" >function getFlows() {</span>
<span class="cstat-no" title="statement not covered" >    return activeConfig;</span>
}
&nbsp;
<span class="fstat-no" title="function not covered" >function delegateError(node,logMessage,msg) {</span>
<span class="cstat-no" title="statement not covered" >    if (activeFlows[node.z]) {</span>
<span class="cstat-no" title="statement not covered" >        activeFlows[node.z].handleError(node,logMessage,msg);</span>
    } else <span class="cstat-no" title="statement not covered" >if (activeNodesToFlow[node.z] &amp;&amp; activeFlows[activeNodesToFlow[node.z]]) {</span>
<span class="cstat-no" title="statement not covered" >        activeFlows[activeNodesToFlow[node.z]].handleError(node,logMessage,msg);</span>
    } else <span class="cstat-no" title="statement not covered" >if (activeFlowConfig.subflows[node.z] &amp;&amp; subflowInstanceNodeMap[node.id]) {</span>
<span class="cstat-no" title="statement not covered" >        subflowInstanceNodeMap[node.id].forEach(<span class="fstat-no" title="function not covered" >function(n) {</span></span>
<span class="cstat-no" title="statement not covered" >            delegateError(getNode(n),logMessage,msg);</span>
        });
    }
}
<span class="fstat-no" title="function not covered" >function handleError(node,logMessage,msg) {</span>
<span class="cstat-no" title="statement not covered" >    if (node.z) {</span>
<span class="cstat-no" title="statement not covered" >        delegateError(node,logMessage,msg);</span>
    } else {
<span class="cstat-no" title="statement not covered" >        if (activeFlowConfig.configs[node.id]) {</span>
<span class="cstat-no" title="statement not covered" >            activeFlowConfig.configs[node.id]._users.forEach(<span class="fstat-no" title="function not covered" >function(id) {</span></span>
<span class="cstat-no" title="statement not covered" >                var userNode = activeFlowConfig.allNodes[id];</span>
<span class="cstat-no" title="statement not covered" >                delegateError(userNode,logMessage,msg);</span>
            })
        }
    }
}
&nbsp;
<span class="fstat-no" title="function not covered" >function delegateStatus(node,statusMessage) {</span>
<span class="cstat-no" title="statement not covered" >    if (activeFlows[node.z]) {</span>
<span class="cstat-no" title="statement not covered" >        activeFlows[node.z].handleStatus(node,statusMessage);</span>
    } else <span class="cstat-no" title="statement not covered" >if (activeNodesToFlow[node.z] &amp;&amp; activeFlows[activeNodesToFlow[node.z]]) {</span>
<span class="cstat-no" title="statement not covered" >        activeFlows[activeNodesToFlow[node.z]].handleStatus(node,statusMessage);</span>
    }
}
<span class="fstat-no" title="function not covered" >function handleStatus(node,statusMessage) {</span>
<span class="cstat-no" title="statement not covered" >    events.emit("node-status",{</span>
        id: node.id,
        status:statusMessage
    });
<span class="cstat-no" title="statement not covered" >    if (node.z) {</span>
<span class="cstat-no" title="statement not covered" >        delegateStatus(node,statusMessage);</span>
    } else {
<span class="cstat-no" title="statement not covered" >        if (activeFlowConfig.configs[node.id]) {</span>
<span class="cstat-no" title="statement not covered" >            activeFlowConfig.configs[node.id]._users.forEach(<span class="fstat-no" title="function not covered" >function(id) {</span></span>
<span class="cstat-no" title="statement not covered" >                var userNode = activeFlowConfig.allNodes[id];</span>
<span class="cstat-no" title="statement not covered" >                delegateStatus(userNode,statusMessage);</span>
            })
        }
    }
}
&nbsp;
&nbsp;
<span class="fstat-no" title="function not covered" >function start(type,diff,muteLog) {</span>
    //dumpActiveNodes();
<span class="cstat-no" title="statement not covered" >    type = type||"full";</span>
<span class="cstat-no" title="statement not covered" >    started = true;</span>
<span class="cstat-no" title="statement not covered" >    var i;</span>
<span class="cstat-no" title="statement not covered" >    if (activeFlowConfig.missingTypes.length &gt; 0) {</span>
<span class="cstat-no" title="statement not covered" >        log.info(log._("nodes.flows.missing-types"));</span>
<span class="cstat-no" title="statement not covered" >        var knownUnknowns = 0;</span>
<span class="cstat-no" title="statement not covered" >        for (i=0;i&lt;activeFlowConfig.missingTypes.length;i++) {</span>
<span class="cstat-no" title="statement not covered" >            var nodeType = activeFlowConfig.missingTypes[i];</span>
<span class="cstat-no" title="statement not covered" >            var info = deprecated.get(nodeType);</span>
<span class="cstat-no" title="statement not covered" >            if (info) {</span>
<span class="cstat-no" title="statement not covered" >                log.info(log._("nodes.flows.missing-type-provided",{type:activeFlowConfig.missingTypes[i],module:info.module}));</span>
<span class="cstat-no" title="statement not covered" >                knownUnknowns += 1;</span>
            } else {
<span class="cstat-no" title="statement not covered" >                log.info(" - "+activeFlowConfig.missingTypes[i]);</span>
            }
        }
<span class="cstat-no" title="statement not covered" >        if (knownUnknowns &gt; 0) {</span>
<span class="cstat-no" title="statement not covered" >            log.info(log._("nodes.flows.missing-type-install-1"));</span>
<span class="cstat-no" title="statement not covered" >            log.info("  npm install &lt;module name&gt;");</span>
<span class="cstat-no" title="statement not covered" >            log.info(log._("nodes.flows.missing-type-install-2"));</span>
<span class="cstat-no" title="statement not covered" >            log.info("  "+settings.userDir);</span>
        }
<span class="cstat-no" title="statement not covered" >        events.emit("runtime-event",{id:"runtime-state",type:"warning",text:"notification.warnings.missing-types"});</span>
<span class="cstat-no" title="statement not covered" >        return when.resolve();</span>
    }
<span class="cstat-no" title="statement not covered" >    if (!muteLog) {</span>
<span class="cstat-no" title="statement not covered" >        if (diff) {</span>
<span class="cstat-no" title="statement not covered" >            log.info(log._("nodes.flows.starting-modified-"+type));</span>
        } else {
<span class="cstat-no" title="statement not covered" >            log.info(log._("nodes.flows.starting-flows"));</span>
        }
    }
<span class="cstat-no" title="statement not covered" >    var id;</span>
<span class="cstat-no" title="statement not covered" >    if (!diff) {</span>
<span class="cstat-no" title="statement not covered" >        if (!activeFlows['global']) {</span>
<span class="cstat-no" title="statement not covered" >            activeFlows['global'] = Flow.create(activeFlowConfig);</span>
        }
<span class="cstat-no" title="statement not covered" >        for (id in activeFlowConfig.flows) {</span>
<span class="cstat-no" title="statement not covered" >            if (activeFlowConfig.flows.hasOwnProperty(id)) {</span>
<span class="cstat-no" title="statement not covered" >                if (!activeFlows[id]) {</span>
<span class="cstat-no" title="statement not covered" >                    activeFlows[id] = Flow.create(activeFlowConfig,activeFlowConfig.flows[id]);</span>
                }
            }
        }
    } else {
<span class="cstat-no" title="statement not covered" >        activeFlows['global'].update(activeFlowConfig,activeFlowConfig);</span>
<span class="cstat-no" title="statement not covered" >        for (id in activeFlowConfig.flows) {</span>
<span class="cstat-no" title="statement not covered" >            if (activeFlowConfig.flows.hasOwnProperty(id)) {</span>
<span class="cstat-no" title="statement not covered" >                if (activeFlows[id]) {</span>
<span class="cstat-no" title="statement not covered" >                    activeFlows[id].update(activeFlowConfig,activeFlowConfig.flows[id]);</span>
                } else {
<span class="cstat-no" title="statement not covered" >                    activeFlows[id] = Flow.create(activeFlowConfig,activeFlowConfig.flows[id]);</span>
                }
            }
        }
    }
&nbsp;
<span class="cstat-no" title="statement not covered" >    for (id in activeFlows) {</span>
<span class="cstat-no" title="statement not covered" >        if (activeFlows.hasOwnProperty(id)) {</span>
<span class="cstat-no" title="statement not covered" >            activeFlows[id].start(diff);</span>
<span class="cstat-no" title="statement not covered" >            var activeNodes = activeFlows[id].getActiveNodes();</span>
<span class="cstat-no" title="statement not covered" >            Object.keys(activeNodes).forEach(<span class="fstat-no" title="function not covered" >function(nid) {</span></span>
<span class="cstat-no" title="statement not covered" >                activeNodesToFlow[nid] = id;</span>
<span class="cstat-no" title="statement not covered" >                if (activeNodes[nid]._alias) {</span>
<span class="cstat-no" title="statement not covered" >                    subflowInstanceNodeMap[activeNodes[nid]._alias] = subflowInstanceNodeMap[activeNodes[nid]._alias] || [];</span>
<span class="cstat-no" title="statement not covered" >                    subflowInstanceNodeMap[activeNodes[nid]._alias].push(nid);</span>
                }
            });
&nbsp;
        }
    }
<span class="cstat-no" title="statement not covered" >    events.emit("nodes-started");</span>
<span class="cstat-no" title="statement not covered" >    events.emit("runtime-event",{id:"runtime-state"});</span>
&nbsp;
<span class="cstat-no" title="statement not covered" >    if (!muteLog) {</span>
<span class="cstat-no" title="statement not covered" >        if (diff) {</span>
<span class="cstat-no" title="statement not covered" >            log.info(log._("nodes.flows.started-modified-"+type));</span>
        } else {
<span class="cstat-no" title="statement not covered" >            log.info(log._("nodes.flows.started-flows"));</span>
        }
    }
<span class="cstat-no" title="statement not covered" >    return when.resolve();</span>
}
&nbsp;
<span class="fstat-no" title="function not covered" >function stop(type,diff,muteLog) {</span>
<span class="cstat-no" title="statement not covered" >    type = type||"full";</span>
<span class="cstat-no" title="statement not covered" >    if (!muteLog) {</span>
<span class="cstat-no" title="statement not covered" >        if (diff) {</span>
<span class="cstat-no" title="statement not covered" >            log.info(log._("nodes.flows.stopping-modified-"+type));</span>
        } else {
<span class="cstat-no" title="statement not covered" >            log.info(log._("nodes.flows.stopping-flows"));</span>
        }
    }
<span class="cstat-no" title="statement not covered" >    started = false;</span>
<span class="cstat-no" title="statement not covered" >    var promises = [];</span>
<span class="cstat-no" title="statement not covered" >    var stopList;</span>
<span class="cstat-no" title="statement not covered" >    if (type === 'nodes') {</span>
<span class="cstat-no" title="statement not covered" >        stopList = diff.changed.concat(diff.removed);</span>
    } else <span class="cstat-no" title="statement not covered" >if (type === 'flows') {</span>
<span class="cstat-no" title="statement not covered" >        stopList = diff.changed.concat(diff.removed).concat(diff.linked);</span>
    }
<span class="cstat-no" title="statement not covered" >    for (var id in activeFlows) {</span>
<span class="cstat-no" title="statement not covered" >        if (activeFlows.hasOwnProperty(id)) {</span>
<span class="cstat-no" title="statement not covered" >            promises = promises.concat(activeFlows[id].stop(stopList));</span>
<span class="cstat-no" title="statement not covered" >            if (!diff || diff.removed.indexOf(id)!==-1) {</span>
<span class="cstat-no" title="statement not covered" >                delete activeFlows[id];</span>
            }
        }
    }
&nbsp;
<span class="cstat-no" title="statement not covered" >    return when.promise(<span class="fstat-no" title="function not covered" >function(resolve,reject) {</span></span>
<span class="cstat-no" title="statement not covered" >        when.settle(promises).then(<span class="fstat-no" title="function not covered" >function() {</span></span>
<span class="cstat-no" title="statement not covered" >            for (id in activeNodesToFlow) {</span>
<span class="cstat-no" title="statement not covered" >                if (activeNodesToFlow.hasOwnProperty(id)) {</span>
<span class="cstat-no" title="statement not covered" >                    if (!activeFlows[activeNodesToFlow[id]]) {</span>
<span class="cstat-no" title="statement not covered" >                        delete activeNodesToFlow[id];</span>
                    }
                }
            }
<span class="cstat-no" title="statement not covered" >            if (stopList) {</span>
<span class="cstat-no" title="statement not covered" >                stopList.forEach(<span class="fstat-no" title="function not covered" >function(id) {</span></span>
<span class="cstat-no" title="statement not covered" >                    delete activeNodesToFlow[id];</span>
                });
            }
            // Ideally we'd prune just what got stopped - but mapping stopList
            // id to the list of subflow instance nodes is something only Flow
            // can do... so cheat by wiping the map knowing it'll be rebuilt
            // in start()
<span class="cstat-no" title="statement not covered" >            subflowInstanceNodeMap = {};</span>
<span class="cstat-no" title="statement not covered" >            if (!muteLog) {</span>
<span class="cstat-no" title="statement not covered" >                if (diff) {</span>
<span class="cstat-no" title="statement not covered" >                    log.info(log._("nodes.flows.stopped-modified-"+type));</span>
                } else {
<span class="cstat-no" title="statement not covered" >                    log.info(log._("nodes.flows.stopped-flows"));</span>
                }
            }
<span class="cstat-no" title="statement not covered" >            resolve();</span>
        });
    });
}
&nbsp;
&nbsp;
<span class="fstat-no" title="function not covered" >function checkTypeInUse(id) {</span>
<span class="cstat-no" title="statement not covered" >    var nodeInfo = typeRegistry.getNodeInfo(id);</span>
<span class="cstat-no" title="statement not covered" >    if (!nodeInfo) {</span>
<span class="cstat-no" title="statement not covered" >        throw new Error(log._("nodes.index.unrecognised-id", {id:id}));</span>
    } else {
<span class="cstat-no" title="statement not covered" >        var inUse = {};</span>
<span class="cstat-no" title="statement not covered" >        var config = getFlows();</span>
<span class="cstat-no" title="statement not covered" >        config.flows.forEach(<span class="fstat-no" title="function not covered" >function(n) {</span></span>
<span class="cstat-no" title="statement not covered" >            inUse[n.type] = (inUse[n.type]||0)+1;</span>
        });
<span class="cstat-no" title="statement not covered" >        var nodesInUse = [];</span>
<span class="cstat-no" title="statement not covered" >        nodeInfo.types.forEach(<span class="fstat-no" title="function not covered" >function(t) {</span></span>
<span class="cstat-no" title="statement not covered" >            if (inUse[t]) {</span>
<span class="cstat-no" title="statement not covered" >                nodesInUse.push(t);</span>
            }
        });
<span class="cstat-no" title="statement not covered" >        if (nodesInUse.length &gt; 0) {</span>
<span class="cstat-no" title="statement not covered" >            var msg = nodesInUse.join(", ");</span>
<span class="cstat-no" title="statement not covered" >            var err = new Error(log._("nodes.index.type-in-use", {msg:msg}));</span>
<span class="cstat-no" title="statement not covered" >            err.code = "type_in_use";</span>
<span class="cstat-no" title="statement not covered" >            throw err;</span>
        }
    }
}
&nbsp;
<span class="fstat-no" title="function not covered" >function updateMissingTypes() {</span>
<span class="cstat-no" title="statement not covered" >    var subflowInstanceRE = /^subflow:(.+)$/;</span>
<span class="cstat-no" title="statement not covered" >    activeFlowConfig.missingTypes = [];</span>
&nbsp;
<span class="cstat-no" title="statement not covered" >    for (var id in activeFlowConfig.allNodes) {</span>
<span class="cstat-no" title="statement not covered" >        if (activeFlowConfig.allNodes.hasOwnProperty(id)) {</span>
<span class="cstat-no" title="statement not covered" >            var node = activeFlowConfig.allNodes[id];</span>
<span class="cstat-no" title="statement not covered" >            if (node.type !== 'tab' &amp;&amp; node.type !== 'subflow') {</span>
<span class="cstat-no" title="statement not covered" >                var subflowDetails = subflowInstanceRE.exec(node.type);</span>
<span class="cstat-no" title="statement not covered" >                if ( (subflowDetails &amp;&amp; !activeFlowConfig.subflows[subflowDetails[1]]) || (!subflowDetails &amp;&amp; !typeRegistry.get(node.type)) ) {</span>
<span class="cstat-no" title="statement not covered" >                    if (activeFlowConfig.missingTypes.indexOf(node.type) === -1) {</span>
<span class="cstat-no" title="statement not covered" >                        activeFlowConfig.missingTypes.push(node.type);</span>
                    }
                }
            }
        }
    }
}
&nbsp;
<span class="fstat-no" title="function not covered" >function addFlow(flow) {</span>
<span class="cstat-no" title="statement not covered" >    var i,node;</span>
<span class="cstat-no" title="statement not covered" >    if (!flow.hasOwnProperty('nodes')) {</span>
<span class="cstat-no" title="statement not covered" >        throw new Error('missing nodes property');</span>
    }
<span class="cstat-no" title="statement not covered" >    flow.id = redUtil.generateId();</span>
&nbsp;
<span class="cstat-no" title="statement not covered" >    var nodes = [{</span>
        type:'tab',
        label:flow.label,
        id:flow.id
    }];
&nbsp;
<span class="cstat-no" title="statement not covered" >    for (i=0;i&lt;flow.nodes.length;i++) {</span>
<span class="cstat-no" title="statement not covered" >        node = flow.nodes[i];</span>
<span class="cstat-no" title="statement not covered" >        if (activeFlowConfig.allNodes[node.id]) {</span>
            // TODO nls
<span class="cstat-no" title="statement not covered" >            return when.reject(new Error('duplicate id'));</span>
        }
<span class="cstat-no" title="statement not covered" >        if (node.type === 'tab' || node.type === 'subflow') {</span>
<span class="cstat-no" title="statement not covered" >            return when.reject(new Error('invalid node type: '+node.type));</span>
        }
<span class="cstat-no" title="statement not covered" >        node.z = flow.id;</span>
<span class="cstat-no" title="statement not covered" >        nodes.push(node);</span>
    }
<span class="cstat-no" title="statement not covered" >    if (flow.configs) {</span>
<span class="cstat-no" title="statement not covered" >        for (i=0;i&lt;flow.configs.length;i++) {</span>
<span class="cstat-no" title="statement not covered" >            node = flow.configs[i];</span>
<span class="cstat-no" title="statement not covered" >            if (activeFlowConfig.allNodes[node.id]) {</span>
                // TODO nls
<span class="cstat-no" title="statement not covered" >                return when.reject(new Error('duplicate id'));</span>
            }
<span class="cstat-no" title="statement not covered" >            if (node.type === 'tab' || node.type === 'subflow') {</span>
<span class="cstat-no" title="statement not covered" >                return when.reject(new Error('invalid node type: '+node.type));</span>
            }
<span class="cstat-no" title="statement not covered" >            node.z = flow.id;</span>
<span class="cstat-no" title="statement not covered" >            nodes.push(node);</span>
        }
    }
<span class="cstat-no" title="statement not covered" >    var newConfig = clone(activeConfig.flows);</span>
<span class="cstat-no" title="statement not covered" >    newConfig = newConfig.concat(nodes);</span>
&nbsp;
<span class="cstat-no" title="statement not covered" >    return setFlows(newConfig,'flows',true).then(<span class="fstat-no" title="function not covered" >function() {</span></span>
<span class="cstat-no" title="statement not covered" >        log.info(log._("nodes.flows.added-flow",{label:(flow.label?flow.label+" ":"")+"["+flow.id+"]"}));</span>
<span class="cstat-no" title="statement not covered" >        return flow.id;</span>
    });
}
&nbsp;
<span class="fstat-no" title="function not covered" >function getFlow(id) {</span>
<span class="cstat-no" title="statement not covered" >    var flow;</span>
<span class="cstat-no" title="statement not covered" >    if (id === 'global') {</span>
<span class="cstat-no" title="statement not covered" >        flow = activeFlowConfig;</span>
    } else {
<span class="cstat-no" title="statement not covered" >        flow = activeFlowConfig.flows[id];</span>
    }
<span class="cstat-no" title="statement not covered" >    if (!flow) {</span>
<span class="cstat-no" title="statement not covered" >        return null;</span>
    }
<span class="cstat-no" title="statement not covered" >    var result = {</span>
        id: id
    };
<span class="cstat-no" title="statement not covered" >    if (flow.label) {</span>
<span class="cstat-no" title="statement not covered" >        result.label = flow.label;</span>
    }
<span class="cstat-no" title="statement not covered" >    if (id !== 'global') {</span>
<span class="cstat-no" title="statement not covered" >        result.nodes = [];</span>
    }
<span class="cstat-no" title="statement not covered" >    if (flow.nodes) {</span>
<span class="cstat-no" title="statement not covered" >        var nodeIds = Object.keys(flow.nodes);</span>
<span class="cstat-no" title="statement not covered" >        if (nodeIds.length &gt; 0) {</span>
<span class="cstat-no" title="statement not covered" >            result.nodes = nodeIds.map(<span class="fstat-no" title="function not covered" >function(nodeId) {</span></span>
<span class="cstat-no" title="statement not covered" >                var node = clone(flow.nodes[nodeId]);</span>
<span class="cstat-no" title="statement not covered" >                if (node.type === 'link out') {</span>
<span class="cstat-no" title="statement not covered" >                    delete node.wires;</span>
                }
<span class="cstat-no" title="statement not covered" >                return node;</span>
            })
        }
    }
<span class="cstat-no" title="statement not covered" >    if (flow.configs) {</span>
<span class="cstat-no" title="statement not covered" >        var configIds = Object.keys(flow.configs);</span>
<span class="cstat-no" title="statement not covered" >        result.configs = configIds.map(<span class="fstat-no" title="function not covered" >function(configId) {</span></span>
<span class="cstat-no" title="statement not covered" >            return clone(flow.configs[configId]);</span>
        })
<span class="cstat-no" title="statement not covered" >        if (result.configs.length === 0) {</span>
<span class="cstat-no" title="statement not covered" >            delete result.configs;</span>
        }
    }
<span class="cstat-no" title="statement not covered" >    if (flow.subflows) {</span>
<span class="cstat-no" title="statement not covered" >        var subflowIds = Object.keys(flow.subflows);</span>
<span class="cstat-no" title="statement not covered" >        result.subflows = subflowIds.map(<span class="fstat-no" title="function not covered" >function(subflowId) {</span></span>
<span class="cstat-no" title="statement not covered" >            var subflow = clone(flow.subflows[subflowId]);</span>
<span class="cstat-no" title="statement not covered" >            var nodeIds = Object.keys(subflow.nodes);</span>
<span class="cstat-no" title="statement not covered" >            subflow.nodes = nodeIds.map(<span class="fstat-no" title="function not covered" >function(id) {</span></span>
<span class="cstat-no" title="statement not covered" >                return subflow.nodes[id];</span>
            });
<span class="cstat-no" title="statement not covered" >            if (subflow.configs) {</span>
<span class="cstat-no" title="statement not covered" >                var configIds = Object.keys(subflow.configs);</span>
<span class="cstat-no" title="statement not covered" >                subflow.configs = configIds.map(<span class="fstat-no" title="function not covered" >function(id) {</span></span>
<span class="cstat-no" title="statement not covered" >                    return subflow.configs[id];</span>
                })
            }
<span class="cstat-no" title="statement not covered" >            delete subflow.instances;</span>
<span class="cstat-no" title="statement not covered" >            return subflow;</span>
        });
<span class="cstat-no" title="statement not covered" >        if (result.subflows.length === 0) {</span>
<span class="cstat-no" title="statement not covered" >            delete result.subflows;</span>
        }
    }
<span class="cstat-no" title="statement not covered" >    return result;</span>
}
&nbsp;
<span class="fstat-no" title="function not covered" >function updateFlow(id,newFlow) {</span>
<span class="cstat-no" title="statement not covered" >    var label = id;</span>
<span class="cstat-no" title="statement not covered" >    if (id !== 'global') {</span>
<span class="cstat-no" title="statement not covered" >        if (!activeFlowConfig.flows[id]) {</span>
<span class="cstat-no" title="statement not covered" >            var e = new Error();</span>
<span class="cstat-no" title="statement not covered" >            e.code = 404;</span>
<span class="cstat-no" title="statement not covered" >            throw e;</span>
        }
<span class="cstat-no" title="statement not covered" >        label = activeFlowConfig.flows[id].label;</span>
    }
<span class="cstat-no" title="statement not covered" >    var newConfig = clone(activeConfig.flows);</span>
<span class="cstat-no" title="statement not covered" >    var nodes;</span>
&nbsp;
<span class="cstat-no" title="statement not covered" >    if (id === 'global') {</span>
        // Remove all nodes whose z is not a known flow
        // When subflows can be owned by a flow, this logic will have to take
        // that into account
<span class="cstat-no" title="statement not covered" >        newConfig = newConfig.filter(<span class="fstat-no" title="function not covered" >function(node) {</span></span>
<span class="cstat-no" title="statement not covered" >            return node.type === 'tab' || (node.hasOwnProperty('z') &amp;&amp; activeFlowConfig.flows.hasOwnProperty(node.z));</span>
        })
&nbsp;
        // Add in the new config nodes
<span class="cstat-no" title="statement not covered" >        nodes = newFlow.configs||[];</span>
<span class="cstat-no" title="statement not covered" >        if (newFlow.subflows) {</span>
            // Add in the new subflows
<span class="cstat-no" title="statement not covered" >            newFlow.subflows.forEach(<span class="fstat-no" title="function not covered" >function(sf) {</span></span>
<span class="cstat-no" title="statement not covered" >                nodes = nodes.concat(sf.nodes||[]).concat(sf.configs||[]);</span>
<span class="cstat-no" title="statement not covered" >                delete sf.nodes;</span>
<span class="cstat-no" title="statement not covered" >                delete sf.configs;</span>
<span class="cstat-no" title="statement not covered" >                nodes.push(sf);</span>
            });
        }
    } else {
<span class="cstat-no" title="statement not covered" >        newConfig = newConfig.filter(<span class="fstat-no" title="function not covered" >function(node) {</span></span>
<span class="cstat-no" title="statement not covered" >            return node.z !== id &amp;&amp; node.id !== id;</span>
        });
<span class="cstat-no" title="statement not covered" >        var tabNode = {</span>
            type:'tab',
            label:newFlow.label,
            id:id
        }
<span class="cstat-no" title="statement not covered" >        nodes = [tabNode].concat(newFlow.nodes||[]).concat(newFlow.configs||[]);</span>
<span class="cstat-no" title="statement not covered" >        nodes.forEach(<span class="fstat-no" title="function not covered" >function(n) {</span></span>
<span class="cstat-no" title="statement not covered" >            n.z = id;</span>
        });
    }
&nbsp;
<span class="cstat-no" title="statement not covered" >    newConfig = newConfig.concat(nodes);</span>
<span class="cstat-no" title="statement not covered" >    return setFlows(newConfig,'flows',true).then(<span class="fstat-no" title="function not covered" >function() {</span></span>
<span class="cstat-no" title="statement not covered" >        log.info(log._("nodes.flows.updated-flow",{label:(label?label+" ":"")+"["+id+"]"}));</span>
    })
}
&nbsp;
<span class="fstat-no" title="function not covered" >function removeFlow(id) {</span>
<span class="cstat-no" title="statement not covered" >    if (id === 'global') {</span>
        // TODO: nls + error code
<span class="cstat-no" title="statement not covered" >        throw new Error('not allowed to remove global');</span>
    }
<span class="cstat-no" title="statement not covered" >    var flow = activeFlowConfig.flows[id];</span>
<span class="cstat-no" title="statement not covered" >    if (!flow) {</span>
<span class="cstat-no" title="statement not covered" >        var e = new Error();</span>
<span class="cstat-no" title="statement not covered" >        e.code = 404;</span>
<span class="cstat-no" title="statement not covered" >        throw e;</span>
    }
&nbsp;
<span class="cstat-no" title="statement not covered" >    var newConfig = clone(activeConfig.flows);</span>
<span class="cstat-no" title="statement not covered" >    newConfig = newConfig.filter(<span class="fstat-no" title="function not covered" >function(node) {</span></span>
<span class="cstat-no" title="statement not covered" >        return node.z !== id &amp;&amp; node.id !== id;</span>
    });
&nbsp;
<span class="cstat-no" title="statement not covered" >    return setFlows(newConfig,'flows',true).then(<span class="fstat-no" title="function not covered" >function() {</span></span>
<span class="cstat-no" title="statement not covered" >        log.info(log._("nodes.flows.removed-flow",{label:(flow.label?flow.label+" ":"")+"["+flow.id+"]"}));</span>
    });
}
&nbsp;
module.exports = {
    init: init,
&nbsp;
    /**
     * Load the current flow configuration from storage
     * @return a promise for the loading of the config
     */
    load: load,
&nbsp;
    get:getNode,
    eachNode: eachNode,
&nbsp;
    /**
     * Gets the current flow configuration
     */
    getFlows: getFlows,
&nbsp;
    /**
     * Sets the current active config.
     * @param config the configuration to enable
     * @param type the type of deployment to do: full (default), nodes, flows, load
     * @return a promise for the saving/starting of the new flow
     */
    setFlows: setFlows,
&nbsp;
    /**
     * Starts the current flow configuration
     */
    startFlows: start,
&nbsp;
    /**
     * Stops the current flow configuration
     * @return a promise for the stopping of the flow
     */
    stopFlows: stop,
&nbsp;
    get started<span class="fstat-no" title="function not covered" >() {</span> <span class="cstat-no" title="statement not covered" >return started }</span>,
&nbsp;
    handleError: handleError,
    handleStatus: handleStatus,
&nbsp;
    checkTypeInUse: checkTypeInUse,
&nbsp;
    addFlow: addFlow,
    getFlow: getFlow,
    updateFlow: updateFlow,
    removeFlow: removeFlow,
    disableFlow:null,
    enableFlow:null
&nbsp;
};
&nbsp;
&nbsp;</pre></td></tr>
</table></pre>
</div>
<div class="footer">
    <div class="meta">Generated by <a href="https://github.com/kaizhu256/node-utility2" target="_blank">utility2</a> at Tue Apr 11 2017 17:25:15 GMT+0000 (UTC)</div>
</div>
</body>
</html>


<!doctype html>
<html lang="en">
<head>
    <title>Code coverage report for node-npmtest-node-red/node-red/red/runtime/nodes/flows/util.js</title>
    <meta charset="utf-8">
    <style>
        body, html {
            margin:0; padding: 0;
        }
        body {
            font-family: Arial, Helvetica;
            font-size: 10pt;
        }
        div.header, div.footer {
            background: #eee;
            padding: 1em;
        }
        div.header {
            height: 160px;
            padding: 0 1em 0 1em;
            z-index: 100;
            position: fixed;
            top: 0;
            border-bottom: 1px solid #666;
            width: 100%;
        }
        div.footer {
            border-top: 1px solid #666;
        }
        div.body {
            margin-top: 170px;
        }
        div.meta {
            font-size: 90%;
            text-align: center;
        }
        h1, h2, h3 {
            font-weight: normal;
        }
        h1 {
            font-size: 12pt;
        }
        h2 {
            font-size: 10pt;
        }
        pre {
            font-family: Menlo, Monaco, Consolas, Courier New, monospace;
            margin: 0;
            padding: 0;
            font-size: 14px;
            tab-size: 2;
        }

        div.path { font-size: 110%; }
        div.path a:link, div.path a:visited { color: #000; }
        table.coverage { border-collapse: collapse; margin:0; padding: 0 }

        table.coverage td {
            margin: 0;
            padding: 0;
            color: #111;
            vertical-align: top;
        }
        table.coverage td.line-count {
            width: 50px;
            text-align: right;
            padding-right: 5px;
        }
        table.coverage td.line-coverage {
            color: #777 !important;
            text-align: right;
            border-left: 1px solid #666;
            border-right: 1px solid #666;
        }

        table.coverage td.text {
        }

        table.coverage td span.cline-any {
            display: inline-block;
            padding: 0 5px;
            width: 40px;
        }
        table.coverage td span.cline-neutral {
            background: #eee;
        }
        table.coverage td span.cline-yes {
            background: #b5d592;
            color: #999;
        }
        table.coverage td span.cline-no {
            background: #fc8c84;
        }

        .cstat-yes { color: #111; }
        .cstat-no { background: #fc8c84; color: #111; }
        .fstat-no { background: #ffc520; color: #111 !important; }
        .cbranch-no { background:  yellow !important; color: #111; }

        .cstat-skip { background: #ddd; color: #111; }
        .fstat-skip { background: #ddd; color: #111 !important; }
        .cbranch-skip { background: #ddd !important; color: #111; }

        .missing-if-branch {
            display: inline-block;
            margin-right: 10px;
            position: relative;
            padding: 0 4px;
            background: black;
            color: yellow;
        }

        .skip-if-branch {
            display: none;
            margin-right: 10px;
            position: relative;
            padding: 0 4px;
            background: #ccc;
            color: white;
        }

        .missing-if-branch .typ, .skip-if-branch .typ {
            color: inherit !important;
        }

        .entity, .metric { font-weight: bold; }
        .metric { display: inline-block; border: 1px solid #333; padding: 0.3em; background: white; }
        .metric small { font-size: 80%; font-weight: normal; color: #666; }

        div.coverage-summary table { border-collapse: collapse; margin: 3em; font-size: 110%; }
        div.coverage-summary td, div.coverage-summary table  th { margin: 0; padding: 0.25em 1em; border-top: 1px solid #666; border-bottom: 1px solid #666; }
        div.coverage-summary th { text-align: left; border: 1px solid #666; background: #eee; font-weight: normal; }
        div.coverage-summary th.file { border-right: none !important; }
        div.coverage-summary th.pic { border-left: none !important; text-align: right; }
        div.coverage-summary th.pct { border-right: none !important; }
        div.coverage-summary th.abs { border-left: none !important; text-align: right; }
        div.coverage-summary td.pct { text-align: right; border-left: 1px solid #666; }
        div.coverage-summary td.abs { text-align: right; font-size: 90%; color: #444; border-right: 1px solid #666; }
        div.coverage-summary td.file { text-align: right; border-left: 1px solid #666; white-space: nowrap;  }
        div.coverage-summary td.pic { min-width: 120px !important;  }
        div.coverage-summary a:link { color: #000; }
        div.coverage-summary a:visited { color: #333; }
        div.coverage-summary tfoot td { border-top: 1px solid #666; }

        div.coverage-summary .yui3-datatable-sort-indicator, div.coverage-summary .dummy-sort-indicator {
            height: 10px;
            width: 7px;
            display: inline-block;
            margin-left: 0.5em;
        }
        div.coverage-summary .yui3-datatable-sort-indicator {
            background: no-repeat scroll 0 0 transparent;
        }
        div.coverage-summary .yui3-datatable-sorted .yui3-datatable-sort-indicator {
            background-position: 0 -20px;
        }
        div.coverage-summary .yui3-datatable-sorted-desc .yui3-datatable-sort-indicator {
            background-position: 0 -10px;
        }

        .high { background: #b5d592 !important; }
        .medium { background: #ffe87c !important; }
        .low { background: #fc8c84 !important; }

        span.cover-fill, span.cover-empty {
            display:inline-block;
            border:1px solid #444;
            background: white;
            height: 12px;
        }
        span.cover-fill {
            background: #ccc;
            border-right: 1px solid #444;
        }
        span.cover-empty {
            background: white;
            border-left: none;
        }
        span.cover-full {
            border-right: none !important;
        }
        pre.prettyprint {
            border: none !important;
            padding: 0 !important;
            margin: 0 !important;
        }
        .com { color: #999 !important; }
        .ignore-none { color: #999; font-weight: normal; }

    </style>
</head>
<body>
<div class="header low">
    <h1 style="font-weight: bold;">
        <a href="https://github.com/npmtest/node-npmtest-node-red">npmtest-node-red (v0.0.1)</a>
    </h1>
    <h1>Code coverage report for <span class="entity">node-npmtest-node-red/node-red/red/runtime/nodes/flows/util.js</span></h1>
    <h2>
        
        Statements: <span class="metric">3.59% <small>(8 / 223)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        
        Branches: <span class="metric">0% <small>(0 / 188)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        
        Functions: <span class="metric">0% <small>(0 / 13)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        
        Lines: <span class="metric">3.62% <small>(8 / 221)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        Ignored: <span class="metric"><span class="ignore-none">none</span></span> &nbsp;&nbsp;&nbsp;&nbsp;
    </h2>
    <div class="path"><a href="../../../../../../index.html">All files</a> &#187; <a href="index.html">node-npmtest-node-red/node-red/red/runtime/nodes/flows/</a> &#187; util.js</div>
</div>
<div class="body">
<pre><table class="coverage">
<tr><td class="line-count">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
164
165
166
167
168
169
170
171
172
173
174
175
176
177
178
179
180
181
182
183
184
185
186
187
188
189
190
191
192
193
194
195
196
197
198
199
200
201
202
203
204
205
206
207
208
209
210
211
212
213
214
215
216
217
218
219
220
221
222
223
224
225
226
227
228
229
230
231
232
233
234
235
236
237
238
239
240
241
242
243
244
245
246
247
248
249
250
251
252
253
254
255
256
257
258
259
260
261
262
263
264
265
266
267
268
269
270
271
272
273
274
275
276
277
278
279
280
281
282
283
284
285
286
287
288
289
290
291
292
293
294
295
296
297
298
299
300
301
302
303
304
305
306
307
308
309
310
311
312
313
314
315
316
317
318
319
320
321
322
323
324
325
326
327
328
329
330
331
332
333
334
335
336
337
338
339
340
341
342
343
344
345
346
347
348
349
350
351
352
353
354
355
356
357
358
359
360
361
362
363
364
365
366
367
368
369
370
371
372
373
374
375
376
377
378
379
380
381
382
383
384
385
386
387
388
389
390
391
392
393
394
395
396
397
398
399
400
401
402
403
404
405
406
407
408
409
410
411
412</td><td class="line-coverage"><span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span></td><td class="text"><pre class="prettyprint lang-js">/**
 * Copyright JS Foundation and other contributors, http://js.foundation
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 **/
var clone = require("clone");
var redUtil = require("../../util");
var subflowInstanceRE = /^subflow:(.+)$/;
var typeRegistry = require("../registry");
&nbsp;
<span class="fstat-no" title="function not covered" >function diffNodes(oldNode,newNode) {</span>
<span class="cstat-no" title="statement not covered" >    if (oldNode == null) {</span>
<span class="cstat-no" title="statement not covered" >        return true;</span>
    }
<span class="cstat-no" title="statement not covered" >    var oldKeys = Object.keys(oldNode).filter(<span class="fstat-no" title="function not covered" >function(p) {</span> <span class="cstat-no" title="statement not covered" >return p != "x" &amp;&amp; p != "y" &amp;&amp; p != "wires" }</span>);</span>
<span class="cstat-no" title="statement not covered" >    var newKeys = Object.keys(newNode).filter(<span class="fstat-no" title="function not covered" >function(p) {</span> <span class="cstat-no" title="statement not covered" >return p != "x" &amp;&amp; p != "y" &amp;&amp; p != "wires" }</span>);</span>
<span class="cstat-no" title="statement not covered" >    if (oldKeys.length != newKeys.length) {</span>
<span class="cstat-no" title="statement not covered" >        return true;</span>
    }
<span class="cstat-no" title="statement not covered" >    for (var i=0;i&lt;newKeys.length;i++) {</span>
<span class="cstat-no" title="statement not covered" >        var p = newKeys[i];</span>
<span class="cstat-no" title="statement not covered" >        if (!redUtil.compareObjects(oldNode[p],newNode[p])) {</span>
<span class="cstat-no" title="statement not covered" >            return true;</span>
        }
    }
&nbsp;
<span class="cstat-no" title="statement not covered" >    return false;</span>
}
&nbsp;
var EnvVarPropertyRE = /^\$\((\S+)\)$/;
&nbsp;
<span class="fstat-no" title="function not covered" >function mapEnvVarProperties(obj,prop) {</span>
<span class="cstat-no" title="statement not covered" >    if (Buffer.isBuffer(obj[prop])) {</span>
<span class="cstat-no" title="statement not covered" >        return;</span>
    } else <span class="cstat-no" title="statement not covered" >if (Array.isArray(obj[prop])) {</span>
<span class="cstat-no" title="statement not covered" >        for (var i=0;i&lt;obj[prop].length;i++) {</span>
<span class="cstat-no" title="statement not covered" >            mapEnvVarProperties(obj[prop],i);</span>
        }
    } else <span class="cstat-no" title="statement not covered" >if (typeof obj[prop] === 'string') {</span>
<span class="cstat-no" title="statement not covered" >        var m;</span>
<span class="cstat-no" title="statement not covered" >        if ( (m = EnvVarPropertyRE.exec(obj[prop])) !== null) {</span>
<span class="cstat-no" title="statement not covered" >            if (process.env.hasOwnProperty(m[1])) {</span>
<span class="cstat-no" title="statement not covered" >                obj[prop] = process.env[m[1]];</span>
            }
        }
    } else {
<span class="cstat-no" title="statement not covered" >        for (var p in obj[prop]) {</span>
<span class="cstat-no" title="statement not covered" >            if (obj[prop].hasOwnProperty(p)) {</span>
<span class="cstat-no" title="statement not covered" >                mapEnvVarProperties(obj[prop],p);</span>
            }
        }
    }
}
&nbsp;
module.exports = {
&nbsp;
    diffNodes: diffNodes,
    mapEnvVarProperties: mapEnvVarProperties,
&nbsp;
    parseConfig: <span class="fstat-no" title="function not covered" >function(config) {</span>
<span class="cstat-no" title="statement not covered" >        var flow = {};</span>
<span class="cstat-no" title="statement not covered" >        flow.allNodes = {};</span>
<span class="cstat-no" title="statement not covered" >        flow.subflows = {};</span>
<span class="cstat-no" title="statement not covered" >        flow.configs = {};</span>
<span class="cstat-no" title="statement not covered" >        flow.flows = {};</span>
<span class="cstat-no" title="statement not covered" >        flow.missingTypes = [];</span>
&nbsp;
<span class="cstat-no" title="statement not covered" >        config.forEach(<span class="fstat-no" title="function not covered" >function(n) {</span></span>
<span class="cstat-no" title="statement not covered" >            flow.allNodes[n.id] = clone(n);</span>
<span class="cstat-no" title="statement not covered" >            if (n.type === 'tab') {</span>
<span class="cstat-no" title="statement not covered" >                flow.flows[n.id] = n;</span>
<span class="cstat-no" title="statement not covered" >                flow.flows[n.id].subflows = {};</span>
<span class="cstat-no" title="statement not covered" >                flow.flows[n.id].configs = {};</span>
<span class="cstat-no" title="statement not covered" >                flow.flows[n.id].nodes = {};</span>
            }
        });
&nbsp;
<span class="cstat-no" title="statement not covered" >        config.forEach(<span class="fstat-no" title="function not covered" >function(n) {</span></span>
<span class="cstat-no" title="statement not covered" >            if (n.type === 'subflow') {</span>
<span class="cstat-no" title="statement not covered" >                flow.subflows[n.id] = n;</span>
<span class="cstat-no" title="statement not covered" >                flow.subflows[n.id].configs = {};</span>
<span class="cstat-no" title="statement not covered" >                flow.subflows[n.id].nodes = {};</span>
<span class="cstat-no" title="statement not covered" >                flow.subflows[n.id].instances = [];</span>
            }
        });
<span class="cstat-no" title="statement not covered" >        var linkWires = {};</span>
<span class="cstat-no" title="statement not covered" >        var linkOutNodes = [];</span>
<span class="cstat-no" title="statement not covered" >        config.forEach(<span class="fstat-no" title="function not covered" >function(n) {</span></span>
<span class="cstat-no" title="statement not covered" >            if (n.type !== 'subflow' &amp;&amp; n.type !== 'tab') {</span>
<span class="cstat-no" title="statement not covered" >                var subflowDetails = subflowInstanceRE.exec(n.type);</span>
&nbsp;
<span class="cstat-no" title="statement not covered" >                if ( (subflowDetails &amp;&amp; !flow.subflows[subflowDetails[1]]) || (!subflowDetails &amp;&amp; !typeRegistry.get(n.type)) ) {</span>
<span class="cstat-no" title="statement not covered" >                    if (flow.missingTypes.indexOf(n.type) === -1) {</span>
<span class="cstat-no" title="statement not covered" >                        flow.missingTypes.push(n.type);</span>
                    }
                }
<span class="cstat-no" title="statement not covered" >                var container = null;</span>
<span class="cstat-no" title="statement not covered" >                if (flow.flows[n.z]) {</span>
<span class="cstat-no" title="statement not covered" >                    container = flow.flows[n.z];</span>
                } else <span class="cstat-no" title="statement not covered" >if (flow.subflows[n.z]) {</span>
<span class="cstat-no" title="statement not covered" >                    container = flow.subflows[n.z];</span>
                }
<span class="cstat-no" title="statement not covered" >                if (n.hasOwnProperty('x') &amp;&amp; n.hasOwnProperty('y')) {</span>
<span class="cstat-no" title="statement not covered" >                    if (subflowDetails) {</span>
<span class="cstat-no" title="statement not covered" >                        var subflowType = subflowDetails[1]</span>
<span class="cstat-no" title="statement not covered" >                        n.subflow = subflowType;</span>
<span class="cstat-no" title="statement not covered" >                        flow.subflows[subflowType].instances.push(n)</span>
                    }
<span class="cstat-no" title="statement not covered" >                    if (container) {</span>
<span class="cstat-no" title="statement not covered" >                        container.nodes[n.id] = n;</span>
                    }
                } else {
<span class="cstat-no" title="statement not covered" >                    if (container) {</span>
<span class="cstat-no" title="statement not covered" >                        container.configs[n.id] = n;</span>
                    } else {
<span class="cstat-no" title="statement not covered" >                        flow.configs[n.id] = n;</span>
<span class="cstat-no" title="statement not covered" >                        flow.configs[n.id]._users = [];</span>
                    }
                }
<span class="cstat-no" title="statement not covered" >                if (n.type === 'link in' &amp;&amp; n.links) {</span>
                    // Ensure wires are present in corresponding link out nodes
<span class="cstat-no" title="statement not covered" >                    n.links.forEach(<span class="fstat-no" title="function not covered" >function(id) {</span></span>
<span class="cstat-no" title="statement not covered" >                        linkWires[id] = linkWires[id]||{};</span>
<span class="cstat-no" title="statement not covered" >                        linkWires[id][n.id] = true;</span>
                    })
                } else <span class="cstat-no" title="statement not covered" >if (n.type === 'link out' &amp;&amp; n.links) {</span>
<span class="cstat-no" title="statement not covered" >                    linkWires[n.id] = linkWires[n.id]||{};</span>
<span class="cstat-no" title="statement not covered" >                    n.links.forEach(<span class="fstat-no" title="function not covered" >function(id) {</span></span>
<span class="cstat-no" title="statement not covered" >                        linkWires[n.id][id] = true;</span>
                    })
<span class="cstat-no" title="statement not covered" >                    linkOutNodes.push(n);</span>
                }
            }
        });
<span class="cstat-no" title="statement not covered" >        linkOutNodes.forEach(<span class="fstat-no" title="function not covered" >function(n) {</span></span>
<span class="cstat-no" title="statement not covered" >            var links = linkWires[n.id];</span>
<span class="cstat-no" title="statement not covered" >            var targets = Object.keys(links);</span>
<span class="cstat-no" title="statement not covered" >            n.wires = [targets];</span>
        });
&nbsp;
&nbsp;
<span class="cstat-no" title="statement not covered" >        var addedTabs = {};</span>
<span class="cstat-no" title="statement not covered" >        config.forEach(<span class="fstat-no" title="function not covered" >function(n) {</span></span>
<span class="cstat-no" title="statement not covered" >            if (n.type !== 'subflow' &amp;&amp; n.type !== 'tab') {</span>
<span class="cstat-no" title="statement not covered" >                for (var prop in n) {</span>
<span class="cstat-no" title="statement not covered" >                    if (n.hasOwnProperty(prop) &amp;&amp; prop !== 'id' &amp;&amp; prop !== 'wires' &amp;&amp; prop !== 'type' &amp;&amp; prop !== '_users' &amp;&amp; flow.configs.hasOwnProperty(n[prop])) {</span>
                        // This property references a global config node
<span class="cstat-no" title="statement not covered" >                        flow.configs[n[prop]]._users.push(n.id)</span>
                    }
                }
<span class="cstat-no" title="statement not covered" >                if (n.z &amp;&amp; !flow.subflows[n.z]) {</span>
&nbsp;
<span class="cstat-no" title="statement not covered" >                    if (!flow.flows[n.z]) {</span>
<span class="cstat-no" title="statement not covered" >                        flow.flows[n.z] = {type:'tab',id:n.z};</span>
<span class="cstat-no" title="statement not covered" >                        flow.flows[n.z].subflows = {};</span>
<span class="cstat-no" title="statement not covered" >                        flow.flows[n.z].configs = {};</span>
<span class="cstat-no" title="statement not covered" >                        flow.flows[n.z].nodes = {};</span>
<span class="cstat-no" title="statement not covered" >                        addedTabs[n.z] = flow.flows[n.z];</span>
                    }
<span class="cstat-no" title="statement not covered" >                    if (addedTabs[n.z]) {</span>
<span class="cstat-no" title="statement not covered" >                        if (n.hasOwnProperty('x') &amp;&amp; n.hasOwnProperty('y')) {</span>
<span class="cstat-no" title="statement not covered" >                            addedTabs[n.z].nodes[n.id] = n;</span>
                        } else {
<span class="cstat-no" title="statement not covered" >                            addedTabs[n.z].configs[n.id] = n;</span>
                        }
                    }
                }
            }
        });
<span class="cstat-no" title="statement not covered" >        return flow;</span>
    },
&nbsp;
    diffConfigs: <span class="fstat-no" title="function not covered" >function(oldConfig, newConfig) {</span>
<span class="cstat-no" title="statement not covered" >        var id;</span>
<span class="cstat-no" title="statement not covered" >        var node;</span>
<span class="cstat-no" title="statement not covered" >        var nn;</span>
<span class="cstat-no" title="statement not covered" >        var wires;</span>
<span class="cstat-no" title="statement not covered" >        var j,k;</span>
&nbsp;
<span class="cstat-no" title="statement not covered" >        var changedSubflows = {};</span>
&nbsp;
<span class="cstat-no" title="statement not covered" >        var added = {};</span>
<span class="cstat-no" title="statement not covered" >        var removed = {};</span>
<span class="cstat-no" title="statement not covered" >        var changed = {};</span>
<span class="cstat-no" title="statement not covered" >        var wiringChanged = {};</span>
&nbsp;
<span class="cstat-no" title="statement not covered" >        var linkMap = {};</span>
&nbsp;
<span class="cstat-no" title="statement not covered" >        for (id in oldConfig.allNodes) {</span>
<span class="cstat-no" title="statement not covered" >            if (oldConfig.allNodes.hasOwnProperty(id)) {</span>
<span class="cstat-no" title="statement not covered" >                node = oldConfig.allNodes[id];</span>
                // build the map of what this node was previously wired to
<span class="cstat-no" title="statement not covered" >                if (node.wires) {</span>
<span class="cstat-no" title="statement not covered" >                    linkMap[node.id] = linkMap[node.id] || [];</span>
<span class="cstat-no" title="statement not covered" >                    for (j=0;j&lt;node.wires.length;j++) {</span>
<span class="cstat-no" title="statement not covered" >                        wires = node.wires[j];</span>
<span class="cstat-no" title="statement not covered" >                        for (k=0;k&lt;wires.length;k++) {</span>
<span class="cstat-no" title="statement not covered" >                            linkMap[node.id].push(wires[k]);</span>
<span class="cstat-no" title="statement not covered" >                            nn = oldConfig.allNodes[wires[k]];</span>
<span class="cstat-no" title="statement not covered" >                            if (nn) {</span>
<span class="cstat-no" title="statement not covered" >                                linkMap[nn.id] = linkMap[nn.id] || [];</span>
<span class="cstat-no" title="statement not covered" >                                linkMap[nn.id].push(node.id);</span>
                            }
                        }
                    }
                }
                // This node has been removed
<span class="cstat-no" title="statement not covered" >                if (!newConfig.allNodes.hasOwnProperty(id)) {</span>
<span class="cstat-no" title="statement not covered" >                    removed[id] = node;</span>
                    // Mark the container as changed
<span class="cstat-no" title="statement not covered" >                    if (newConfig.allNodes[removed[id].z]) {</span>
<span class="cstat-no" title="statement not covered" >                        changed[removed[id].z] = newConfig.allNodes[removed[id].z];</span>
<span class="cstat-no" title="statement not covered" >                        if (changed[removed[id].z].type === "subflow") {</span>
<span class="cstat-no" title="statement not covered" >                            changedSubflows[removed[id].z] = changed[removed[id].z];</span>
                            //delete removed[id];
                        }
                    }
                } else {
                    // This node has a material configuration change
<span class="cstat-no" title="statement not covered" >                    if (diffNodes(node,newConfig.allNodes[id]) || newConfig.allNodes[id].credentials) {</span>
<span class="cstat-no" title="statement not covered" >                        changed[id] = newConfig.allNodes[id];</span>
<span class="cstat-no" title="statement not covered" >                        if (changed[id].type === "subflow") {</span>
<span class="cstat-no" title="statement not covered" >                            changedSubflows[id] = changed[id];</span>
                        }
                        // Mark the container as changed
<span class="cstat-no" title="statement not covered" >                        if (newConfig.allNodes[changed[id].z]) {</span>
<span class="cstat-no" title="statement not covered" >                            changed[changed[id].z] = newConfig.allNodes[changed[id].z];</span>
<span class="cstat-no" title="statement not covered" >                            if (changed[changed[id].z].type === "subflow") {</span>
<span class="cstat-no" title="statement not covered" >                                changedSubflows[changed[id].z] = changed[changed[id].z];</span>
<span class="cstat-no" title="statement not covered" >                                delete changed[id];</span>
                            }
                        }
                    }
                    // This node's wiring has changed
<span class="cstat-no" title="statement not covered" >                    if (!redUtil.compareObjects(node.wires,newConfig.allNodes[id].wires)) {</span>
<span class="cstat-no" title="statement not covered" >                        wiringChanged[id] = newConfig.allNodes[id];</span>
                        // Mark the container as changed
<span class="cstat-no" title="statement not covered" >                        if (newConfig.allNodes[wiringChanged[id].z]) {</span>
<span class="cstat-no" title="statement not covered" >                            changed[wiringChanged[id].z] = newConfig.allNodes[wiringChanged[id].z];</span>
<span class="cstat-no" title="statement not covered" >                            if (changed[wiringChanged[id].z].type === "subflow") {</span>
<span class="cstat-no" title="statement not covered" >                                changedSubflows[wiringChanged[id].z] = changed[wiringChanged[id].z];</span>
<span class="cstat-no" title="statement not covered" >                                delete wiringChanged[id];</span>
                            }
                        }
                    }
                }
            }
        }
        // Look for added nodes
<span class="cstat-no" title="statement not covered" >        for (id in newConfig.allNodes) {</span>
<span class="cstat-no" title="statement not covered" >            if (newConfig.allNodes.hasOwnProperty(id)) {</span>
<span class="cstat-no" title="statement not covered" >                node = newConfig.allNodes[id];</span>
                // build the map of what this node is now wired to
<span class="cstat-no" title="statement not covered" >                if (node.wires) {</span>
<span class="cstat-no" title="statement not covered" >                    linkMap[node.id] = linkMap[node.id] || [];</span>
<span class="cstat-no" title="statement not covered" >                    for (j=0;j&lt;node.wires.length;j++) {</span>
<span class="cstat-no" title="statement not covered" >                        wires = node.wires[j];</span>
<span class="cstat-no" title="statement not covered" >                        for (k=0;k&lt;wires.length;k++) {</span>
<span class="cstat-no" title="statement not covered" >                            if (linkMap[node.id].indexOf(wires[k]) === -1) {</span>
<span class="cstat-no" title="statement not covered" >                                linkMap[node.id].push(wires[k]);</span>
                            }
<span class="cstat-no" title="statement not covered" >                            nn = newConfig.allNodes[wires[k]];</span>
<span class="cstat-no" title="statement not covered" >                            if (nn) {</span>
<span class="cstat-no" title="statement not covered" >                                linkMap[nn.id] = linkMap[nn.id] || [];</span>
<span class="cstat-no" title="statement not covered" >                                if (linkMap[nn.id].indexOf(node.id) === -1) {</span>
<span class="cstat-no" title="statement not covered" >                                    linkMap[nn.id].push(node.id);</span>
                                }
                            }
                        }
                    }
                }
                // This node has been added
<span class="cstat-no" title="statement not covered" >                if (!oldConfig.allNodes.hasOwnProperty(id)) {</span>
<span class="cstat-no" title="statement not covered" >                    added[id] = node;</span>
                    // Mark the container as changed
<span class="cstat-no" title="statement not covered" >                    if (newConfig.allNodes[added[id].z]) {</span>
<span class="cstat-no" title="statement not covered" >                        changed[added[id].z] = newConfig.allNodes[added[id].z];</span>
<span class="cstat-no" title="statement not covered" >                        if (changed[added[id].z].type === "subflow") {</span>
<span class="cstat-no" title="statement not covered" >                            changedSubflows[added[id].z] = changed[added[id].z];</span>
<span class="cstat-no" title="statement not covered" >                            delete added[id];</span>
                        }
                    }
                }
            }
        }
&nbsp;
<span class="cstat-no" title="statement not covered" >        var madeChange;</span>
        // Loop through the nodes looking for references to changed config nodes
        // Repeat the loop if anything is marked as changed as it may need to be
        // propagated to parent nodes.
        // TODO: looping through all nodes every time is a bit inefficient - could be more targeted
<span class="cstat-no" title="statement not covered" >        do {</span>
<span class="cstat-no" title="statement not covered" >            madeChange = false;</span>
<span class="cstat-no" title="statement not covered" >            for (id in newConfig.allNodes) {</span>
<span class="cstat-no" title="statement not covered" >                if (newConfig.allNodes.hasOwnProperty(id)) {</span>
<span class="cstat-no" title="statement not covered" >                    node = newConfig.allNodes[id];</span>
<span class="cstat-no" title="statement not covered" >                    for (var prop in node) {</span>
<span class="cstat-no" title="statement not covered" >                        if (node.hasOwnProperty(prop) &amp;&amp; prop != "z" &amp;&amp; prop != "id" &amp;&amp; prop != "wires") {</span>
                            // This node has a property that references a changed/removed node
                            // Assume it is a config node change and mark this node as
                            // changed.
<span class="cstat-no" title="statement not covered" >                            if (changed[node[prop]] || removed[node[prop]]) {</span>
<span class="cstat-no" title="statement not covered" >                                if (!changed[node.id]) {</span>
<span class="cstat-no" title="statement not covered" >                                    madeChange = true;</span>
<span class="cstat-no" title="statement not covered" >                                    changed[node.id] = node;</span>
                                    // This node exists within subflow template
                                    // Mark the template as having changed
<span class="cstat-no" title="statement not covered" >                                    if (newConfig.allNodes[node.z]) {</span>
<span class="cstat-no" title="statement not covered" >                                        changed[node.z] = newConfig.allNodes[node.z];</span>
<span class="cstat-no" title="statement not covered" >                                        if (changed[node.z].type === "subflow") {</span>
<span class="cstat-no" title="statement not covered" >                                            changedSubflows[node.z] = changed[node.z];</span>
                                        }
                                    }
                                }
                            }
                        }
                    }
                }
            }
        } while (madeChange===true)
&nbsp;
        // Find any nodes that exist on a subflow template and remove from changed
        // list as the parent subflow will now be marked as containing a change
<span class="cstat-no" title="statement not covered" >        for (id in newConfig.allNodes) {</span>
<span class="cstat-no" title="statement not covered" >            if (newConfig.allNodes.hasOwnProperty(id)) {</span>
<span class="cstat-no" title="statement not covered" >                node = newConfig.allNodes[id];</span>
<span class="cstat-no" title="statement not covered" >                if (newConfig.allNodes[node.z] &amp;&amp; newConfig.allNodes[node.z].type === "subflow") {</span>
<span class="cstat-no" title="statement not covered" >                    delete changed[node.id];</span>
                }
            }
        }
&nbsp;
        // Recursively mark all instances of changed subflows as changed
<span class="cstat-no" title="statement not covered" >        var changedSubflowStack = Object.keys(changedSubflows);</span>
<span class="cstat-no" title="statement not covered" >        while (changedSubflowStack.length &gt; 0) {</span>
<span class="cstat-no" title="statement not covered" >            var subflowId = changedSubflowStack.pop();</span>
<span class="cstat-no" title="statement not covered" >            for (id in newConfig.allNodes) {</span>
<span class="cstat-no" title="statement not covered" >                if (newConfig.allNodes.hasOwnProperty(id)) {</span>
<span class="cstat-no" title="statement not covered" >                    node = newConfig.allNodes[id];</span>
<span class="cstat-no" title="statement not covered" >                    if (node.type === 'subflow:'+subflowId) {</span>
<span class="cstat-no" title="statement not covered" >                        if (!changed[node.id]) {</span>
<span class="cstat-no" title="statement not covered" >                            changed[node.id] = node;</span>
<span class="cstat-no" title="statement not covered" >                            if (!changed[changed[node.id].z] &amp;&amp; newConfig.allNodes[changed[node.id].z]) {</span>
<span class="cstat-no" title="statement not covered" >                                changed[changed[node.id].z] = newConfig.allNodes[changed[node.id].z];</span>
<span class="cstat-no" title="statement not covered" >                                if (newConfig.allNodes[changed[node.id].z].type === "subflow") {</span>
                                    // This subflow instance is inside a subflow. Add the
                                    // containing subflow to the stack to mark
<span class="cstat-no" title="statement not covered" >                                    changedSubflowStack.push(changed[node.id].z);</span>
<span class="cstat-no" title="statement not covered" >                                    delete changed[node.id];</span>
                                }
                            }
                        }
                    }
                }
            }
        }
&nbsp;
<span class="cstat-no" title="statement not covered" >        var diff = {</span>
            added:Object.keys(added),
            changed:Object.keys(changed),
            removed:Object.keys(removed),
            rewired:Object.keys(wiringChanged),
            linked:[]
        }
&nbsp;
        // Traverse the links of all modified nodes to mark the connected nodes
<span class="cstat-no" title="statement not covered" >        var modifiedNodes = diff.added.concat(diff.changed).concat(diff.removed).concat(diff.rewired);</span>
<span class="cstat-no" title="statement not covered" >        var visited = {};</span>
<span class="cstat-no" title="statement not covered" >        while (modifiedNodes.length &gt; 0) {</span>
<span class="cstat-no" title="statement not covered" >            node = modifiedNodes.pop();</span>
<span class="cstat-no" title="statement not covered" >            if (!visited[node]) {</span>
<span class="cstat-no" title="statement not covered" >                visited[node] = true;</span>
<span class="cstat-no" title="statement not covered" >                if (linkMap[node]) {</span>
<span class="cstat-no" title="statement not covered" >                    if (!changed[node] &amp;&amp; !added[node] &amp;&amp; !removed[node] &amp;&amp; !wiringChanged[node]) {</span>
<span class="cstat-no" title="statement not covered" >                        diff.linked.push(node);</span>
                    }
<span class="cstat-no" title="statement not covered" >                    modifiedNodes = modifiedNodes.concat(linkMap[node]);</span>
                }
            }
        }
        // for (id in newConfig.allNodes) {
        //     console.log(
        //         (added[id]?"+":(changed[id]?"!":" "))+(wiringChanged[id]?"w":" ")+(diff.linked.indexOf(id)!==-1?"~":" "),
        //         id,
        //         newConfig.allNodes[id].type,
        //         newConfig.allNodes[id].name||newConfig.allNodes[id].label||""
        //     );
        // }
        // for (id in removed) {
        //     console.log(
        //         "- "+(diff.linked.indexOf(id)!==-1?"~":" "),
        //         id,
        //         oldConfig.allNodes[id].type,
        //         oldConfig.allNodes[id].name||oldConfig.allNodes[id].label||""
        //     );
        // }
&nbsp;
<span class="cstat-no" title="statement not covered" >        return diff;</span>
    }
}
&nbsp;
&nbsp;</pre></td></tr>
</table></pre>
</div>
<div class="footer">
    <div class="meta">Generated by <a href="https://github.com/kaizhu256/node-utility2" target="_blank">utility2</a> at Tue Apr 11 2017 17:25:15 GMT+0000 (UTC)</div>
</div>
</body>
</html>


<!doctype html>
<html lang="en">
<head>
    <title>Code coverage report for node-npmtest-node-red/node-red/red/runtime/nodes/registry/</title>
    <meta charset="utf-8">
    <style>
        body, html {
            margin:0; padding: 0;
        }
        body {
            font-family: Arial, Helvetica;
            font-size: 10pt;
        }
        div.header, div.footer {
            background: #eee;
            padding: 1em;
        }
        div.header {
            height: 160px;
            padding: 0 1em 0 1em;
            z-index: 100;
            position: fixed;
            top: 0;
            border-bottom: 1px solid #666;
            width: 100%;
        }
        div.footer {
            border-top: 1px solid #666;
        }
        div.body {
            margin-top: 170px;
        }
        div.meta {
            font-size: 90%;
            text-align: center;
        }
        h1, h2, h3 {
            font-weight: normal;
        }
        h1 {
            font-size: 12pt;
        }
        h2 {
            font-size: 10pt;
        }
        pre {
            font-family: Menlo, Monaco, Consolas, Courier New, monospace;
            margin: 0;
            padding: 0;
            font-size: 14px;
            tab-size: 2;
        }

        div.path { font-size: 110%; }
        div.path a:link, div.path a:visited { color: #000; }
        table.coverage { border-collapse: collapse; margin:0; padding: 0 }

        table.coverage td {
            margin: 0;
            padding: 0;
            color: #111;
            vertical-align: top;
        }
        table.coverage td.line-count {
            width: 50px;
            text-align: right;
            padding-right: 5px;
        }
        table.coverage td.line-coverage {
            color: #777 !important;
            text-align: right;
            border-left: 1px solid #666;
            border-right: 1px solid #666;
        }

        table.coverage td.text {
        }

        table.coverage td span.cline-any {
            display: inline-block;
            padding: 0 5px;
            width: 40px;
        }
        table.coverage td span.cline-neutral {
            background: #eee;
        }
        table.coverage td span.cline-yes {
            background: #b5d592;
            color: #999;
        }
        table.coverage td span.cline-no {
            background: #fc8c84;
        }

        .cstat-yes { color: #111; }
        .cstat-no { background: #fc8c84; color: #111; }
        .fstat-no { background: #ffc520; color: #111 !important; }
        .cbranch-no { background:  yellow !important; color: #111; }

        .cstat-skip { background: #ddd; color: #111; }
        .fstat-skip { background: #ddd; color: #111 !important; }
        .cbranch-skip { background: #ddd !important; color: #111; }

        .missing-if-branch {
            display: inline-block;
            margin-right: 10px;
            position: relative;
            padding: 0 4px;
            background: black;
            color: yellow;
        }

        .skip-if-branch {
            display: none;
            margin-right: 10px;
            position: relative;
            padding: 0 4px;
            background: #ccc;
            color: white;
        }

        .missing-if-branch .typ, .skip-if-branch .typ {
            color: inherit !important;
        }

        .entity, .metric { font-weight: bold; }
        .metric { display: inline-block; border: 1px solid #333; padding: 0.3em; background: white; }
        .metric small { font-size: 80%; font-weight: normal; color: #666; }

        div.coverage-summary table { border-collapse: collapse; margin: 3em; font-size: 110%; }
        div.coverage-summary td, div.coverage-summary table  th { margin: 0; padding: 0.25em 1em; border-top: 1px solid #666; border-bottom: 1px solid #666; }
        div.coverage-summary th { text-align: left; border: 1px solid #666; background: #eee; font-weight: normal; }
        div.coverage-summary th.file { border-right: none !important; }
        div.coverage-summary th.pic { border-left: none !important; text-align: right; }
        div.coverage-summary th.pct { border-right: none !important; }
        div.coverage-summary th.abs { border-left: none !important; text-align: right; }
        div.coverage-summary td.pct { text-align: right; border-left: 1px solid #666; }
        div.coverage-summary td.abs { text-align: right; font-size: 90%; color: #444; border-right: 1px solid #666; }
        div.coverage-summary td.file { text-align: right; border-left: 1px solid #666; white-space: nowrap;  }
        div.coverage-summary td.pic { min-width: 120px !important;  }
        div.coverage-summary a:link { color: #000; }
        div.coverage-summary a:visited { color: #333; }
        div.coverage-summary tfoot td { border-top: 1px solid #666; }

        div.coverage-summary .yui3-datatable-sort-indicator, div.coverage-summary .dummy-sort-indicator {
            height: 10px;
            width: 7px;
            display: inline-block;
            margin-left: 0.5em;
        }
        div.coverage-summary .yui3-datatable-sort-indicator {
            background: no-repeat scroll 0 0 transparent;
        }
        div.coverage-summary .yui3-datatable-sorted .yui3-datatable-sort-indicator {
            background-position: 0 -20px;
        }
        div.coverage-summary .yui3-datatable-sorted-desc .yui3-datatable-sort-indicator {
            background-position: 0 -10px;
        }

        .high { background: #b5d592 !important; }
        .medium { background: #ffe87c !important; }
        .low { background: #fc8c84 !important; }

        span.cover-fill, span.cover-empty {
            display:inline-block;
            border:1px solid #444;
            background: white;
            height: 12px;
        }
        span.cover-fill {
            background: #ccc;
            border-right: 1px solid #444;
        }
        span.cover-empty {
            background: white;
            border-left: none;
        }
        span.cover-full {
            border-right: none !important;
        }
        pre.prettyprint {
            border: none !important;
            padding: 0 !important;
            margin: 0 !important;
        }
        .com { color: #999 !important; }
        .ignore-none { color: #999; font-weight: normal; }

    </style>
</head>
<body>
<div class="header low">
    <h1 style="font-weight: bold;">
        <a href="https://github.com/npmtest/node-npmtest-node-red">npmtest-node-red (v0.0.1)</a>
    </h1>
    <h1>Code coverage report for <span class="entity">node-npmtest-node-red/node-red/red/runtime/nodes/registry/</span></h1>
    <h2>
        
        Statements: <span class="metric">14.09% <small>(113 / 802)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        
        Branches: <span class="metric">4.5% <small>(15 / 333)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        
        Functions: <span class="metric">0% <small>(0 / 97)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        
        Lines: <span class="metric">14.13% <small>(113 / 800)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        Ignored: <span class="metric">13 branches</span> &nbsp;&nbsp;&nbsp;&nbsp;
    </h2>
    <div class="path"><a href="../../../../../../index.html">All files</a> &#187; node-npmtest-node-red/node-red/red/runtime/nodes/registry/</div>
</div>
<div class="body">
<div class="coverage-summary">
<table>
<thead>
<tr>
   <th data-col="file" data-fmt="html" data-html="true" class="file">File</th>
   <th data-col="pic" data-type="number" data-fmt="html" data-html="true" class="pic"></th>
   <th data-col="statements" data-type="number" data-fmt="pct" class="pct">Statements</th>
   <th data-col="statements_raw" data-type="number" data-fmt="html" class="abs"></th>
   <th data-col="branches" data-type="number" data-fmt="pct" class="pct">Branches</th>
   <th data-col="branches_raw" data-type="number" data-fmt="html" class="abs"></th>
   <th data-col="functions" data-type="number" data-fmt="pct" class="pct">Functions</th>
   <th data-col="functions_raw" data-type="number" data-fmt="html" class="abs"></th>
   <th data-col="lines" data-type="number" data-fmt="pct" class="pct">Lines</th>
   <th data-col="lines_raw" data-type="number" data-fmt="html" class="abs"></th>
</tr>
</thead>
<tbody><tr>
	<td class="file medium" data-value="deprecated.js"><a href="deprecated.js.html">deprecated.js</a></td>
	<td data-value="66.67" class="pic medium"><span class="cover-fill" style="width: 66px;"></span><span class="cover-empty" style="width:34px;"></span></td>
	<td data-value="66.67" class="pct medium">66.67%</td>
	<td data-value="3" class="abs medium">(2&nbsp;/&nbsp;3)</td>
	<td data-value="100" class="pct high">100%</td>
	<td data-value="0" class="abs high">(0&nbsp;/&nbsp;0)</td>
	<td data-value="0" class="pct low">0%</td>
	<td data-value="1" class="abs low">(0&nbsp;/&nbsp;1)</td>
	<td data-value="66.67" class="pct medium">66.67%</td>
	<td data-value="3" class="abs medium">(2&nbsp;/&nbsp;3)</td>
	</tr>

<tr>
	<td class="file low" data-value="index.js"><a href="index.js.html">index.js</a></td>
	<td data-value="48.15" class="pic low"><span class="cover-fill" style="width: 48px;"></span><span class="cover-empty" style="width:52px;"></span></td>
	<td data-value="48.15" class="pct low">48.15%</td>
	<td data-value="27" class="abs low">(13&nbsp;/&nbsp;27)</td>
	<td data-value="0" class="pct low">0%</td>
	<td data-value="2" class="abs low">(0&nbsp;/&nbsp;2)</td>
	<td data-value="0" class="pct low">0%</td>
	<td data-value="7" class="abs low">(0&nbsp;/&nbsp;7)</td>
	<td data-value="48.15" class="pct low">48.15%</td>
	<td data-value="27" class="abs low">(13&nbsp;/&nbsp;27)</td>
	</tr>

<tr>
	<td class="file low" data-value="installer.js"><a href="installer.js.html">installer.js</a></td>
	<td data-value="18.75" class="pic low"><span class="cover-fill" style="width: 18px;"></span><span class="cover-empty" style="width:82px;"></span></td>
	<td data-value="18.75" class="pct low">18.75%</td>
	<td data-value="112" class="abs low">(21&nbsp;/&nbsp;112)</td>
	<td data-value="4.76" class="pct low">4.76%</td>
	<td data-value="42" class="abs low">(2&nbsp;/&nbsp;42)</td>
	<td data-value="0" class="pct low">0%</td>
	<td data-value="15" class="abs low">(0&nbsp;/&nbsp;15)</td>
	<td data-value="18.75" class="pct low">18.75%</td>
	<td data-value="112" class="abs low">(21&nbsp;/&nbsp;112)</td>
	</tr>

<tr>
	<td class="file low" data-value="loader.js"><a href="loader.js.html">loader.js</a></td>
	<td data-value="9.48" class="pic low"><span class="cover-fill" style="width: 9px;"></span><span class="cover-empty" style="width:91px;"></span></td>
	<td data-value="9.48" class="pct low">9.48%</td>
	<td data-value="211" class="abs low">(20&nbsp;/&nbsp;211)</td>
	<td data-value="2.38" class="pct low">2.38%</td>
	<td data-value="84" class="abs low">(2&nbsp;/&nbsp;84)</td>
	<td data-value="0" class="pct low">0%</td>
	<td data-value="27" class="abs low">(0&nbsp;/&nbsp;27)</td>
	<td data-value="9.48" class="pct low">9.48%</td>
	<td data-value="211" class="abs low">(20&nbsp;/&nbsp;211)</td>
	</tr>

<tr>
	<td class="file low" data-value="localfilesystem.js"><a href="localfilesystem.js.html">localfilesystem.js</a></td>
	<td data-value="11.76" class="pic low"><span class="cover-fill" style="width: 11px;"></span><span class="cover-empty" style="width:89px;"></span></td>
	<td data-value="11.76" class="pct low">11.76%</td>
	<td data-value="153" class="abs low">(18&nbsp;/&nbsp;153)</td>
	<td data-value="1.54" class="pct low">1.54%</td>
	<td data-value="65" class="abs low">(1&nbsp;/&nbsp;65)</td>
	<td data-value="0" class="pct low">0%</td>
	<td data-value="16" class="abs low">(0&nbsp;/&nbsp;16)</td>
	<td data-value="11.84" class="pct low">11.84%</td>
	<td data-value="152" class="abs low">(18&nbsp;/&nbsp;152)</td>
	</tr>

<tr>
	<td class="file low" data-value="registry.js"><a href="registry.js.html">registry.js</a></td>
	<td data-value="13.18" class="pic low"><span class="cover-fill" style="width: 13px;"></span><span class="cover-empty" style="width:87px;"></span></td>
	<td data-value="13.18" class="pct low">13.18%</td>
	<td data-value="296" class="abs low">(39&nbsp;/&nbsp;296)</td>
	<td data-value="7.14" class="pct low">7.14%</td>
	<td data-value="140" class="abs low">(10&nbsp;/&nbsp;140)</td>
	<td data-value="0" class="pct low">0%</td>
	<td data-value="31" class="abs low">(0&nbsp;/&nbsp;31)</td>
	<td data-value="13.22" class="pct low">13.22%</td>
	<td data-value="295" class="abs low">(39&nbsp;/&nbsp;295)</td>
	</tr>

</tbody>
</table>
</div></div>
<div class="footer">
    <div class="meta">Generated by <a href="https://github.com/kaizhu256/node-utility2" target="_blank">utility2</a> at Tue Apr 11 2017 17:25:15 GMT+0000 (UTC)</div>
</div>
</body>
</html>


<!doctype html>
<html lang="en">
<head>
    <title>Code coverage report for node-npmtest-node-red/node-red/red/runtime/nodes/registry/deprecated.js</title>
    <meta charset="utf-8">
    <style>
        body, html {
            margin:0; padding: 0;
        }
        body {
            font-family: Arial, Helvetica;
            font-size: 10pt;
        }
        div.header, div.footer {
            background: #eee;
            padding: 1em;
        }
        div.header {
            height: 160px;
            padding: 0 1em 0 1em;
            z-index: 100;
            position: fixed;
            top: 0;
            border-bottom: 1px solid #666;
            width: 100%;
        }
        div.footer {
            border-top: 1px solid #666;
        }
        div.body {
            margin-top: 170px;
        }
        div.meta {
            font-size: 90%;
            text-align: center;
        }
        h1, h2, h3 {
            font-weight: normal;
        }
        h1 {
            font-size: 12pt;
        }
        h2 {
            font-size: 10pt;
        }
        pre {
            font-family: Menlo, Monaco, Consolas, Courier New, monospace;
            margin: 0;
            padding: 0;
            font-size: 14px;
            tab-size: 2;
        }

        div.path { font-size: 110%; }
        div.path a:link, div.path a:visited { color: #000; }
        table.coverage { border-collapse: collapse; margin:0; padding: 0 }

        table.coverage td {
            margin: 0;
            padding: 0;
            color: #111;
            vertical-align: top;
        }
        table.coverage td.line-count {
            width: 50px;
            text-align: right;
            padding-right: 5px;
        }
        table.coverage td.line-coverage {
            color: #777 !important;
            text-align: right;
            border-left: 1px solid #666;
            border-right: 1px solid #666;
        }

        table.coverage td.text {
        }

        table.coverage td span.cline-any {
            display: inline-block;
            padding: 0 5px;
            width: 40px;
        }
        table.coverage td span.cline-neutral {
            background: #eee;
        }
        table.coverage td span.cline-yes {
            background: #b5d592;
            color: #999;
        }
        table.coverage td span.cline-no {
            background: #fc8c84;
        }

        .cstat-yes { color: #111; }
        .cstat-no { background: #fc8c84; color: #111; }
        .fstat-no { background: #ffc520; color: #111 !important; }
        .cbranch-no { background:  yellow !important; color: #111; }

        .cstat-skip { background: #ddd; color: #111; }
        .fstat-skip { background: #ddd; color: #111 !important; }
        .cbranch-skip { background: #ddd !important; color: #111; }

        .missing-if-branch {
            display: inline-block;
            margin-right: 10px;
            position: relative;
            padding: 0 4px;
            background: black;
            color: yellow;
        }

        .skip-if-branch {
            display: none;
            margin-right: 10px;
            position: relative;
            padding: 0 4px;
            background: #ccc;
            color: white;
        }

        .missing-if-branch .typ, .skip-if-branch .typ {
            color: inherit !important;
        }

        .entity, .metric { font-weight: bold; }
        .metric { display: inline-block; border: 1px solid #333; padding: 0.3em; background: white; }
        .metric small { font-size: 80%; font-weight: normal; color: #666; }

        div.coverage-summary table { border-collapse: collapse; margin: 3em; font-size: 110%; }
        div.coverage-summary td, div.coverage-summary table  th { margin: 0; padding: 0.25em 1em; border-top: 1px solid #666; border-bottom: 1px solid #666; }
        div.coverage-summary th { text-align: left; border: 1px solid #666; background: #eee; font-weight: normal; }
        div.coverage-summary th.file { border-right: none !important; }
        div.coverage-summary th.pic { border-left: none !important; text-align: right; }
        div.coverage-summary th.pct { border-right: none !important; }
        div.coverage-summary th.abs { border-left: none !important; text-align: right; }
        div.coverage-summary td.pct { text-align: right; border-left: 1px solid #666; }
        div.coverage-summary td.abs { text-align: right; font-size: 90%; color: #444; border-right: 1px solid #666; }
        div.coverage-summary td.file { text-align: right; border-left: 1px solid #666; white-space: nowrap;  }
        div.coverage-summary td.pic { min-width: 120px !important;  }
        div.coverage-summary a:link { color: #000; }
        div.coverage-summary a:visited { color: #333; }
        div.coverage-summary tfoot td { border-top: 1px solid #666; }

        div.coverage-summary .yui3-datatable-sort-indicator, div.coverage-summary .dummy-sort-indicator {
            height: 10px;
            width: 7px;
            display: inline-block;
            margin-left: 0.5em;
        }
        div.coverage-summary .yui3-datatable-sort-indicator {
            background: no-repeat scroll 0 0 transparent;
        }
        div.coverage-summary .yui3-datatable-sorted .yui3-datatable-sort-indicator {
            background-position: 0 -20px;
        }
        div.coverage-summary .yui3-datatable-sorted-desc .yui3-datatable-sort-indicator {
            background-position: 0 -10px;
        }

        .high { background: #b5d592 !important; }
        .medium { background: #ffe87c !important; }
        .low { background: #fc8c84 !important; }

        span.cover-fill, span.cover-empty {
            display:inline-block;
            border:1px solid #444;
            background: white;
            height: 12px;
        }
        span.cover-fill {
            background: #ccc;
            border-right: 1px solid #444;
        }
        span.cover-empty {
            background: white;
            border-left: none;
        }
        span.cover-full {
            border-right: none !important;
        }
        pre.prettyprint {
            border: none !important;
            padding: 0 !important;
            margin: 0 !important;
        }
        .com { color: #999 !important; }
        .ignore-none { color: #999; font-weight: normal; }

    </style>
</head>
<body>
<div class="header medium">
    <h1 style="font-weight: bold;">
        <a href="https://github.com/npmtest/node-npmtest-node-red">npmtest-node-red (v0.0.1)</a>
    </h1>
    <h1>Code coverage report for <span class="entity">node-npmtest-node-red/node-red/red/runtime/nodes/registry/deprecated.js</span></h1>
    <h2>
        
        Statements: <span class="metric">66.67% <small>(2 / 3)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        
        Branches: <span class="metric">100% <small>(0 / 0)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        
        Functions: <span class="metric">0% <small>(0 / 1)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        
        Lines: <span class="metric">66.67% <small>(2 / 3)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        Ignored: <span class="metric"><span class="ignore-none">none</span></span> &nbsp;&nbsp;&nbsp;&nbsp;
    </h2>
    <div class="path"><a href="../../../../../../index.html">All files</a> &#187; <a href="index.html">node-npmtest-node-red/node-red/red/runtime/nodes/registry/</a> &#187; deprecated.js</div>
</div>
<div class="body">
<pre><table class="coverage">
<tr><td class="line-count">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51</td><td class="line-coverage"><span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span></td><td class="text"><pre class="prettyprint lang-js">/**
 * Copyright JS Foundation and other contributors, http://js.foundation
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 **/
 
var nodes = {
    "irc in":     {module:"node-red-node-irc"},
    "irc out":    {module:"node-red-node-irc"},
    "irc-server": {module:"node-red-node-irc"},
    
    "arduino in":    {module:"node-red-node-arduino"},
    "arduino out":   {module:"node-red-node-arduino"},
    "arduino-board": {module:"node-red-node-arduino"},
    
    "redis out": {module:"node-red-node-redis"},
    
    "mongodb": {module:"node-red-node-mongodb"},
    "mongodb out": {module:"node-red-node-mongodb"},
    
    "serial in": {module:"node-red-node-serialport"},
    "serial out": {module:"node-red-node-serialport"},
    "serial-port": {module:"node-red-node-serialport"},
    
    "twitter-credentials": {module:"node-red-node-twitter"},
    "twitter in": {module:"node-red-node-twitter"},
    "twitter out": {module:"node-red-node-twitter"},
    
    "e-mail": {module:"node-red-node-email"},
    "e-mail in": {module:"node-red-node-email"},
    
    "feedparse": {module:"node-red-node-feedparser"}
}
&nbsp;
module.exports = {
    get: <span class="fstat-no" title="function not covered" >function(id) {</span>
<span class="cstat-no" title="statement not covered" >        return nodes[id];</span>
    }
}
&nbsp;
&nbsp;</pre></td></tr>
</table></pre>
</div>
<div class="footer">
    <div class="meta">Generated by <a href="https://github.com/kaizhu256/node-utility2" target="_blank">utility2</a> at Tue Apr 11 2017 17:25:15 GMT+0000 (UTC)</div>
</div>
</body>
</html>


<!doctype html>
<html lang="en">
<head>
    <title>Code coverage report for node-npmtest-node-red/node-red/red/runtime/nodes/registry/index.js</title>
    <meta charset="utf-8">
    <style>
        body, html {
            margin:0; padding: 0;
        }
        body {
            font-family: Arial, Helvetica;
            font-size: 10pt;
        }
        div.header, div.footer {
            background: #eee;
            padding: 1em;
        }
        div.header {
            height: 160px;
            padding: 0 1em 0 1em;
            z-index: 100;
            position: fixed;
            top: 0;
            border-bottom: 1px solid #666;
            width: 100%;
        }
        div.footer {
            border-top: 1px solid #666;
        }
        div.body {
            margin-top: 170px;
        }
        div.meta {
            font-size: 90%;
            text-align: center;
        }
        h1, h2, h3 {
            font-weight: normal;
        }
        h1 {
            font-size: 12pt;
        }
        h2 {
            font-size: 10pt;
        }
        pre {
            font-family: Menlo, Monaco, Consolas, Courier New, monospace;
            margin: 0;
            padding: 0;
            font-size: 14px;
            tab-size: 2;
        }

        div.path { font-size: 110%; }
        div.path a:link, div.path a:visited { color: #000; }
        table.coverage { border-collapse: collapse; margin:0; padding: 0 }

        table.coverage td {
            margin: 0;
            padding: 0;
            color: #111;
            vertical-align: top;
        }
        table.coverage td.line-count {
            width: 50px;
            text-align: right;
            padding-right: 5px;
        }
        table.coverage td.line-coverage {
            color: #777 !important;
            text-align: right;
            border-left: 1px solid #666;
            border-right: 1px solid #666;
        }

        table.coverage td.text {
        }

        table.coverage td span.cline-any {
            display: inline-block;
            padding: 0 5px;
            width: 40px;
        }
        table.coverage td span.cline-neutral {
            background: #eee;
        }
        table.coverage td span.cline-yes {
            background: #b5d592;
            color: #999;
        }
        table.coverage td span.cline-no {
            background: #fc8c84;
        }

        .cstat-yes { color: #111; }
        .cstat-no { background: #fc8c84; color: #111; }
        .fstat-no { background: #ffc520; color: #111 !important; }
        .cbranch-no { background:  yellow !important; color: #111; }

        .cstat-skip { background: #ddd; color: #111; }
        .fstat-skip { background: #ddd; color: #111 !important; }
        .cbranch-skip { background: #ddd !important; color: #111; }

        .missing-if-branch {
            display: inline-block;
            margin-right: 10px;
            position: relative;
            padding: 0 4px;
            background: black;
            color: yellow;
        }

        .skip-if-branch {
            display: none;
            margin-right: 10px;
            position: relative;
            padding: 0 4px;
            background: #ccc;
            color: white;
        }

        .missing-if-branch .typ, .skip-if-branch .typ {
            color: inherit !important;
        }

        .entity, .metric { font-weight: bold; }
        .metric { display: inline-block; border: 1px solid #333; padding: 0.3em; background: white; }
        .metric small { font-size: 80%; font-weight: normal; color: #666; }

        div.coverage-summary table { border-collapse: collapse; margin: 3em; font-size: 110%; }
        div.coverage-summary td, div.coverage-summary table  th { margin: 0; padding: 0.25em 1em; border-top: 1px solid #666; border-bottom: 1px solid #666; }
        div.coverage-summary th { text-align: left; border: 1px solid #666; background: #eee; font-weight: normal; }
        div.coverage-summary th.file { border-right: none !important; }
        div.coverage-summary th.pic { border-left: none !important; text-align: right; }
        div.coverage-summary th.pct { border-right: none !important; }
        div.coverage-summary th.abs { border-left: none !important; text-align: right; }
        div.coverage-summary td.pct { text-align: right; border-left: 1px solid #666; }
        div.coverage-summary td.abs { text-align: right; font-size: 90%; color: #444; border-right: 1px solid #666; }
        div.coverage-summary td.file { text-align: right; border-left: 1px solid #666; white-space: nowrap;  }
        div.coverage-summary td.pic { min-width: 120px !important;  }
        div.coverage-summary a:link { color: #000; }
        div.coverage-summary a:visited { color: #333; }
        div.coverage-summary tfoot td { border-top: 1px solid #666; }

        div.coverage-summary .yui3-datatable-sort-indicator, div.coverage-summary .dummy-sort-indicator {
            height: 10px;
            width: 7px;
            display: inline-block;
            margin-left: 0.5em;
        }
        div.coverage-summary .yui3-datatable-sort-indicator {
            background: no-repeat scroll 0 0 transparent;
        }
        div.coverage-summary .yui3-datatable-sorted .yui3-datatable-sort-indicator {
            background-position: 0 -20px;
        }
        div.coverage-summary .yui3-datatable-sorted-desc .yui3-datatable-sort-indicator {
            background-position: 0 -10px;
        }

        .high { background: #b5d592 !important; }
        .medium { background: #ffe87c !important; }
        .low { background: #fc8c84 !important; }

        span.cover-fill, span.cover-empty {
            display:inline-block;
            border:1px solid #444;
            background: white;
            height: 12px;
        }
        span.cover-fill {
            background: #ccc;
            border-right: 1px solid #444;
        }
        span.cover-empty {
            background: white;
            border-left: none;
        }
        span.cover-full {
            border-right: none !important;
        }
        pre.prettyprint {
            border: none !important;
            padding: 0 !important;
            margin: 0 !important;
        }
        .com { color: #999 !important; }
        .ignore-none { color: #999; font-weight: normal; }

    </style>
</head>
<body>
<div class="header low">
    <h1 style="font-weight: bold;">
        <a href="https://github.com/npmtest/node-npmtest-node-red">npmtest-node-red (v0.0.1)</a>
    </h1>
    <h1>Code coverage report for <span class="entity">node-npmtest-node-red/node-red/red/runtime/nodes/registry/index.js</span></h1>
    <h2>
        
        Statements: <span class="metric">48.15% <small>(13 / 27)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        
        Branches: <span class="metric">0% <small>(0 / 2)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        
        Functions: <span class="metric">0% <small>(0 / 7)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        
        Lines: <span class="metric">48.15% <small>(13 / 27)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        Ignored: <span class="metric"><span class="ignore-none">none</span></span> &nbsp;&nbsp;&nbsp;&nbsp;
    </h2>
    <div class="path"><a href="../../../../../../index.html">All files</a> &#187; <a href="index.html">node-npmtest-node-red/node-red/red/runtime/nodes/registry/</a> &#187; index.js</div>
</div>
<div class="body">
<pre><table class="coverage">
<tr><td class="line-count">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88</td><td class="line-coverage"><span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span></td><td class="text"><pre class="prettyprint lang-js">/**
 * Copyright JS Foundation and other contributors, http://js.foundation
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 **/
&nbsp;
var when = require("when");
var fs = require("fs");
var path = require("path");
&nbsp;
var events = require("../../events");
var registry = require("./registry");
var loader = require("./loader");
var installer = require("./installer");
&nbsp;
var settings;
&nbsp;
<span class="fstat-no" title="function not covered" >function init(runtime) {</span>
<span class="cstat-no" title="statement not covered" >    settings = runtime.settings;</span>
<span class="cstat-no" title="statement not covered" >    installer.init(runtime.settings);</span>
<span class="cstat-no" title="statement not covered" >    loader.init(runtime);</span>
<span class="cstat-no" title="statement not covered" >    registry.init(settings,loader);</span>
}
&nbsp;
<span class="fstat-no" title="function not covered" >function load() {</span>
<span class="cstat-no" title="statement not covered" >    registry.load();</span>
<span class="cstat-no" title="statement not covered" >    return installer.checkPrereq().then(loader.load);</span>
}
&nbsp;
<span class="fstat-no" title="function not covered" >function addModule(module) {</span>
<span class="cstat-no" title="statement not covered" >    return loader.addModule(module).then(<span class="fstat-no" title="function not covered" >function() {</span></span>
<span class="cstat-no" title="statement not covered" >        return registry.getModuleInfo(module);</span>
    });
}
&nbsp;
<span class="fstat-no" title="function not covered" >function enableNodeSet(typeOrId) {</span>
<span class="cstat-no" title="statement not covered" >    return registry.enableNodeSet(typeOrId).then(<span class="fstat-no" title="function not covered" >function() {</span></span>
<span class="cstat-no" title="statement not covered" >        var nodeSet = registry.getNodeInfo(typeOrId);</span>
<span class="cstat-no" title="statement not covered" >        if (!nodeSet.loaded) {</span>
<span class="cstat-no" title="statement not covered" >            return loader.loadNodeSet(registry.getFullNodeInfo(typeOrId)).then(<span class="fstat-no" title="function not covered" >function() {</span></span>
<span class="cstat-no" title="statement not covered" >                return registry.getNodeInfo(typeOrId);</span>
            });
        }
<span class="cstat-no" title="statement not covered" >        return when.resolve(nodeSet);</span>
    });
}
&nbsp;
module.exports = {
    init:init,
    load:load,
    clear: registry.clear,
    registerType: registry.registerNodeConstructor,
&nbsp;
    get: registry.getNodeConstructor,
    getNodeInfo: registry.getNodeInfo,
    getNodeList: registry.getNodeList,
&nbsp;
    getModuleInfo: registry.getModuleInfo,
    getModuleList: registry.getModuleList,
&nbsp;
    getNodeConfigs: registry.getAllNodeConfigs,
    getNodeConfig: registry.getNodeConfig,
&nbsp;
    enableNode: enableNodeSet,
    disableNode: registry.disableNodeSet,
&nbsp;
    addModule: addModule,
    removeModule: registry.removeModule,
&nbsp;
    installModule: installer.installModule,
    uninstallModule: installer.uninstallModule,
&nbsp;
    cleanModuleList: registry.cleanModuleList,
&nbsp;
    paletteEditorEnabled: installer.paletteEditorEnabled
};
&nbsp;
&nbsp;</pre></td></tr>
</table></pre>
</div>
<div class="footer">
    <div class="meta">Generated by <a href="https://github.com/kaizhu256/node-utility2" target="_blank">utility2</a> at Tue Apr 11 2017 17:25:15 GMT+0000 (UTC)</div>
</div>
</body>
</html>


<!doctype html>
<html lang="en">
<head>
    <title>Code coverage report for node-npmtest-node-red/node-red/red/runtime/nodes/registry/installer.js</title>
    <meta charset="utf-8">
    <style>
        body, html {
            margin:0; padding: 0;
        }
        body {
            font-family: Arial, Helvetica;
            font-size: 10pt;
        }
        div.header, div.footer {
            background: #eee;
            padding: 1em;
        }
        div.header {
            height: 160px;
            padding: 0 1em 0 1em;
            z-index: 100;
            position: fixed;
            top: 0;
            border-bottom: 1px solid #666;
            width: 100%;
        }
        div.footer {
            border-top: 1px solid #666;
        }
        div.body {
            margin-top: 170px;
        }
        div.meta {
            font-size: 90%;
            text-align: center;
        }
        h1, h2, h3 {
            font-weight: normal;
        }
        h1 {
            font-size: 12pt;
        }
        h2 {
            font-size: 10pt;
        }
        pre {
            font-family: Menlo, Monaco, Consolas, Courier New, monospace;
            margin: 0;
            padding: 0;
            font-size: 14px;
            tab-size: 2;
        }

        div.path { font-size: 110%; }
        div.path a:link, div.path a:visited { color: #000; }
        table.coverage { border-collapse: collapse; margin:0; padding: 0 }

        table.coverage td {
            margin: 0;
            padding: 0;
            color: #111;
            vertical-align: top;
        }
        table.coverage td.line-count {
            width: 50px;
            text-align: right;
            padding-right: 5px;
        }
        table.coverage td.line-coverage {
            color: #777 !important;
            text-align: right;
            border-left: 1px solid #666;
            border-right: 1px solid #666;
        }

        table.coverage td.text {
        }

        table.coverage td span.cline-any {
            display: inline-block;
            padding: 0 5px;
            width: 40px;
        }
        table.coverage td span.cline-neutral {
            background: #eee;
        }
        table.coverage td span.cline-yes {
            background: #b5d592;
            color: #999;
        }
        table.coverage td span.cline-no {
            background: #fc8c84;
        }

        .cstat-yes { color: #111; }
        .cstat-no { background: #fc8c84; color: #111; }
        .fstat-no { background: #ffc520; color: #111 !important; }
        .cbranch-no { background:  yellow !important; color: #111; }

        .cstat-skip { background: #ddd; color: #111; }
        .fstat-skip { background: #ddd; color: #111 !important; }
        .cbranch-skip { background: #ddd !important; color: #111; }

        .missing-if-branch {
            display: inline-block;
            margin-right: 10px;
            position: relative;
            padding: 0 4px;
            background: black;
            color: yellow;
        }

        .skip-if-branch {
            display: none;
            margin-right: 10px;
            position: relative;
            padding: 0 4px;
            background: #ccc;
            color: white;
        }

        .missing-if-branch .typ, .skip-if-branch .typ {
            color: inherit !important;
        }

        .entity, .metric { font-weight: bold; }
        .metric { display: inline-block; border: 1px solid #333; padding: 0.3em; background: white; }
        .metric small { font-size: 80%; font-weight: normal; color: #666; }

        div.coverage-summary table { border-collapse: collapse; margin: 3em; font-size: 110%; }
        div.coverage-summary td, div.coverage-summary table  th { margin: 0; padding: 0.25em 1em; border-top: 1px solid #666; border-bottom: 1px solid #666; }
        div.coverage-summary th { text-align: left; border: 1px solid #666; background: #eee; font-weight: normal; }
        div.coverage-summary th.file { border-right: none !important; }
        div.coverage-summary th.pic { border-left: none !important; text-align: right; }
        div.coverage-summary th.pct { border-right: none !important; }
        div.coverage-summary th.abs { border-left: none !important; text-align: right; }
        div.coverage-summary td.pct { text-align: right; border-left: 1px solid #666; }
        div.coverage-summary td.abs { text-align: right; font-size: 90%; color: #444; border-right: 1px solid #666; }
        div.coverage-summary td.file { text-align: right; border-left: 1px solid #666; white-space: nowrap;  }
        div.coverage-summary td.pic { min-width: 120px !important;  }
        div.coverage-summary a:link { color: #000; }
        div.coverage-summary a:visited { color: #333; }
        div.coverage-summary tfoot td { border-top: 1px solid #666; }

        div.coverage-summary .yui3-datatable-sort-indicator, div.coverage-summary .dummy-sort-indicator {
            height: 10px;
            width: 7px;
            display: inline-block;
            margin-left: 0.5em;
        }
        div.coverage-summary .yui3-datatable-sort-indicator {
            background: no-repeat scroll 0 0 transparent;
        }
        div.coverage-summary .yui3-datatable-sorted .yui3-datatable-sort-indicator {
            background-position: 0 -20px;
        }
        div.coverage-summary .yui3-datatable-sorted-desc .yui3-datatable-sort-indicator {
            background-position: 0 -10px;
        }

        .high { background: #b5d592 !important; }
        .medium { background: #ffe87c !important; }
        .low { background: #fc8c84 !important; }

        span.cover-fill, span.cover-empty {
            display:inline-block;
            border:1px solid #444;
            background: white;
            height: 12px;
        }
        span.cover-fill {
            background: #ccc;
            border-right: 1px solid #444;
        }
        span.cover-empty {
            background: white;
            border-left: none;
        }
        span.cover-full {
            border-right: none !important;
        }
        pre.prettyprint {
            border: none !important;
            padding: 0 !important;
            margin: 0 !important;
        }
        .com { color: #999 !important; }
        .ignore-none { color: #999; font-weight: normal; }

    </style>
</head>
<body>
<div class="header low">
    <h1 style="font-weight: bold;">
        <a href="https://github.com/npmtest/node-npmtest-node-red">npmtest-node-red (v0.0.1)</a>
    </h1>
    <h1>Code coverage report for <span class="entity">node-npmtest-node-red/node-red/red/runtime/nodes/registry/installer.js</span></h1>
    <h2>
        
        Statements: <span class="metric">18.75% <small>(21 / 112)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        
        Branches: <span class="metric">4.76% <small>(2 / 42)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        
        Functions: <span class="metric">0% <small>(0 / 15)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        
        Lines: <span class="metric">18.75% <small>(21 / 112)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        Ignored: <span class="metric"><span class="ignore-none">none</span></span> &nbsp;&nbsp;&nbsp;&nbsp;
    </h2>
    <div class="path"><a href="../../../../../../index.html">All files</a> &#187; <a href="index.html">node-npmtest-node-red/node-red/red/runtime/nodes/registry/</a> &#187; installer.js</div>
</div>
<div class="body">
<pre><table class="coverage">
<tr><td class="line-count">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
164
165
166
167
168
169
170
171
172
173
174
175
176
177
178
179
180
181
182
183
184
185
186
187
188
189
190
191
192
193
194
195
196
197
198
199
200
201
202
203
204
205
206
207
208
209
210
211
212
213
214
215
216
217
218
219
220
221</td><td class="line-coverage"><span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span></td><td class="text"><pre class="prettyprint lang-js">/**
 * Copyright JS Foundation and other contributors, http://js.foundation
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 **/
&nbsp;
&nbsp;
var when = require("when");
var path = require("path");
var fs = require("fs");
&nbsp;
var registry = require("./registry");
var log = require("../../log");
&nbsp;
var events = require("../../events");
&nbsp;
var child_process = require('child_process');
var npmCommand = process.platform === 'win32' ? <span class="branch-0 cbranch-no" title="branch not covered" >'npm.cmd' </span>: 'npm';
var paletteEditorEnabled = false;
&nbsp;
var settings;
&nbsp;
var moduleRe = /^[^/]+$/;
var slashRe = process.platform === "win32" ? <span class="branch-0 cbranch-no" title="branch not covered" >/\\|[/]/ </span>: /[/]/;
&nbsp;
<span class="fstat-no" title="function not covered" >function init(_settings) {</span>
<span class="cstat-no" title="statement not covered" >    settings = _settings;</span>
}
&nbsp;
<span class="fstat-no" title="function not covered" >function checkModulePath(folder) {</span>
<span class="cstat-no" title="statement not covered" >    var moduleName;</span>
<span class="cstat-no" title="statement not covered" >    var err;</span>
<span class="cstat-no" title="statement not covered" >    var fullPath = path.resolve(folder);</span>
<span class="cstat-no" title="statement not covered" >    var packageFile = path.join(fullPath,'package.json');</span>
<span class="cstat-no" title="statement not covered" >    try {</span>
<span class="cstat-no" title="statement not covered" >        var pkg = require(packageFile);</span>
<span class="cstat-no" title="statement not covered" >        moduleName = pkg.name;</span>
<span class="cstat-no" title="statement not covered" >        if (!pkg['node-red']) {</span>
            // TODO: nls
<span class="cstat-no" title="statement not covered" >            err = new Error("Invalid Node-RED module");</span>
<span class="cstat-no" title="statement not covered" >            err.code = 'invalid_module';</span>
<span class="cstat-no" title="statement not covered" >            throw err;</span>
        }
    } catch(err2) {
<span class="cstat-no" title="statement not covered" >        err = new Error("Module not found");</span>
<span class="cstat-no" title="statement not covered" >        err.code = 404;</span>
<span class="cstat-no" title="statement not covered" >        throw err;</span>
    }
<span class="cstat-no" title="statement not covered" >    return moduleName;</span>
}
&nbsp;
<span class="fstat-no" title="function not covered" >function checkExistingModule(module) {</span>
<span class="cstat-no" title="statement not covered" >    if (registry.getModuleInfo(module)) {</span>
        // TODO: nls
<span class="cstat-no" title="statement not covered" >        var err = new Error("Module already loaded");</span>
<span class="cstat-no" title="statement not covered" >        err.code = "module_already_loaded";</span>
<span class="cstat-no" title="statement not covered" >        throw err;</span>
    }
}
&nbsp;
<span class="fstat-no" title="function not covered" >function installModule(module) {</span>
    //TODO: ensure module is 'safe'
<span class="cstat-no" title="statement not covered" >    return when.promise(<span class="fstat-no" title="function not covered" >function(resolve,reject) {</span></span>
<span class="cstat-no" title="statement not covered" >        var installName = module;</span>
&nbsp;
<span class="cstat-no" title="statement not covered" >        try {</span>
<span class="cstat-no" title="statement not covered" >            if (moduleRe.test(module)) {</span>
                // Simple module name - assume it can be npm installed
            } else <span class="cstat-no" title="statement not covered" >if (slashRe.test(module)) {</span>
                // A path - check if there's a valid package.json
<span class="cstat-no" title="statement not covered" >                installName = module;</span>
<span class="cstat-no" title="statement not covered" >                module = checkModulePath(module);</span>
            }
<span class="cstat-no" title="statement not covered" >            checkExistingModule(module);</span>
        } catch(err) {
<span class="cstat-no" title="statement not covered" >            return reject(err);</span>
        }
<span class="cstat-no" title="statement not covered" >        log.info(log._("server.install.installing",{name: module}));</span>
&nbsp;
<span class="cstat-no" title="statement not covered" >        var installDir = settings.userDir || process.env.NODE_RED_HOME || ".";</span>
<span class="cstat-no" title="statement not covered" >        var child = child_process.execFile(npmCommand,['install','--production',installName],</span>
            {
                cwd: installDir
            },
<span class="fstat-no" title="function not covered" >            function(err, stdin, stdout) {</span>
<span class="cstat-no" title="statement not covered" >                if (err) {</span>
<span class="cstat-no" title="statement not covered" >                    var lookFor404 = new RegExp(" 404 .*"+installName+"$","m");</span>
<span class="cstat-no" title="statement not covered" >                    if (lookFor404.test(stdout)) {</span>
<span class="cstat-no" title="statement not covered" >                        log.warn(log._("server.install.install-failed-not-found",{name:module}));</span>
<span class="cstat-no" title="statement not covered" >                        var e = new Error("Module not found");</span>
<span class="cstat-no" title="statement not covered" >                        e.code = 404;</span>
<span class="cstat-no" title="statement not covered" >                        reject(e);</span>
                    } else {
<span class="cstat-no" title="statement not covered" >                        log.warn(log._("server.install.install-failed-long",{name:module}));</span>
<span class="cstat-no" title="statement not covered" >                        log.warn("------------------------------------------");</span>
<span class="cstat-no" title="statement not covered" >                        log.warn(err.toString());</span>
<span class="cstat-no" title="statement not covered" >                        log.warn("------------------------------------------");</span>
<span class="cstat-no" title="statement not covered" >                        reject(new Error(log._("server.install.install-failed")));</span>
                    }
                } else {
<span class="cstat-no" title="statement not covered" >                    log.info(log._("server.install.installed",{name:module}));</span>
<span class="cstat-no" title="statement not covered" >                    resolve(require("./index").addModule(module).then(reportAddedModules));</span>
                }
            }
        );
    });
}
&nbsp;
&nbsp;
<span class="fstat-no" title="function not covered" >function reportAddedModules(info) {</span>
    //comms.publish("node/added",info.nodes,false);
<span class="cstat-no" title="statement not covered" >    if (info.nodes.length &gt; 0) {</span>
<span class="cstat-no" title="statement not covered" >        log.info(log._("server.added-types"));</span>
<span class="cstat-no" title="statement not covered" >        for (var i=0;i&lt;info.nodes.length;i++) {</span>
<span class="cstat-no" title="statement not covered" >            for (var j=0;j&lt;info.nodes[i].types.length;j++) {</span>
<span class="cstat-no" title="statement not covered" >                log.info(" - "+</span>
                    (info.nodes[i].module?info.nodes[i].module+":":"")+
                    info.nodes[i].types[j]+
                    (info.nodes[i].err?" : "+info.nodes[i].err:"")
                );
            }
        }
    }
<span class="cstat-no" title="statement not covered" >    return info;</span>
}
&nbsp;
<span class="fstat-no" title="function not covered" >function reportRemovedModules(removedNodes) {</span>
    //comms.publish("node/removed",removedNodes,false);
<span class="cstat-no" title="statement not covered" >    log.info(log._("server.removed-types"));</span>
<span class="cstat-no" title="statement not covered" >    for (var j=0;j&lt;removedNodes.length;j++) {</span>
<span class="cstat-no" title="statement not covered" >        for (var i=0;i&lt;removedNodes[j].types.length;i++) {</span>
<span class="cstat-no" title="statement not covered" >            log.info(" - "+(removedNodes[j].module?removedNodes[j].module+":":"")+removedNodes[j].types[i]);</span>
        }
    }
<span class="cstat-no" title="statement not covered" >    return removedNodes;</span>
}
&nbsp;
<span class="fstat-no" title="function not covered" >function uninstallModule(module) {</span>
<span class="cstat-no" title="statement not covered" >    return when.promise(<span class="fstat-no" title="function not covered" >function(resolve,reject) {</span></span>
<span class="cstat-no" title="statement not covered" >        if (/[\s;]/.test(module)) {</span>
<span class="cstat-no" title="statement not covered" >            reject(new Error(log._("server.install.invalid")));</span>
<span class="cstat-no" title="statement not covered" >            return;</span>
        }
<span class="cstat-no" title="statement not covered" >        var installDir = settings.userDir || process.env.NODE_RED_HOME || ".";</span>
<span class="cstat-no" title="statement not covered" >        var moduleDir = path.join(installDir,"node_modules",module);</span>
&nbsp;
<span class="cstat-no" title="statement not covered" >        try {</span>
<span class="cstat-no" title="statement not covered" >            fs.statSync(moduleDir);</span>
        } catch(err) {
<span class="cstat-no" title="statement not covered" >            return reject(new Error(log._("server.install.uninstall-failed",{name:module})));</span>
        }
&nbsp;
<span class="cstat-no" title="statement not covered" >        var list = registry.removeModule(module);</span>
<span class="cstat-no" title="statement not covered" >        log.info(log._("server.install.uninstalling",{name:module}));</span>
<span class="cstat-no" title="statement not covered" >        var child = child_process.execFile(npmCommand,['remove',module],</span>
            {
                cwd: installDir
            },
<span class="fstat-no" title="function not covered" >            function(err, stdin, stdout) {</span>
<span class="cstat-no" title="statement not covered" >                if (err) {</span>
<span class="cstat-no" title="statement not covered" >                    log.warn(log._("server.install.uninstall-failed-long",{name:module}));</span>
<span class="cstat-no" title="statement not covered" >                    log.warn("------------------------------------------");</span>
<span class="cstat-no" title="statement not covered" >                    log.warn(err.toString());</span>
<span class="cstat-no" title="statement not covered" >                    log.warn("------------------------------------------");</span>
<span class="cstat-no" title="statement not covered" >                    reject(new Error(log._("server.install.uninstall-failed",{name:module})));</span>
                } else {
<span class="cstat-no" title="statement not covered" >                    log.info(log._("server.install.uninstalled",{name:module}));</span>
<span class="cstat-no" title="statement not covered" >                    reportRemovedModules(list);</span>
                    // TODO: tidy up internal event names
<span class="cstat-no" title="statement not covered" >                    events.emit("node-module-uninstalled",module)</span>
<span class="cstat-no" title="statement not covered" >                    resolve(list);</span>
                }
            }
        );
    });
}
&nbsp;
<span class="fstat-no" title="function not covered" >function checkPrereq() {</span>
<span class="cstat-no" title="statement not covered" >    if (settings.hasOwnProperty('editorTheme') &amp;&amp;</span>
        settings.editorTheme.hasOwnProperty('palette') &amp;&amp;
        settings.editorTheme.palette.hasOwnProperty('editable') &amp;&amp;
        settings.editorTheme.palette.editable === false
    ) {
<span class="cstat-no" title="statement not covered" >        log.info(log._("server.palette-editor.disabled"));</span>
<span class="cstat-no" title="statement not covered" >        paletteEditorEnabled = false;</span>
<span class="cstat-no" title="statement not covered" >        return when.resolve();</span>
    } else {
<span class="cstat-no" title="statement not covered" >        return when.promise(<span class="fstat-no" title="function not covered" >function(resolve) {</span></span>
<span class="cstat-no" title="statement not covered" >            child_process.execFile(npmCommand,['-v'],<span class="fstat-no" title="function not covered" >function(err) {</span></span>
<span class="cstat-no" title="statement not covered" >                if (err) {</span>
<span class="cstat-no" title="statement not covered" >                    log.info(log._("server.palette-editor.npm-not-found"));</span>
<span class="cstat-no" title="statement not covered" >                    paletteEditorEnabled = false;</span>
                } else {
<span class="cstat-no" title="statement not covered" >                    paletteEditorEnabled = true;</span>
                }
<span class="cstat-no" title="statement not covered" >                resolve();</span>
            });
        })
    }
}
module.exports = {
    init: init,
    checkPrereq: checkPrereq,
    installModule: installModule,
    uninstallModule: uninstallModule,
    paletteEditorEnabled: <span class="fstat-no" title="function not covered" >function() {</span>
<span class="cstat-no" title="statement not covered" >        return paletteEditorEnabled</span>
    }
}
&nbsp;
&nbsp;</pre></td></tr>
</table></pre>
</div>
<div class="footer">
    <div class="meta">Generated by <a href="https://github.com/kaizhu256/node-utility2" target="_blank">utility2</a> at Tue Apr 11 2017 17:25:15 GMT+0000 (UTC)</div>
</div>
</body>
</html>


<!doctype html>
<html lang="en">
<head>
    <title>Code coverage report for node-npmtest-node-red/node-red/red/runtime/nodes/registry/loader.js</title>
    <meta charset="utf-8">
    <style>
        body, html {
            margin:0; padding: 0;
        }
        body {
            font-family: Arial, Helvetica;
            font-size: 10pt;
        }
        div.header, div.footer {
            background: #eee;
            padding: 1em;
        }
        div.header {
            height: 160px;
            padding: 0 1em 0 1em;
            z-index: 100;
            position: fixed;
            top: 0;
            border-bottom: 1px solid #666;
            width: 100%;
        }
        div.footer {
            border-top: 1px solid #666;
        }
        div.body {
            margin-top: 170px;
        }
        div.meta {
            font-size: 90%;
            text-align: center;
        }
        h1, h2, h3 {
            font-weight: normal;
        }
        h1 {
            font-size: 12pt;
        }
        h2 {
            font-size: 10pt;
        }
        pre {
            font-family: Menlo, Monaco, Consolas, Courier New, monospace;
            margin: 0;
            padding: 0;
            font-size: 14px;
            tab-size: 2;
        }

        div.path { font-size: 110%; }
        div.path a:link, div.path a:visited { color: #000; }
        table.coverage { border-collapse: collapse; margin:0; padding: 0 }

        table.coverage td {
            margin: 0;
            padding: 0;
            color: #111;
            vertical-align: top;
        }
        table.coverage td.line-count {
            width: 50px;
            text-align: right;
            padding-right: 5px;
        }
        table.coverage td.line-coverage {
            color: #777 !important;
            text-align: right;
            border-left: 1px solid #666;
            border-right: 1px solid #666;
        }

        table.coverage td.text {
        }

        table.coverage td span.cline-any {
            display: inline-block;
            padding: 0 5px;
            width: 40px;
        }
        table.coverage td span.cline-neutral {
            background: #eee;
        }
        table.coverage td span.cline-yes {
            background: #b5d592;
            color: #999;
        }
        table.coverage td span.cline-no {
            background: #fc8c84;
        }

        .cstat-yes { color: #111; }
        .cstat-no { background: #fc8c84; color: #111; }
        .fstat-no { background: #ffc520; color: #111 !important; }
        .cbranch-no { background:  yellow !important; color: #111; }

        .cstat-skip { background: #ddd; color: #111; }
        .fstat-skip { background: #ddd; color: #111 !important; }
        .cbranch-skip { background: #ddd !important; color: #111; }

        .missing-if-branch {
            display: inline-block;
            margin-right: 10px;
            position: relative;
            padding: 0 4px;
            background: black;
            color: yellow;
        }

        .skip-if-branch {
            display: none;
            margin-right: 10px;
            position: relative;
            padding: 0 4px;
            background: #ccc;
            color: white;
        }

        .missing-if-branch .typ, .skip-if-branch .typ {
            color: inherit !important;
        }

        .entity, .metric { font-weight: bold; }
        .metric { display: inline-block; border: 1px solid #333; padding: 0.3em; background: white; }
        .metric small { font-size: 80%; font-weight: normal; color: #666; }

        div.coverage-summary table { border-collapse: collapse; margin: 3em; font-size: 110%; }
        div.coverage-summary td, div.coverage-summary table  th { margin: 0; padding: 0.25em 1em; border-top: 1px solid #666; border-bottom: 1px solid #666; }
        div.coverage-summary th { text-align: left; border: 1px solid #666; background: #eee; font-weight: normal; }
        div.coverage-summary th.file { border-right: none !important; }
        div.coverage-summary th.pic { border-left: none !important; text-align: right; }
        div.coverage-summary th.pct { border-right: none !important; }
        div.coverage-summary th.abs { border-left: none !important; text-align: right; }
        div.coverage-summary td.pct { text-align: right; border-left: 1px solid #666; }
        div.coverage-summary td.abs { text-align: right; font-size: 90%; color: #444; border-right: 1px solid #666; }
        div.coverage-summary td.file { text-align: right; border-left: 1px solid #666; white-space: nowrap;  }
        div.coverage-summary td.pic { min-width: 120px !important;  }
        div.coverage-summary a:link { color: #000; }
        div.coverage-summary a:visited { color: #333; }
        div.coverage-summary tfoot td { border-top: 1px solid #666; }

        div.coverage-summary .yui3-datatable-sort-indicator, div.coverage-summary .dummy-sort-indicator {
            height: 10px;
            width: 7px;
            display: inline-block;
            margin-left: 0.5em;
        }
        div.coverage-summary .yui3-datatable-sort-indicator {
            background: no-repeat scroll 0 0 transparent;
        }
        div.coverage-summary .yui3-datatable-sorted .yui3-datatable-sort-indicator {
            background-position: 0 -20px;
        }
        div.coverage-summary .yui3-datatable-sorted-desc .yui3-datatable-sort-indicator {
            background-position: 0 -10px;
        }

        .high { background: #b5d592 !important; }
        .medium { background: #ffe87c !important; }
        .low { background: #fc8c84 !important; }

        span.cover-fill, span.cover-empty {
            display:inline-block;
            border:1px solid #444;
            background: white;
            height: 12px;
        }
        span.cover-fill {
            background: #ccc;
            border-right: 1px solid #444;
        }
        span.cover-empty {
            background: white;
            border-left: none;
        }
        span.cover-full {
            border-right: none !important;
        }
        pre.prettyprint {
            border: none !important;
            padding: 0 !important;
            margin: 0 !important;
        }
        .com { color: #999 !important; }
        .ignore-none { color: #999; font-weight: normal; }

    </style>
</head>
<body>
<div class="header low">
    <h1 style="font-weight: bold;">
        <a href="https://github.com/npmtest/node-npmtest-node-red">npmtest-node-red (v0.0.1)</a>
    </h1>
    <h1>Code coverage report for <span class="entity">node-npmtest-node-red/node-red/red/runtime/nodes/registry/loader.js</span></h1>
    <h2>
        
        Statements: <span class="metric">9.48% <small>(20 / 211)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        
        Branches: <span class="metric">2.38% <small>(2 / 84)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        
        Functions: <span class="metric">0% <small>(0 / 27)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        
        Lines: <span class="metric">9.48% <small>(20 / 211)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        Ignored: <span class="metric">2 branches</span> &nbsp;&nbsp;&nbsp;&nbsp;
    </h2>
    <div class="path"><a href="../../../../../../index.html">All files</a> &#187; <a href="index.html">node-npmtest-node-red/node-red/red/runtime/nodes/registry/</a> &#187; loader.js</div>
</div>
<div class="body">
<pre><table class="coverage">
<tr><td class="line-count">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
164
165
166
167
168
169
170
171
172
173
174
175
176
177
178
179
180
181
182
183
184
185
186
187
188
189
190
191
192
193
194
195
196
197
198
199
200
201
202
203
204
205
206
207
208
209
210
211
212
213
214
215
216
217
218
219
220
221
222
223
224
225
226
227
228
229
230
231
232
233
234
235
236
237
238
239
240
241
242
243
244
245
246
247
248
249
250
251
252
253
254
255
256
257
258
259
260
261
262
263
264
265
266
267
268
269
270
271
272
273
274
275
276
277
278
279
280
281
282
283
284
285
286
287
288
289
290
291
292
293
294
295
296
297
298
299
300
301
302
303
304
305
306
307
308
309
310
311
312
313
314
315
316
317
318
319
320
321
322
323
324
325
326
327
328
329
330
331
332
333
334
335
336
337
338
339
340
341
342
343
344
345
346
347
348
349
350
351
352
353
354
355
356
357
358
359
360
361
362
363
364
365
366
367
368
369
370
371
372
373
374
375
376
377
378
379
380
381
382
383
384
385
386
387
388
389
390
391
392
393
394
395
396
397
398
399</td><td class="line-coverage"><span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span></td><td class="text"><pre class="prettyprint lang-js">/**
 * Copyright JS Foundation and other contributors, http://js.foundation
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 **/
&nbsp;
var when = require("when");
var fs = require("fs");
var path = require("path");
var semver = require("semver");
&nbsp;
var localfilesystem = require("./localfilesystem");
var registry = require("./registry");
&nbsp;
var settings;
var runtime;
&nbsp;
<span class="fstat-no" title="function not covered" >function init(_runtime) {</span>
<span class="cstat-no" title="statement not covered" >    runtime = _runtime;</span>
<span class="cstat-no" title="statement not covered" >    settings = runtime.settings;</span>
<span class="cstat-no" title="statement not covered" >    localfilesystem.init(runtime);</span>
}
&nbsp;
<span class="fstat-no" title="function not covered" >function load(defaultNodesDir,disableNodePathScan) {</span>
    // To skip node scan, the following line will use the stored node list.
    // We should expose that as an option at some point, although the
    // performance gains are minimal.
    //return loadNodeFiles(registry.getModuleList());
<span class="cstat-no" title="statement not covered" >    runtime.log.info(runtime.log._("server.loading"));</span>
&nbsp;
<span class="cstat-no" title="statement not covered" >    var nodeFiles = localfilesystem.getNodeFiles(defaultNodesDir,disableNodePathScan);</span>
<span class="cstat-no" title="statement not covered" >    return loadNodeFiles(nodeFiles);</span>
}
&nbsp;
<span class="fstat-no" title="function not covered" >function copyObjectProperties(src,dst,copyList,blockList) {</span>
<span class="cstat-no" title="statement not covered" >    if (!src) {</span>
<span class="cstat-no" title="statement not covered" >        return;</span>
    }
<span class="cstat-no" title="statement not covered" >    if (copyList &amp;&amp; !blockList) {</span>
<span class="cstat-no" title="statement not covered" >        copyList.forEach(<span class="fstat-no" title="function not covered" >function(i) {</span></span>
<span class="cstat-no" title="statement not covered" >            if (src.hasOwnProperty(i)) {</span>
<span class="cstat-no" title="statement not covered" >                var propDescriptor = Object.getOwnPropertyDescriptor(src,i);</span>
<span class="cstat-no" title="statement not covered" >                Object.defineProperty(dst,i,propDescriptor);</span>
            }
        });
    } else <span class="cstat-no" title="statement not covered" >if (!copyList &amp;&amp; blockList) {</span>
<span class="cstat-no" title="statement not covered" >        for (var i in src) {</span>
<span class="cstat-no" title="statement not covered" >            if (src.hasOwnProperty(i) &amp;&amp; blockList.indexOf(i) === -1) {</span>
<span class="cstat-no" title="statement not covered" >                var propDescriptor = Object.getOwnPropertyDescriptor(src,i);</span>
<span class="cstat-no" title="statement not covered" >                Object.defineProperty(dst,i,propDescriptor);</span>
            }
        }
    }
}
&nbsp;
<span class="fstat-no" title="function not covered" >function createNodeApi(node) {</span>
<span class="cstat-no" title="statement not covered" >    var red = {</span>
        nodes: {},
        log: {},
        settings: {},
        events: runtime.events,
        util: runtime.util,
        version: runtime.version,
    }
<span class="cstat-no" title="statement not covered" >    copyObjectProperties(runtime.nodes,red.nodes,["createNode","getNode","eachNode","addCredentials","getCredentials","deleteCredentials" ]);</span>
<span class="cstat-no" title="statement not covered" >    red.nodes.registerType = <span class="fstat-no" title="function not covered" >function(type,constructor,opts) {</span></span>
<span class="cstat-no" title="statement not covered" >        runtime.nodes.registerType(node.id,type,constructor,opts);</span>
    }
<span class="cstat-no" title="statement not covered" >    copyObjectProperties(runtime.log,red.log,null,["init"]);</span>
<span class="cstat-no" title="statement not covered" >    copyObjectProperties(runtime.settings,red.settings,null,["init","load","reset"]);</span>
<span class="cstat-no" title="statement not covered" >    if (runtime.adminApi) {</span>
<span class="cstat-no" title="statement not covered" >        red.comms = runtime.adminApi.comms;</span>
<span class="cstat-no" title="statement not covered" >        red.library = runtime.adminApi.library;</span>
<span class="cstat-no" title="statement not covered" >        red.auth = runtime.adminApi.auth;</span>
<span class="cstat-no" title="statement not covered" >        red.httpAdmin = runtime.adminApi.adminApp;</span>
<span class="cstat-no" title="statement not covered" >        red.httpNode = runtime.nodeApp;</span>
<span class="cstat-no" title="statement not covered" >        red.server = runtime.adminApi.server;</span>
    } else {
        //TODO: runtime.adminApi is always stubbed if not enabled, so this block
        // is unused - but may be needed for the unit tests
<span class="cstat-no" title="statement not covered" >        red.comms = {</span>
            publish: <span class="fstat-no" title="function not covered" >function() {</span>}
        };
<span class="cstat-no" title="statement not covered" >        red.library = {</span>
            register: <span class="fstat-no" title="function not covered" >function() {</span>}
        };
<span class="cstat-no" title="statement not covered" >        red.auth = {</span>
            needsPermission: <span class="fstat-no" title="function not covered" >function() {</span>}
        };
        // TODO: stub out httpAdmin/httpNode/server
    }
<span class="cstat-no" title="statement not covered" >    red["_"] = <span class="fstat-no" title="function not covered" >function() {</span></span>
<span class="cstat-no" title="statement not covered" >        var args = Array.prototype.slice.call(arguments, 0);</span>
<span class="cstat-no" title="statement not covered" >        if (args[0].indexOf(":") === -1) {</span>
<span class="cstat-no" title="statement not covered" >            args[0] = node.namespace+":"+args[0];</span>
        }
<span class="cstat-no" title="statement not covered" >        return runtime.i18n._.apply(null,args);</span>
    }
<span class="cstat-no" title="statement not covered" >    return red;</span>
}
&nbsp;
&nbsp;
<span class="fstat-no" title="function not covered" >function loadNodeFiles(nodeFiles) {</span>
<span class="cstat-no" title="statement not covered" >    var promises = [];</span>
<span class="cstat-no" title="statement not covered" >    for (var module in nodeFiles) {</span>
        /* istanbul ignore else */
<span class="cstat-no" title="statement not covered" >        if (nodeFiles.hasOwnProperty(module)) {</span>
<span class="cstat-no" title="statement not covered" >            if (nodeFiles[module].redVersion &amp;&amp;</span>
                !semver.satisfies(runtime.version().replace("-git",""), nodeFiles[module].redVersion)) {
                //TODO: log it
<span class="cstat-no" title="statement not covered" >                runtime.log.warn("["+module+"] "+runtime.log._("server.node-version-mismatch",{version:nodeFiles[module].redVersion}));</span>
<span class="cstat-no" title="statement not covered" >                continue;</span>
            }
<span class="cstat-no" title="statement not covered" >            if (module == "node-red" || !registry.getModuleInfo(module)) {</span>
<span class="cstat-no" title="statement not covered" >                var first = true;</span>
<span class="cstat-no" title="statement not covered" >                for (var node in nodeFiles[module].nodes) {</span>
                    /* istanbul ignore else */
<span class="cstat-no" title="statement not covered" >                    if (nodeFiles[module].nodes.hasOwnProperty(node)) {</span>
<span class="cstat-no" title="statement not covered" >                        if (module != "node-red" &amp;&amp; first) {</span>
                            // Check the module directory exists
<span class="cstat-no" title="statement not covered" >                            first = false;</span>
<span class="cstat-no" title="statement not covered" >                            var fn = nodeFiles[module].nodes[node].file;</span>
<span class="cstat-no" title="statement not covered" >                            var parts = fn.split("/");</span>
<span class="cstat-no" title="statement not covered" >                            var i = parts.length-1;</span>
<span class="cstat-no" title="statement not covered" >                            for (;i&gt;=0;i--) {</span>
<span class="cstat-no" title="statement not covered" >                                if (parts[i] == "node_modules") {</span>
<span class="cstat-no" title="statement not covered" >                                    break;</span>
                                }
                            }
<span class="cstat-no" title="statement not covered" >                            var moduleFn = parts.slice(0,i+2).join("/");</span>
&nbsp;
<span class="cstat-no" title="statement not covered" >                            try {</span>
<span class="cstat-no" title="statement not covered" >                                var stat = fs.statSync(moduleFn);</span>
                            } catch(err) {
                                // Module not found, don't attempt to load its nodes
<span class="cstat-no" title="statement not covered" >                                break;</span>
                            }
                        }
&nbsp;
<span class="cstat-no" title="statement not covered" >                        try {</span>
<span class="cstat-no" title="statement not covered" >                            promises.push(loadNodeConfig(nodeFiles[module].nodes[node]))</span>
                        } catch(err) {
                            //
                        }
                    }
                }
            }
        }
    }
<span class="cstat-no" title="statement not covered" >    return when.settle(promises).then(<span class="fstat-no" title="function not covered" >function(results) {</span></span>
<span class="cstat-no" title="statement not covered" >        var nodes = results.map(<span class="fstat-no" title="function not covered" >function(r) {</span></span>
<span class="cstat-no" title="statement not covered" >            registry.addNodeSet(r.value.id,r.value,r.value.version);</span>
<span class="cstat-no" title="statement not covered" >            return r.value;</span>
        });
<span class="cstat-no" title="statement not covered" >        return loadNodeSetList(nodes);</span>
    });
}
&nbsp;
<span class="fstat-no" title="function not covered" >function loadNodeConfig(fileInfo) {</span>
<span class="cstat-no" title="statement not covered" >    return when.promise(<span class="fstat-no" title="function not covered" >function(resolve) {</span></span>
<span class="cstat-no" title="statement not covered" >        var file = fileInfo.file;</span>
<span class="cstat-no" title="statement not covered" >        var module = fileInfo.module;</span>
<span class="cstat-no" title="statement not covered" >        var name = fileInfo.name;</span>
<span class="cstat-no" title="statement not covered" >        var version = fileInfo.version;</span>
&nbsp;
<span class="cstat-no" title="statement not covered" >        var id = module + "/" + name;</span>
<span class="cstat-no" title="statement not covered" >        var info = registry.getNodeInfo(id);</span>
<span class="cstat-no" title="statement not covered" >        var isEnabled = true;</span>
<span class="cstat-no" title="statement not covered" >        if (info) {</span>
<span class="cstat-no" title="statement not covered" >            if (info.hasOwnProperty("loaded")) {</span>
<span class="cstat-no" title="statement not covered" >                throw new Error(file+" already loaded");</span>
            }
<span class="cstat-no" title="statement not covered" >            isEnabled = info.enabled;</span>
        }
&nbsp;
<span class="cstat-no" title="statement not covered" >        var node = {</span>
            id: id,
            module: module,
            name: name,
            file: file,
            template: file.replace(/\.js$/,".html"),
            enabled: isEnabled,
            loaded:false,
            version: version,
            local: fileInfo.local
        };
<span class="cstat-no" title="statement not covered" >        if (fileInfo.hasOwnProperty("types")) {</span>
<span class="cstat-no" title="statement not covered" >            node.types = fileInfo.types;</span>
        }
&nbsp;
<span class="cstat-no" title="statement not covered" >        fs.readFile(node.template,'utf8', <span class="fstat-no" title="function not covered" >function(err,content) {</span></span>
<span class="cstat-no" title="statement not covered" >            if (err) {</span>
<span class="cstat-no" title="statement not covered" >                node.types = [];</span>
<span class="cstat-no" title="statement not covered" >                if (err.code === 'ENOENT') {</span>
<span class="cstat-no" title="statement not covered" >                    if (!node.types) {</span>
<span class="cstat-no" title="statement not covered" >                        node.types = [];</span>
                    }
<span class="cstat-no" title="statement not covered" >                    node.err = "Error: "+node.template+" does not exist";</span>
                } else {
<span class="cstat-no" title="statement not covered" >                    node.types = [];</span>
<span class="cstat-no" title="statement not covered" >                    node.err = err.toString();</span>
                }
<span class="cstat-no" title="statement not covered" >                resolve(node);</span>
            } else {
<span class="cstat-no" title="statement not covered" >                var types = [];</span>
&nbsp;
<span class="cstat-no" title="statement not covered" >                var regExp = /&lt;script ([^&gt;]*)data-template-name=['"]([^'"]*)['"]/gi;</span>
<span class="cstat-no" title="statement not covered" >                var match = null;</span>
&nbsp;
<span class="cstat-no" title="statement not covered" >                while ((match = regExp.exec(content)) !== null) {</span>
<span class="cstat-no" title="statement not covered" >                    types.push(match[2]);</span>
                }
<span class="cstat-no" title="statement not covered" >                node.types = types;</span>
&nbsp;
<span class="cstat-no" title="statement not covered" >                var langRegExp = /^&lt;script[^&gt;]* data-lang=['"](.+?)['"]/i;</span>
<span class="cstat-no" title="statement not covered" >                regExp = /(&lt;script[^&gt;]* data-help-name=[\s\S]*?&lt;\/script&gt;)/gi;</span>
<span class="cstat-no" title="statement not covered" >                match = null;</span>
<span class="cstat-no" title="statement not covered" >                var mainContent = "";</span>
<span class="cstat-no" title="statement not covered" >                var helpContent = {};</span>
<span class="cstat-no" title="statement not covered" >                var index = 0;</span>
<span class="cstat-no" title="statement not covered" >                while ((match = regExp.exec(content)) !== null) {</span>
<span class="cstat-no" title="statement not covered" >                    mainContent += content.substring(index,regExp.lastIndex-match[1].length);</span>
<span class="cstat-no" title="statement not covered" >                    index = regExp.lastIndex;</span>
<span class="cstat-no" title="statement not covered" >                    var help = content.substring(regExp.lastIndex-match[1].length,regExp.lastIndex);</span>
&nbsp;
<span class="cstat-no" title="statement not covered" >                    var lang = runtime.i18n.defaultLang;</span>
<span class="cstat-no" title="statement not covered" >                    if ((match = langRegExp.exec(help)) !== null) {</span>
<span class="cstat-no" title="statement not covered" >                        lang = match[1];</span>
                    }
<span class="cstat-no" title="statement not covered" >                    if (!helpContent.hasOwnProperty(lang)) {</span>
<span class="cstat-no" title="statement not covered" >                        helpContent[lang] = "";</span>
                    }
&nbsp;
<span class="cstat-no" title="statement not covered" >                    helpContent[lang] += help;</span>
                }
<span class="cstat-no" title="statement not covered" >                mainContent += content.substring(index);</span>
&nbsp;
<span class="cstat-no" title="statement not covered" >                node.config = mainContent;</span>
<span class="cstat-no" title="statement not covered" >                node.help = helpContent;</span>
                // TODO: parse out the javascript portion of the template
                //node.script = "";
<span class="cstat-no" title="statement not covered" >                for (var i=0;i&lt;node.types.length;i++) {</span>
<span class="cstat-no" title="statement not covered" >                    if (registry.getTypeId(node.types[i])) {</span>
<span class="cstat-no" title="statement not covered" >                        node.err = node.types[i]+" already registered";</span>
<span class="cstat-no" title="statement not covered" >                        break;</span>
                    }
                }
<span class="cstat-no" title="statement not covered" >                fs.stat(path.join(path.dirname(file),"locales"),<span class="fstat-no" title="function not covered" >function(err,stat) {</span></span>
<span class="cstat-no" title="statement not covered" >                    if (!err) {</span>
<span class="cstat-no" title="statement not covered" >                        node.namespace = node.id;</span>
<span class="cstat-no" title="statement not covered" >                        runtime.i18n.registerMessageCatalog(node.id,</span>
                                path.join(path.dirname(file),"locales"),
                                path.basename(file,".js")+".json")
                            .then(<span class="fstat-no" title="function not covered" >function() {</span>
<span class="cstat-no" title="statement not covered" >                                resolve(node);</span>
                            });
                    } else {
<span class="cstat-no" title="statement not covered" >                        node.namespace = node.module;</span>
<span class="cstat-no" title="statement not covered" >                        resolve(node);</span>
                    }
                });
            }
        });
    });
}
&nbsp;
/**
 * Loads the specified node into the runtime
 * @param node a node info object - see loadNodeConfig
 * @return a promise that resolves to an update node info object. The object
 *         has the following properties added:
 *            err: any error encountered whilst loading the node
 *
 */
<span class="fstat-no" title="function not covered" >function loadNodeSet(node) {</span>
<span class="cstat-no" title="statement not covered" >    var nodeDir = path.dirname(node.file);</span>
<span class="cstat-no" title="statement not covered" >    var nodeFn = path.basename(node.file);</span>
<span class="cstat-no" title="statement not covered" >    if (!node.enabled) {</span>
<span class="cstat-no" title="statement not covered" >        return when.resolve(node);</span>
    } else {
    }
<span class="cstat-no" title="statement not covered" >    try {</span>
<span class="cstat-no" title="statement not covered" >        var loadPromise = null;</span>
<span class="cstat-no" title="statement not covered" >        var r = require(node.file);</span>
<span class="cstat-no" title="statement not covered" >        if (typeof r === "function") {</span>
&nbsp;
<span class="cstat-no" title="statement not covered" >            var red = createNodeApi(node);</span>
<span class="cstat-no" title="statement not covered" >            var promise = r(red);</span>
<span class="cstat-no" title="statement not covered" >            if (promise != null &amp;&amp; typeof promise.then === "function") {</span>
<span class="cstat-no" title="statement not covered" >                loadPromise = promise.then(<span class="fstat-no" title="function not covered" >function() {</span></span>
<span class="cstat-no" title="statement not covered" >                    node.enabled = true;</span>
<span class="cstat-no" title="statement not covered" >                    node.loaded = true;</span>
<span class="cstat-no" title="statement not covered" >                    return node;</span>
                }).otherwise(<span class="fstat-no" title="function not covered" >function(err) {</span>
<span class="cstat-no" title="statement not covered" >                    node.err = err;</span>
<span class="cstat-no" title="statement not covered" >                    return node;</span>
                });
            }
        }
<span class="cstat-no" title="statement not covered" >        if (loadPromise == null) {</span>
<span class="cstat-no" title="statement not covered" >            node.enabled = true;</span>
<span class="cstat-no" title="statement not covered" >            node.loaded = true;</span>
<span class="cstat-no" title="statement not covered" >            loadPromise = when.resolve(node);</span>
        }
<span class="cstat-no" title="statement not covered" >        return loadPromise;</span>
    } catch(err) {
<span class="cstat-no" title="statement not covered" >        node.err = err;</span>
<span class="cstat-no" title="statement not covered" >        return when.resolve(node);</span>
    }
}
&nbsp;
<span class="fstat-no" title="function not covered" >function loadNodeSetList(nodes) {</span>
<span class="cstat-no" title="statement not covered" >    var promises = [];</span>
<span class="cstat-no" title="statement not covered" >    nodes.forEach(<span class="fstat-no" title="function not covered" >function(node) {</span></span>
<span class="cstat-no" title="statement not covered" >        if (!node.err) {</span>
<span class="cstat-no" title="statement not covered" >            promises.push(loadNodeSet(node));</span>
        } else {
<span class="cstat-no" title="statement not covered" >            promises.push(node);</span>
        }
    });
&nbsp;
<span class="cstat-no" title="statement not covered" >    return when.settle(promises).then(<span class="fstat-no" title="function not covered" >function() {</span></span>
<span class="cstat-no" title="statement not covered" >        if (settings.available()) {</span>
<span class="cstat-no" title="statement not covered" >            return registry.saveNodeList();</span>
        } else {
<span class="cstat-no" title="statement not covered" >            return;</span>
        }
    });
}
&nbsp;
<span class="fstat-no" title="function not covered" >function addModule(module) {</span>
<span class="cstat-no" title="statement not covered" >    if (!settings.available()) {</span>
<span class="cstat-no" title="statement not covered" >        throw new Error("Settings unavailable");</span>
    }
<span class="cstat-no" title="statement not covered" >    var nodes = [];</span>
<span class="cstat-no" title="statement not covered" >    if (registry.getModuleInfo(module)) {</span>
        // TODO: nls
<span class="cstat-no" title="statement not covered" >        var e = new Error("module_already_loaded");</span>
<span class="cstat-no" title="statement not covered" >        e.code = "module_already_loaded";</span>
<span class="cstat-no" title="statement not covered" >        return when.reject(e);</span>
    }
<span class="cstat-no" title="statement not covered" >    try {</span>
<span class="cstat-no" title="statement not covered" >        var moduleFiles = localfilesystem.getModuleFiles(module);</span>
<span class="cstat-no" title="statement not covered" >        return loadNodeFiles(moduleFiles);</span>
    } catch(err) {
<span class="cstat-no" title="statement not covered" >        return when.reject(err);</span>
    }
}
&nbsp;
<span class="fstat-no" title="function not covered" >function loadNodeHelp(node,lang) {</span>
<span class="cstat-no" title="statement not covered" >    var dir = path.dirname(node.template);</span>
<span class="cstat-no" title="statement not covered" >    var base = path.basename(node.template);</span>
<span class="cstat-no" title="statement not covered" >    var localePath = path.join(dir,"locales",lang,base);</span>
<span class="cstat-no" title="statement not covered" >    try {</span>
        // TODO: make this async
<span class="cstat-no" title="statement not covered" >        var content = fs.readFileSync(localePath, "utf8")</span>
<span class="cstat-no" title="statement not covered" >        return content;</span>
    } catch(err) {
<span class="cstat-no" title="statement not covered" >        return null;</span>
    }
}
&nbsp;
<span class="fstat-no" title="function not covered" >function getNodeHelp(node,lang) {</span>
<span class="cstat-no" title="statement not covered" >    if (!node.help[lang]) {</span>
<span class="cstat-no" title="statement not covered" >        var help = loadNodeHelp(node,lang);</span>
<span class="cstat-no" title="statement not covered" >        if (help == null) {</span>
<span class="cstat-no" title="statement not covered" >            var langParts = lang.split("-");</span>
<span class="cstat-no" title="statement not covered" >            if (langParts.length == 2) {</span>
<span class="cstat-no" title="statement not covered" >                help = loadNodeHelp(node,langParts[0]);</span>
            }
        }
<span class="cstat-no" title="statement not covered" >        if (help) {</span>
<span class="cstat-no" title="statement not covered" >            node.help[lang] = help;</span>
        } else {
<span class="cstat-no" title="statement not covered" >            node.help[lang] = node.help[runtime.i18n.defaultLang];</span>
        }
    }
<span class="cstat-no" title="statement not covered" >    return node.help[lang];</span>
}
&nbsp;
module.exports = {
    init: init,
    load: load,
    addModule: addModule,
    loadNodeSet: loadNodeSet,
    getNodeHelp: getNodeHelp
}
&nbsp;
&nbsp;</pre></td></tr>
</table></pre>
</div>
<div class="footer">
    <div class="meta">Generated by <a href="https://github.com/kaizhu256/node-utility2" target="_blank">utility2</a> at Tue Apr 11 2017 17:25:15 GMT+0000 (UTC)</div>
</div>
</body>
</html>


<!doctype html>
<html lang="en">
<head>
    <title>Code coverage report for node-npmtest-node-red/node-red/red/runtime/nodes/registry/localfilesystem.js</title>
    <meta charset="utf-8">
    <style>
        body, html {
            margin:0; padding: 0;
        }
        body {
            font-family: Arial, Helvetica;
            font-size: 10pt;
        }
        div.header, div.footer {
            background: #eee;
            padding: 1em;
        }
        div.header {
            height: 160px;
            padding: 0 1em 0 1em;
            z-index: 100;
            position: fixed;
            top: 0;
            border-bottom: 1px solid #666;
            width: 100%;
        }
        div.footer {
            border-top: 1px solid #666;
        }
        div.body {
            margin-top: 170px;
        }
        div.meta {
            font-size: 90%;
            text-align: center;
        }
        h1, h2, h3 {
            font-weight: normal;
        }
        h1 {
            font-size: 12pt;
        }
        h2 {
            font-size: 10pt;
        }
        pre {
            font-family: Menlo, Monaco, Consolas, Courier New, monospace;
            margin: 0;
            padding: 0;
            font-size: 14px;
            tab-size: 2;
        }

        div.path { font-size: 110%; }
        div.path a:link, div.path a:visited { color: #000; }
        table.coverage { border-collapse: collapse; margin:0; padding: 0 }

        table.coverage td {
            margin: 0;
            padding: 0;
            color: #111;
            vertical-align: top;
        }
        table.coverage td.line-count {
            width: 50px;
            text-align: right;
            padding-right: 5px;
        }
        table.coverage td.line-coverage {
            color: #777 !important;
            text-align: right;
            border-left: 1px solid #666;
            border-right: 1px solid #666;
        }

        table.coverage td.text {
        }

        table.coverage td span.cline-any {
            display: inline-block;
            padding: 0 5px;
            width: 40px;
        }
        table.coverage td span.cline-neutral {
            background: #eee;
        }
        table.coverage td span.cline-yes {
            background: #b5d592;
            color: #999;
        }
        table.coverage td span.cline-no {
            background: #fc8c84;
        }

        .cstat-yes { color: #111; }
        .cstat-no { background: #fc8c84; color: #111; }
        .fstat-no { background: #ffc520; color: #111 !important; }
        .cbranch-no { background:  yellow !important; color: #111; }

        .cstat-skip { background: #ddd; color: #111; }
        .fstat-skip { background: #ddd; color: #111 !important; }
        .cbranch-skip { background: #ddd !important; color: #111; }

        .missing-if-branch {
            display: inline-block;
            margin-right: 10px;
            position: relative;
            padding: 0 4px;
            background: black;
            color: yellow;
        }

        .skip-if-branch {
            display: none;
            margin-right: 10px;
            position: relative;
            padding: 0 4px;
            background: #ccc;
            color: white;
        }

        .missing-if-branch .typ, .skip-if-branch .typ {
            color: inherit !important;
        }

        .entity, .metric { font-weight: bold; }
        .metric { display: inline-block; border: 1px solid #333; padding: 0.3em; background: white; }
        .metric small { font-size: 80%; font-weight: normal; color: #666; }

        div.coverage-summary table { border-collapse: collapse; margin: 3em; font-size: 110%; }
        div.coverage-summary td, div.coverage-summary table  th { margin: 0; padding: 0.25em 1em; border-top: 1px solid #666; border-bottom: 1px solid #666; }
        div.coverage-summary th { text-align: left; border: 1px solid #666; background: #eee; font-weight: normal; }
        div.coverage-summary th.file { border-right: none !important; }
        div.coverage-summary th.pic { border-left: none !important; text-align: right; }
        div.coverage-summary th.pct { border-right: none !important; }
        div.coverage-summary th.abs { border-left: none !important; text-align: right; }
        div.coverage-summary td.pct { text-align: right; border-left: 1px solid #666; }
        div.coverage-summary td.abs { text-align: right; font-size: 90%; color: #444; border-right: 1px solid #666; }
        div.coverage-summary td.file { text-align: right; border-left: 1px solid #666; white-space: nowrap;  }
        div.coverage-summary td.pic { min-width: 120px !important;  }
        div.coverage-summary a:link { color: #000; }
        div.coverage-summary a:visited { color: #333; }
        div.coverage-summary tfoot td { border-top: 1px solid #666; }

        div.coverage-summary .yui3-datatable-sort-indicator, div.coverage-summary .dummy-sort-indicator {
            height: 10px;
            width: 7px;
            display: inline-block;
            margin-left: 0.5em;
        }
        div.coverage-summary .yui3-datatable-sort-indicator {
            background: no-repeat scroll 0 0 transparent;
        }
        div.coverage-summary .yui3-datatable-sorted .yui3-datatable-sort-indicator {
            background-position: 0 -20px;
        }
        div.coverage-summary .yui3-datatable-sorted-desc .yui3-datatable-sort-indicator {
            background-position: 0 -10px;
        }

        .high { background: #b5d592 !important; }
        .medium { background: #ffe87c !important; }
        .low { background: #fc8c84 !important; }

        span.cover-fill, span.cover-empty {
            display:inline-block;
            border:1px solid #444;
            background: white;
            height: 12px;
        }
        span.cover-fill {
            background: #ccc;
            border-right: 1px solid #444;
        }
        span.cover-empty {
            background: white;
            border-left: none;
        }
        span.cover-full {
            border-right: none !important;
        }
        pre.prettyprint {
            border: none !important;
            padding: 0 !important;
            margin: 0 !important;
        }
        .com { color: #999 !important; }
        .ignore-none { color: #999; font-weight: normal; }

    </style>
</head>
<body>
<div class="header low">
    <h1 style="font-weight: bold;">
        <a href="https://github.com/npmtest/node-npmtest-node-red">npmtest-node-red (v0.0.1)</a>
    </h1>
    <h1>Code coverage report for <span class="entity">node-npmtest-node-red/node-red/red/runtime/nodes/registry/localfilesystem.js</span></h1>
    <h2>
        
        Statements: <span class="metric">11.76% <small>(18 / 153)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        
        Branches: <span class="metric">1.54% <small>(1 / 65)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        
        Functions: <span class="metric">0% <small>(0 / 16)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        
        Lines: <span class="metric">11.84% <small>(18 / 152)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        Ignored: <span class="metric">1 branch</span> &nbsp;&nbsp;&nbsp;&nbsp;
    </h2>
    <div class="path"><a href="../../../../../../index.html">All files</a> &#187; <a href="index.html">node-npmtest-node-red/node-red/red/runtime/nodes/registry/</a> &#187; localfilesystem.js</div>
</div>
<div class="body">
<pre><table class="coverage">
<tr><td class="line-count">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
164
165
166
167
168
169
170
171
172
173
174
175
176
177
178
179
180
181
182
183
184
185
186
187
188
189
190
191
192
193
194
195
196
197
198
199
200
201
202
203
204
205
206
207
208
209
210
211
212
213
214
215
216
217
218
219
220
221
222
223
224
225
226
227
228
229
230
231
232
233
234
235
236
237
238
239
240
241
242
243
244
245
246
247
248
249
250
251
252
253
254
255
256
257
258
259
260
261
262
263
264
265
266
267
268
269
270
271
272
273
274
275
276
277
278
279
280
281
282
283
284
285
286
287
288
289
290
291
292
293
294
295
296
297
298</td><td class="line-coverage"><span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span></td><td class="text"><pre class="prettyprint lang-js">/**
 * Copyright JS Foundation and other contributors, http://js.foundation
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 **/
&nbsp;
var when = require("when");
var fs = require("fs");
var path = require("path");
&nbsp;
var events;
var log;
var i18n;
&nbsp;
var settings;
var disableNodePathScan = false;
&nbsp;
<span class="fstat-no" title="function not covered" >function init(runtime) {</span>
<span class="cstat-no" title="statement not covered" >    settings = runtime.settings;</span>
<span class="cstat-no" title="statement not covered" >    events = runtime.events;</span>
<span class="cstat-no" title="statement not covered" >    log = runtime.log;</span>
<span class="cstat-no" title="statement not covered" >    i18n = runtime.i18n;</span>
}
&nbsp;
<span class="fstat-no" title="function not covered" >function isExcluded(name) {</span>
<span class="cstat-no" title="statement not covered" >     if (settings.nodesExcludes) {</span>
<span class="cstat-no" title="statement not covered" >        for (var i=0;i&lt;settings.nodesExcludes.length;i++) {</span>
<span class="cstat-no" title="statement not covered" >            if (settings.nodesExcludes[i] == name) {</span>
<span class="cstat-no" title="statement not covered" >                return true;</span>
            }
        }
    }
<span class="cstat-no" title="statement not covered" >    return false;</span>
}
<span class="fstat-no" title="function not covered" >function getLocalFile(file) {</span>
<span class="cstat-no" title="statement not covered" >    if (isExcluded(path.basename(file))) {</span>
<span class="cstat-no" title="statement not covered" >        return null;</span>
    }
<span class="cstat-no" title="statement not covered" >    try {</span>
<span class="cstat-no" title="statement not covered" >        fs.statSync(file.replace(/\.js$/,".html"));</span>
<span class="cstat-no" title="statement not covered" >        return {</span>
            file:    file,
            module:  "node-red",
            name:    path.basename(file).replace(/^\d+-/,"").replace(/\.js$/,""),
            version: settings.version
        };
    } catch(err) {
<span class="cstat-no" title="statement not covered" >        return null;</span>
    }
}
&nbsp;
&nbsp;
/**
 * Synchronously walks the directory looking for node files.
 * Emits 'node-icon-dir' events for an icon dirs found
 * @param dir the directory to search
 * @return an array of fully-qualified paths to .js files
 */
<span class="fstat-no" title="function not covered" >function getLocalNodeFiles(dir) {</span>
<span class="cstat-no" title="statement not covered" >    var result = [];</span>
<span class="cstat-no" title="statement not covered" >    var files = [];</span>
<span class="cstat-no" title="statement not covered" >    try {</span>
<span class="cstat-no" title="statement not covered" >        files = fs.readdirSync(dir);</span>
    } catch(err) {
<span class="cstat-no" title="statement not covered" >        return result;</span>
    }
<span class="cstat-no" title="statement not covered" >    files.sort();</span>
<span class="cstat-no" title="statement not covered" >    files.forEach(<span class="fstat-no" title="function not covered" >function(fn) {</span></span>
<span class="cstat-no" title="statement not covered" >        var stats = fs.statSync(path.join(dir,fn));</span>
<span class="cstat-no" title="statement not covered" >        if (stats.isFile()) {</span>
<span class="cstat-no" title="statement not covered" >            if (/\.js$/.test(fn)) {</span>
<span class="cstat-no" title="statement not covered" >                var info = getLocalFile(path.join(dir,fn));</span>
<span class="cstat-no" title="statement not covered" >                if (info) {</span>
<span class="cstat-no" title="statement not covered" >                    result.push(info);</span>
                }
            }
        } else <span class="cstat-no" title="statement not covered" >if (stats.isDirectory()) {</span>
            // Ignore /.dirs/, /lib/ /node_modules/
<span class="cstat-no" title="statement not covered" >            if (!/^(\..*|lib|icons|node_modules|test|locales)$/.test(fn)) {</span>
<span class="cstat-no" title="statement not covered" >                result = result.concat(getLocalNodeFiles(path.join(dir,fn)));</span>
            } else <span class="cstat-no" title="statement not covered" >if (fn === "icons") {</span>
<span class="cstat-no" title="statement not covered" >                events.emit("node-icon-dir",path.join(dir,fn));</span>
            }
        }
    });
<span class="cstat-no" title="statement not covered" >    return result;</span>
}
&nbsp;
<span class="fstat-no" title="function not covered" >function scanDirForNodesModules(dir,moduleName) {</span>
<span class="cstat-no" title="statement not covered" >    var results = [];</span>
<span class="cstat-no" title="statement not covered" >    try {</span>
<span class="cstat-no" title="statement not covered" >        var files = fs.readdirSync(dir);</span>
<span class="cstat-no" title="statement not covered" >        for (var i=0;i&lt;files.length;i++) {</span>
<span class="cstat-no" title="statement not covered" >            var fn = files[i];</span>
<span class="cstat-no" title="statement not covered" >            if (/^@/.test(fn)) {</span>
<span class="cstat-no" title="statement not covered" >                results = results.concat(scanDirForNodesModules(path.join(dir,fn),moduleName));</span>
            } else {
<span class="cstat-no" title="statement not covered" >                if (!isExcluded(fn) &amp;&amp; (!moduleName || fn == moduleName)) {</span>
<span class="cstat-no" title="statement not covered" >                    var pkgfn = path.join(dir,fn,"package.json");</span>
<span class="cstat-no" title="statement not covered" >                    try {</span>
<span class="cstat-no" title="statement not covered" >                        var pkg = require(pkgfn);</span>
<span class="cstat-no" title="statement not covered" >                        if (pkg['node-red']) {</span>
<span class="cstat-no" title="statement not covered" >                            var moduleDir = path.join(dir,fn);</span>
<span class="cstat-no" title="statement not covered" >                            results.push({dir:moduleDir,package:pkg});</span>
                        }
                    } catch(err) {
<span class="cstat-no" title="statement not covered" >                        if (err.code != "MODULE_NOT_FOUND") {</span>
                            // TODO: handle unexpected error
                        }
                    }
<span class="cstat-no" title="statement not covered" >                    if (fn == moduleName) {</span>
<span class="cstat-no" title="statement not covered" >                        break;</span>
                    }
                }
            }
        }
    } catch(err) {
    }
<span class="cstat-no" title="statement not covered" >    return results;</span>
}
&nbsp;
/**
 * Scans the node_modules path for nodes
 * @param moduleName the name of the module to be found
 * @return a list of node modules: {dir,package}
 */
<span class="fstat-no" title="function not covered" >function scanTreeForNodesModules(moduleName) {</span>
<span class="cstat-no" title="statement not covered" >    var dir = settings.coreNodesDir;</span>
<span class="cstat-no" title="statement not covered" >    var results = [];</span>
<span class="cstat-no" title="statement not covered" >    var userDir;</span>
&nbsp;
<span class="cstat-no" title="statement not covered" >    if (settings.userDir) {</span>
<span class="cstat-no" title="statement not covered" >        userDir = path.join(settings.userDir,"node_modules");</span>
<span class="cstat-no" title="statement not covered" >        results = scanDirForNodesModules(userDir,moduleName);</span>
<span class="cstat-no" title="statement not covered" >        results.forEach(<span class="fstat-no" title="function not covered" >function(r) {</span> <span class="cstat-no" title="statement not covered" >r.local = true; </span>});</span>
    }
&nbsp;
<span class="cstat-no" title="statement not covered" >    if (dir) {</span>
<span class="cstat-no" title="statement not covered" >        var up = path.resolve(path.join(dir,".."));</span>
<span class="cstat-no" title="statement not covered" >        while (up !== dir) {</span>
<span class="cstat-no" title="statement not covered" >            var pm = path.join(dir,"node_modules");</span>
<span class="cstat-no" title="statement not covered" >            if (pm != userDir) {</span>
<span class="cstat-no" title="statement not covered" >                results = results.concat(scanDirForNodesModules(pm,moduleName));</span>
            }
<span class="cstat-no" title="statement not covered" >            dir = up;</span>
<span class="cstat-no" title="statement not covered" >            up = path.resolve(path.join(dir,".."));</span>
        }
    }
<span class="cstat-no" title="statement not covered" >    return results;</span>
}
&nbsp;
<span class="fstat-no" title="function not covered" >function getModuleNodeFiles(module) {</span>
&nbsp;
<span class="cstat-no" title="statement not covered" >    var moduleDir = module.dir;</span>
<span class="cstat-no" title="statement not covered" >    var pkg = module.package;</span>
&nbsp;
<span class="cstat-no" title="statement not covered" >    var nodes = pkg['node-red'].nodes||{};</span>
<span class="cstat-no" title="statement not covered" >    var results = [];</span>
<span class="cstat-no" title="statement not covered" >    var iconDirs = [];</span>
&nbsp;
<span class="cstat-no" title="statement not covered" >    for (var n in nodes) {</span>
        /* istanbul ignore else */
<span class="cstat-no" title="statement not covered" >        if (nodes.hasOwnProperty(n)) {</span>
<span class="cstat-no" title="statement not covered" >            var file = path.join(moduleDir,nodes[n]);</span>
<span class="cstat-no" title="statement not covered" >            results.push({</span>
                file:    file,
                module:  pkg.name,
                name:    n,
                version: pkg.version
            });
<span class="cstat-no" title="statement not covered" >            var iconDir = path.join(moduleDir,path.dirname(nodes[n]),"icons");</span>
<span class="cstat-no" title="statement not covered" >            if (iconDirs.indexOf(iconDir) == -1) {</span>
<span class="cstat-no" title="statement not covered" >                try {</span>
<span class="cstat-no" title="statement not covered" >                    fs.statSync(iconDir);</span>
<span class="cstat-no" title="statement not covered" >                    events.emit("node-icon-dir",iconDir);</span>
<span class="cstat-no" title="statement not covered" >                    iconDirs.push(iconDir);</span>
                } catch(err) {
                }
            }
        }
    }
<span class="cstat-no" title="statement not covered" >    var examplesDir = path.join(moduleDir,"examples");</span>
<span class="cstat-no" title="statement not covered" >    try {</span>
<span class="cstat-no" title="statement not covered" >        fs.statSync(examplesDir)</span>
<span class="cstat-no" title="statement not covered" >        events.emit("node-examples-dir",{name:pkg.name,path:examplesDir});</span>
    } catch(err) {
    }
<span class="cstat-no" title="statement not covered" >    return results;</span>
}
&nbsp;
<span class="fstat-no" title="function not covered" >function getNodeFiles(disableNodePathScan) {</span>
<span class="cstat-no" title="statement not covered" >    var dir;</span>
    // Find all of the nodes to load
<span class="cstat-no" title="statement not covered" >    var nodeFiles = [];</span>
&nbsp;
<span class="cstat-no" title="statement not covered" >    if (settings.coreNodesDir) {</span>
<span class="cstat-no" title="statement not covered" >        nodeFiles = getLocalNodeFiles(path.resolve(settings.coreNodesDir));</span>
<span class="cstat-no" title="statement not covered" >        var defaultLocalesPath = path.resolve(path.join(settings.coreNodesDir,"core","locales"));</span>
<span class="cstat-no" title="statement not covered" >        i18n.registerMessageCatalog("node-red",defaultLocalesPath,"messages.json");</span>
    }
&nbsp;
<span class="cstat-no" title="statement not covered" >    if (settings.userDir) {</span>
<span class="cstat-no" title="statement not covered" >        dir = path.join(settings.userDir,"nodes");</span>
<span class="cstat-no" title="statement not covered" >        nodeFiles = nodeFiles.concat(getLocalNodeFiles(dir));</span>
    }
<span class="cstat-no" title="statement not covered" >    if (settings.nodesDir) {</span>
<span class="cstat-no" title="statement not covered" >        dir = settings.nodesDir;</span>
<span class="cstat-no" title="statement not covered" >        if (typeof settings.nodesDir == "string") {</span>
<span class="cstat-no" title="statement not covered" >            dir = [dir];</span>
        }
<span class="cstat-no" title="statement not covered" >        for (var i=0;i&lt;dir.length;i++) {</span>
<span class="cstat-no" title="statement not covered" >            nodeFiles = nodeFiles.concat(getLocalNodeFiles(dir[i]));</span>
        }
    }
&nbsp;
<span class="cstat-no" title="statement not covered" >    var nodeList = {</span>
        "node-red": {
            name: "node-red",
            version: settings.version,
            nodes: {}
        }
    }
<span class="cstat-no" title="statement not covered" >    nodeFiles.forEach(<span class="fstat-no" title="function not covered" >function(node) {</span></span>
<span class="cstat-no" title="statement not covered" >        nodeList["node-red"].nodes[node.name] = node;</span>
    });
&nbsp;
<span class="cstat-no" title="statement not covered" >    if (!disableNodePathScan) {</span>
<span class="cstat-no" title="statement not covered" >        var moduleFiles = scanTreeForNodesModules();</span>
<span class="cstat-no" title="statement not covered" >        moduleFiles.forEach(<span class="fstat-no" title="function not covered" >function(moduleFile) {</span></span>
<span class="cstat-no" title="statement not covered" >            var nodeModuleFiles = getModuleNodeFiles(moduleFile);</span>
<span class="cstat-no" title="statement not covered" >            nodeList[moduleFile.package.name] = {</span>
                name: moduleFile.package.name,
                version: moduleFile.package.version,
                local: moduleFile.local||false,
                nodes: {}
            };
<span class="cstat-no" title="statement not covered" >            if (moduleFile.package['node-red'].version) {</span>
<span class="cstat-no" title="statement not covered" >                nodeList[moduleFile.package.name].redVersion = moduleFile.package['node-red'].version;</span>
            }
<span class="cstat-no" title="statement not covered" >            nodeModuleFiles.forEach(<span class="fstat-no" title="function not covered" >function(node) {</span></span>
<span class="cstat-no" title="statement not covered" >                node.local = moduleFile.local||false;</span>
<span class="cstat-no" title="statement not covered" >                nodeList[moduleFile.package.name].nodes[node.name] = node;</span>
            });
<span class="cstat-no" title="statement not covered" >            nodeFiles = nodeFiles.concat(nodeModuleFiles);</span>
        });
    } else {
<span class="cstat-no" title="statement not covered" >        console.log("node path scan disabled");</span>
    }
<span class="cstat-no" title="statement not covered" >    return nodeList;</span>
}
&nbsp;
<span class="fstat-no" title="function not covered" >function getModuleFiles(module) {</span>
<span class="cstat-no" title="statement not covered" >    var nodeList = {};</span>
&nbsp;
<span class="cstat-no" title="statement not covered" >    var moduleFiles = scanTreeForNodesModules(module);</span>
<span class="cstat-no" title="statement not covered" >    if (moduleFiles.length === 0) {</span>
<span class="cstat-no" title="statement not covered" >        var err = new Error(log._("nodes.registry.localfilesystem.module-not-found", {module:module}));</span>
<span class="cstat-no" title="statement not covered" >        err.code = 'MODULE_NOT_FOUND';</span>
<span class="cstat-no" title="statement not covered" >        throw err;</span>
    }
&nbsp;
<span class="cstat-no" title="statement not covered" >    moduleFiles.forEach(<span class="fstat-no" title="function not covered" >function(moduleFile) {</span></span>
<span class="cstat-no" title="statement not covered" >        var nodeModuleFiles = getModuleNodeFiles(moduleFile);</span>
<span class="cstat-no" title="statement not covered" >        nodeList[moduleFile.package.name] = {</span>
            name: moduleFile.package.name,
            version: moduleFile.package.version,
            nodes: {}
        };
<span class="cstat-no" title="statement not covered" >        if (moduleFile.package['node-red'].version) {</span>
<span class="cstat-no" title="statement not covered" >            nodeList[moduleFile.package.name].redVersion = moduleFile.package['node-red'].version;</span>
        }
<span class="cstat-no" title="statement not covered" >        nodeModuleFiles.forEach(<span class="fstat-no" title="function not covered" >function(node) {</span></span>
<span class="cstat-no" title="statement not covered" >            nodeList[moduleFile.package.name].nodes[node.name] = node;</span>
<span class="cstat-no" title="statement not covered" >            nodeList[moduleFile.package.name].nodes[node.name].local = moduleFile.local || false;</span>
        });
    });
<span class="cstat-no" title="statement not covered" >    return nodeList;</span>
}
&nbsp;
&nbsp;
module.exports = {
    init: init,
    getNodeFiles: getNodeFiles,
    getLocalFile: getLocalFile,
    getModuleFiles: getModuleFiles
}
&nbsp;
&nbsp;</pre></td></tr>
</table></pre>
</div>
<div class="footer">
    <div class="meta">Generated by <a href="https://github.com/kaizhu256/node-utility2" target="_blank">utility2</a> at Tue Apr 11 2017 17:25:15 GMT+0000 (UTC)</div>
</div>
</body>
</html>


<!doctype html>
<html lang="en">
<head>
    <title>Code coverage report for node-npmtest-node-red/node-red/red/runtime/nodes/registry/registry.js</title>
    <meta charset="utf-8">
    <style>
        body, html {
            margin:0; padding: 0;
        }
        body {
            font-family: Arial, Helvetica;
            font-size: 10pt;
        }
        div.header, div.footer {
            background: #eee;
            padding: 1em;
        }
        div.header {
            height: 160px;
            padding: 0 1em 0 1em;
            z-index: 100;
            position: fixed;
            top: 0;
            border-bottom: 1px solid #666;
            width: 100%;
        }
        div.footer {
            border-top: 1px solid #666;
        }
        div.body {
            margin-top: 170px;
        }
        div.meta {
            font-size: 90%;
            text-align: center;
        }
        h1, h2, h3 {
            font-weight: normal;
        }
        h1 {
            font-size: 12pt;
        }
        h2 {
            font-size: 10pt;
        }
        pre {
            font-family: Menlo, Monaco, Consolas, Courier New, monospace;
            margin: 0;
            padding: 0;
            font-size: 14px;
            tab-size: 2;
        }

        div.path { font-size: 110%; }
        div.path a:link, div.path a:visited { color: #000; }
        table.coverage { border-collapse: collapse; margin:0; padding: 0 }

        table.coverage td {
            margin: 0;
            padding: 0;
            color: #111;
            vertical-align: top;
        }
        table.coverage td.line-count {
            width: 50px;
            text-align: right;
            padding-right: 5px;
        }
        table.coverage td.line-coverage {
            color: #777 !important;
            text-align: right;
            border-left: 1px solid #666;
            border-right: 1px solid #666;
        }

        table.coverage td.text {
        }

        table.coverage td span.cline-any {
            display: inline-block;
            padding: 0 5px;
            width: 40px;
        }
        table.coverage td span.cline-neutral {
            background: #eee;
        }
        table.coverage td span.cline-yes {
            background: #b5d592;
            color: #999;
        }
        table.coverage td span.cline-no {
            background: #fc8c84;
        }

        .cstat-yes { color: #111; }
        .cstat-no { background: #fc8c84; color: #111; }
        .fstat-no { background: #ffc520; color: #111 !important; }
        .cbranch-no { background:  yellow !important; color: #111; }

        .cstat-skip { background: #ddd; color: #111; }
        .fstat-skip { background: #ddd; color: #111 !important; }
        .cbranch-skip { background: #ddd !important; color: #111; }

        .missing-if-branch {
            display: inline-block;
            margin-right: 10px;
            position: relative;
            padding: 0 4px;
            background: black;
            color: yellow;
        }

        .skip-if-branch {
            display: none;
            margin-right: 10px;
            position: relative;
            padding: 0 4px;
            background: #ccc;
            color: white;
        }

        .missing-if-branch .typ, .skip-if-branch .typ {
            color: inherit !important;
        }

        .entity, .metric { font-weight: bold; }
        .metric { display: inline-block; border: 1px solid #333; padding: 0.3em; background: white; }
        .metric small { font-size: 80%; font-weight: normal; color: #666; }

        div.coverage-summary table { border-collapse: collapse; margin: 3em; font-size: 110%; }
        div.coverage-summary td, div.coverage-summary table  th { margin: 0; padding: 0.25em 1em; border-top: 1px solid #666; border-bottom: 1px solid #666; }
        div.coverage-summary th { text-align: left; border: 1px solid #666; background: #eee; font-weight: normal; }
        div.coverage-summary th.file { border-right: none !important; }
        div.coverage-summary th.pic { border-left: none !important; text-align: right; }
        div.coverage-summary th.pct { border-right: none !important; }
        div.coverage-summary th.abs { border-left: none !important; text-align: right; }
        div.coverage-summary td.pct { text-align: right; border-left: 1px solid #666; }
        div.coverage-summary td.abs { text-align: right; font-size: 90%; color: #444; border-right: 1px solid #666; }
        div.coverage-summary td.file { text-align: right; border-left: 1px solid #666; white-space: nowrap;  }
        div.coverage-summary td.pic { min-width: 120px !important;  }
        div.coverage-summary a:link { color: #000; }
        div.coverage-summary a:visited { color: #333; }
        div.coverage-summary tfoot td { border-top: 1px solid #666; }

        div.coverage-summary .yui3-datatable-sort-indicator, div.coverage-summary .dummy-sort-indicator {
            height: 10px;
            width: 7px;
            display: inline-block;
            margin-left: 0.5em;
        }
        div.coverage-summary .yui3-datatable-sort-indicator {
            background: no-repeat scroll 0 0 transparent;
        }
        div.coverage-summary .yui3-datatable-sorted .yui3-datatable-sort-indicator {
            background-position: 0 -20px;
        }
        div.coverage-summary .yui3-datatable-sorted-desc .yui3-datatable-sort-indicator {
            background-position: 0 -10px;
        }

        .high { background: #b5d592 !important; }
        .medium { background: #ffe87c !important; }
        .low { background: #fc8c84 !important; }

        span.cover-fill, span.cover-empty {
            display:inline-block;
            border:1px solid #444;
            background: white;
            height: 12px;
        }
        span.cover-fill {
            background: #ccc;
            border-right: 1px solid #444;
        }
        span.cover-empty {
            background: white;
            border-left: none;
        }
        span.cover-full {
            border-right: none !important;
        }
        pre.prettyprint {
            border: none !important;
            padding: 0 !important;
            margin: 0 !important;
        }
        .com { color: #999 !important; }
        .ignore-none { color: #999; font-weight: normal; }

    </style>
</head>
<body>
<div class="header low">
    <h1 style="font-weight: bold;">
        <a href="https://github.com/npmtest/node-npmtest-node-red">npmtest-node-red (v0.0.1)</a>
    </h1>
    <h1>Code coverage report for <span class="entity">node-npmtest-node-red/node-red/red/runtime/nodes/registry/registry.js</span></h1>
    <h2>
        
        Statements: <span class="metric">13.18% <small>(39 / 296)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        
        Branches: <span class="metric">7.14% <small>(10 / 140)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        
        Functions: <span class="metric">0% <small>(0 / 31)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        
        Lines: <span class="metric">13.22% <small>(39 / 295)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        Ignored: <span class="metric">10 branches</span> &nbsp;&nbsp;&nbsp;&nbsp;
    </h2>
    <div class="path"><a href="../../../../../../index.html">All files</a> &#187; <a href="index.html">node-npmtest-node-red/node-red/red/runtime/nodes/registry/</a> &#187; registry.js</div>
</div>
<div class="body">
<pre><table class="coverage">
<tr><td class="line-count">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
164
165
166
167
168
169
170
171
172
173
174
175
176
177
178
179
180
181
182
183
184
185
186
187
188
189
190
191
192
193
194
195
196
197
198
199
200
201
202
203
204
205
206
207
208
209
210
211
212
213
214
215
216
217
218
219
220
221
222
223
224
225
226
227
228
229
230
231
232
233
234
235
236
237
238
239
240
241
242
243
244
245
246
247
248
249
250
251
252
253
254
255
256
257
258
259
260
261
262
263
264
265
266
267
268
269
270
271
272
273
274
275
276
277
278
279
280
281
282
283
284
285
286
287
288
289
290
291
292
293
294
295
296
297
298
299
300
301
302
303
304
305
306
307
308
309
310
311
312
313
314
315
316
317
318
319
320
321
322
323
324
325
326
327
328
329
330
331
332
333
334
335
336
337
338
339
340
341
342
343
344
345
346
347
348
349
350
351
352
353
354
355
356
357
358
359
360
361
362
363
364
365
366
367
368
369
370
371
372
373
374
375
376
377
378
379
380
381
382
383
384
385
386
387
388
389
390
391
392
393
394
395
396
397
398
399
400
401
402
403
404
405
406
407
408
409
410
411
412
413
414
415
416
417
418
419
420
421
422
423
424
425
426
427
428
429
430
431
432
433
434
435
436
437
438
439
440
441
442
443
444
445
446
447
448
449
450
451
452
453
454
455
456
457
458
459
460
461
462
463
464
465
466
467
468
469
470
471
472
473
474
475
476
477
478
479
480
481
482
483
484
485
486
487
488
489
490
491
492
493
494
495
496
497
498
499
500
501
502
503
504
505
506
507
508
509
510
511
512
513
514
515
516
517
518
519
520
521
522
523
524
525
526
527
528
529
530
531
532
533
534
535
536
537
538
539
540
541
542
543
544
545
546
547
548
549
550
551
552
553
554
555
556
557
558
559
560
561
562
563
564
565
566
567
568
569
570
571
572
573
574
575
576
577</td><td class="line-coverage"><span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span></td><td class="text"><pre class="prettyprint lang-js">/**
 * Copyright JS Foundation and other contributors, http://js.foundation
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 **/
&nbsp;
 //var UglifyJS = require("uglify-js");
var util = require("util");
var when = require("when");
var events = require("../../events");
&nbsp;
var settings;
&nbsp;
var Node;
&nbsp;
var loader;
&nbsp;
var nodeConfigCache = null;
var moduleConfigs = {};
var nodeList = [];
var nodeConstructors = {};
var nodeTypeToId = {};
var moduleNodes = {};
&nbsp;
<span class="fstat-no" title="function not covered" >function init(_settings,_loader) {</span>
<span class="cstat-no" title="statement not covered" >    settings = _settings;</span>
<span class="cstat-no" title="statement not covered" >    loader = _loader;</span>
<span class="cstat-no" title="statement not covered" >    moduleNodes = {};</span>
<span class="cstat-no" title="statement not covered" >    nodeTypeToId = {};</span>
<span class="cstat-no" title="statement not covered" >    nodeConstructors = {};</span>
<span class="cstat-no" title="statement not covered" >    nodeList = [];</span>
<span class="cstat-no" title="statement not covered" >    nodeConfigCache = null;</span>
<span class="cstat-no" title="statement not covered" >    Node = require("../Node");</span>
}
&nbsp;
<span class="fstat-no" title="function not covered" >function load() {</span>
<span class="cstat-no" title="statement not covered" >    if (settings.available()) {</span>
<span class="cstat-no" title="statement not covered" >        moduleConfigs = loadNodeConfigs();</span>
    } else {
<span class="cstat-no" title="statement not covered" >        moduleConfigs = {};</span>
    }
}
&nbsp;
<span class="fstat-no" title="function not covered" >function filterNodeInfo(n) {</span>
<span class="cstat-no" title="statement not covered" >    var r = {</span>
        id: n.id||n.module+"/"+n.name,
        name: n.name,
        types: n.types,
        enabled: n.enabled,
        local: n.local||false
    };
<span class="cstat-no" title="statement not covered" >    if (n.hasOwnProperty("module")) {</span>
<span class="cstat-no" title="statement not covered" >        r.module = n.module;</span>
    }
<span class="cstat-no" title="statement not covered" >    if (n.hasOwnProperty("err")) {</span>
<span class="cstat-no" title="statement not covered" >        r.err = n.err.toString();</span>
    }
<span class="cstat-no" title="statement not covered" >    return r;</span>
}
&nbsp;
&nbsp;
&nbsp;
<span class="fstat-no" title="function not covered" >function getModule(id) {</span>
<span class="cstat-no" title="statement not covered" >    var parts = id.split("/");</span>
<span class="cstat-no" title="statement not covered" >    return parts.slice(0,parts.length-1).join("/");</span>
}
&nbsp;
<span class="fstat-no" title="function not covered" >function getNode(id) {</span>
<span class="cstat-no" title="statement not covered" >    var parts = id.split("/");</span>
<span class="cstat-no" title="statement not covered" >    return parts[parts.length-1];</span>
}
&nbsp;
<span class="fstat-no" title="function not covered" >function saveNodeList() {</span>
<span class="cstat-no" title="statement not covered" >    var moduleList = {};</span>
&nbsp;
<span class="cstat-no" title="statement not covered" >    for (var module in moduleConfigs) {</span>
        /* istanbul ignore else */
<span class="cstat-no" title="statement not covered" >        if (moduleConfigs.hasOwnProperty(module)) {</span>
<span class="cstat-no" title="statement not covered" >            if (Object.keys(moduleConfigs[module].nodes).length &gt; 0) {</span>
<span class="cstat-no" title="statement not covered" >                if (!moduleList[module]) {</span>
<span class="cstat-no" title="statement not covered" >                    moduleList[module] = {</span>
                        name: module,
                        version: moduleConfigs[module].version,
                        local: moduleConfigs[module].local||false,
                        nodes: {}
                    };
                }
<span class="cstat-no" title="statement not covered" >                var nodes = moduleConfigs[module].nodes;</span>
<span class="cstat-no" title="statement not covered" >                for(var node in nodes) {</span>
                    /* istanbul ignore else */
<span class="cstat-no" title="statement not covered" >                    if (nodes.hasOwnProperty(node)) {</span>
<span class="cstat-no" title="statement not covered" >                        var config = nodes[node];</span>
<span class="cstat-no" title="statement not covered" >                        var n = filterNodeInfo(config);</span>
<span class="cstat-no" title="statement not covered" >                        delete n.err;</span>
<span class="cstat-no" title="statement not covered" >                        delete n.file;</span>
<span class="cstat-no" title="statement not covered" >                        delete n.id;</span>
<span class="cstat-no" title="statement not covered" >                        n.file = config.file;</span>
<span class="cstat-no" title="statement not covered" >                        moduleList[module].nodes[node] = n;</span>
                    }
                }
            }
        }
    }
<span class="cstat-no" title="statement not covered" >    if (settings.available()) {</span>
<span class="cstat-no" title="statement not covered" >        return settings.set("nodes",moduleList);</span>
    } else {
<span class="cstat-no" title="statement not covered" >        return when.reject("Settings unavailable");</span>
    }
}
&nbsp;
<span class="fstat-no" title="function not covered" >function loadNodeConfigs() {</span>
<span class="cstat-no" title="statement not covered" >    var configs = settings.get("nodes");</span>
&nbsp;
<span class="cstat-no" title="statement not covered" >    if (!configs) {</span>
<span class="cstat-no" title="statement not covered" >        return {};</span>
    } else <span class="cstat-no" title="statement not covered" >if (configs['node-red']) {</span>
<span class="cstat-no" title="statement not covered" >        return configs;</span>
    } else {
        // Migrate from the 0.9.1 format of settings
<span class="cstat-no" title="statement not covered" >        var newConfigs = {};</span>
<span class="cstat-no" title="statement not covered" >        for (var id in configs) {</span>
            /* istanbul ignore else */
<span class="cstat-no" title="statement not covered" >            if (configs.hasOwnProperty(id)) {</span>
<span class="cstat-no" title="statement not covered" >                var nodeConfig = configs[id];</span>
<span class="cstat-no" title="statement not covered" >                var moduleName;</span>
<span class="cstat-no" title="statement not covered" >                var nodeSetName;</span>
&nbsp;
<span class="cstat-no" title="statement not covered" >                if (nodeConfig.module) {</span>
<span class="cstat-no" title="statement not covered" >                    moduleName = nodeConfig.module;</span>
<span class="cstat-no" title="statement not covered" >                    nodeSetName = nodeConfig.name.split(":")[1];</span>
                } else {
<span class="cstat-no" title="statement not covered" >                    moduleName = "node-red";</span>
<span class="cstat-no" title="statement not covered" >                    nodeSetName = nodeConfig.name.replace(/^\d+-/,"").replace(/\.js$/,"");</span>
                }
&nbsp;
<span class="cstat-no" title="statement not covered" >                if (!newConfigs[moduleName]) {</span>
<span class="cstat-no" title="statement not covered" >                    newConfigs[moduleName] = {</span>
                        name: moduleName,
                        nodes:{}
                    };
                }
<span class="cstat-no" title="statement not covered" >                newConfigs[moduleName].nodes[nodeSetName] = {</span>
                    name: nodeSetName,
                    types: nodeConfig.types,
                    enabled: nodeConfig.enabled,
                    module: moduleName
                };
            }
        }
<span class="cstat-no" title="statement not covered" >        settings.set("nodes",newConfigs);</span>
<span class="cstat-no" title="statement not covered" >        return newConfigs;</span>
    }
}
&nbsp;
<span class="fstat-no" title="function not covered" >function addNodeSet(id,set,version) {</span>
<span class="cstat-no" title="statement not covered" >    if (!set.err) {</span>
<span class="cstat-no" title="statement not covered" >        set.types.forEach(<span class="fstat-no" title="function not covered" >function(t) {</span></span>
<span class="cstat-no" title="statement not covered" >            nodeTypeToId[t] = id;</span>
        });
    }
<span class="cstat-no" title="statement not covered" >    moduleNodes[set.module] = moduleNodes[set.module]||[];</span>
<span class="cstat-no" title="statement not covered" >    moduleNodes[set.module].push(set.name);</span>
&nbsp;
<span class="cstat-no" title="statement not covered" >    if (!moduleConfigs[set.module]) {</span>
<span class="cstat-no" title="statement not covered" >        moduleConfigs[set.module] = {</span>
            name: set.module,
            nodes: {}
        };
    }
&nbsp;
<span class="cstat-no" title="statement not covered" >    if (version) {</span>
<span class="cstat-no" title="statement not covered" >        moduleConfigs[set.module].version = version;</span>
    }
<span class="cstat-no" title="statement not covered" >    moduleConfigs[set.module].local = set.local;</span>
&nbsp;
<span class="cstat-no" title="statement not covered" >    moduleConfigs[set.module].nodes[set.name] = set;</span>
<span class="cstat-no" title="statement not covered" >    nodeList.push(id);</span>
<span class="cstat-no" title="statement not covered" >    nodeConfigCache = null;</span>
}
&nbsp;
<span class="fstat-no" title="function not covered" >function removeNode(id) {</span>
<span class="cstat-no" title="statement not covered" >    var config = moduleConfigs[getModule(id)].nodes[getNode(id)];</span>
<span class="cstat-no" title="statement not covered" >    if (!config) {</span>
<span class="cstat-no" title="statement not covered" >        throw new Error("Unrecognised id: "+id);</span>
    }
<span class="cstat-no" title="statement not covered" >    delete moduleConfigs[getModule(id)].nodes[getNode(id)];</span>
<span class="cstat-no" title="statement not covered" >    var i = nodeList.indexOf(id);</span>
<span class="cstat-no" title="statement not covered" >    if (i &gt; -1) {</span>
<span class="cstat-no" title="statement not covered" >        nodeList.splice(i,1);</span>
    }
<span class="cstat-no" title="statement not covered" >    config.types.forEach(<span class="fstat-no" title="function not covered" >function(t) {</span></span>
<span class="cstat-no" title="statement not covered" >        var typeId = nodeTypeToId[t];</span>
<span class="cstat-no" title="statement not covered" >        if (typeId === id) {</span>
<span class="cstat-no" title="statement not covered" >            delete nodeConstructors[t];</span>
<span class="cstat-no" title="statement not covered" >            delete nodeTypeToId[t];</span>
        }
    });
<span class="cstat-no" title="statement not covered" >    config.enabled = false;</span>
<span class="cstat-no" title="statement not covered" >    config.loaded = false;</span>
<span class="cstat-no" title="statement not covered" >    nodeConfigCache = null;</span>
<span class="cstat-no" title="statement not covered" >    return filterNodeInfo(config);</span>
}
&nbsp;
<span class="fstat-no" title="function not covered" >function removeModule(module) {</span>
<span class="cstat-no" title="statement not covered" >    if (!settings.available()) {</span>
<span class="cstat-no" title="statement not covered" >        throw new Error("Settings unavailable");</span>
    }
<span class="cstat-no" title="statement not covered" >    var nodes = moduleNodes[module];</span>
<span class="cstat-no" title="statement not covered" >    if (!nodes) {</span>
<span class="cstat-no" title="statement not covered" >        throw new Error("Unrecognised module: "+module);</span>
    }
<span class="cstat-no" title="statement not covered" >    var infoList = [];</span>
<span class="cstat-no" title="statement not covered" >    for (var i=0;i&lt;nodes.length;i++) {</span>
<span class="cstat-no" title="statement not covered" >        infoList.push(removeNode(module+"/"+nodes[i]));</span>
    }
<span class="cstat-no" title="statement not covered" >    delete moduleNodes[module];</span>
<span class="cstat-no" title="statement not covered" >    delete moduleConfigs[module];</span>
<span class="cstat-no" title="statement not covered" >    saveNodeList();</span>
<span class="cstat-no" title="statement not covered" >    return infoList;</span>
}
&nbsp;
<span class="fstat-no" title="function not covered" >function getNodeInfo(typeOrId) {</span>
<span class="cstat-no" title="statement not covered" >    var id = typeOrId;</span>
<span class="cstat-no" title="statement not covered" >    if (nodeTypeToId.hasOwnProperty(typeOrId)) {</span>
<span class="cstat-no" title="statement not covered" >        id = nodeTypeToId[typeOrId];</span>
    }
    /* istanbul ignore else */
<span class="cstat-no" title="statement not covered" >    if (id) {</span>
<span class="cstat-no" title="statement not covered" >        var module = moduleConfigs[getModule(id)];</span>
<span class="cstat-no" title="statement not covered" >        if (module) {</span>
<span class="cstat-no" title="statement not covered" >            var config = module.nodes[getNode(id)];</span>
<span class="cstat-no" title="statement not covered" >            if (config) {</span>
<span class="cstat-no" title="statement not covered" >                var info = filterNodeInfo(config);</span>
<span class="cstat-no" title="statement not covered" >                if (config.hasOwnProperty("loaded")) {</span>
<span class="cstat-no" title="statement not covered" >                    info.loaded = config.loaded;</span>
                }
<span class="cstat-no" title="statement not covered" >                info.version = module.version;</span>
<span class="cstat-no" title="statement not covered" >                return info;</span>
            }
        }
    }
<span class="cstat-no" title="statement not covered" >    return null;</span>
}
&nbsp;
<span class="fstat-no" title="function not covered" >function getFullNodeInfo(typeOrId) {</span>
    // Used by index.enableNodeSet so that .file can be retrieved to pass
    // to loader.loadNodeSet
<span class="cstat-no" title="statement not covered" >    var id = typeOrId;</span>
<span class="cstat-no" title="statement not covered" >    if (nodeTypeToId.hasOwnProperty(typeOrId)) {</span>
<span class="cstat-no" title="statement not covered" >        id = nodeTypeToId[typeOrId];</span>
    }
    /* istanbul ignore else */
<span class="cstat-no" title="statement not covered" >    if (id) {</span>
<span class="cstat-no" title="statement not covered" >        var module = moduleConfigs[getModule(id)];</span>
<span class="cstat-no" title="statement not covered" >        if (module) {</span>
<span class="cstat-no" title="statement not covered" >            return module.nodes[getNode(id)];</span>
        }
    }
<span class="cstat-no" title="statement not covered" >    return null;</span>
}
&nbsp;
<span class="fstat-no" title="function not covered" >function getNodeList(filter) {</span>
<span class="cstat-no" title="statement not covered" >    var list = [];</span>
<span class="cstat-no" title="statement not covered" >    for (var module in moduleConfigs) {</span>
        /* istanbul ignore else */
<span class="cstat-no" title="statement not covered" >        if (moduleConfigs.hasOwnProperty(module)) {</span>
<span class="cstat-no" title="statement not covered" >            var nodes = moduleConfigs[module].nodes;</span>
<span class="cstat-no" title="statement not covered" >            for (var node in nodes) {</span>
                /* istanbul ignore else */
<span class="cstat-no" title="statement not covered" >                if (nodes.hasOwnProperty(node)) {</span>
<span class="cstat-no" title="statement not covered" >                    var nodeInfo = filterNodeInfo(nodes[node]);</span>
<span class="cstat-no" title="statement not covered" >                    nodeInfo.version = moduleConfigs[module].version;</span>
<span class="cstat-no" title="statement not covered" >                    if (!filter || filter(nodes[node])) {</span>
<span class="cstat-no" title="statement not covered" >                        list.push(nodeInfo);</span>
                    }
                }
            }
        }
    }
<span class="cstat-no" title="statement not covered" >    return list;</span>
}
&nbsp;
<span class="fstat-no" title="function not covered" >function getModuleList() {</span>
    //var list = [];
    //for (var module in moduleNodes) {
    //    /* istanbul ignore else */
    //    if (moduleNodes.hasOwnProperty(module)) {
    //        list.push(registry.getModuleInfo(module));
    //    }
    //}
    //return list;
<span class="cstat-no" title="statement not covered" >    return moduleConfigs;</span>
&nbsp;
}
&nbsp;
<span class="fstat-no" title="function not covered" >function getModuleInfo(module) {</span>
<span class="cstat-no" title="statement not covered" >    if (moduleNodes[module]) {</span>
<span class="cstat-no" title="statement not covered" >        var nodes = moduleNodes[module];</span>
<span class="cstat-no" title="statement not covered" >        var m = {</span>
            name: module,
            version: moduleConfigs[module].version,
            local: moduleConfigs[module].local,
            nodes: []
        };
<span class="cstat-no" title="statement not covered" >        for (var i = 0; i &lt; nodes.length; ++i) {</span>
<span class="cstat-no" title="statement not covered" >            var nodeInfo = filterNodeInfo(moduleConfigs[module].nodes[nodes[i]]);</span>
<span class="cstat-no" title="statement not covered" >            nodeInfo.version = m.version;</span>
<span class="cstat-no" title="statement not covered" >            m.nodes.push(nodeInfo);</span>
        }
<span class="cstat-no" title="statement not covered" >        return m;</span>
    } else {
<span class="cstat-no" title="statement not covered" >        return null;</span>
    }
}
&nbsp;
<span class="fstat-no" title="function not covered" >function getCaller(){</span>
<span class="cstat-no" title="statement not covered" >    var orig = Error.prepareStackTrace;</span>
<span class="cstat-no" title="statement not covered" >    Error.prepareStackTrace = <span class="fstat-no" title="function not covered" >function(_, stack){</span> <span class="cstat-no" title="statement not covered" >return stack; </span>};</span>
<span class="cstat-no" title="statement not covered" >    var err = new Error();</span>
<span class="cstat-no" title="statement not covered" >    Error.captureStackTrace(err, arguments.callee);</span>
<span class="cstat-no" title="statement not covered" >    var stack = err.stack;</span>
<span class="cstat-no" title="statement not covered" >    Error.prepareStackTrace = orig;</span>
<span class="cstat-no" title="statement not covered" >    stack.shift();</span>
<span class="cstat-no" title="statement not covered" >    stack.shift();</span>
<span class="cstat-no" title="statement not covered" >    return stack[0].getFileName();</span>
}
&nbsp;
<span class="fstat-no" title="function not covered" >function inheritNode(constructor) {</span>
<span class="cstat-no" title="statement not covered" >    if(Object.getPrototypeOf(constructor.prototype) === Object.prototype) {</span>
<span class="cstat-no" title="statement not covered" >        util.inherits(constructor,Node);</span>
    } else {
<span class="cstat-no" title="statement not covered" >        var proto = constructor.prototype;</span>
<span class="cstat-no" title="statement not covered" >        while(Object.getPrototypeOf(proto) !== Object.prototype) {</span>
<span class="cstat-no" title="statement not covered" >            proto = Object.getPrototypeOf(proto);</span>
        }
        //TODO: This is a partial implementation of util.inherits &gt;= node v5.0.0
        //      which should be changed when support for node &lt; v5.0.0 is dropped
        //      see: https://github.com/nodejs/node/pull/3455
<span class="cstat-no" title="statement not covered" >        proto.constructor.super_ = Node;</span>
<span class="cstat-no" title="statement not covered" >        if(Object.setPrototypeOf) {</span>
<span class="cstat-no" title="statement not covered" >            Object.setPrototypeOf(proto, Node.prototype);</span>
        } else {
            // hack for node v0.10
<span class="cstat-no" title="statement not covered" >            proto.__proto__ = Node.prototype;</span>
        }
    }
}
&nbsp;
<span class="fstat-no" title="function not covered" >function registerNodeConstructor(nodeSet,type,constructor) {</span>
<span class="cstat-no" title="statement not covered" >    if (nodeConstructors.hasOwnProperty(type)) {</span>
<span class="cstat-no" title="statement not covered" >        throw new Error(type+" already registered");</span>
    }
    //TODO: Ensure type is known - but doing so will break some tests
    //      that don't have a way to register a node template ahead
    //      of registering the constructor
<span class="cstat-no" title="statement not covered" >    if(!(constructor.prototype instanceof Node)) {</span>
<span class="cstat-no" title="statement not covered" >        inheritNode(constructor);</span>
    }
&nbsp;
<span class="cstat-no" title="statement not covered" >    var nodeSetInfo = getFullNodeInfo(nodeSet);</span>
<span class="cstat-no" title="statement not covered" >    if (nodeSetInfo) {</span>
<span class="cstat-no" title="statement not covered" >        if (nodeSetInfo.types.indexOf(type) === -1) {</span>
            // A type is being registered for a known set, but for some reason
            // we didn't spot it when parsing the HTML file.
            // Registered a type is the definitive action - not the presence
            // of an edit template. Ensure it is on the list of known types.
<span class="cstat-no" title="statement not covered" >            nodeSetInfo.types.push(type);</span>
        }
    }
&nbsp;
<span class="cstat-no" title="statement not covered" >    nodeConstructors[type] = constructor;</span>
<span class="cstat-no" title="statement not covered" >    events.emit("type-registered",type);</span>
}
&nbsp;
<span class="fstat-no" title="function not covered" >function getAllNodeConfigs(lang) {</span>
<span class="cstat-no" title="statement not covered" >    if (!nodeConfigCache) {</span>
<span class="cstat-no" title="statement not covered" >        var result = "";</span>
<span class="cstat-no" title="statement not covered" >        var script = "";</span>
<span class="cstat-no" title="statement not covered" >        for (var i=0;i&lt;nodeList.length;i++) {</span>
<span class="cstat-no" title="statement not covered" >            var id = nodeList[i];</span>
<span class="cstat-no" title="statement not covered" >            var config = moduleConfigs[getModule(id)].nodes[getNode(id)];</span>
<span class="cstat-no" title="statement not covered" >            if (config.enabled &amp;&amp; !config.err) {</span>
<span class="cstat-no" title="statement not covered" >                result += config.config;</span>
<span class="cstat-no" title="statement not covered" >                result += loader.getNodeHelp(config,lang||"en-US")||"";</span>
                //script += config.script;
            }
        }
        //if (script.length &gt; 0) {
        //    result += '&lt;script type="text/javascript"&gt;';
        //    result += UglifyJS.minify(script, {fromString: true}).code;
        //    result += '&lt;/script&gt;';
        //}
<span class="cstat-no" title="statement not covered" >        nodeConfigCache = result;</span>
    }
<span class="cstat-no" title="statement not covered" >    return nodeConfigCache;</span>
}
&nbsp;
<span class="fstat-no" title="function not covered" >function getNodeConfig(id,lang) {</span>
<span class="cstat-no" title="statement not covered" >    var config = moduleConfigs[getModule(id)];</span>
<span class="cstat-no" title="statement not covered" >    if (!config) {</span>
<span class="cstat-no" title="statement not covered" >        return null;</span>
    }
<span class="cstat-no" title="statement not covered" >    config = config.nodes[getNode(id)];</span>
<span class="cstat-no" title="statement not covered" >    if (config) {</span>
<span class="cstat-no" title="statement not covered" >        var result = config.config;</span>
<span class="cstat-no" title="statement not covered" >        result += loader.getNodeHelp(config,lang||"en-US")</span>
&nbsp;
        //if (config.script) {
        //    result += '&lt;script type="text/javascript"&gt;'+config.script+'&lt;/script&gt;';
        //}
<span class="cstat-no" title="statement not covered" >        return result;</span>
    } else {
<span class="cstat-no" title="statement not covered" >        return null;</span>
    }
}
&nbsp;
<span class="fstat-no" title="function not covered" >function getNodeConstructor(type) {</span>
<span class="cstat-no" title="statement not covered" >    var id = nodeTypeToId[type];</span>
&nbsp;
<span class="cstat-no" title="statement not covered" >    var config;</span>
<span class="cstat-no" title="statement not covered" >    if (typeof id === "undefined") {</span>
<span class="cstat-no" title="statement not covered" >        config = undefined;</span>
    } else {
<span class="cstat-no" title="statement not covered" >        config = moduleConfigs[getModule(id)].nodes[getNode(id)];</span>
    }
&nbsp;
<span class="cstat-no" title="statement not covered" >    if (!config || (config.enabled &amp;&amp; !config.err)) {</span>
<span class="cstat-no" title="statement not covered" >        return nodeConstructors[type];</span>
    }
<span class="cstat-no" title="statement not covered" >    return null;</span>
}
&nbsp;
<span class="fstat-no" title="function not covered" >function clear() {</span>
<span class="cstat-no" title="statement not covered" >    nodeConfigCache = null;</span>
<span class="cstat-no" title="statement not covered" >    moduleConfigs = {};</span>
<span class="cstat-no" title="statement not covered" >    nodeList = [];</span>
<span class="cstat-no" title="statement not covered" >    nodeConstructors = {};</span>
<span class="cstat-no" title="statement not covered" >    nodeTypeToId = {};</span>
}
&nbsp;
<span class="fstat-no" title="function not covered" >function getTypeId(type) {</span>
<span class="cstat-no" title="statement not covered" >    if (nodeTypeToId.hasOwnProperty(type)) {</span>
<span class="cstat-no" title="statement not covered" >        return nodeTypeToId[type];</span>
    } else {
<span class="cstat-no" title="statement not covered" >        return null;</span>
    }
}
&nbsp;
<span class="fstat-no" title="function not covered" >function enableNodeSet(typeOrId) {</span>
<span class="cstat-no" title="statement not covered" >    if (!settings.available()) {</span>
<span class="cstat-no" title="statement not covered" >        throw new Error("Settings unavailable");</span>
    }
&nbsp;
<span class="cstat-no" title="statement not covered" >    var id = typeOrId;</span>
<span class="cstat-no" title="statement not covered" >    if (nodeTypeToId.hasOwnProperty(typeOrId)) {</span>
<span class="cstat-no" title="statement not covered" >        id = nodeTypeToId[typeOrId];</span>
    }
<span class="cstat-no" title="statement not covered" >    var config;</span>
<span class="cstat-no" title="statement not covered" >    try {</span>
<span class="cstat-no" title="statement not covered" >        config = moduleConfigs[getModule(id)].nodes[getNode(id)];</span>
<span class="cstat-no" title="statement not covered" >        delete config.err;</span>
<span class="cstat-no" title="statement not covered" >        config.enabled = true;</span>
<span class="cstat-no" title="statement not covered" >        nodeConfigCache = null;</span>
<span class="cstat-no" title="statement not covered" >        return saveNodeList().then(<span class="fstat-no" title="function not covered" >function() {</span></span>
<span class="cstat-no" title="statement not covered" >            return filterNodeInfo(config);</span>
        });
    } catch (err) {
<span class="cstat-no" title="statement not covered" >        throw new Error("Unrecognised id: "+typeOrId);</span>
    }
}
&nbsp;
<span class="fstat-no" title="function not covered" >function disableNodeSet(typeOrId) {</span>
<span class="cstat-no" title="statement not covered" >    if (!settings.available()) {</span>
<span class="cstat-no" title="statement not covered" >        throw new Error("Settings unavailable");</span>
    }
<span class="cstat-no" title="statement not covered" >    var id = typeOrId;</span>
<span class="cstat-no" title="statement not covered" >    if (nodeTypeToId.hasOwnProperty(typeOrId)) {</span>
<span class="cstat-no" title="statement not covered" >        id = nodeTypeToId[typeOrId];</span>
    }
<span class="cstat-no" title="statement not covered" >    var config;</span>
<span class="cstat-no" title="statement not covered" >    try {</span>
<span class="cstat-no" title="statement not covered" >        config = moduleConfigs[getModule(id)].nodes[getNode(id)];</span>
        // TODO: persist setting
<span class="cstat-no" title="statement not covered" >        config.enabled = false;</span>
<span class="cstat-no" title="statement not covered" >        nodeConfigCache = null;</span>
<span class="cstat-no" title="statement not covered" >        return saveNodeList().then(<span class="fstat-no" title="function not covered" >function() {</span></span>
<span class="cstat-no" title="statement not covered" >            return filterNodeInfo(config);</span>
        });
    } catch (err) {
<span class="cstat-no" title="statement not covered" >        throw new Error("Unrecognised id: "+id);</span>
    }
}
&nbsp;
<span class="fstat-no" title="function not covered" >function cleanModuleList() {</span>
<span class="cstat-no" title="statement not covered" >    var removed = false;</span>
<span class="cstat-no" title="statement not covered" >    for (var mod in moduleConfigs) {</span>
        /* istanbul ignore else */
<span class="cstat-no" title="statement not covered" >        if (moduleConfigs.hasOwnProperty(mod)) {</span>
<span class="cstat-no" title="statement not covered" >            var nodes = moduleConfigs[mod].nodes;</span>
<span class="cstat-no" title="statement not covered" >            var node;</span>
<span class="cstat-no" title="statement not covered" >            if (mod == "node-red") {</span>
                // For core nodes, look for nodes that are enabled, !loaded and !errored
<span class="cstat-no" title="statement not covered" >                for (node in nodes) {</span>
                    /* istanbul ignore else */
<span class="cstat-no" title="statement not covered" >                    if (nodes.hasOwnProperty(node)) {</span>
<span class="cstat-no" title="statement not covered" >                        var n = nodes[node];</span>
<span class="cstat-no" title="statement not covered" >                        if (n.enabled &amp;&amp; !n.err &amp;&amp; !n.loaded) {</span>
<span class="cstat-no" title="statement not covered" >                            removeNode(mod+"/"+node);</span>
<span class="cstat-no" title="statement not covered" >                            removed = true;</span>
                        }
                    }
                }
            } else {
<span class="cstat-no" title="statement not covered" >                if (moduleConfigs[mod] &amp;&amp; !moduleNodes[mod]) {</span>
                    // For node modules, look for missing ones
<span class="cstat-no" title="statement not covered" >                    for (node in nodes) {</span>
                        /* istanbul ignore else */
<span class="cstat-no" title="statement not covered" >                        if (nodes.hasOwnProperty(node)) {</span>
<span class="cstat-no" title="statement not covered" >                            removeNode(mod+"/"+node);</span>
<span class="cstat-no" title="statement not covered" >                            removed = true;</span>
                        }
                    }
<span class="cstat-no" title="statement not covered" >                    delete moduleConfigs[mod];</span>
                }
            }
        }
    }
<span class="cstat-no" title="statement not covered" >    if (removed) {</span>
<span class="cstat-no" title="statement not covered" >        saveNodeList();</span>
    }
}
&nbsp;
var registry = module.exports = {
    init: init,
    load: load,
    clear: clear,
&nbsp;
    registerNodeConstructor: registerNodeConstructor,
    getNodeConstructor: getNodeConstructor,
&nbsp;
    addNodeSet: addNodeSet,
    enableNodeSet: enableNodeSet,
    disableNodeSet: disableNodeSet,
&nbsp;
    removeModule: removeModule,
&nbsp;
    getNodeInfo: getNodeInfo,
    getFullNodeInfo: getFullNodeInfo,
    getNodeList: getNodeList,
    getModuleList: getModuleList,
    getModuleInfo: getModuleInfo,
&nbsp;
    /**
     * Gets all of the node template configs
     * @return all of the node templates in a single string
     */
    getAllNodeConfigs: getAllNodeConfigs,
    getNodeConfig: getNodeConfig,
&nbsp;
    getTypeId: getTypeId,
&nbsp;
    saveNodeList: saveNodeList,
&nbsp;
    cleanModuleList: cleanModuleList
};
&nbsp;
&nbsp;</pre></td></tr>
</table></pre>
</div>
<div class="footer">
    <div class="meta">Generated by <a href="https://github.com/kaizhu256/node-utility2" target="_blank">utility2</a> at Tue Apr 11 2017 17:25:15 GMT+0000 (UTC)</div>
</div>
</body>
</html>


<!doctype html>
<html lang="en">
<head>
    <title>Code coverage report for node-npmtest-node-red/node-red/red/runtime/storage/</title>
    <meta charset="utf-8">
    <style>
        body, html {
            margin:0; padding: 0;
        }
        body {
            font-family: Arial, Helvetica;
            font-size: 10pt;
        }
        div.header, div.footer {
            background: #eee;
            padding: 1em;
        }
        div.header {
            height: 160px;
            padding: 0 1em 0 1em;
            z-index: 100;
            position: fixed;
            top: 0;
            border-bottom: 1px solid #666;
            width: 100%;
        }
        div.footer {
            border-top: 1px solid #666;
        }
        div.body {
            margin-top: 170px;
        }
        div.meta {
            font-size: 90%;
            text-align: center;
        }
        h1, h2, h3 {
            font-weight: normal;
        }
        h1 {
            font-size: 12pt;
        }
        h2 {
            font-size: 10pt;
        }
        pre {
            font-family: Menlo, Monaco, Consolas, Courier New, monospace;
            margin: 0;
            padding: 0;
            font-size: 14px;
            tab-size: 2;
        }

        div.path { font-size: 110%; }
        div.path a:link, div.path a:visited { color: #000; }
        table.coverage { border-collapse: collapse; margin:0; padding: 0 }

        table.coverage td {
            margin: 0;
            padding: 0;
            color: #111;
            vertical-align: top;
        }
        table.coverage td.line-count {
            width: 50px;
            text-align: right;
            padding-right: 5px;
        }
        table.coverage td.line-coverage {
            color: #777 !important;
            text-align: right;
            border-left: 1px solid #666;
            border-right: 1px solid #666;
        }

        table.coverage td.text {
        }

        table.coverage td span.cline-any {
            display: inline-block;
            padding: 0 5px;
            width: 40px;
        }
        table.coverage td span.cline-neutral {
            background: #eee;
        }
        table.coverage td span.cline-yes {
            background: #b5d592;
            color: #999;
        }
        table.coverage td span.cline-no {
            background: #fc8c84;
        }

        .cstat-yes { color: #111; }
        .cstat-no { background: #fc8c84; color: #111; }
        .fstat-no { background: #ffc520; color: #111 !important; }
        .cbranch-no { background:  yellow !important; color: #111; }

        .cstat-skip { background: #ddd; color: #111; }
        .fstat-skip { background: #ddd; color: #111 !important; }
        .cbranch-skip { background: #ddd !important; color: #111; }

        .missing-if-branch {
            display: inline-block;
            margin-right: 10px;
            position: relative;
            padding: 0 4px;
            background: black;
            color: yellow;
        }

        .skip-if-branch {
            display: none;
            margin-right: 10px;
            position: relative;
            padding: 0 4px;
            background: #ccc;
            color: white;
        }

        .missing-if-branch .typ, .skip-if-branch .typ {
            color: inherit !important;
        }

        .entity, .metric { font-weight: bold; }
        .metric { display: inline-block; border: 1px solid #333; padding: 0.3em; background: white; }
        .metric small { font-size: 80%; font-weight: normal; color: #666; }

        div.coverage-summary table { border-collapse: collapse; margin: 3em; font-size: 110%; }
        div.coverage-summary td, div.coverage-summary table  th { margin: 0; padding: 0.25em 1em; border-top: 1px solid #666; border-bottom: 1px solid #666; }
        div.coverage-summary th { text-align: left; border: 1px solid #666; background: #eee; font-weight: normal; }
        div.coverage-summary th.file { border-right: none !important; }
        div.coverage-summary th.pic { border-left: none !important; text-align: right; }
        div.coverage-summary th.pct { border-right: none !important; }
        div.coverage-summary th.abs { border-left: none !important; text-align: right; }
        div.coverage-summary td.pct { text-align: right; border-left: 1px solid #666; }
        div.coverage-summary td.abs { text-align: right; font-size: 90%; color: #444; border-right: 1px solid #666; }
        div.coverage-summary td.file { text-align: right; border-left: 1px solid #666; white-space: nowrap;  }
        div.coverage-summary td.pic { min-width: 120px !important;  }
        div.coverage-summary a:link { color: #000; }
        div.coverage-summary a:visited { color: #333; }
        div.coverage-summary tfoot td { border-top: 1px solid #666; }

        div.coverage-summary .yui3-datatable-sort-indicator, div.coverage-summary .dummy-sort-indicator {
            height: 10px;
            width: 7px;
            display: inline-block;
            margin-left: 0.5em;
        }
        div.coverage-summary .yui3-datatable-sort-indicator {
            background: no-repeat scroll 0 0 transparent;
        }
        div.coverage-summary .yui3-datatable-sorted .yui3-datatable-sort-indicator {
            background-position: 0 -20px;
        }
        div.coverage-summary .yui3-datatable-sorted-desc .yui3-datatable-sort-indicator {
            background-position: 0 -10px;
        }

        .high { background: #b5d592 !important; }
        .medium { background: #ffe87c !important; }
        .low { background: #fc8c84 !important; }

        span.cover-fill, span.cover-empty {
            display:inline-block;
            border:1px solid #444;
            background: white;
            height: 12px;
        }
        span.cover-fill {
            background: #ccc;
            border-right: 1px solid #444;
        }
        span.cover-empty {
            background: white;
            border-left: none;
        }
        span.cover-full {
            border-right: none !important;
        }
        pre.prettyprint {
            border: none !important;
            padding: 0 !important;
            margin: 0 !important;
        }
        .com { color: #999 !important; }
        .ignore-none { color: #999; font-weight: normal; }

    </style>
</head>
<body>
<div class="header low">
    <h1 style="font-weight: bold;">
        <a href="https://github.com/npmtest/node-npmtest-node-red">npmtest-node-red (v0.0.1)</a>
    </h1>
    <h1>Code coverage report for <span class="entity">node-npmtest-node-red/node-red/red/runtime/storage/</span></h1>
    <h2>
        
        Statements: <span class="metric">12.62% <small>(13 / 103)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        
        Branches: <span class="metric">0% <small>(0 / 44)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        
        Functions: <span class="metric">0% <small>(0 / 24)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        
        Lines: <span class="metric">12.62% <small>(13 / 103)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        Ignored: <span class="metric"><span class="ignore-none">none</span></span> &nbsp;&nbsp;&nbsp;&nbsp;
    </h2>
    <div class="path"><a href="../../../../../index.html">All files</a> &#187; node-npmtest-node-red/node-red/red/runtime/storage/</div>
</div>
<div class="body">
<div class="coverage-summary">
<table>
<thead>
<tr>
   <th data-col="file" data-fmt="html" data-html="true" class="file">File</th>
   <th data-col="pic" data-type="number" data-fmt="html" data-html="true" class="pic"></th>
   <th data-col="statements" data-type="number" data-fmt="pct" class="pct">Statements</th>
   <th data-col="statements_raw" data-type="number" data-fmt="html" class="abs"></th>
   <th data-col="branches" data-type="number" data-fmt="pct" class="pct">Branches</th>
   <th data-col="branches_raw" data-type="number" data-fmt="html" class="abs"></th>
   <th data-col="functions" data-type="number" data-fmt="pct" class="pct">Functions</th>
   <th data-col="functions_raw" data-type="number" data-fmt="html" class="abs"></th>
   <th data-col="lines" data-type="number" data-fmt="pct" class="pct">Lines</th>
   <th data-col="lines_raw" data-type="number" data-fmt="html" class="abs"></th>
</tr>
</thead>
<tbody><tr>
	<td class="file low" data-value="index.js"><a href="index.js.html">index.js</a></td>
	<td data-value="12.62" class="pic low"><span class="cover-fill" style="width: 12px;"></span><span class="cover-empty" style="width:88px;"></span></td>
	<td data-value="12.62" class="pct low">12.62%</td>
	<td data-value="103" class="abs low">(13&nbsp;/&nbsp;103)</td>
	<td data-value="0" class="pct low">0%</td>
	<td data-value="44" class="abs low">(0&nbsp;/&nbsp;44)</td>
	<td data-value="0" class="pct low">0%</td>
	<td data-value="24" class="abs low">(0&nbsp;/&nbsp;24)</td>
	<td data-value="12.62" class="pct low">12.62%</td>
	<td data-value="103" class="abs low">(13&nbsp;/&nbsp;103)</td>
	</tr>

</tbody>
</table>
</div></div>
<div class="footer">
    <div class="meta">Generated by <a href="https://github.com/kaizhu256/node-utility2" target="_blank">utility2</a> at Tue Apr 11 2017 17:25:15 GMT+0000 (UTC)</div>
</div>
</body>
</html>


<!doctype html>
<html lang="en">
<head>
    <title>Code coverage report for node-npmtest-node-red/node-red/red/runtime/storage/index.js</title>
    <meta charset="utf-8">
    <style>
        body, html {
            margin:0; padding: 0;
        }
        body {
            font-family: Arial, Helvetica;
            font-size: 10pt;
        }
        div.header, div.footer {
            background: #eee;
            padding: 1em;
        }
        div.header {
            height: 160px;
            padding: 0 1em 0 1em;
            z-index: 100;
            position: fixed;
            top: 0;
            border-bottom: 1px solid #666;
            width: 100%;
        }
        div.footer {
            border-top: 1px solid #666;
        }
        div.body {
            margin-top: 170px;
        }
        div.meta {
            font-size: 90%;
            text-align: center;
        }
        h1, h2, h3 {
            font-weight: normal;
        }
        h1 {
            font-size: 12pt;
        }
        h2 {
            font-size: 10pt;
        }
        pre {
            font-family: Menlo, Monaco, Consolas, Courier New, monospace;
            margin: 0;
            padding: 0;
            font-size: 14px;
            tab-size: 2;
        }

        div.path { font-size: 110%; }
        div.path a:link, div.path a:visited { color: #000; }
        table.coverage { border-collapse: collapse; margin:0; padding: 0 }

        table.coverage td {
            margin: 0;
            padding: 0;
            color: #111;
            vertical-align: top;
        }
        table.coverage td.line-count {
            width: 50px;
            text-align: right;
            padding-right: 5px;
        }
        table.coverage td.line-coverage {
            color: #777 !important;
            text-align: right;
            border-left: 1px solid #666;
            border-right: 1px solid #666;
        }

        table.coverage td.text {
        }

        table.coverage td span.cline-any {
            display: inline-block;
            padding: 0 5px;
            width: 40px;
        }
        table.coverage td span.cline-neutral {
            background: #eee;
        }
        table.coverage td span.cline-yes {
            background: #b5d592;
            color: #999;
        }
        table.coverage td span.cline-no {
            background: #fc8c84;
        }

        .cstat-yes { color: #111; }
        .cstat-no { background: #fc8c84; color: #111; }
        .fstat-no { background: #ffc520; color: #111 !important; }
        .cbranch-no { background:  yellow !important; color: #111; }

        .cstat-skip { background: #ddd; color: #111; }
        .fstat-skip { background: #ddd; color: #111 !important; }
        .cbranch-skip { background: #ddd !important; color: #111; }

        .missing-if-branch {
            display: inline-block;
            margin-right: 10px;
            position: relative;
            padding: 0 4px;
            background: black;
            color: yellow;
        }

        .skip-if-branch {
            display: none;
            margin-right: 10px;
            position: relative;
            padding: 0 4px;
            background: #ccc;
            color: white;
        }

        .missing-if-branch .typ, .skip-if-branch .typ {
            color: inherit !important;
        }

        .entity, .metric { font-weight: bold; }
        .metric { display: inline-block; border: 1px solid #333; padding: 0.3em; background: white; }
        .metric small { font-size: 80%; font-weight: normal; color: #666; }

        div.coverage-summary table { border-collapse: collapse; margin: 3em; font-size: 110%; }
        div.coverage-summary td, div.coverage-summary table  th { margin: 0; padding: 0.25em 1em; border-top: 1px solid #666; border-bottom: 1px solid #666; }
        div.coverage-summary th { text-align: left; border: 1px solid #666; background: #eee; font-weight: normal; }
        div.coverage-summary th.file { border-right: none !important; }
        div.coverage-summary th.pic { border-left: none !important; text-align: right; }
        div.coverage-summary th.pct { border-right: none !important; }
        div.coverage-summary th.abs { border-left: none !important; text-align: right; }
        div.coverage-summary td.pct { text-align: right; border-left: 1px solid #666; }
        div.coverage-summary td.abs { text-align: right; font-size: 90%; color: #444; border-right: 1px solid #666; }
        div.coverage-summary td.file { text-align: right; border-left: 1px solid #666; white-space: nowrap;  }
        div.coverage-summary td.pic { min-width: 120px !important;  }
        div.coverage-summary a:link { color: #000; }
        div.coverage-summary a:visited { color: #333; }
        div.coverage-summary tfoot td { border-top: 1px solid #666; }

        div.coverage-summary .yui3-datatable-sort-indicator, div.coverage-summary .dummy-sort-indicator {
            height: 10px;
            width: 7px;
            display: inline-block;
            margin-left: 0.5em;
        }
        div.coverage-summary .yui3-datatable-sort-indicator {
            background: no-repeat scroll 0 0 transparent;
        }
        div.coverage-summary .yui3-datatable-sorted .yui3-datatable-sort-indicator {
            background-position: 0 -20px;
        }
        div.coverage-summary .yui3-datatable-sorted-desc .yui3-datatable-sort-indicator {
            background-position: 0 -10px;
        }

        .high { background: #b5d592 !important; }
        .medium { background: #ffe87c !important; }
        .low { background: #fc8c84 !important; }

        span.cover-fill, span.cover-empty {
            display:inline-block;
            border:1px solid #444;
            background: white;
            height: 12px;
        }
        span.cover-fill {
            background: #ccc;
            border-right: 1px solid #444;
        }
        span.cover-empty {
            background: white;
            border-left: none;
        }
        span.cover-full {
            border-right: none !important;
        }
        pre.prettyprint {
            border: none !important;
            padding: 0 !important;
            margin: 0 !important;
        }
        .com { color: #999 !important; }
        .ignore-none { color: #999; font-weight: normal; }

    </style>
</head>
<body>
<div class="header low">
    <h1 style="font-weight: bold;">
        <a href="https://github.com/npmtest/node-npmtest-node-red">npmtest-node-red (v0.0.1)</a>
    </h1>
    <h1>Code coverage report for <span class="entity">node-npmtest-node-red/node-red/red/runtime/storage/index.js</span></h1>
    <h2>
        
        Statements: <span class="metric">12.62% <small>(13 / 103)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        
        Branches: <span class="metric">0% <small>(0 / 44)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        
        Functions: <span class="metric">0% <small>(0 / 24)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        
        Lines: <span class="metric">12.62% <small>(13 / 103)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        Ignored: <span class="metric"><span class="ignore-none">none</span></span> &nbsp;&nbsp;&nbsp;&nbsp;
    </h2>
    <div class="path"><a href="../../../../../index.html">All files</a> &#187; <a href="index.html">node-npmtest-node-red/node-red/red/runtime/storage/</a> &#187; index.js</div>
</div>
<div class="body">
<pre><table class="coverage">
<tr><td class="line-count">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
164
165
166
167
168
169
170
171
172
173
174
175
176
177
178
179
180
181
182
183
184
185
186
187
188
189
190
191
192
193
194
195
196
197
198
199
200
201
202
203
204
205
206
207
208
209
210
211
212
213
214
215
216
217
218
219
220</td><td class="line-coverage"><span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span></td><td class="text"><pre class="prettyprint lang-js">/**
 * Copyright JS Foundation and other contributors, http://js.foundation
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 **/
&nbsp;
var when = require('when');
var Path = require('path');
var crypto = require('crypto');
&nbsp;
var log = require("../log");
&nbsp;
var runtime;
var storageModule;
var settingsAvailable;
var sessionsAvailable;
&nbsp;
<span class="fstat-no" title="function not covered" >function moduleSelector(aSettings) {</span>
<span class="cstat-no" title="statement not covered" >    var toReturn;</span>
<span class="cstat-no" title="statement not covered" >    if (aSettings.storageModule) {</span>
<span class="cstat-no" title="statement not covered" >        if (typeof aSettings.storageModule === "string") {</span>
            // TODO: allow storage modules to be specified by absolute path
<span class="cstat-no" title="statement not covered" >            toReturn = require("./"+aSettings.storageModule);</span>
        } else {
<span class="cstat-no" title="statement not covered" >            toReturn = aSettings.storageModule;</span>
        }
    } else {
<span class="cstat-no" title="statement not covered" >        toReturn = require("./localfilesystem");</span>
    }
<span class="cstat-no" title="statement not covered" >    return toReturn;</span>
}
&nbsp;
<span class="fstat-no" title="function not covered" >function is_malicious(path) {</span>
<span class="cstat-no" title="statement not covered" >    return path.indexOf('../') != -1 || path.indexOf('..\\') != -1;</span>
}
&nbsp;
var storageModuleInterface = {
        init: <span class="fstat-no" title="function not covered" >function(_runtime) {</span>
<span class="cstat-no" title="statement not covered" >            runtime = _runtime;</span>
<span class="cstat-no" title="statement not covered" >            try {</span>
<span class="cstat-no" title="statement not covered" >                storageModule = moduleSelector(runtime.settings);</span>
<span class="cstat-no" title="statement not covered" >                settingsAvailable = storageModule.hasOwnProperty("getSettings") &amp;&amp; storageModule.hasOwnProperty("saveSettings");</span>
<span class="cstat-no" title="statement not covered" >                sessionsAvailable = storageModule.hasOwnProperty("getSessions") &amp;&amp; storageModule.hasOwnProperty("saveSessions");</span>
            } catch (e) {
<span class="cstat-no" title="statement not covered" >                return when.reject(e);</span>
            }
<span class="cstat-no" title="statement not covered" >            return storageModule.init(runtime.settings);</span>
        },
        getFlows: <span class="fstat-no" title="function not covered" >function() {</span>
<span class="cstat-no" title="statement not covered" >            return storageModule.getFlows().then(<span class="fstat-no" title="function not covered" >function(flows) {</span></span>
<span class="cstat-no" title="statement not covered" >                return storageModule.getCredentials().then(<span class="fstat-no" title="function not covered" >function(creds) {</span></span>
<span class="cstat-no" title="statement not covered" >                    var result = {</span>
                        flows: flows,
                        credentials: creds
                    };
<span class="cstat-no" title="statement not covered" >                    result.rev = crypto.createHash('md5').update(JSON.stringify(result)).digest("hex");</span>
<span class="cstat-no" title="statement not covered" >                    return result;</span>
                })
            });
        },
        saveFlows: <span class="fstat-no" title="function not covered" >function(config) {</span>
<span class="cstat-no" title="statement not covered" >            var flows = config.flows;</span>
<span class="cstat-no" title="statement not covered" >            var credentials = config.credentials;</span>
<span class="cstat-no" title="statement not covered" >            var credentialSavePromise;</span>
<span class="cstat-no" title="statement not covered" >            if (config.credentialsDirty) {</span>
<span class="cstat-no" title="statement not covered" >                credentialSavePromise = storageModule.saveCredentials(credentials);</span>
            } else {
<span class="cstat-no" title="statement not covered" >                credentialSavePromise = when.resolve();</span>
            }
<span class="cstat-no" title="statement not covered" >            delete config.credentialsDirty;</span>
&nbsp;
<span class="cstat-no" title="statement not covered" >            return credentialSavePromise.then(<span class="fstat-no" title="function not covered" >function() {</span></span>
<span class="cstat-no" title="statement not covered" >                return storageModule.saveFlows(flows).then(<span class="fstat-no" title="function not covered" >function() {</span></span>
<span class="cstat-no" title="statement not covered" >                    return crypto.createHash('md5').update(JSON.stringify(config)).digest("hex");</span>
                })
            });
        },
        // getCredentials: function() {
        //     return storageModule.getCredentials();
        // },
        // saveCredentials: function(credentials) {
        //     return storageModule.saveCredentials(credentials);
        // },
        getSettings: <span class="fstat-no" title="function not covered" >function() {</span>
<span class="cstat-no" title="statement not covered" >            if (settingsAvailable) {</span>
<span class="cstat-no" title="statement not covered" >                return storageModule.getSettings();</span>
            } else {
<span class="cstat-no" title="statement not covered" >                return when.resolve(null);</span>
            }
        },
        saveSettings: <span class="fstat-no" title="function not covered" >function(settings) {</span>
<span class="cstat-no" title="statement not covered" >            if (settingsAvailable) {</span>
<span class="cstat-no" title="statement not covered" >                return storageModule.saveSettings(settings);</span>
            } else {
<span class="cstat-no" title="statement not covered" >                return when.resolve();</span>
            }
        },
        getSessions: <span class="fstat-no" title="function not covered" >function() {</span>
<span class="cstat-no" title="statement not covered" >            if (sessionsAvailable) {</span>
<span class="cstat-no" title="statement not covered" >                return storageModule.getSessions();</span>
            } else {
<span class="cstat-no" title="statement not covered" >                return when.resolve(null);</span>
            }
        },
        saveSessions: <span class="fstat-no" title="function not covered" >function(sessions) {</span>
<span class="cstat-no" title="statement not covered" >            if (sessionsAvailable) {</span>
<span class="cstat-no" title="statement not covered" >                return storageModule.saveSessions(sessions);</span>
            } else {
<span class="cstat-no" title="statement not covered" >                return when.resolve();</span>
            }
        },
&nbsp;
        /* Library Functions */
&nbsp;
        getLibraryEntry: <span class="fstat-no" title="function not covered" >function(type, path) {</span>
<span class="cstat-no" title="statement not covered" >            if (is_malicious(path)) {</span>
<span class="cstat-no" title="statement not covered" >                var err = new Error();</span>
<span class="cstat-no" title="statement not covered" >                err.code = "forbidden";</span>
<span class="cstat-no" title="statement not covered" >                return when.reject(err);</span>
            }
<span class="cstat-no" title="statement not covered" >            return storageModule.getLibraryEntry(type, path);</span>
        },
        saveLibraryEntry: <span class="fstat-no" title="function not covered" >function(type, path, meta, body) {</span>
<span class="cstat-no" title="statement not covered" >            if (is_malicious(path)) {</span>
<span class="cstat-no" title="statement not covered" >                var err = new Error();</span>
<span class="cstat-no" title="statement not covered" >                err.code = "forbidden";</span>
<span class="cstat-no" title="statement not covered" >                return when.reject(err);</span>
            }
<span class="cstat-no" title="statement not covered" >            return storageModule.saveLibraryEntry(type, path, meta, body);</span>
        },
&nbsp;
/* Deprecated functions */
        getAllFlows: <span class="fstat-no" title="function not covered" >function() {</span>
<span class="cstat-no" title="statement not covered" >            if (storageModule.hasOwnProperty("getAllFlows")) {</span>
<span class="cstat-no" title="statement not covered" >                return storageModule.getAllFlows();</span>
            } else {
<span class="cstat-no" title="statement not covered" >                return listFlows("/");</span>
            }
        },
        getFlow: <span class="fstat-no" title="function not covered" >function(fn) {</span>
<span class="cstat-no" title="statement not covered" >            if (is_malicious(fn)) {</span>
<span class="cstat-no" title="statement not covered" >                var err = new Error();</span>
<span class="cstat-no" title="statement not covered" >                err.code = "forbidden";</span>
<span class="cstat-no" title="statement not covered" >                return when.reject(err);</span>
            }
<span class="cstat-no" title="statement not covered" >            if (storageModule.hasOwnProperty("getFlow")) {</span>
<span class="cstat-no" title="statement not covered" >                return storageModule.getFlow(fn);</span>
            } else {
<span class="cstat-no" title="statement not covered" >                return storageModule.getLibraryEntry("flows",fn);</span>
            }
&nbsp;
        },
        saveFlow: <span class="fstat-no" title="function not covered" >function(fn, data) {</span>
<span class="cstat-no" title="statement not covered" >            if (is_malicious(fn)) {</span>
<span class="cstat-no" title="statement not covered" >                var err = new Error();</span>
<span class="cstat-no" title="statement not covered" >                err.code = "forbidden";</span>
<span class="cstat-no" title="statement not covered" >                return when.reject(err);</span>
            }
<span class="cstat-no" title="statement not covered" >            if (storageModule.hasOwnProperty("saveFlow")) {</span>
<span class="cstat-no" title="statement not covered" >                return storageModule.saveFlow(fn, data);</span>
            } else {
<span class="cstat-no" title="statement not covered" >                return storageModule.saveLibraryEntry("flows",fn,{},data);</span>
            }
        }
/* End deprecated functions */
&nbsp;
}
&nbsp;
&nbsp;
<span class="fstat-no" title="function not covered" >function listFlows(path) {</span>
<span class="cstat-no" title="statement not covered" >    return storageModule.getLibraryEntry("flows",path).then(<span class="fstat-no" title="function not covered" >function(res) {</span></span>
<span class="cstat-no" title="statement not covered" >        return when.promise(<span class="fstat-no" title="function not covered" >function(resolve) {</span></span>
<span class="cstat-no" title="statement not covered" >            var promises = [];</span>
<span class="cstat-no" title="statement not covered" >            res.forEach(<span class="fstat-no" title="function not covered" >function(r) {</span></span>
<span class="cstat-no" title="statement not covered" >                if (typeof r === "string") {</span>
<span class="cstat-no" title="statement not covered" >                    promises.push(listFlows(Path.join(path,r)));</span>
                } else {
<span class="cstat-no" title="statement not covered" >                    promises.push(when.resolve(r));</span>
                }
            });
<span class="cstat-no" title="statement not covered" >            var i=0;</span>
<span class="cstat-no" title="statement not covered" >            when.settle(promises).then(<span class="fstat-no" title="function not covered" >function(res2) {</span></span>
<span class="cstat-no" title="statement not covered" >                var result = {};</span>
<span class="cstat-no" title="statement not covered" >                res2.forEach(<span class="fstat-no" title="function not covered" >function(r) {</span></span>
                    // TODO: name||fn
<span class="cstat-no" title="statement not covered" >                    if (r.value.fn) {</span>
<span class="cstat-no" title="statement not covered" >                        var name = r.value.name;</span>
<span class="cstat-no" title="statement not covered" >                        if (!name) {</span>
<span class="cstat-no" title="statement not covered" >                            name = r.value.fn.split(".")[0];</span>
                        }
<span class="cstat-no" title="statement not covered" >                        result.f = result.f || [];</span>
<span class="cstat-no" title="statement not covered" >                        result.f.push(name);</span>
                    } else {
<span class="cstat-no" title="statement not covered" >                        result.d = result.d || {};</span>
<span class="cstat-no" title="statement not covered" >                        result.d[res[i]] = r.value;</span>
                        //console.log("&gt;",r.value);
                    }
<span class="cstat-no" title="statement not covered" >                    i++;</span>
                });
<span class="cstat-no" title="statement not covered" >                resolve(result);</span>
            });
        });
    });
}
&nbsp;
&nbsp;
&nbsp;
module.exports = storageModuleInterface;
&nbsp;
&nbsp;</pre></td></tr>
</table></pre>
</div>
<div class="footer">
    <div class="meta">Generated by <a href="https://github.com/kaizhu256/node-utility2" target="_blank">utility2</a> at Tue Apr 11 2017 17:25:15 GMT+0000 (UTC)</div>
</div>
</body>
</html>


</div>
</div>
